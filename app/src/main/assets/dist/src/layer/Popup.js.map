{"version":3,"file":"Popup.js","sourceRoot":"","sources":["../../../../../../../../browser/src/layer/Popup.js"],"names":[],"mappings":"AAAA,gCAAgC;AAChC;;GAEG;AAEH,CAAC,CAAC,GAAG,CAAC,YAAY,CAAC;IAClB,iBAAiB,EAAE,IAAI;CACvB,CAAC,CAAC;AAEH,CAAC,CAAC,KAAK,GAAG,CAAC,CAAC,KAAK,CAAC,MAAM,CAAC;IAExB,OAAO,EAAE;QACR,IAAI,EAAE,WAAW;QAEjB,QAAQ,EAAE,EAAE;QACZ,QAAQ,EAAE,GAAG;QACb,uBAAuB;QACvB,MAAM,EAAE,CAAC,CAAC,EAAE,CAAC,CAAC;QAEd,OAAO,EAAE,IAAI;QACb,cAAc,EAAE,CAAC,CAAC,EAAE,CAAC,CAAC;QACtB,kCAAkC;QAClC,sCAAsC;QAEtC,WAAW,EAAE,IAAI;QACjB,SAAS,EAAE,IAAI;QACf,qBAAqB;QACrB,iBAAiB;KACjB;IAED,UAAU,EAAE,UAAU,OAAO,EAAE,MAAM;QACpC,CAAC,CAAC,UAAU,CAAC,IAAI,EAAE,OAAO,CAAC,CAAC;QAE5B,IAAI,CAAC,OAAO,GAAG,MAAM,CAAC;IACvB,CAAC;IAED,KAAK,EAAE,UAAU,GAAG;QACnB,IAAI,CAAC,IAAI,CAAC,UAAU,EAAE;YACrB,IAAI,CAAC,WAAW,EAAE,CAAC;SACnB;QAED,IAAI,GAAG,CAAC,aAAa,EAAE;YACtB,CAAC,CAAC,OAAO,CAAC,UAAU,CAAC,IAAI,CAAC,UAAU,EAAE,CAAC,CAAC,CAAC;SACzC;QAED,YAAY,CAAC,IAAI,CAAC,cAAc,CAAC,CAAC;QAClC,IAAI,CAAC,OAAO,EAAE,CAAC,WAAW,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC;QAC5C,IAAI,CAAC,MAAM,EAAE,CAAC;QAEd,IAAI,GAAG,CAAC,aAAa,EAAE;YACtB,CAAC,CAAC,OAAO,CAAC,UAAU,CAAC,IAAI,CAAC,UAAU,EAAE,CAAC,CAAC,CAAC;SACzC;QAED,GAAG,CAAC,IAAI,CAAC,WAAW,EAAE,EAAC,KAAK,EAAE,IAAI,EAAC,CAAC,CAAC;QAErC,IAAI,IAAI,CAAC,OAAO,EAAE;YACjB,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,WAAW,EAAE,EAAC,KAAK,EAAE,IAAI,EAAC,EAAE,IAAI,CAAC,CAAC;SACpD;IACF,CAAC;IAED,MAAM,EAAE,UAAU,GAAG;QACpB,GAAG,CAAC,SAAS,CAAC,IAAI,CAAC,CAAC;QACpB,OAAO,IAAI,CAAC;IACb,CAAC;IAED,QAAQ,EAAE,UAAU,GAAG;QACtB,IAAI,GAAG,CAAC,aAAa,EAAE;YACtB,CAAC,CAAC,OAAO,CAAC,UAAU,CAAC,IAAI,CAAC,UAAU,EAAE,CAAC,CAAC,CAAC;YACzC,IAAI,CAAC,cAAc,GAAG,UAAU,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,OAAO,CAAC,MAAM,EAAE,CAAC,CAAC,OAAO,EAAE,IAAI,CAAC,UAAU,CAAC,EAAE,GAAG,CAAC,CAAC;SAC5F;aAAM;YACN,CAAC,CAAC,OAAO,CAAC,MAAM,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC;SAClC;QAED,GAAG,CAAC,IAAI,CAAC,YAAY,EAAE,EAAC,KAAK,EAAE,IAAI,EAAC,CAAC,CAAC;QAEtC,IAAI,IAAI,CAAC,OAAO,EAAE;YACjB,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,YAAY,EAAE,EAAC,KAAK,EAAE,IAAI,EAAC,EAAE,IAAI,CAAC,CAAC;SACrD;IACF,CAAC;IAED,SAAS,EAAE;QACV,OAAO,IAAI,CAAC,OAAO,CAAC;IACrB,CAAC;IAED,SAAS,EAAE,UAAU,MAAM;QAC1B,IAAI,CAAC,OAAO,GAAG,CAAC,CAAC,MAAM,CAAC,MAAM,CAAC,CAAC;QAChC,IAAI,IAAI,CAAC,IAAI,EAAE;YACd,IAAI,CAAC,eAAe,EAAE,CAAC;YACvB,IAAI,CAAC,UAAU,EAAE,CAAC;SAClB;QACD,OAAO,IAAI,CAAC;IACb,CAAC;IAED,UAAU,EAAE,UAAU,OAAO;QAC5B,IAAI,CAAC,QAAQ,GAAG,OAAO,CAAC;QACxB,IAAI,CAAC,MAAM,EAAE,CAAC;QACd,OAAO,IAAI,CAAC;IACb,CAAC;IAED,MAAM,EAAE;QACP,IAAI,CAAC,IAAI,CAAC,IAAI,EAAE;YAAE,OAAO;SAAE;QAE3B,IAAI,CAAC,UAAU,CAAC,KAAK,CAAC,UAAU,GAAG,QAAQ,CAAC;QAE5C,IAAI,CAAC,cAAc,EAAE,CAAC;QACtB,IAAI,CAAC,aAAa,EAAE,CAAC;QACrB,IAAI,CAAC,eAAe,EAAE,CAAC;QAEvB,IAAI,CAAC,UAAU,CAAC,KAAK,CAAC,UAAU,GAAG,EAAE,CAAC;QAEtC,IAAI,CAAC,UAAU,EAAE,CAAC;IACnB,CAAC;IAED,SAAS,EAAE;QACV,IAAI,MAAM,GAAG;YACZ,SAAS,EAAE,IAAI,CAAC,eAAe;YAC/B,IAAI,EAAE,IAAI,CAAC,eAAe;SAC1B,CAAC;QACF,IAAI,OAAO,GAAG,IAAI,CAAC,OAAO,CAAC;QAE3B,IAAI,cAAc,IAAI,OAAO,CAAC,CAAC,CAAC,OAAO,CAAC,YAAY,CAAC,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC,iBAAiB,EAAE;YAC3F,MAAM,CAAC,QAAQ,GAAG,IAAI,CAAC,MAAM,CAAC;SAC9B;QACD,IAAI,OAAO,CAAC,UAAU,EAAE;YACvB,MAAM,CAAC,OAAO,GAAG,IAAI,CAAC,UAAU,CAAC;SACjC;QAED,OAAO,MAAM,CAAC;IACf,CAAC;IAED,MAAM,EAAE;QACP,OAAO,CAAC,CAAC,IAAI,CAAC,IAAI,IAAI,IAAI,CAAC,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAC;IAChD,CAAC;IAED,MAAM,EAAE;QACP,IAAI,IAAI,CAAC,IAAI,EAAE;YACd,IAAI,CAAC,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,CAAC;SAC3B;IACF,CAAC;IAED,WAAW,EAAE;QACZ,IAAI,MAAM,GAAG,eAAe,EACxB,SAAS,GAAG,IAAI,CAAC,UAAU,GAAG,CAAC,CAAC,OAAO,CAAC,MAAM,CAAC,KAAK,EACvD,MAAM,GAAG,GAAG,GAAG,CAAC,IAAI,CAAC,OAAO,CAAC,SAAS,IAAI,EAAE,CAAC;YAC7C,oBAAoB,CAAC,CAAC;QAEvB,IAAI,IAAI,CAAC,OAAO,CAAC,WAAW,EAAE;YAC7B,IAAI,WAAW,GAAG,IAAI,CAAC,YAAY,GAAG,CAAC,CAAC,OAAO,CAAC,MAAM,CAAC,GAAG,EAAE,MAAM,GAAG,eAAe,EAAE,SAAS,CAAC,CAAC;YACjG,WAAW,CAAC,IAAI,GAAG,QAAQ,CAAC;YAC5B,WAAW,CAAC,SAAS,GAAG,QAAQ,CAAC;YAEjC,CAAC,CAAC,QAAQ,CAAC,EAAE,CAAC,WAAW,EAAE,OAAO,EAAE,IAAI,CAAC,mBAAmB,EAAE,IAAI,CAAC,CAAC;SACpE;QAED,IAAI,OAAO,GAAG,IAAI,CAAC,QAAQ,GAAG,CAAC,CAAC,OAAO,CAAC,MAAM,CAAC,KAAK,EAAE,MAAM,GAAG,kBAAkB,EAAE,SAAS,CAAC,CAAC;QAC9F,IAAI,CAAC,YAAY,GAAG,CAAC,CAAC,OAAO,CAAC,MAAM,CAAC,KAAK,EAAE,MAAM,GAAG,UAAU,EAAE,OAAO,CAAC,CAAC;QAE1E,CAAC,CAAC,QAAQ;aACR,uBAAuB,CAAC,OAAO,CAAC;aAChC,wBAAwB,CAAC,IAAI,CAAC,YAAY,CAAC;aAC3C,EAAE,CAAC,OAAO,EAAE,aAAa,EAAE,CAAC,CAAC,QAAQ,CAAC,eAAe,CAAC,CAAC;QAEzD,IAAI,CAAC,aAAa,GAAG,CAAC,CAAC,OAAO,CAAC,MAAM,CAAC,KAAK,EAAE,MAAM,GAAG,gBAAgB,EAAE,SAAS,CAAC,CAAC;QACnF,IAAI,CAAC,IAAI,GAAG,CAAC,CAAC,OAAO,CAAC,MAAM,CAAC,KAAK,EAAE,MAAM,GAAG,MAAM,EAAE,IAAI,CAAC,aAAa,CAAC,CAAC;QAEzE,IAAI,IAAI,CAAC,OAAO,CAAC,eAAe,EAAE;YACjC,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,kBAAkB,CAAC,GAAG,IAAI,CAAC,QAAQ,CAAC,KAAK,CAAC,kBAAkB,CAAC,GAAG,IAAI,CAAC,OAAO,CAAC,eAAe,CAAC;SAC7G;QAED,IAAI,IAAI,CAAC,OAAO,CAAC,KAAK,EAAE;YACvB,IAAI,CAAC,QAAQ,CAAC,KAAK,CAAC,OAAO,CAAC,GAAG,IAAI,CAAC,OAAO,CAAC,KAAK,CAAC;SAClD;IAEF,CAAC;IAED,cAAc,EAAE;QACf,IAAI,CAAC,IAAI,CAAC,QAAQ,EAAE;YAAE,OAAO;SAAE;QAE/B,IAAI,IAAI,GAAG,IAAI,CAAC,YAAY,CAAC;QAE7B,IAAI,OAAO,IAAI,CAAC,QAAQ,KAAK,QAAQ,EAAE;YACtC,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC,QAAQ,CAAC;SAC/B;aAAM;YACN,OAAO,IAAI,CAAC,aAAa,EAAE,EAAE;gBAC5B,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC;aAClC;YACD,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;SAChC;QACD,IAAI,CAAC,IAAI,CAAC,eAAe,CAAC,CAAC;IAC5B,CAAC;IAED,aAAa,EAAE;QACd,IAAI,SAAS,GAAG,IAAI,CAAC,YAAY,EAC7B,KAAK,GAAG,SAAS,CAAC,KAAK,CAAC;QAE5B,KAAK,CAAC,KAAK,GAAG,EAAE,CAAC;QACjB,KAAK,CAAC,UAAU,GAAG,QAAQ,CAAC;QAE5B,IAAI,KAAK,GAAG,SAAS,CAAC,WAAW,CAAC;QAClC,KAAK,GAAG,IAAI,CAAC,GAAG,CAAC,KAAK,EAAE,IAAI,CAAC,OAAO,CAAC,QAAQ,CAAC,CAAC;QAC/C,KAAK,GAAG,IAAI,CAAC,GAAG,CAAC,KAAK,EAAE,IAAI,CAAC,OAAO,CAAC,QAAQ,CAAC,CAAC;QAE/C,KAAK,CAAC,KAAK,GAAG,CAAC,KAAK,GAAG,CAAC,CAAC,GAAG,IAAI,CAAC;QACjC,KAAK,CAAC,UAAU,GAAG,EAAE,CAAC;QAEtB,KAAK,CAAC,MAAM,GAAG,EAAE,CAAC;QAElB,IAAI,MAAM,GAAG,SAAS,CAAC,YAAY,EAC/B,SAAS,GAAG,IAAI,CAAC,OAAO,CAAC,SAAS,EAClC,aAAa,GAAG,wBAAwB,CAAC;QAE7C,IAAI,SAAS,IAAI,MAAM,GAAG,SAAS,EAAE;YACpC,KAAK,CAAC,MAAM,GAAG,SAAS,GAAG,IAAI,CAAC;YAChC,CAAC,CAAC,OAAO,CAAC,QAAQ,CAAC,SAAS,EAAE,aAAa,CAAC,CAAC;SAC7C;aAAM;YACN,CAAC,CAAC,OAAO,CAAC,WAAW,CAAC,SAAS,EAAE,aAAa,CAAC,CAAC;SAChD;QAED,IAAI,CAAC,eAAe,GAAG,IAAI,CAAC,UAAU,CAAC,WAAW,CAAC;IACpD,CAAC;IAID,eAAe,EAAE;QAChB,IAAI,CAAC,IAAI,CAAC,IAAI,EAAE;YAAE,OAAO;SAAE;QAE3B,IAAI,MAAM,GAAG,CAAC,CAAC,KAAK,CAAC,IAAI,CAAC,OAAO,CAAC,MAAM,CAAC,CAAC;QAC1C,IAAI,MAAM,GAAG,CAAC,CAAC,KAAK,CAAC,0BAA0B,CAAC,IAAI,CAAC,OAAO,EAAE;YAC7D,KAAK,EAAE,IAAI,CAAC,eAAe;YAC3B,MAAM,EAAE,IAAI,CAAC,UAAU,CAAC,YAAY;SACpC,EAAE,IAAI,CAAC,IAAI,EACZ,IAAI,CAAC,CAAC,KAAK,CACV,MAAM,CAAC,CAAC,GAAG,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,eAAe,GAAG,CAAC,CAAC,EAC/C,CAAC,IAAI,CAAC,UAAU,CAAC,YAAY,GAAG,MAAM,CAAC,CAAC,CAAC,CAAC,CAAC;QAC5C,IAAI,GAAG,GAAG,MAAM,CAAC,QAAQ,CAAC;QAE1B,MAAM,GAAG,MAAM,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC;QAEzB,IAAI,SAAS,GAAG,IAAI,CAAC,IAAI,CAAC,SAAS,CAAC,SAAS,EAAE,CAAC;QAChD,IAAI,MAAM,GAAG,IAAI,CAAC,gBAAgB,GAAG,CAAC,MAAM,CAAC,CAAC,EAC1C,IAAI,GAAG,IAAI,CAAC,cAAc,GAAG,CAAC,IAAI,CAAC,KAAK,CAAC,SAAS,CAAC,CAAC,CAAC,IAAI,CAAC,eAAe,CAAC,CAAC,CAAC,IAAI,CAAC,eAAe,GAAG,CAAC,CAAC,GAAG,MAAM,CAAC,CAAC,CAAC;QAErH,yFAAyF;QACzF,IAAI,CAAC,UAAU,CAAC,KAAK,CAAC,MAAM,GAAG,MAAM,GAAG,IAAI,CAAC;QAC7C,IAAI,CAAC,UAAU,CAAC,KAAK,CAAC,IAAI,GAAG,IAAI,GAAG,IAAI,CAAC;QACzC,IAAI,CAAC,UAAU,CAAC,KAAK,CAAC,UAAU,GAAG,MAAM,CAAC,UAAU,CAAC;IACtD,CAAC;IAED,UAAU,EAAE;QACX,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC,OAAO,EAAE;YAAE,OAAO;SAAE;QAEtC,IAAI,GAAG,GAAG,IAAI,CAAC,IAAI,EACf,eAAe,GAAG,IAAI,CAAC,UAAU,CAAC,YAAY,EAC9C,cAAc,GAAG,IAAI,CAAC,eAAe,EACrC,QAAQ,GAAG,IAAI,CAAC,CAAC,KAAK,CAAC,IAAI,CAAC,cAAc,EAAE,CAAC,eAAe,GAAG,IAAI,CAAC,gBAAgB,CAAC,CAAC;QAE1F,IAAI,YAAY,GAAG,GAAG,CAAC,0BAA0B,CAAC,QAAQ,CAAC,EACvD,OAAO,GAAG,CAAC,CAAC,KAAK,CAAC,IAAI,CAAC,OAAO,CAAC,cAAc,CAAC,EAC9C,SAAS,GAAG,CAAC,CAAC,KAAK,CAAC,IAAI,CAAC,OAAO,CAAC,qBAAqB,IAAI,OAAO,CAAC,EAClE,SAAS,GAAG,CAAC,CAAC,KAAK,CAAC,IAAI,CAAC,OAAO,CAAC,yBAAyB,IAAI,OAAO,CAAC,EACtE,IAAI,GAAG,GAAG,CAAC,OAAO,EAAE,EACpB,EAAE,GAAG,CAAC,EACN,EAAE,GAAG,CAAC,CAAC;QAEX,IAAI,YAAY,CAAC,CAAC,GAAG,cAAc,GAAG,SAAS,CAAC,CAAC,GAAG,IAAI,CAAC,CAAC,EAAE,EAAE,QAAQ;YACrE,EAAE,GAAG,YAAY,CAAC,CAAC,GAAG,cAAc,GAAG,IAAI,CAAC,CAAC,GAAG,SAAS,CAAC,CAAC,CAAC;SAC5D;QACD,IAAI,YAAY,CAAC,CAAC,GAAG,EAAE,GAAG,SAAS,CAAC,CAAC,GAAG,CAAC,EAAE,EAAE,OAAO;YACnD,EAAE,GAAG,YAAY,CAAC,CAAC,GAAG,SAAS,CAAC,CAAC,CAAC;SAClC;QACD,IAAI,YAAY,CAAC,CAAC,GAAG,eAAe,GAAG,SAAS,CAAC,CAAC,GAAG,IAAI,CAAC,CAAC,EAAE,EAAE,SAAS;YACvE,EAAE,GAAG,YAAY,CAAC,CAAC,GAAG,eAAe,GAAG,IAAI,CAAC,CAAC,GAAG,SAAS,CAAC,CAAC,CAAC;SAC7D;QACD,IAAI,YAAY,CAAC,CAAC,GAAG,EAAE,GAAG,SAAS,CAAC,CAAC,GAAG,CAAC,EAAE,EAAE,MAAM;YAClD,EAAE,GAAG,YAAY,CAAC,CAAC,GAAG,SAAS,CAAC,CAAC,CAAC;SAClC;QAED,IAAI,EAAE,IAAI,EAAE,EAAE;YACb,GAAG;iBACE,IAAI,CAAC,cAAc,CAAC;iBACpB,KAAK,CAAC,CAAC,EAAE,EAAE,EAAE,CAAC,CAAC,CAAC;SACrB;IACF,CAAC;IAED,mBAAmB,EAAE,UAAU,CAAC;QAC/B,IAAI,CAAC,MAAM,EAAE,CAAC;QACd,CAAC,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC;IACpB,CAAC;CACD,CAAC,CAAC;AAEH,CAAC,CAAC,KAAK,GAAG,UAAU,OAAO,EAAE,MAAM;IAClC,OAAO,IAAI,CAAC,CAAC,KAAK,CAAC,OAAO,EAAE,MAAM,CAAC,CAAC;AACrC,CAAC,CAAC;AAGF,CAAC,CAAC,GAAG,CAAC,OAAO,CAAC;IACb,SAAS,EAAE,UAAU,KAAK,EAAE,MAAM,EAAE,OAAO;QAC1C,IAAI,CAAC,CAAC,KAAK,YAAY,CAAC,CAAC,KAAK,CAAC,EAAE;YAChC,IAAI,OAAO,GAAG,KAAK,CAAC;YAEpB,KAAK,GAAG,IAAI,CAAC,CAAC,KAAK,CAAC,OAAO,CAAC,CAAC,UAAU,CAAC,OAAO,CAAC,CAAC;SACjD;QAED,IAAI,MAAM,EAAE;YACX,KAAK,CAAC,SAAS,CAAC,MAAM,CAAC,CAAC;SACxB;QAED,IAAI,IAAI,CAAC,QAAQ,CAAC,KAAK,CAAC,EAAE;YACzB,OAAO,IAAI,CAAC;SACZ;QAED,IAAI,IAAI,CAAC,MAAM,IAAI,IAAI,CAAC,MAAM,CAAC,OAAO,CAAC,SAAS,EAAE;YACjD,IAAI,CAAC,UAAU,EAAE,CAAC;SAClB;QAED,IAAI,CAAC,MAAM,GAAG,KAAK,CAAC;QACpB,OAAO,IAAI,CAAC,QAAQ,CAAC,KAAK,CAAC,CAAC;IAC7B,CAAC;IAED,UAAU,EAAE,UAAU,KAAK;QAC1B,IAAI,CAAC,KAAK,IAAI,KAAK,KAAK,IAAI,CAAC,MAAM,EAAE;YACpC,KAAK,GAAG,IAAI,CAAC,MAAM,CAAC;YACpB,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC;SACnB;QACD,IAAI,KAAK,EAAE;YACV,IAAI,CAAC,WAAW,CAAC,KAAK,CAAC,CAAC;SACxB;QACD,OAAO,IAAI,CAAC;IACb,CAAC;CACD,CAAC,CAAC","sourcesContent":["/* -*- js-indent-level: 8 -*- */\n/*\n * L.Popup is used for displaying popups on the map.\n */\n\nL.Map.mergeOptions({\n\tclosePopupOnClick: true\n});\n\nL.Popup = L.Layer.extend({\n\n\toptions: {\n\t\tpane: 'popupPane',\n\n\t\tminWidth: 50,\n\t\tmaxWidth: 300,\n\t\t// maxHeight: <Number>,\n\t\toffset: [0, 7],\n\n\t\tautoPan: true,\n\t\tautoPanPadding: [5, 5],\n\t\t// autoPanPaddingTopLeft: <Point>,\n\t\t// autoPanPaddingBottomRight: <Point>,\n\n\t\tcloseButton: true,\n\t\tautoClose: true,\n\t\t// keepInView: false,\n\t\t// className: '',\n\t},\n\n\tinitialize: function (options, source) {\n\t\tL.setOptions(this, options);\n\n\t\tthis._source = source;\n\t},\n\n\tonAdd: function (map) {\n\t\tif (!this._container) {\n\t\t\tthis._initLayout();\n\t\t}\n\n\t\tif (map._fadeAnimated) {\n\t\t\tL.DomUtil.setOpacity(this._container, 0);\n\t\t}\n\n\t\tclearTimeout(this._removeTimeout);\n\t\tthis.getPane().appendChild(this._container);\n\t\tthis.update();\n\n\t\tif (map._fadeAnimated) {\n\t\t\tL.DomUtil.setOpacity(this._container, 1);\n\t\t}\n\n\t\tmap.fire('popupopen', {popup: this});\n\n\t\tif (this._source) {\n\t\t\tthis._source.fire('popupopen', {popup: this}, true);\n\t\t}\n\t},\n\n\topenOn: function (map) {\n\t\tmap.openPopup(this);\n\t\treturn this;\n\t},\n\n\tonRemove: function (map) {\n\t\tif (map._fadeAnimated) {\n\t\t\tL.DomUtil.setOpacity(this._container, 0);\n\t\t\tthis._removeTimeout = setTimeout(L.bind(L.DomUtil.remove, L.DomUtil, this._container), 200);\n\t\t} else {\n\t\t\tL.DomUtil.remove(this._container);\n\t\t}\n\n\t\tmap.fire('popupclose', {popup: this});\n\n\t\tif (this._source) {\n\t\t\tthis._source.fire('popupclose', {popup: this}, true);\n\t\t}\n\t},\n\n\tgetLatLng: function () {\n\t\treturn this._latlng;\n\t},\n\n\tsetLatLng: function (latlng) {\n\t\tthis._latlng = L.latLng(latlng);\n\t\tif (this._map) {\n\t\t\tthis._updatePosition();\n\t\t\tthis._adjustPan();\n\t\t}\n\t\treturn this;\n\t},\n\n\tsetContent: function (content) {\n\t\tthis._content = content;\n\t\tthis.update();\n\t\treturn this;\n\t},\n\n\tupdate: function () {\n\t\tif (!this._map) { return; }\n\n\t\tthis._container.style.visibility = 'hidden';\n\n\t\tthis._updateContent();\n\t\tthis._updateLayout();\n\t\tthis._updatePosition();\n\n\t\tthis._container.style.visibility = '';\n\n\t\tthis._adjustPan();\n\t},\n\n\tgetEvents: function () {\n\t\tvar events = {\n\t\t\tviewreset: this._updatePosition,\n\t\t\tmove: this._updatePosition\n\t\t};\n\t\tvar options = this.options;\n\n\t\tif ('closeOnClick' in options ? options.closeOnClick : this._map.options.closePopupOnClick) {\n\t\t\tevents.preclick = this._close;\n\t\t}\n\t\tif (options.keepInView) {\n\t\t\tevents.moveend = this._adjustPan;\n\t\t}\n\n\t\treturn events;\n\t},\n\n\tisOpen: function () {\n\t\treturn !!this._map && this._map.hasLayer(this);\n\t},\n\n\t_close: function () {\n\t\tif (this._map) {\n\t\t\tthis._map.closePopup(this);\n\t\t}\n\t},\n\n\t_initLayout: function () {\n\t\tvar prefix = 'leaflet-popup',\n\t\t    container = this._container = L.DomUtil.create('div',\n\t\t\tprefix + ' ' + (this.options.className || '') +\n\t\t\t' leaflet-zoom-hide');\n\n\t\tif (this.options.closeButton) {\n\t\t\tvar closeButton = this._closeButton = L.DomUtil.create('a', prefix + '-close-button', container);\n\t\t\tcloseButton.href = '#close';\n\t\t\tcloseButton.innerHTML = '&#215;';\n\n\t\t\tL.DomEvent.on(closeButton, 'click', this._onCloseButtonClick, this);\n\t\t}\n\n\t\tvar wrapper = this._wrapper = L.DomUtil.create('div', prefix + '-content-wrapper', container);\n\t\tthis._contentNode = L.DomUtil.create('div', prefix + '-content', wrapper);\n\n\t\tL.DomEvent\n\t\t\t.disableClickPropagation(wrapper)\n\t\t\t.disableScrollPropagation(this._contentNode)\n\t\t\t.on(wrapper, 'contextmenu', L.DomEvent.stopPropagation);\n\n\t\tthis._tipContainer = L.DomUtil.create('div', prefix + '-tip-container', container);\n\t\tthis._tip = L.DomUtil.create('div', prefix + '-tip', this._tipContainer);\n\n\t\tif (this.options.backgroundColor) {\n\t\t\tthis._tip.style['background-color'] = this._wrapper.style['background-color'] = this.options.backgroundColor;\n\t\t}\n\n\t\tif (this.options.color) {\n\t\t\tthis._wrapper.style['color'] = this.options.color;\n\t\t}\n\n\t},\n\n\t_updateContent: function () {\n\t\tif (!this._content) { return; }\n\n\t\tvar node = this._contentNode;\n\n\t\tif (typeof this._content === 'string') {\n\t\t\tnode.innerHTML = this._content;\n\t\t} else {\n\t\t\twhile (node.hasChildNodes()) {\n\t\t\t\tnode.removeChild(node.firstChild);\n\t\t\t}\n\t\t\tnode.appendChild(this._content);\n\t\t}\n\t\tthis.fire('contentupdate');\n\t},\n\n\t_updateLayout: function () {\n\t\tvar container = this._contentNode,\n\t\t    style = container.style;\n\n\t\tstyle.width = '';\n\t\tstyle.whiteSpace = 'nowrap';\n\n\t\tvar width = container.offsetWidth;\n\t\twidth = Math.min(width, this.options.maxWidth);\n\t\twidth = Math.max(width, this.options.minWidth);\n\n\t\tstyle.width = (width + 1) + 'px';\n\t\tstyle.whiteSpace = '';\n\n\t\tstyle.height = '';\n\n\t\tvar height = container.offsetHeight,\n\t\t    maxHeight = this.options.maxHeight,\n\t\t    scrolledClass = 'leaflet-popup-scrolled';\n\n\t\tif (maxHeight && height > maxHeight) {\n\t\t\tstyle.height = maxHeight + 'px';\n\t\t\tL.DomUtil.addClass(container, scrolledClass);\n\t\t} else {\n\t\t\tL.DomUtil.removeClass(container, scrolledClass);\n\t\t}\n\n\t\tthis._containerWidth = this._container.offsetWidth;\n\t},\n\n\n\n\t_updatePosition: function () {\n\t\tif (!this._map) { return; }\n\n\t\tvar offset = L.point(this.options.offset);\n\t\tvar posVis = L.Layer.getLayerPositionVisibility(this._latlng, {\n\t\t\twidth: this._containerWidth,\n\t\t\theight: this._container.offsetHeight\n\t\t}, this._map,\n\t\tnew L.Point(\n\t\t\toffset.x - Math.round(this._containerWidth / 2),\n\t\t\t-this._container.offsetHeight - offset.y));\n\t\tvar pos = posVis.position;\n\n\t\toffset = offset.add(pos);\n\n\t\tvar rtlAdjust = this._map._docLayer.isCalcRTL();\n\t\tvar bottom = this._containerBottom = -offset.y,\n\t\t    left = this._containerLeft = -Math.round(rtlAdjust ? this._containerWidth : this._containerWidth / 2) + offset.x;\n\n\t\t// bottom position the popup in case the height of the popup changes (images loading etc)\n\t\tthis._container.style.bottom = bottom + 'px';\n\t\tthis._container.style.left = left + 'px';\n\t\tthis._container.style.visibility = posVis.visibility;\n\t},\n\n\t_adjustPan: function () {\n\t\tif (!this.options.autoPan) { return; }\n\n\t\tvar map = this._map,\n\t\t    containerHeight = this._container.offsetHeight,\n\t\t    containerWidth = this._containerWidth,\n\t\t    layerPos = new L.Point(this._containerLeft, -containerHeight - this._containerBottom);\n\n\t\tvar containerPos = map.layerPointToContainerPoint(layerPos),\n\t\t    padding = L.point(this.options.autoPanPadding),\n\t\t    paddingTL = L.point(this.options.autoPanPaddingTopLeft || padding),\n\t\t    paddingBR = L.point(this.options.autoPanPaddingBottomRight || padding),\n\t\t    size = map.getSize(),\n\t\t    dx = 0,\n\t\t    dy = 0;\n\n\t\tif (containerPos.x + containerWidth + paddingBR.x > size.x) { // right\n\t\t\tdx = containerPos.x + containerWidth - size.x + paddingBR.x;\n\t\t}\n\t\tif (containerPos.x - dx - paddingTL.x < 0) { // left\n\t\t\tdx = containerPos.x - paddingTL.x;\n\t\t}\n\t\tif (containerPos.y + containerHeight + paddingBR.y > size.y) { // bottom\n\t\t\tdy = containerPos.y + containerHeight - size.y + paddingBR.y;\n\t\t}\n\t\tif (containerPos.y - dy - paddingTL.y < 0) { // top\n\t\t\tdy = containerPos.y - paddingTL.y;\n\t\t}\n\n\t\tif (dx || dy) {\n\t\t\tmap\n\t\t\t    .fire('autopanstart')\n\t\t\t    .panBy([dx, dy]);\n\t\t}\n\t},\n\n\t_onCloseButtonClick: function (e) {\n\t\tthis._close();\n\t\tL.DomEvent.stop(e);\n\t}\n});\n\nL.popup = function (options, source) {\n\treturn new L.Popup(options, source);\n};\n\n\nL.Map.include({\n\topenPopup: function (popup, latlng, options) { // (Popup) or (String || HTMLElement, LatLng[, Object])\n\t\tif (!(popup instanceof L.Popup)) {\n\t\t\tvar content = popup;\n\n\t\t\tpopup = new L.Popup(options).setContent(content);\n\t\t}\n\n\t\tif (latlng) {\n\t\t\tpopup.setLatLng(latlng);\n\t\t}\n\n\t\tif (this.hasLayer(popup)) {\n\t\t\treturn this;\n\t\t}\n\n\t\tif (this._popup && this._popup.options.autoClose) {\n\t\t\tthis.closePopup();\n\t\t}\n\n\t\tthis._popup = popup;\n\t\treturn this.addLayer(popup);\n\t},\n\n\tclosePopup: function (popup) {\n\t\tif (!popup || popup === this._popup) {\n\t\t\tpopup = this._popup;\n\t\t\tthis._popup = null;\n\t\t}\n\t\tif (popup) {\n\t\t\tthis.removeLayer(popup);\n\t\t}\n\t\treturn this;\n\t}\n});\n"]}