{"version":3,"file":"CommentSection.js","sourceRoot":"","sources":["../../../../../../../../../browser/src/layer/tile/CommentSection.ts"],"names":[],"mappings":"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","sourcesContent":["/* See CanvasSectionContainer.ts for explanations. */\n\ndeclare var L: any;\ndeclare var app: any;\ndeclare var _: any;\ndeclare var Autolinker: any;\ndeclare var Hammer: any;\ndeclare var $: any;\n\napp.definitions.Comment =\nclass Comment {\n\tcontext: CanvasRenderingContext2D = null;\n\tmyTopLeft: Array<number> = [0, 0];\n\tdocumentTopLeft: Array<number> = null;\n\tcontainerObject: any = null;\n\tdpiScale: number = null;\n\tname: string = L.CSections.Comment.name;\n\tbackgroundColor: string = '';\n\tbackgroundOpacity: number = 1; // Valid when backgroundColor is valid.\n\tborderColor: string = null;\n\tboundToSection: string = null;\n\tanchor: Array<any> = new Array(0);\n\tdocumentObject: boolean = true;\n\tposition: Array<number> = [0, 0];\n\tsize: Array<number> = new Array(0);\n\texpand: Array<string> = new Array(0);\n\tisLocated: boolean = false;\n\tshowSection: boolean = true;\n\tprocessingOrder: number = L.CSections.Comment.processingOrder;\n\tdrawingOrder: number = L.CSections.Comment.drawingOrder;\n\tzIndex: number = L.CSections.Comment.zIndex;\n\tinteractable: boolean = true;\n\tsectionProperties: any = {};\n\tvalid: boolean = true;\n\n\t// Implemented by section container.\n\tstopPropagating: () => void;\n\n\t// Implemented by section container. Document objects only.\n\tsetPosition: (x: number, y: number) => void;\n\n\t// Implemented by section container.\n\tisCalcRTL: () => boolean;\n\n\tmap: any;\n\tpendingInit: boolean = true;\n\tisCollapsed: boolean = false;\n\n\tconstructor (data: any, options: any, commentListSectionPointer: any) {\n\t\tthis.map = L.Map.THIS;\n\n\t\tif (!options)\n\t\t\toptions = {};\n\n\t\tthis.sectionProperties.commentListSection = commentListSectionPointer;\n\n\t\tthis.sectionProperties.docLayer = this.map._docLayer;\n\t\tthis.sectionProperties.selectedAreaPoint = null;\n\t\tthis.sectionProperties.cellCursorPoint = null;\n\n\t\tthis.sectionProperties.draggingStarted = false;\n\t\tthis.sectionProperties.dragStartPosition = null;\n\n\t\tthis.sectionProperties.minWidth = options.minWidth ? options.minWidth : 160;\n\t\tthis.sectionProperties.maxHeight = options.maxHeight ? options.maxHeight : 50;\n\t\tthis.sectionProperties.imgSize = options.imgSize ? options.imgSize : [32, 32];\n\t\tthis.sectionProperties.margin = options.margin ? options.margin : [40, 40];\n\t\tthis.sectionProperties.noMenu = options.noMenu ? options.noMenu : false;\n\n\t\tthis.sectionProperties.data = data;\n\t\tthis.sectionProperties.annotationMarker = null;\n\t\tthis.sectionProperties.wrapper = null;\n\t\tthis.sectionProperties.collapsed = null;\n\t\tthis.sectionProperties.container = null;\n\t\tthis.sectionProperties.author = null;\n\t\tthis.sectionProperties.resolvedTextElement = null;\n\t\tthis.sectionProperties.authorAvatarImg = null;\n\t\tthis.sectionProperties.authorCollapsedAvatarImg = null;\n\t\tthis.sectionProperties.authorAvatartdImg = null;\n\t\tthis.sectionProperties.contentAuthor = null;\n\t\tthis.sectionProperties.contentDate = null;\n\t\tthis.sectionProperties.acceptButton = null;\n\t\tthis.sectionProperties.rejectButton = null;\n\t\tthis.sectionProperties.menu = null;\n\t\tthis.sectionProperties.captionNode = null;\n\t\tthis.sectionProperties.captionText = null;\n\n\t\tthis.sectionProperties.contentNode = null;\n\t\tthis.sectionProperties.nodeModify = null;\n\t\tthis.sectionProperties.nodeModifyText = null;\n\t\tthis.sectionProperties.contentText = null;\n\t\tthis.sectionProperties.nodeReply = null;\n\t\tthis.sectionProperties.nodeReplyText = null;\n\t\tthis.sectionProperties.contextMenu = false;\n\n\t\tthis.sectionProperties.highlightedTextColor = '#777777'; // Writer.\n\t\tthis.sectionProperties.usedTextColor = this.sectionProperties.data.color; // Writer.\n\t\tthis.sectionProperties.showSelectedCoordinate = true; // Writer.\n\n\t\tif (this.sectionProperties.docLayer._docType === 'presentation' || this.sectionProperties.docLayer._docType === 'drawing') {\n\t\t\tthis.sectionProperties.parthash = this.sectionProperties.data.parthash;\n\t\t\tthis.sectionProperties.partIndex = this.sectionProperties.docLayer._partHashes.indexOf(String(this.sectionProperties.parthash));\n\t\t}\n\n\t\tthis.sectionProperties.isHighlighted = false;\n\n\t\tthis.name = data.id === 'new' ? 'new comment': 'comment ' + data.id;\n\n\t\tthis.sectionProperties.isRemoved = false;\n\t}\n\n\t// Comments import can be costly if the document has a lot of them. If they are all imported/initialized\n\t// when online gets comments message from core, the initial doc render is delayed. To avoid that we do\n\t// lazy import of each comment when it needs to be shown (based on its coordinates).\n\tprivate doPendingInitializationInView (force: boolean = false) {\n\t\tif (!this.pendingInit)\n\t\t\treturn;\n\n\t\tif (!force && !this.convertRectanglesToCoreCoordinates())\n\t\t\treturn;\n\n\t\tvar button = L.DomUtil.create('div', 'annotation-btns-container', this.sectionProperties.nodeModify);\n\t\tL.DomEvent.on(this.sectionProperties.nodeModifyText, 'blur', this.onLostFocus, this);\n\t\tL.DomEvent.on(this.sectionProperties.nodeReplyText, 'blur', this.onLostFocusReply, this);\n\t\tthis.createButton(button, 'annotation-cancel-' + this.sectionProperties.data.id, 'annotation-button button-secondary', _('Cancel'), this.onCancelClick);\n\t\tthis.createButton(button, 'annotation-save-' + this.sectionProperties.data.id, 'annotation-button button-primary',_('Save'), this.onSaveComment);\n\t\tbutton = L.DomUtil.create('div', '', this.sectionProperties.nodeReply);\n\t\tthis.createButton(button, 'annotation-cancel-reply-' + this.sectionProperties.data.id, 'annotation-button button-secondary', _('Cancel'), this.onCancelClick);\n\t\tthis.createButton(button, 'annotation-reply-' + this.sectionProperties.data.id, 'annotation-button button-primary', _('Reply'), this.onReplyClick);\n\t\tL.DomEvent.disableScrollPropagation(this.sectionProperties.container);\n\n\t\tthis.sectionProperties.container.style.visibility = 'hidden';\n\t\tthis.sectionProperties.nodeModify.style.display = 'none';\n\t\tthis.sectionProperties.nodeReply.style.display = 'none';\n\n\t\tvar events = ['click', 'dblclick', 'mousedown', 'mouseup', 'mouseover', 'mouseout', 'keydown', 'keypress', 'keyup', 'touchstart', 'touchmove', 'touchend'];\n\t\tL.DomEvent.on(this.sectionProperties.container, 'click', this.onMouseClick, this);\n\t\tL.DomEvent.on(this.sectionProperties.container, 'keydown', this.onEscKey, this);\n\n\t\tfor (var it = 0; it < events.length; it++) {\n\t\t\tL.DomEvent.on(this.sectionProperties.container, events[it], L.DomEvent.stopPropagation, this);\n\t\t}\n\n\t\tL.DomEvent.on(this.sectionProperties.container, 'touchstart',\n\t\t\tfunction (e: TouchEvent) {\n\t\t\t\tif (e && e.touches.length > 1) {\n\t\t\t\t\tL.DomEvent.preventDefault(e);\n\t\t\t\t}\n\t\t\t},\n\t\t\tthis);\n\n\t\tif ((<any>window).mode.isDesktop()) {\n\t\t\tL.DomEvent.on(this.sectionProperties.container, {\n\t\t\t\tmousewheel: this.map.scrollHandler._onWheelScroll,\n\t\t\t\tMozMousePixelScroll: L.DomEvent.preventDefault\n\t\t\t}, this.map.scrollHandler);\n\t\t}\n\n\t\tthis.update();\n\n\t\tthis.pendingInit = false;\n\t}\n\n\tpublic onInitialize () {\n\t\tthis.createContainerAndWrapper();\n\n\t\tthis.createAuthorTable();\n\n\t\tif (this.sectionProperties.data.trackchange && !this.map.isPermissionReadOnly()) {\n\t\t\tthis.createTrackChangeButtons();\n\t\t}\n\n\t\tif (this.sectionProperties.noMenu !== true && (this.map.isPermissionEditForComments() || this.map.isPermissionEdit())) {\n\t\t\tthis.createMenu();\n\t\t}\n\n\t\tif (this.sectionProperties.data.trackchange) {\n\t\t\tthis.sectionProperties.captionNode = L.DomUtil.create('div', 'cool-annotation-caption', this.sectionProperties.wrapper);\n\t\t\tthis.sectionProperties.captionText = L.DomUtil.create('div', '', this.sectionProperties.captionNode);\n\t\t}\n\n\t\tthis.sectionProperties.contentNode = L.DomUtil.create('div', 'cool-annotation-content cool-dont-break', this.sectionProperties.wrapper);\n\t\tthis.sectionProperties.contentNode.id = 'annotation-content-area-' + this.sectionProperties.data.id;\n\t\tthis.sectionProperties.nodeModify = L.DomUtil.create('div', 'cool-annotation-edit' + ' modify-annotation', this.sectionProperties.wrapper);\n\t\tthis.sectionProperties.nodeModifyText = L.DomUtil.create('textarea', 'cool-annotation-textarea', this.sectionProperties.nodeModify);\n\t\tthis.sectionProperties.nodeModifyText.id = 'annotation-modify-textarea-' + this.sectionProperties.data.id;\n\t\tthis.sectionProperties.contentText = L.DomUtil.create('div', '', this.sectionProperties.contentNode);\n\t\tthis.sectionProperties.nodeReply = L.DomUtil.create('div', 'cool-annotation-edit' + ' reply-annotation', this.sectionProperties.wrapper);\n\t\tthis.sectionProperties.nodeReplyText = L.DomUtil.create('textarea', 'cool-annotation-textarea', this.sectionProperties.nodeReply);\n\t\tthis.sectionProperties.nodeReplyText.id = 'annotation-reply-textarea-' + this.sectionProperties.data.id;\n\n\t\tthis.sectionProperties.container.style.visibility = 'hidden';\n\n\t\tthis.doPendingInitializationInView();\n\n\t\tthis.setExpanded();\n\t}\n\n\tprivate createContainerAndWrapper () {\n\t\tvar isRTL = document.documentElement.dir === 'rtl';\n\t\tthis.sectionProperties.container = L.DomUtil.create('div', 'cool-annotation' + (isRTL ? ' rtl' : ''));\n\t\tthis.sectionProperties.container.id = 'comment-container-' + this.sectionProperties.data.id;\n\n\t\tvar mobileClass = (<any>window).mode.isMobile() ? ' wizard-comment-box': '';\n\n\t\tif (this.sectionProperties.data.trackchange) {\n\t\t\tthis.sectionProperties.wrapper = L.DomUtil.create('div', 'cool-annotation-redline-content-wrapper' + mobileClass, this.sectionProperties.container);\n\t\t} else {\n\t\t\tthis.sectionProperties.wrapper = L.DomUtil.create('div', 'cool-annotation-content-wrapper' + mobileClass, this.sectionProperties.container);\n\t\t}\n\n\t\tthis.sectionProperties.collapsed = L.DomUtil.create('div', 'cool-annotation-collapsed', this.sectionProperties.container);\n\n\t\tdocument.getElementById('document-container').appendChild(this.sectionProperties.container);\n\t}\n\n\tprivate createAuthorTable () {\n\t\tthis.sectionProperties.author = L.DomUtil.create('table', 'cool-annotation-table', this.sectionProperties.wrapper);\n\n\t\tvar tbody = L.DomUtil.create('tbody', '', this.sectionProperties.author);\n\t\tvar rowResolved = L.DomUtil.create('tr', '', tbody);\n\t\tvar tdResolved = L.DomUtil.create('td', 'cool-annotation-resolved', rowResolved);\n\t\tvar pResolved = L.DomUtil.create('div', 'cool-annotation-content-resolved', tdResolved);\n\t\tthis.sectionProperties.resolvedTextElement = pResolved;\n\n\t\tthis.updateResolvedField(this.sectionProperties.data.resolved);\n\n\t\tvar tr = L.DomUtil.create('tr', '', tbody);\n\t\tthis.sectionProperties.authorRow = tr;\n\t\ttr.id = 'author table row ' + this.sectionProperties.data.id;\n\t\tvar tdImg = L.DomUtil.create('td', 'cool-annotation-img', tr);\n\t\tvar tdAuthor = L.DomUtil.create('td', 'cool-annotation-author', tr);\n\t\tvar imgAuthor = L.DomUtil.create('img', 'avatar-img', tdImg);\n\n\t\timgAuthor.setAttribute('src', L.LOUtil.getImageURL('user.svg'));\n\t\timgAuthor.setAttribute('width', this.sectionProperties.imgSize[0]);\n\t\timgAuthor.setAttribute('height', this.sectionProperties.imgSize[1]);\n\t\timgAuthor.onerror = function () { imgAuthor.setAttribute('src', L.LOUtil.getImageURL('user.svg')); };\n\n\t\tvar imgCollapsedAuthor = L.DomUtil.create('img', 'avatar-img', this.sectionProperties.collapsed);\n\t\timgCollapsedAuthor.setAttribute('src', L.LOUtil.getImageURL('user.svg'));\n\t\timgCollapsedAuthor.setAttribute('width', this.sectionProperties.imgSize[0]);\n\t\timgCollapsedAuthor.setAttribute('height', this.sectionProperties.imgSize[1]);\n\t\timgCollapsedAuthor.onerror = function () { imgCollapsedAuthor.setAttribute('src', L.LOUtil.getImageURL('user.svg')); };\n\t\tthis.sectionProperties.replyCountNode = L.DomUtil.create('div', 'cool-annotation-reply-count-collapsed', this.sectionProperties.collapsed);\n\t\tthis.sectionProperties.replyCountNode.style.display = 'none';\n\n\t\tthis.sectionProperties.authorAvatarImg = imgAuthor;\n\t\tthis.sectionProperties.authorCollapsedAvatarImg = imgCollapsedAuthor;\n\t\tthis.sectionProperties.authorAvatartdImg = tdImg;\n\t\tthis.sectionProperties.contentAuthor = L.DomUtil.create('div', 'cool-annotation-content-author', tdAuthor);\n\t\tthis.sectionProperties.contentDate = L.DomUtil.create('div', 'cool-annotation-date', tdAuthor);\n\t}\n\n\tprivate createMenu () {\n\t\tvar tdMenu = L.DomUtil.create('td', 'cool-annotation-menubar', this.sectionProperties.authorRow);\n\t\tthis.sectionProperties.menu = L.DomUtil.create('div', this.sectionProperties.data.trackchange ? 'cool-annotation-menu-redline' : 'cool-annotation-menu', tdMenu);\n\t\tthis.sectionProperties.menu.id = 'comment-annotation-menu-' + this.sectionProperties.data.id;\n\t\tthis.sectionProperties.menu.onclick = this.menuOnMouseClick.bind(this);\n\t\tvar divMenuTooltipText = _('Open menu');\n\t\tthis.sectionProperties.menu.dataset.title = divMenuTooltipText;\n\t\tthis.sectionProperties.menu.setAttribute('aria-label', divMenuTooltipText);\n\t\tthis.sectionProperties.menu.annotation = this;\n\t}\n\n\tpublic setData (data: any) {\n\t\tthis.sectionProperties.data = data;\n\t}\n\n\tprivate createTrackChangeButtons () {\n\t\tvar tdAccept = L.DomUtil.create('td', 'cool-annotation-menubar', this.sectionProperties.authorRow);\n\t\tvar acceptButton = this.sectionProperties.acceptButton = L.DomUtil.create('button', 'cool-redline-accept-button', tdAccept);\n\n\t\tvar tdReject = L.DomUtil.create('td', 'cool-annotation-menubar', this.sectionProperties.authorRow);\n\t\tvar rejectButton = this.sectionProperties.rejectButton = L.DomUtil.create('button', 'cool-redline-reject-button', tdReject);\n\n\t\tacceptButton.dataset.title = _('Accept change');\n\t\tacceptButton.setAttribute('aria-label', _('Accept change'));\n\n\t\tL.DomEvent.on(acceptButton, 'click', function() {\n\t\t\tthis.map.fire('RedlineAccept', {id: this.sectionProperties.data.id});\n\t\t}, this);\n\n\t\trejectButton.dataset.title = _('Reject change');\n\t\trejectButton.setAttribute('aria-label', _('Reject change'));\n\n\t\tL.DomEvent.on(rejectButton, 'click', function() {\n\t\t\tthis.map.fire('RedlineReject', {id: this.sectionProperties.data.id});\n\t\t}, this);\n\t}\n\n\tprivate createButton (container: any, id: any, cssClass: string, value: any, handler: any) {\n\t\tvar button = L.DomUtil.create('input', cssClass, container);\n\t\tbutton.id = id;\n\t\tbutton.type = 'button';\n\t\tbutton.value = value;\n\t\tL.DomEvent.on(button, 'mousedown', L.DomEvent.preventDefault);\n\t\tL.DomEvent.on(button, 'click', handler, this);\n\t}\n\n\tpublic parentOf (comment: any) {\n\t\treturn this.sectionProperties.data.id === comment.sectionProperties.data.parent;\n\t}\n\n\tpublic updateResolvedField (state: string) {\n\t\tthis.sectionProperties.resolvedTextElement.innerText = state === 'true' ? _('Resolved') : '';\n\t}\n\n\tprivate updateContent () {\n\t\tthis.sectionProperties.contentText.innerText = this.sectionProperties.data.text ? this.sectionProperties.data.text: '';\n\t\t// Get the escaped HTML out and find for possible, useful links\n\t\tvar linkedText = Autolinker.link(this.sectionProperties.contentText.outerHTML);\n\t\t// Set the property of text field directly. This is insecure otherwise because it doesn't escape the input\n\t\t// But we have already escaped the input before and only thing we are adding on top of that is Autolinker\n\t\t// generated text.\n\t\tthis.sectionProperties.contentText.innerHTML = linkedText;\n\t\t// Original unlinked text\n\t\tthis.sectionProperties.contentText.origText = this.sectionProperties.data.text ? this.sectionProperties.data.text: '';\n\t\tthis.sectionProperties.nodeModifyText.textContent = this.sectionProperties.data.text ? this.sectionProperties.data.text: '';\n\t\tthis.sectionProperties.contentAuthor.innerText = this.sectionProperties.data.author;\n\n\t\tthis.updateResolvedField(this.sectionProperties.data.resolved);\n\t\tif (this.sectionProperties.data.avatar) {\n\t\t\tthis.sectionProperties.authorAvatarImg.setAttribute('src', this.sectionProperties.data.avatar);\n\t\t\tthis.sectionProperties.authorCollapsedAvatarImg.setAttribute('src', this.sectionProperties.data.avatar);\n\t\t}\n\t\telse {\n\t\t\t$(this.sectionProperties.authorAvatarImg).css('padding-top', '4px');\n\t\t}\n\t\tvar user = this.map.getViewId(this.sectionProperties.data.author);\n\t\tif (user >= 0) {\n\t\t\tvar color = L.LOUtil.rgbToHex(this.map.getViewColor(user));\n\t\t\tthis.sectionProperties.authorAvatartdImg.style.borderColor = color;\n\t\t}\n\n\t\tvar d = new Date(this.sectionProperties.data.dateTime.replace(/,.*/, 'Z'));\n\t\tvar dateOptions: any = { weekday: 'short', year: 'numeric', month: 'short', day: 'numeric' };\n\t\tthis.sectionProperties.contentDate.innerText = isNaN(d.getTime()) ? this.sectionProperties.data.dateTime: d.toLocaleDateString((<any>String).locale, dateOptions);\n\n\t\tif (this.sectionProperties.data.trackchange) {\n\t\t\tthis.sectionProperties.captionText.innerText = this.sectionProperties.data.description;\n\t\t}\n\t}\n\n\tprivate updateLayout () {\n\t\tvar style = this.sectionProperties.wrapper.style;\n\t\tstyle.width = '';\n\t\tstyle.whiteSpace = 'nowrap';\n\n\t\tstyle.whiteSpace = '';\n\t}\n\n\tprivate setPositionAndSize () {\n\t\tvar rectangles = this.sectionProperties.data.rectanglesOriginal;\n\t\tif (rectangles && this.sectionProperties.docLayer._docType === 'text') {\n\t\t\tvar xMin: number = Infinity, yMin: number = Infinity, xMax: number = 0, yMax: number = 0;\n\t\t\tfor (var i = 0; i < rectangles.length; i++) {\n\t\t\t\tif (rectangles[i][0] < xMin)\n\t\t\t\t\txMin = rectangles[i][0];\n\n\t\t\t\tif (rectangles[i][1] < yMin)\n\t\t\t\t\tyMin = rectangles[i][1];\n\n\t\t\t\tif (rectangles[i][0] + rectangles[i][2] > xMax)\n\t\t\t\t\txMax = rectangles[i][0] + rectangles[i][2];\n\n\t\t\t\tif (rectangles[i][1] + rectangles[i][3] > yMax)\n\t\t\t\t\tyMax = rectangles[i][1] + rectangles[i][3];\n\t\t\t}\n\t\t\t// Rectangles are in twips. Convert them to core pixels.\n\t\t\tvar ratio: number = (app.tile.size.pixels[0] / app.tile.size.twips[0]);\n\t\t\txMin = Math.round(xMin * ratio);\n\t\t\tyMin = Math.round(yMin * ratio);\n\t\t\txMax = Math.round(xMax * ratio);\n\t\t\tyMax = Math.round(yMax * ratio);\n\n\t\t\tthis.setPosition(xMin, yMin); // This function is added by section container.\n\t\t\tthis.size = [xMax - xMin, yMax - yMin];\n\t\t\tif (this.size[0] < 5)\n\t\t\t\tthis.size[0] = 5;\n\t\t}\n\t\telse if (this.sectionProperties.data.cellPos && this.sectionProperties.docLayer._docType === 'spreadsheet') {\n\t\t\tvar ratio: number = (app.tile.size.pixels[0] / app.tile.size.twips[0]);\n\t\t\tconst sizeX = this.sectionProperties.data.cellPos[2];\n\t\t\tthis.size = [Math.round(sizeX * ratio), Math.round(this.sectionProperties.data.cellPos[3] * ratio)];\n\t\t\tlet startX = this.sectionProperties.data.cellPos[0];\n\t\t\tif (this.isCalcRTL()) { // Mirroring is done in setPosition\n\t\t\t\tstartX += sizeX;  // but adjust for width of the cell.\n\t\t\t}\n\t\t\tthis.setPosition(Math.round(this.sectionProperties.data.cellPos[0] * ratio), Math.round(this.sectionProperties.data.cellPos[1] * ratio));\n\t\t}\n\t\telse if (this.sectionProperties.docLayer._docType === 'presentation' || this.sectionProperties.docLayer._docType === 'drawing') {\n\t\t\tvar ratio: number = (app.tile.size.pixels[0] / app.tile.size.twips[0]);\n\t\t\tthis.size = [Math.round(this.sectionProperties.imgSize[0] * app.dpiScale), Math.round(this.sectionProperties.imgSize[1] * app.dpiScale)];\n\t\t\tthis.setPosition(Math.round(this.sectionProperties.data.rectangle[0] * ratio), Math.round(this.sectionProperties.data.rectangle[1] * ratio));\n\t\t}\n\t}\n\n\tpublic removeHighlight () {\n\t\tif (this.sectionProperties.docLayer._docType === 'text') {\n\t\t\tthis.sectionProperties.usedTextColor = this.sectionProperties.data.color;\n\n\t\t\tthis.sectionProperties.isHighlighted = false;\n\t\t}\n\t\telse if (this.sectionProperties.docLayer._docType === 'spreadsheet') {\n\t\t\tthis.backgroundColor = null;\n\t\t\tthis.backgroundOpacity = 1;\n\t\t}\n\t}\n\n\tpublic highlight () {\n\t\tif (this.sectionProperties.docLayer._docType === 'text') {\n\t\t\tthis.sectionProperties.usedTextColor = this.sectionProperties.highlightedTextColor;\n\n\t\t\tvar x: number = Math.round(this.position[0] / app.dpiScale);\n\t\t\tvar y: number = Math.round(this.position[1] / app.dpiScale);\n\t\t\tthis.containerObject.getSectionWithName(L.CSections.Scroll.name).onScrollTo({x: x, y: y});\n\t\t}\n\t\telse if (this.sectionProperties.docLayer._docType === 'spreadsheet') {\n\t\t\tthis.backgroundColor = '#777777'; //background: rgba(119, 119, 119, 0.25);\n\t\t\tthis.backgroundOpacity = 0.25;\n\n\t\t\tvar x: number = Math.round(this.position[0] / app.dpiScale);\n\t\t\tvar y: number = Math.round(this.position[1] / app.dpiScale);\n\t\t\tthis.containerObject.getSectionWithName(L.CSections.Scroll.name).onScrollTo({x: x, y: y});\n\t\t}\n\t\telse if (this.sectionProperties.docLayer._docType === 'presentation' || this.sectionProperties.docLayer._docType === 'drawing') {\n\t\t\tvar x: number = Math.round(this.position[0] / app.dpiScale);\n\t\t\tvar y: number = Math.round(this.position[1] / app.dpiScale);\n\t\t\tthis.containerObject.getSectionWithName(L.CSections.Scroll.name).onScrollTo({x: x, y: y});\n\t\t}\n\n\t\tthis.containerObject.requestReDraw();\n\t\tthis.sectionProperties.isHighlighted = true;\n\t}\n\n\tprivate static doesRectIntersectView(pos: number[], size: number[], viewContext: any): boolean {\n\t\tvar paneBoundsList = <any[]>viewContext.paneBoundsList;\n\t\tvar endPos = [pos[0] + size[0], pos[1] + size[1]];\n\t\tfor (var i = 0; i < paneBoundsList.length; ++i) {\n\t\t\tvar paneBounds = paneBoundsList[i];\n\t\t\tvar rectInvisible = (endPos[0] < paneBounds.min.x || endPos[1] < paneBounds.min.y ||\n\t\t\t\tpos[0] > paneBounds.max.x || pos[1] > paneBounds.max.y);\n\t\t\tif (!rectInvisible)\n\t\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t}\n\n\t// This is for svg elements that will be bound to document-container.\n\t// This also returns whether any rectangle has an intersection with the visible area/panes.\n\tprivate convertRectanglesToCoreCoordinates () : boolean {\n\t\tvar rectangles = this.sectionProperties.data.rectangles;\n\t\tvar originals = this.sectionProperties.data.rectanglesOriginal;\n\t\tvar viewContext = this.map.getTileSectionMgr()._paintContext();\n\t\tvar intersectsVisibleArea = false;\n\t\tvar ratio: number = (app.tile.size.pixels[0] / app.tile.size.twips[0]);\n\t\tvar pos: number[], size: number[];\n\n\t\tif (rectangles) {\n\t\t\tvar documentAnchorSection = this.containerObject.getDocumentAnchorSection();\n\t\t\tvar diff = [documentAnchorSection.myTopLeft[0] - this.documentTopLeft[0], documentAnchorSection.myTopLeft[1] - this.documentTopLeft[1]];\n\n\t\t\tfor (var i = 0; i < rectangles.length; i++) {\n\t\t\t\tpos = [\n\t\t\t\t\tMath.round(originals[i][0] * ratio),\n\t\t\t\t\tMath.round(originals[i][1] * ratio)\n\t\t\t\t];\n\t\t\t\tsize = [\n\t\t\t\t\tMath.round(originals[i][2] * ratio),\n\t\t\t\t\tMath.round(originals[i][3] * ratio)\n\t\t\t\t];\n\n\t\t\t\tif (!intersectsVisibleArea && Comment.doesRectIntersectView(pos, size, viewContext))\n\t\t\t\t\tintersectsVisibleArea = true;\n\n\t\t\t\trectangles[i][0] = pos[0] + diff[0];\n\t\t\t\trectangles[i][1] = pos[1] + diff[1];\n\t\t\t\trectangles[i][2] = size[0];\n\t\t\t\trectangles[i][3] = size[1];\n\t\t\t}\n\t\t} else if (this.sectionProperties.data.trackchange && this.sectionProperties.data.anchorPos) {\n\t\t\t// For redline comments there are no 'rectangles' or 'rectangleOriginal' properties in sectionProperties.data\n\t\t\t// So use the comment rectangle stored in anchorPos (in display? twips).\n\t\t\tvar anchorPos = this.sectionProperties.data.anchorPos;\n\t\t\tpos = [\n\t\t\t\tMath.round(anchorPos[0] * ratio),\n\t\t\t\tMath.round(anchorPos[1] * ratio)\n\t\t\t];\n\t\t\tsize = [\n\t\t\t\tMath.round(anchorPos[2] * ratio),\n\t\t\t\tMath.round(anchorPos[3] * ratio)\n\t\t\t];\n\n\t\t\tintersectsVisibleArea = Comment.doesRectIntersectView(pos, size, viewContext);\n\t\t}\n\n\t\treturn intersectsVisibleArea;\n\t}\n\n\tprivate updatePosition () {\n\t\tthis.convertRectanglesToCoreCoordinates();\n\t\tthis.setPositionAndSize();\n\t}\n\n\tprivate updateAnnotationMarker () {\n\t\t// Make sure to place the markers only for presentations and draw documents\n\t\tif (this.sectionProperties.docLayer._docType !== 'presentation' && this.sectionProperties.docLayer._docType !== 'drawing')\n\t\t\treturn;\n\n\t\tif (this.sectionProperties.data == null)\n\t\t\treturn;\n\n\t\tif (this.sectionProperties.annotationMarker === null) {\n\t\t\tthis.sectionProperties.annotationMarker = L.marker(new L.LatLng(0, 0), {\n\t\t\t\ticon: L.divIcon({\n\t\t\t\t\tclassName: 'annotation-marker',\n\t\t\t\t\ticonSize: null\n\t\t\t\t}),\n\t\t\t\tdraggable: true\n\t\t\t});\n\t\t\tif (this.sectionProperties.docLayer._partHashes[this.sectionProperties.docLayer._selectedPart] === this.sectionProperties.data.parthash || app.file.fileBasedView)\n\t\t\t\tthis.map.addLayer(this.sectionProperties.annotationMarker);\n\t\t}\n\t\tif (this.sectionProperties.data.rectangle != null) {\n\t\t\tthis.sectionProperties.annotationMarker.setLatLng(this.sectionProperties.docLayer._twipsToLatLng(new L.Point(this.sectionProperties.data.rectangle[0], this.sectionProperties.data.rectangle[1])));\n\t\t\tthis.sectionProperties.annotationMarker.on('dragstart drag dragend', this.onMarkerDrag, this);\n\t\t\t//this.sectionProperties.annotationMarker.on('click', this.onMarkerClick, this);\n\t\t}\n\t}\n\n\tpublic isContainerVisible () {\n\t\treturn (this.sectionProperties.container.style && this.sectionProperties.container.style.visibility === '');\n\t}\n\n\tpublic updateScaling (scaleFactor: number, initialLayoutData: any) {\n\t\tif ((<any>window).mode.isDesktop())\n\t\t\treturn;\n\n\t\tthis.doPendingInitializationInView();\n\n\t\tvar wrapperWidth = Math.round(initialLayoutData.wrapperWidth * scaleFactor);\n\t\tthis.sectionProperties.wrapper.style.width = wrapperWidth + 'px';\n\t\tvar wrapperFontSize = Math.round(initialLayoutData.wrapperFontSize * scaleFactor);\n\t\tthis.sectionProperties.wrapper.style.fontSize = wrapperFontSize + 'px';\n\t\tvar contentAuthorHeight = Math.round(initialLayoutData.authorContentHeight * scaleFactor);\n\t\tthis.sectionProperties.contentAuthor.style.height = contentAuthorHeight + 'px';\n\t\tvar dateFontSize = Math.round(initialLayoutData.dateFontSize * scaleFactor);\n\t\tthis.sectionProperties.contentDate.style.fontSize = dateFontSize + 'px';\n\t\tif (this.sectionProperties.menu) {\n\t\t\tvar menuWidth = Math.round(initialLayoutData.menuWidth * scaleFactor);\n\t\t\tthis.sectionProperties.menu.style.width = menuWidth + 'px';\n\t\t\tvar menuHeight = Math.round(initialLayoutData.menuHeight * scaleFactor);\n\t\t\tthis.sectionProperties.menu.style.height = menuHeight + 'px';\n\n\t\t\tif (this.sectionProperties.acceptButton) {\n\t\t\t\tthis.sectionProperties.acceptButton.style.width = menuWidth + 'px';\n\t\t\t\tthis.sectionProperties.acceptButton.style.height = menuHeight + 'px';\n\t\t\t}\n\t\t\tif (this.sectionProperties.rejectButton) {\n\t\t\t\tthis.sectionProperties.rejectButton.style.width = menuWidth + 'px';\n\t\t\t\tthis.sectionProperties.rejectButton.style.height = menuHeight + 'px';\n\t\t\t}\n\t\t}\n\n\t\tvar authorImageWidth = Math.round(this.sectionProperties.imgSize[0] * scaleFactor);\n\t\tvar authorImageHeight = Math.round(this.sectionProperties.imgSize[1] * scaleFactor);\n\t\tthis.sectionProperties.authorAvatarImg.setAttribute('width', authorImageWidth);\n\t\tthis.sectionProperties.authorAvatarImg.setAttribute('height', authorImageHeight);\n\t\tthis.sectionProperties.authorCollapsedAvatarImg.setAttribute('width', authorImageWidth);\n\t\tthis.sectionProperties.authorCollapsedAvatarImg.setAttribute('height', authorImageHeight);\n\t}\n\n\tprivate update () {\n\t\tthis.updateContent();\n\t\tthis.updateLayout();\n\t\tthis.updatePosition();\n\t\tthis.updateAnnotationMarker();\n\t}\n\n\tprivate showMarker () {\n\t\tif (this.sectionProperties.annotationMarker != null) {\n\t\t\tthis.map.addLayer(this.sectionProperties.annotationMarker);\n\t\t}\n\t}\n\n\tprivate hideMarker () {\n\t\tif (this.sectionProperties.annotationMarker != null) {\n\t\t\tthis.map.removeLayer(this.sectionProperties.annotationMarker);\n\t\t}\n\t}\n\n\tprivate show () {\n\t\tthis.doPendingInitializationInView(true /* force */);\n\t\tthis.showMarker();\n\n\t\t// On mobile, container shouldn't be 'document-container', but it is 'document-container' on initialization. So we hide the comment until comment wizard is opened.\n\t\tif ((<any>window).mode.isMobile() && this.sectionProperties.container.parentElement === document.getElementById('document-container'))\n\t\t\tthis.sectionProperties.container.style.visibility = 'hidden';\n\t\telse\n\t\t\tthis.sectionProperties.container.style.visibility = '';\n\n\t\tthis.sectionProperties.contentNode.style.display = '';\n\t\tthis.sectionProperties.nodeModify.style.display = 'none';\n\t\tthis.sectionProperties.nodeReply.style.display = 'none';\n\n\t\tthis.sectionProperties.showSelectedCoordinate = true; // Writer.\n\n\t\tif (this.sectionProperties.docLayer._docType === 'spreadsheet' && !(<any>window).mode.isMobile()) {\n\t\t\tvar ratio: number = (app.tile.size.pixels[0] / app.tile.size.twips[0]);\n\t\t\tvar originalSize = [Math.round((this.sectionProperties.data.cellPos[2]) * ratio), Math.round((this.sectionProperties.data.cellPos[3]) * ratio)];\n\n\t\t\tconst commentWidth = parseFloat(getComputedStyle(this.sectionProperties.container).width) * app.dpiScale;\n\t\t\tconst startX = this.isCalcRTL() ? this.myTopLeft[0] - commentWidth : this.myTopLeft[0] + originalSize[0] - 3;\n\n\t\t\tvar pos: Array<number> = [Math.round(startX / app.dpiScale), Math.round(this.myTopLeft[1] / app.dpiScale)];\n\t\t\tthis.sectionProperties.container.style.transform = 'translate3d(' + pos[0] + 'px, ' + pos[1] + 'px, 0px)';\n\t\t\tthis.sectionProperties.commentListSection.selectedComment = this;\n\t\t}\n\t}\n\n\tprivate hide () {\n\t\tif (this.sectionProperties.data.id === 'new') {\n\t\t\tthis.sectionProperties.commentListSection.removeItem(this.sectionProperties.data.id);\n\t\t\treturn;\n\t\t}\n\n\t\tthis.sectionProperties.container.style.visibility = 'hidden';\n\t\t//this.sectionProperties.contentNode.style.display = 'none';\n\t\tthis.sectionProperties.nodeModify.style.display = 'none';\n\t\tthis.sectionProperties.nodeReply.style.display = 'none';\n\n\t\tthis.sectionProperties.showSelectedCoordinate = false; // Writer.\n\n\t\tif (this.sectionProperties.docLayer._docType === 'spreadsheet' && this.sectionProperties.commentListSection.sectionProperties.selectedComment === this)\n\t\t\tthis.sectionProperties.commentListSection.sectionProperties.selectedComment = null;\n\n\t\tthis.hideMarker();\n\t}\n\n\tprivate menuOnMouseClick (e: any) {\n\t\t$(this.sectionProperties.menu).contextMenu();\n\t\tL.DomEvent.stopPropagation(e);\n\t}\n\n\tprivate onMouseClick (e: any) {\n\t\tif (((<any>window).mode.isMobile() || (<any>window).mode.isTablet())\n\t\t\t&& this.map.getDocType() == 'spreadsheet'\n\t\t\t&& !this.map.uiManager.mobileWizard.isOpen()) {\n\t\t\tthis.hide();\n\t\t}\n\t\tL.DomEvent.stopPropagation(e);\n\t\tthis.sectionProperties.commentListSection.click(this);\n\t}\n\n\tprivate onEscKey (e: any) {\n\t\tif ((<any>window).mode.isDesktop()) {\n\t\t\tif (e.keyCode === 27) {\n\t\t\t\tthis.onCancelClick(e);\n\t\t\t}\n\t\t}\n\t}\n\n\tpublic onReplyClick (e: any) {\n\t\tL.DomEvent.stopPropagation(e);\n\t\tif ((<any>window).mode.isMobile() || (<any>window).mode.isTablet()) {\n\t\t\tthis.sectionProperties.data.reply = this.sectionProperties.data.text;\n\t\t\tthis.sectionProperties.commentListSection.saveReply(this);\n\t\t} else {\n\t\t\tthis.sectionProperties.data.reply = this.sectionProperties.nodeReplyText.value;\n\t\t\t// Assigning an empty string to .innerHTML property in some browsers will convert it to 'null'\n\t\t\t// While in browsers like Chrome and Firefox, a null value is automatically converted to ''\n\t\t\t// Better to assign '' here instead of null to keep the behavior same for all\n\t\t\tthis.sectionProperties.nodeReplyText.value = '';\n\t\t\tthis.show();\n\t\t\tthis.sectionProperties.commentListSection.saveReply(this);\n\t\t}\n\t}\n\n\tpublic onCancelClick (e: any) {\n\t\tif (e)\n\t\t\tL.DomEvent.stopPropagation(e);\n\t\tthis.sectionProperties.nodeModifyText.value = this.sectionProperties.contentText.origText;\n\t\tthis.sectionProperties.nodeReplyText.value = '';\n\t\tif (this.sectionProperties.docLayer._docType !== 'spreadsheet')\n\t\t\tthis.show();\n\t\tthis.sectionProperties.commentListSection.cancel(this);\n\t}\n\n\tpublic onSaveComment (e: any) {\n\t\tL.DomEvent.stopPropagation(e);\n\t\tthis.sectionProperties.data.text = this.sectionProperties.nodeModifyText.value;\n\t\tthis.updateContent();\n\t\tthis.show();\n\t\tthis.sectionProperties.commentListSection.save(this);\n\t}\n\n\tpublic onLostFocus (e: any) {\n\t\tif (!this.sectionProperties.isRemoved) {\n\t\t\t$(this.sectionProperties.container).removeClass('annotation-active reply-annotation-container modify-annotation-container');\n\t\t\tif (this.sectionProperties.contentText.origText !== this.sectionProperties.nodeModifyText.value) {\n\t\t\t\tthis.onSaveComment(e);\n\t\t\t}\n\t\t\telse {\n\t\t\t\tif (!this.containerObject.testing) // eslint-disable-line no-lonely-if\n\t\t\t\t\tthis.onCancelClick(e);\n\t\t\t\telse {\n\t\t\t\t\tvar insertButton = document.getElementById('menu-insertcomment');\n\t\t\t\t\tif (insertButton) {\n\t\t\t\t\t\tif (window.getComputedStyle(insertButton).display === 'none') {\n\t\t\t\t\t\t\tthis.onCancelClick(e);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tapp.view.commentHasFocus = false;\n\t}\n\n\tpublic onLostFocusReply (e: any) {\n\t\tif (this.sectionProperties.nodeReplyText.value !== '') {\n\t\t\tthis.onReplyClick(e);\n\t\t}\n\t\telse {\n\t\t\tthis.sectionProperties.nodeReply.style.display = 'none';\n\t\t}\n\t\tapp.view.commentHasFocus = false;\n\t}\n\n\tpublic focus () {\n\t\tthis.sectionProperties.container.classList.add('annotation-active');\n\t\tthis.sectionProperties.nodeModifyText.focus();\n\t\tthis.sectionProperties.nodeReplyText.focus();\n\t\tapp.view.commentHasFocus = true;\n\t}\n\n\tpublic reply () {\n\t\tthis.sectionProperties.container.classList.add('reply-annotation-container');\n\t\tthis.sectionProperties.container.style.visibility = '';\n\t\tthis.sectionProperties.contentNode.style.display = '';\n\t\tthis.sectionProperties.nodeModify.style.display = 'none';\n\t\tthis.sectionProperties.nodeReply.style.display = '';\n\t\treturn this;\n\t}\n\n\tpublic edit () {\n\t\tthis.doPendingInitializationInView(true /* force */);\n\t\tthis.sectionProperties.container.classList.add('modify-annotation-container');\n\t\tthis.sectionProperties.nodeModify.style.display = '';\n\t\tthis.sectionProperties.nodeReply.style.display = 'none';\n\t\tthis.sectionProperties.container.style.visibility = '';\n\t\tthis.sectionProperties.contentNode.style.display = 'none';\n\t\treturn this;\n\t}\n\n\tpublic isEdit () {\n\t\treturn (this.sectionProperties.nodeModify && this.sectionProperties.nodeModify.style.display !== 'none') ||\n\t\t       (this.sectionProperties.nodeReply && this.sectionProperties.nodeReply.style.display !== 'none');\n\t}\n\n\tprivate sendAnnotationPositionChange (newPosition: any) {\n\t\tif (app.file.fileBasedView) {\n\t\t\tthis.map.setPart(this.sectionProperties.docLayer._selectedPart, false);\n\t\t\tnewPosition.y -= this.sectionProperties.data.yAddition;\n\t\t}\n\n\t\tvar comment = {\n\t\t\tId: {\n\t\t\t\ttype: 'string',\n\t\t\t\tvalue: this.sectionProperties.data.id\n\t\t\t},\n\t\t\tPositionX: {\n\t\t\t\ttype: 'int32',\n\t\t\t\tvalue: newPosition.x\n\t\t\t},\n\t\t\tPositionY: {\n\t\t\t\ttype: 'int32',\n\t\t\t\tvalue: newPosition.y\n\t\t\t}\n\t\t};\n\t\tthis.map.sendUnoCommand('.uno:EditAnnotation', comment);\n\n\t\tif (app.file.fileBasedView)\n\t\t\tthis.map.setPart(0, false);\n\t}\n\n\tprivate onMarkerDrag (event: any) {\n\t\tif (this.sectionProperties.annotationMarker == null)\n\t\t\treturn;\n\n\t\tif (event.type === 'dragend') {\n\t\t\tvar pointTwip = this.sectionProperties.docLayer._latLngToTwips(this.sectionProperties.annotationMarker.getLatLng());\n\t\t\tthis.sendAnnotationPositionChange(pointTwip);\n\t\t}\n\t}\n\n\tpublic isDisplayed () {\n\t\treturn (this.sectionProperties.container.style && this.sectionProperties.container.style.visibility === '');\n\t}\n\n\tpublic onResize () {\n\t\tthis.updatePosition();\n\t}\n\n\tprivate doesRectangleContainPoint (rectangle: any, point: Array<number>): boolean {\n\t\tif (point[0] >= rectangle[0] && point[0] <= rectangle[0] + rectangle[2]) {\n\t\t\tif (point[1] >= rectangle[1] && point[1] <= rectangle[1] + rectangle[3]) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n\n\tpublic onClick (point: Array<number>, e: MouseEvent) {\n\t\tif (this.sectionProperties.docLayer._docType === 'text') {\n\t\t\tvar rectangles = this.sectionProperties.data.rectangles;\n\t\t\tpoint[0] = point[0] + this.myTopLeft[0];\n\t\t\tpoint[1] = point[1] + this.myTopLeft[1];\n\t\t\tif (rectangles) { // A text file.\n\t\t\t\tfor (var i: number = 0; i < rectangles.length; i++) {\n\t\t\t\t\tif (this.doesRectangleContainPoint(rectangles[i], point)) {\n\t\t\t\t\t\tthis.sectionProperties.commentListSection.selectById(this.sectionProperties.data.id);\n\t\t\t\t\t\te.stopPropagation();\n\t\t\t\t\t\tthis.stopPropagating();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\telse if (this.sectionProperties.docLayer._docType === 'presentation' || this.sectionProperties.docLayer._docType === 'drawing') {\n\t\t\tthis.sectionProperties.commentListSection.selectById(this.sectionProperties.data.id);\n\t\t\te.stopPropagation();\n\t\t\tthis.stopPropagating();\n\t\t}\n\t}\n\n\tpublic onDraw () {\n\t\tif (this.sectionProperties.docLayer._docType === 'text' && this.sectionProperties.showSelectedCoordinate) {\n\t\t\tvar rectangles: Array<any> = this.sectionProperties.data.rectangles;\n\t\t\tif (rectangles) {\n\t\t\t\tthis.context.fillStyle = this.sectionProperties.usedTextColor;\n\t\t\t\tthis.context.globalAlpha = 0.25;\n\n\t\t\t\tfor (var i: number = 0; i < this.sectionProperties.data.rectangles.length;i ++) {\n\t\t\t\t\tvar x = rectangles[i][0] - this.myTopLeft[0];\n\t\t\t\t\tvar y = rectangles[i][1] - this.myTopLeft[1];\n\t\t\t\t\tvar w = rectangles[i][2] > 3 ? rectangles[i][2]: 3;\n\t\t\t\t\tvar h = rectangles[i][3];\n\n\t\t\t\t\tthis.context.fillRect(x, y, w , h);\n\t\t\t\t}\n\n\t\t\t\tthis.context.globalAlpha = 1;\n\t\t\t}\n\t\t}\n\t}\n\n\tpublic onMouseMove (point: Array<number>, dragDistance: Array<number>, e: MouseEvent) {\n\t\treturn;\n\t}\n\n\tpublic onMouseUp (point: Array<number>, e: MouseEvent) {\n\t\t// Hammer.js doesn't fire onClick event after touchEnd event.\n\t\t// CanvasSectionContainer fires the onClick event. But since Hammer.js is used for map, it disables the onClick for SectionContainer.\n\t\t// We will use this event as click event on touch devices, until we remove Hammer.js (then this code will be removed from here).\n\t\t// Control.ColumnHeader.js file is not affected by this situation, because map element (so Hammer.js) doesn't cover headers.\n\t\tif (!this.containerObject.draggingSomething && (<any>window).mode.isMobile() || (<any>window).mode.isTablet()) {\n\t\t\tif (this.sectionProperties.docLayer._docType === 'presentataion' || this.sectionProperties.docLayer._docType === 'drawing')\n\t\t\t\tthis.sectionProperties.docLayer._openCommentWizard(this);\n\t\t\tthis.onMouseEnter();\n\t\t\tthis.onClick(point, e);\n\t\t}\n\t}\n\n\tpublic onMouseDown (point: Array<number>, e: MouseEvent) {\n\t\treturn;\n\t}\n\n\tprivate calcContinueWithMouseEvent (): boolean {\n\t\tif (this.sectionProperties.docLayer._docType === 'spreadsheet') {\n\t\t\tvar conditions: boolean = !this.isEdit();\n\t\t\tif (conditions) {\n\t\t\t\tvar sc = this.sectionProperties.commentListSection.sectionProperties.selectedComment;\n\t\t\t\tif (sc)\n\t\t\t\t\tconditions = sc.sectionProperties.data.id !== 'new';\n\t\t\t}\n\t\t\treturn conditions;\n\t\t}\n\t\telse {\n\t\t\treturn false;\n\t\t}\n\t}\n\n\tpublic onMouseEnter () {\n\t\tif (this.calcContinueWithMouseEvent()) {\n\t\t\t// When mouse is above this section, comment's HTML element will be shown.\n\t\t\t// If mouse pointer goes to HTML element, onMouseLeave event shouldn't be fired.\n\t\t\t// But mouse pointer will have left the borders of this section and onMouseLeave event will be fired.\n\t\t\t// Let's do it properly, when mouse is above this section, we will make this section's size bigger and onMouseLeave event will not be fired.\n\t\t\tif (parseInt(this.sectionProperties.data.tab) === this.sectionProperties.docLayer._selectedPart) {\n\t\t\t\tvar sc = this.sectionProperties.commentListSection.sectionProperties.selectedComment;\n\t\t\t\tif (sc) {\n\t\t\t\t\tif (!sc.isEdit())\n\t\t\t\t\t\tsc.hide();\n\t\t\t\t\telse\n\t\t\t\t\t\treturn; // Another comment is being edited. Return.\n\t\t\t\t}\n\n\t\t\t\tvar containerWidth: number = this.sectionProperties.container.getBoundingClientRect().width;\n\t\t\t\tvar ratio: number = (app.tile.size.pixels[0] / app.tile.size.twips[0]);\n\t\t\t\tthis.size = [Math.round((this.sectionProperties.data.cellPos[2]) * ratio + containerWidth), Math.round((this.sectionProperties.data.cellPos[3]) * ratio)];\n\t\t\t\tthis.sectionProperties.commentListSection.selectById(this.sectionProperties.data.id);\n\t\t\t\tthis.show();\n\t\t\t}\n\t\t}\n\t}\n\n\tpublic onMouseLeave (point: Array<number>) {\n\t\tif (this.calcContinueWithMouseEvent()) {\n\t\t\tif (parseInt(this.sectionProperties.data.tab) === this.sectionProperties.docLayer._selectedPart) {\n\t\t\t\t// Revert the changes we did on \"onMouseEnter\" event.\n\t\t\t\tvar ratio: number = (app.tile.size.pixels[0] / app.tile.size.twips[0]);\n\t\t\t\tthis.size = [Math.round((this.sectionProperties.data.cellPos[2]) * ratio), Math.round((this.sectionProperties.data.cellPos[3]) * ratio)];\n\t\t\t\tif (point) {\n\t\t\t\t\tthis.hide();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tpublic onNewDocumentTopLeft () {\n\t\tthis.doPendingInitializationInView();\n\t\tthis.updatePosition();\n\t}\n\n\tpublic onCommentDataUpdate() {\n\t\tthis.doPendingInitializationInView();\n\t\tthis.updatePosition();\n\t}\n\n\tpublic onRemove () {\n\t\tthis.sectionProperties.isRemoved = true;\n\n\t\tif (this.sectionProperties.commentListSection.sectionProperties.selectedComment === this)\n\t\t\tthis.sectionProperties.commentListSection.sectionProperties.selectedComment = null;\n\n\t\tthis.sectionProperties.commentListSection.hideArrow();\n\t\tvar container = this.sectionProperties.container;\n\t\tif (container && container.parentElement) {\n\t\t\tthis.hideMarker();\n\t\t\tvar c: number = 0;\n\t\t\twhile (c < 10) {\n\t\t\t\ttry {\n\t\t\t\t\tcontainer.parentElement.removeChild(container);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tcatch (e) {\n\t\t\t\t\tc++;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tpublic onMouseWheel () { return; }\n\tpublic onDoubleClick () { return; }\n\tpublic onContextMenu () { return; }\n\tpublic onLongPress () { return; }\n\tpublic onMultiTouchStart () { return; }\n\tpublic onMultiTouchMove () { return; }\n\tpublic onMultiTouchEnd () { return; }\n\n\tpublic setCollapsed() {\n\t\tthis.isCollapsed = true;\n\n\t\tvar isRootComment = this.sectionProperties.docLayer._docType !== 'text' || this.sectionProperties.data.parent === '0';\n\t\tif (isRootComment || this.sectionProperties.data.trackchange)\n\t\t\tthis.sectionProperties.collapsed.style.display = '';\n\t\telse\n\t\t\tthis.sectionProperties.collapsed.style.display = 'none';\n\n\t\tthis.sectionProperties.wrapper.style.display = 'none';\n\t}\n\n\tpublic setExpanded() {\n\t\tthis.isCollapsed = false;\n\t\tthis.sectionProperties.collapsed.style.display = 'none';\n\t\tthis.sectionProperties.wrapper.style.display = '';\n\t}\n};\n\n"]}