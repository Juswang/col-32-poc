{"version":3,"file":"ScrollSection.js","sourceRoot":"","sources":["../../../../../../../../../browser/src/layer/tile/ScrollSection.ts"],"names":[],"mappings":"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","sourcesContent":["/* See CanvasSectionContainer.ts for explanations. */\n\n// We are using typescript without modules and compile files individually for now. Typescript needs to know about global definitions.\n// We will keep below definitions until we use tsconfig.json.\ndeclare var L: any;\ndeclare var app: any;\n\nclass ScrollSection {\n\tcontext: CanvasRenderingContext2D = null;\n\tmyTopLeft: Array<number> = null;\n\tdocumentTopLeft: Array<number> = null;\n\tcontainerObject: any = null;\n\tdpiScale: number = null;\n\tname: string = null;\n\tbackgroundColor: string = null;\n\tborderColor: string = null;\n\tboundToSection: string = null;\n\tanchor: Array<string> = new Array(0);\n\tposition: Array<number> = new Array(0);\n\tsize: Array<number> = new Array(0);\n\texpand: Array<string> = new Array(0);\n\tisLocated: boolean = false;\n\tprocessingOrder: number = null;\n\tdrawingOrder: number = null;\n\tzIndex: number = null;\n\tinteractable: boolean = true;\n\tisAnimating: boolean = false; // This variable is set by the CanvasSectionContainer class.\n\twindowSection = true; // This section covers the entire canvas.\n\tsectionProperties: any = {};\n\n\t// Implemented by container.\n\tstopPropagating: () => void;\n\n\t// Implemented by container.\n\tstartAnimating: (options: any) => boolean;\n\n\t// Implemented by container.\n\tresetAnimation: () => void;\n\n\t// Implemented by container.\n\tisCalcRTL: () => boolean;\n\n\tmap: any;\n\tautoScrollTimer: any;\n\tpendingScrollEvent: any = null;\n\n\tconstructor () {\n\t\tthis.name = L.CSections.Scroll.name;\n\t\tthis.processingOrder = L.CSections.Scroll.processingOrder;\n\t\tthis.drawingOrder = L.CSections.Scroll.drawingOrder;\n\t\tthis.zIndex = L.CSections.Scroll.zIndex;\n\n\t\tthis.map = L.Map.THIS;\n\n\t\tthis.map.on('scrollto', this.onScrollTo, this);\n\t\tthis.map.on('scrollby', this.onScrollBy, this);\n\t\tthis.map.on('scrollvelocity', this.onScrollVelocity, this);\n\t\tthis.map.on('handleautoscroll', this.onHandleAutoScroll, this);\n\t\tthis.map.on('updatescrolloffset', this.onUpdateScrollOffset, this);\n\t}\n\n\tpublic onInitialize () {\n\t\tthis.sectionProperties.docLayer = this.map._docLayer;\n\t\tthis.sectionProperties.mapPane = (<HTMLElement>(document.querySelectorAll('.leaflet-map-pane')[0]));\n\t\tthis.sectionProperties.defaultCursorStyle = this.sectionProperties.mapPane.style.cursor;\n\n\t\tthis.sectionProperties.yMax = 0;\n\t\tthis.sectionProperties.yMin = 0;\n\t\tthis.sectionProperties.xMax = 0;\n\t\tthis.sectionProperties.xMin = 0;\n\n\t\tthis.sectionProperties.previousDragDistance = null;\n\n\t\tthis.sectionProperties.usableThickness = 20 * app.roundedDpiScale;\n\t\tthis.sectionProperties.scrollBarThickness = 12 * app.roundedDpiScale;\n\t\tthis.sectionProperties.edgeOffset = 10 * app.roundedDpiScale;\n\n\t\tthis.sectionProperties.drawVerticalScrollBar = ((<any>window).mode.isDesktop() ? true: false);\n\t\tthis.sectionProperties.drawHorizontalScrollBar = ((<any>window).mode.isDesktop() ? true: false);\n\n\t\tthis.sectionProperties.clickScrollVertical = false; // true when user presses on the scroll bar drawing.\n\t\tthis.sectionProperties.clickScrollHorizontal = false;\n\n\t\tthis.sectionProperties.mouseIsOnVerticalScrollBar = false;\n\t\tthis.sectionProperties.mouseIsOnHorizontalScrollBar = false;\n\n\t\tthis.sectionProperties.minimumScrollSize = 80 * app.roundedDpiScale;\n\n\t\tthis.sectionProperties.circleSliderRadius = 24 * app.roundedDpiScale; // Radius of the mobile vertical circular slider.\n\t\tthis.sectionProperties.arrowCornerLength = 10 * app.roundedDpiScale; // Corner length of the arrows inside circular slider.\n\n\t\t// Opacity.\n\t\tthis.sectionProperties.alphaWhenVisible = 0.5; // Scroll bar is visible but not being used.\n\t\tthis.sectionProperties.alphaWhenBeingUsed = 0.8; // Scroll bar is being used.\n\t\tthis.sectionProperties.currentAlpha = 1.0; // This variable will be updated while animating. When not animating, this will be equal to one of the above variables.\n\n\t\t// Durations.\n\t\tthis.sectionProperties.idleDuration = 2000; // In miliseconds. Scroll bar will be visible for this period of time after being used.\n\t\tthis.sectionProperties.fadeOutStartingTime = 1800; // After this period, scroll bar starts to disappear. This duration is included in \"idleDuration\".\n\t\tthis.sectionProperties.fadeOutDuration = this.sectionProperties.idleDuration - this.sectionProperties.fadeOutStartingTime;\n\n\t\tthis.sectionProperties.yOffset = 0;\n\t\tthis.sectionProperties.xOffset = 0;\n\n\t\tthis.sectionProperties.horizontalScrollRightOffset = this.sectionProperties.usableThickness * 2; // To prevent overlapping of the scroll bars.\n\n\t\tthis.sectionProperties.animatingVerticalScrollBar = false;\n\t\tthis.sectionProperties.animatingHorizontalScrollBar = false;\n\n\t\tthis.sectionProperties.pointerSyncWithVerticalScrollBar = true;\n\t\tthis.sectionProperties.pointerSyncWithHorizontalScrollBar = true;\n\t\tthis.sectionProperties.pointerReCaptureSpacer = null; // Clicked point of the scroll bar.\n\t}\n\n\tpublic completePendingScroll() {\n\t\tif (this.pendingScrollEvent) {\n\t\t\tthis.onScrollTo(this.pendingScrollEvent, true /* force */);\n\t\t\tthis.pendingScrollEvent = null;\n\t\t}\n\t}\n\n\tpublic onScrollTo (e: any, force: boolean = false) {\n\t\tif (!force && !this.containerObject.drawingAllowed()) {\n\t\t\t// Only remember the last scroll-to position.\n\t\t\tthis.pendingScrollEvent = e;\n\t\t\treturn;\n\t\t}\n\t\t// Triggered by the document (e.g. search result out of the viewing area).\n\t\tthis.map.scrollTop(e.y, {});\n\t\tthis.map.scrollLeft(e.x, {});\n\t}\n\n\tpublic onScrollBy (e: any) {\n\t\tif (this.map._docLayer._docType !== 'spreadsheet') {\n\t\t\tthis.scrollVerticalWithOffset(e.y);\n\t\t\tthis.scrollHorizontalWithOffset(e.x);\n\t\t} else {\n\t\t\t// For Calc, top position shouldn't be below zero, for others, we can activate a similar check if needed (while keeping in mind that top position may be below zero for others).\n\t\t\tvar docTopLef = this.containerObject.getDocumentTopLeft();\n\n\t\t\t// Some early exits.\n\t\t\tif (e.y < 0 && docTopLef[1] === 0) // Don't scroll to negative values.\n\t\t\t\treturn;\n\n\t\t\tif (e.x < 0 && docTopLef[0] === 0)\n\t\t\t\treturn;\n\n\t\t\tvar diff = Math.round(e.y * app.dpiScale);\n\n\t\t\tif (docTopLef[1] + diff < 0) {\n\t\t\t\te.y = Math.round(-1 * docTopLef[1] / app.dpiScale);\n\t\t\t}\n\n\t\t\tdiff = Math.round(e.x * app.dpiScale);\n\t\t\tif (docTopLef[0] + diff < 0) {\n\t\t\t\te.x = Math.round(-1 * docTopLef[0] / app.dpiScale);\n\t\t\t}\n\t\t\tthis.map.panBy(new L.Point(e.x, e.y), {animate: false});\n\t\t}\n\t}\n\n\tpublic onScrollVelocity (e: any) {\n\t\tif (e.vx === 0 && e.vy === 0) {\n\t\t\tclearInterval(this.autoScrollTimer);\n\t\t\tthis.autoScrollTimer = null;\n\t\t\tthis.map.isAutoScrolling = false;\n\t\t} else {\n\t\t\tclearInterval(this.autoScrollTimer);\n\t\t\tthis.map.isAutoScrolling = true;\n\t\t\tthis.autoScrollTimer = setInterval(L.bind(function() {\n\t\t\t\tthis.onScrollBy({x: e.vx, y: e.vy});\n\t\t\t\t// Unfortunately, dragging outside the map doesn't work for the map element.\n\t\t\t\t// We will keep this until we remove leaflet.\n\t\t\t\tif (L.Map.THIS.mouse\n\t\t\t\t&& L.Map.THIS.mouse._mouseDown\n\t\t\t\t&& this.containerObject.targetBoundSectionListContains(L.CSections.Tiles.name)\n\t\t\t\t&& (<any>window).mode.isDesktop()\n\t\t\t\t&& this.containerObject.draggingSomething\n\t\t\t\t&& L.Map.THIS._docLayer._docType === 'spreadsheet') {\n\t\t\t\t\tvar temp = this.containerObject.positionOnMouseDown;\n\t\t\t\t\tvar tempPos = [(this.isCalcRTL() ? this.map._size.x - temp[0] : temp[0]) * app.dpiScale, temp[1] * app.dpiScale];\n\t\t\t\t\tvar docTopLeft = app.sectionContainer.getDocumentTopLeft();\n\t\t\t\t\ttempPos = [tempPos[0] + docTopLeft[0], tempPos[1] + docTopLeft[1]];\n\t\t\t\t\ttempPos = [Math.round(tempPos[0] * app.pixelsToTwips), Math.round(tempPos[1] * app.pixelsToTwips)];\n\t\t\t\t\tL.Map.THIS._docLayer._postMouseEvent('move', tempPos[0], tempPos[1], 1, 1, 0);\n\t\t\t\t}\n\t\t\t}, this), 100);\n\t\t}\n\t}\n\n\tpublic onHandleAutoScroll (e :any) {\n\t\tvar vx = 0;\n\t\tvar vy = 0;\n\n\t\tif (e.pos.y > e.map._size.y - 50) {\n\t\t\tvy = 50;\n\t\t} else if (e.pos.y < 50 && e.map._getTopLeftPoint().y > 50) {\n\t\t\tvy = -50;\n\t\t}\n\n\t\tconst mousePosX: number = this.isCalcRTL() ? e.map._size.x - e.pos.x : e.pos.x;\n\t\tconst mapLeft: number = this.isCalcRTL() ? e.map._size.x - e.map._getTopLeftPoint().x : e.map._getTopLeftPoint().x;\n\t\tif (mousePosX > e.map._size.x - 50) {\n\t\t\tvx = 50;\n\t\t} else if (mousePosX < 50 && mapLeft > 50) {\n\t\t\tvx = -50;\n\t\t}\n\n\t\tthis.onScrollVelocity({vx: vx, vy: vy});\n\t}\n\n\tprivate getVerticalScrollLength () :number {\n\t\tvar result: number = this.containerObject.getDocumentAnchorSection().size[1];\n\t\tthis.sectionProperties.yOffset = this.containerObject.getDocumentAnchorSection().myTopLeft[1];\n\n\t\tif (this.map._docLayer._docType !== 'spreadsheet') {\n\t\t\treturn result;\n\t\t}\n\t\telse {\n\t\t\tvar splitPanesContext: any = this.map.getSplitPanesContext();\n\t\t\tvar splitPos = {x: 0, y: 0};\n\t\t\tif (splitPanesContext) {\n\t\t\t\tsplitPos = splitPanesContext.getSplitPos().clone();\n\t\t\t\tsplitPos.y = Math.round(splitPos.y * app.dpiScale);\n\t\t\t}\n\n\t\t\tthis.sectionProperties.yOffset += splitPos.y;\n\t\t\treturn result - splitPos.y;\n\t\t}\n\t}\n\n\tprivate calculateVerticalScrollSize (scrollLength: number) :number {\n\t\tvar scrollSize = Math.round(scrollLength * scrollLength / app.view.size.pixels[1]);\n\t\treturn Math.round(scrollSize);\n\t}\n\n\tprivate calculateYMinMax () {\n\t\tvar diff: number = Math.round(app.view.size.pixels[1] - this.containerObject.getDocumentAnchorSection().size[1]);\n\n\t\tif (diff >= 0) {\n\t\t\tthis.sectionProperties.yMin = 0;\n\t\t\tthis.sectionProperties.yMax = diff;\n\t\t\tif ((<any>window).mode.isDesktop())\n\t\t\t\tthis.sectionProperties.drawVerticalScrollBar = true;\n\t\t}\n\t\telse {\n\t\t\tdiff = Math.round((app.view.size.pixels[1] - this.containerObject.getDocumentAnchorSection().size[1]) * 0.5);\n\t\t\tthis.sectionProperties.yMin = diff;\n\t\t\tthis.sectionProperties.yMax = diff;\n\t\t\tif (app.view.size.pixels[1] >  0) {\n\t\t\t\tif (this.map._docLayer._docType !== 'spreadsheet' || !(<any>window).mode.isDesktop())\n\t\t\t\t\tthis.sectionProperties.drawVerticalScrollBar = false;\n\t\t\t}\n\t\t}\n\t}\n\n\tpublic getVerticalScrollProperties () :any {\n\t\tthis.calculateYMinMax();\n\t\tvar result: any = {};\n\t\tresult.scrollLength = this.getVerticalScrollLength(); // The length of the railway that the scroll bar moves on up & down.\n\t\tresult.scrollSize = this.calculateVerticalScrollSize(result.scrollLength); // Size of the scroll bar.\n\n\t\tif (result.scrollSize < this.sectionProperties.minimumScrollSize) {\n\t\t\tvar diff: number = this.sectionProperties.minimumScrollSize - result.scrollSize;\n\t\t\tresult.scrollLength -= diff;\n\t\t\tresult.scrollSize = this.sectionProperties.minimumScrollSize;\n\t\t}\n\n\t\tresult.ratio = app.view.size.pixels[1] / result.scrollLength; // 1px scrolling = xpx document height.\n\t\tresult.startY = Math.round(this.documentTopLeft[1] / result.ratio + this.sectionProperties.scrollBarThickness * 0.5 + this.sectionProperties.yOffset);\n\n\t\treturn result;\n\t}\n\n\tprivate getHorizontalScrollLength () :number {\n\t\tvar result: number = this.containerObject.getDocumentAnchorSection().size[0];\n\t\tthis.sectionProperties.xOffset = this.containerObject.getDocumentAnchorSection().myTopLeft[0];\n\n\t\tif (this.map._docLayer._docType !== 'spreadsheet') {\n\t\t\treturn result - this.sectionProperties.horizontalScrollRightOffset;\n\t\t}\n\t\telse {\n\t\t\tvar splitPanesContext: any = this.map.getSplitPanesContext();\n\t\t\tvar splitPos = {x: 0, y: 0};\n\t\t\tif (splitPanesContext) {\n\t\t\t\tsplitPos = splitPanesContext.getSplitPos().clone();\n\t\t\t\tsplitPos.x = Math.round(splitPos.x * app.dpiScale);\n\t\t\t}\n\n\t\t\tthis.sectionProperties.xOffset += splitPos.x;\n\t\t\treturn result - splitPos.x - this.sectionProperties.horizontalScrollRightOffset;\n\t\t}\n\t}\n\n\tprivate calculateHorizontalScrollSize (scrollLength: number) :number {\n\t\tvar scrollSize = Math.round(scrollLength * scrollLength / app.view.size.pixels[0]);\n\t\treturn scrollSize;\n\t}\n\n\tprivate calculateXMinMax () {\n\t\tvar diff: number = Math.round(app.view.size.pixels[0] - this.containerObject.getDocumentAnchorSection().size[0]);\n\n\t\tif (diff >= 0) {\n\t\t\tthis.sectionProperties.xMin = 0;\n\t\t\tthis.sectionProperties.xMax = diff;\n\t\t\tif ((<any>window).mode.isDesktop())\n\t\t\t\tthis.sectionProperties.drawHorizontalScrollBar = true;\n\t\t}\n\t\telse {\n\t\t\tdiff = Math.round((app.view.size.pixels[0] - this.containerObject.getDocumentAnchorSection().size[0]) * 0.5);\n\t\t\tthis.sectionProperties.xMin = diff;\n\t\t\tthis.sectionProperties.xMax = diff;\n\t\t\tif (app.view.size.pixels[0] >  0) {\n\t\t\t\tif (this.map._docLayer._docType !== 'spreadsheet' || !(<any>window).mode.isDesktop())\n\t\t\t\t\tthis.sectionProperties.drawHorizontalScrollBar = false;\n\t\t\t}\n\t\t}\n\t}\n\n\tpublic getHorizontalScrollProperties () :any {\n\t\tthis.calculateXMinMax();\n\t\tvar result: any = {};\n\t\tresult.scrollLength = this.getHorizontalScrollLength(); // The length of the railway that the scroll bar moves on left & right.\n\t\tresult.scrollSize = this.calculateHorizontalScrollSize(result.scrollLength); // Width of the scroll bar.\n\n\t\tif (result.scrollSize < this.sectionProperties.minimumScrollSize) {\n\t\t\tvar diff: number = this.sectionProperties.minimumScrollSize - result.scrollSize;\n\t\t\tresult.scrollLength -= diff;\n\t\t\tresult.scrollSize = this.sectionProperties.minimumScrollSize;\n\t\t}\n\n\t\tresult.ratio = app.view.size.pixels[0] / result.scrollLength;\n\t\tresult.startX = Math.round(this.documentTopLeft[0] / result.ratio + this.sectionProperties.scrollBarThickness * 0.5 + this.sectionProperties.xOffset);\n\n\t\treturn result;\n\t}\n\n\tpublic onUpdateScrollOffset () {\n\t\tif (this.map._docLayer._docType === 'spreadsheet')\n\t\t\tthis.map._docLayer.refreshViewData();\n\t}\n\n\tprivate DrawVerticalScrollBarMobile () {\n\t\tvar scrollProps: any = this.getVerticalScrollProperties();\n\n\t\tif (this.sectionProperties.animatingVerticalScrollBar)\n\t\t\tthis.context.globalAlpha = this.sectionProperties.currentAlpha;\n\t\telse\n\t\t\tthis.context.globalAlpha = this.sectionProperties.clickScrollVertical ? this.sectionProperties.alphaWhenBeingUsed: this.sectionProperties.alphaWhenVisible;\n\n\t\tthis.context.strokeStyle = '#7E8182';\n\t\tthis.context.fillStyle = 'white';\n\n\t\tvar circleStartY = scrollProps.startY + this.sectionProperties.circleSliderRadius;\n\t\tvar circleStartX = this.size[0] - this.sectionProperties.circleSliderRadius * 0.5;\n\n\t\tthis.context.beginPath();\n\t\tthis.context.arc(circleStartX, circleStartY, this.sectionProperties.circleSliderRadius, 0, Math.PI * 2, true);\n\t\tthis.context.fill();\n\t\tthis.context.stroke();\n\n\t\tthis.context.fillStyle = '#7E8182';\n\t\tthis.context.beginPath();\n\t\tvar x: number = circleStartX - this.sectionProperties.arrowCornerLength * 0.5;\n\t\tvar y: number = circleStartY - 5 * app.roundedDpiScale;\n\t\tthis.context.moveTo(x, y);\n\t\tx += this.sectionProperties.arrowCornerLength;\n\t\tthis.context.lineTo(x, y);\n\t\tx -= this.sectionProperties.arrowCornerLength * 0.5;\n\t\ty -= Math.sin(Math.PI / 3) * this.sectionProperties.arrowCornerLength;\n\t\tthis.context.lineTo(x, y);\n\t\tx -= this.sectionProperties.arrowCornerLength * 0.5;\n\t\ty += Math.sin(Math.PI / 3) * this.sectionProperties.arrowCornerLength;\n\t\tthis.context.lineTo(x, y);\n\t\tthis.context.fill();\n\n\t\tx = circleStartX - this.sectionProperties.arrowCornerLength * 0.5;\n\t\ty = circleStartY + 5 * app.roundedDpiScale;\n\t\tthis.context.moveTo(x, y);\n\t\tx += this.sectionProperties.arrowCornerLength;\n\t\tthis.context.lineTo(x, y);\n\t\tx -= this.sectionProperties.arrowCornerLength * 0.5;\n\t\ty += Math.sin(Math.PI / 3) * this.sectionProperties.arrowCornerLength;\n\t\tthis.context.lineTo(x, y);\n\t\tx -= this.sectionProperties.arrowCornerLength * 0.5;\n\t\ty -= Math.sin(Math.PI / 3) * this.sectionProperties.arrowCornerLength;\n\t\tthis.context.lineTo(x, y);\n\t\tthis.context.fill();\n\n\t\tthis.context.globalAlpha = 1.0;\n\t}\n\n\tprivate drawVerticalScrollBar () {\n\t\tvar scrollProps: any = this.getVerticalScrollProperties();\n\n\t\tif (this.sectionProperties.animatingVerticalScrollBar)\n\t\t\tthis.context.globalAlpha = this.sectionProperties.currentAlpha;\n\t\telse\n\t\t\tthis.context.globalAlpha = this.sectionProperties.clickScrollVertical ? this.sectionProperties.alphaWhenBeingUsed: this.sectionProperties.alphaWhenVisible;\n\n\t\tthis.context.fillStyle = '#7E8182';\n\n\t\tvar startX = this.isCalcRTL() ? this.sectionProperties.edgeOffset : this.size[0] - this.sectionProperties.scrollBarThickness - this.sectionProperties.edgeOffset;\n\n\t\tthis.context.fillRect(startX, scrollProps.startY, this.sectionProperties.scrollBarThickness, scrollProps.scrollSize - this.sectionProperties.scrollBarThickness);\n\n\t\tthis.context.globalAlpha = 1.0;\n\n\t\tif (this.containerObject.testing) {\n\t\t\tvar element: HTMLDivElement = <HTMLDivElement>document.getElementById('test-div-vertical-scrollbar');\n\t\t\tif (!element) {\n\t\t\t\telement = document.createElement('div');\n\t\t\t\telement.id = 'test-div-vertical-scrollbar';\n\t\t\t\tdocument.body.appendChild(element);\n\t\t\t}\n\t\t\telement.textContent = String(scrollProps.startY);\n\t\t\telement.style.display = 'none';\n\t\t\telement.style.position = 'fixed';\n\t\t\telement.style.zIndex = '-1';\n\t\t}\n\t}\n\n\tprivate drawHorizontalScrollBar () {\n\t\tvar scrollProps: any = this.getHorizontalScrollProperties();\n\n\t\tif (this.sectionProperties.animatingHorizontalScrollBar)\n\t\t\tthis.context.globalAlpha = this.sectionProperties.currentAlpha;\n\t\telse\n\t\t\tthis.context.globalAlpha = this.sectionProperties.clickScrollHorizontal ? this.sectionProperties.alphaWhenBeingUsed: this.sectionProperties.alphaWhenVisible;\n\n\t\tthis.context.fillStyle = '#7E8182';\n\n\t\tvar startY = this.size[1] - this.sectionProperties.scrollBarThickness - this.sectionProperties.edgeOffset;\n\n\t\tconst sizeX = scrollProps.scrollSize - this.sectionProperties.scrollBarThickness;\n\t\tconst docWidth: number = this.map.getPixelBoundsCore().getSize().x;\n\t\tconst startX = this.isCalcRTL() ? docWidth - scrollProps.startX - sizeX : scrollProps.startX;\n\n\t\tthis.context.fillRect(startX, startY, sizeX, this.sectionProperties.scrollBarThickness);\n\n\t\tthis.context.globalAlpha = 1.0;\n\n\t\tif (this.containerObject.testing) {\n\t\t\tvar element: HTMLDivElement = <HTMLDivElement>document.getElementById('test-div-horizontal-scrollbar');\n\t\t\tif (!element) {\n\t\t\t\telement = document.createElement('div');\n\t\t\t\telement.id = 'test-div-horizontal-scrollbar';\n\t\t\t\tdocument.body.appendChild(element);\n\t\t\t}\n\t\t\telement.textContent = String(scrollProps.startX);\n\t\t\telement.style.display = 'none';\n\t\t\telement.style.position = 'fixed';\n\t\t\telement.style.zIndex = '-1';\n\t\t}\n\n\t}\n\n\tprivate calculateCurrentAlpha (elapsedTime: number) {\n\t\tif (elapsedTime >= this.sectionProperties.fadeOutStartingTime) {\n\t\t\tthis.sectionProperties.currentAlpha = Math.max((1 - ((elapsedTime - this.sectionProperties.fadeOutStartingTime) / this.sectionProperties.fadeOutDuration)) * this.sectionProperties.alphaWhenVisible, 0.1);\n\t\t}\n\t\telse {\n\t\t\tthis.sectionProperties.currentAlpha = this.sectionProperties.alphaWhenVisible;\n\t\t}\n\t}\n\n\tpublic onDraw (frameCount: number, elapsedTime: number) {\n\t\tif (this.isAnimating && frameCount >= 0)\n\t\t\tthis.calculateCurrentAlpha(elapsedTime);\n\n\t\tif ((this.sectionProperties.drawVerticalScrollBar || this.sectionProperties.animatingVerticalScrollBar)) {\n\t\t\tif ((<any>window).mode.isMobile())\n\t\t\t\tthis.DrawVerticalScrollBarMobile();\n\t\t\telse\n\t\t\t\tthis.drawVerticalScrollBar();\n\t\t}\n\n\t\tif ((this.sectionProperties.drawHorizontalScrollBar || this.sectionProperties.animatingHorizontalScrollBar)) {\n\t\t\tthis.drawHorizontalScrollBar();\n\t\t}\n\t}\n\n\tpublic onAnimationEnded (frameCount: number, elapsedTime: number) {\n\t\tthis.sectionProperties.animatingVerticalScrollBar = false;\n\t\tthis.sectionProperties.animatingHorizontalScrollBar = false;\n\t}\n\n\tprivate fadeOutHorizontalScrollBar () {\n\t\tif (this.isAnimating) {\n\t\t\tthis.resetAnimation();\n\t\t\tthis.sectionProperties.animatingHorizontalScrollBar = true;\n\t\t}\n\t\telse {\n\t\t\tvar options: any = {\n\t\t\t\tduration: this.sectionProperties.idleDuration\n\t\t\t};\n\n\t\t\tthis.sectionProperties.animatingHorizontalScrollBar = this.startAnimating(options);\n\t\t}\n\t}\n\n\tprivate fadeOutVerticalScrollBar () {\n\t\tif (this.isAnimating) {\n\t\t\tthis.resetAnimation();\n\t\t\tthis.sectionProperties.animatingVerticalScrollBar = true;\n\t\t}\n\t\telse {\n\t\t\tvar options: any = {\n\t\t\t\tduration: this.sectionProperties.idleDuration\n\t\t\t};\n\n\t\t\tthis.sectionProperties.animatingVerticalScrollBar = this.startAnimating(options);\n\t\t}\n\t}\n\n\tprivate hideVerticalScrollBar () {\n\t\tif (this.sectionProperties.mouseIsOnVerticalScrollBar) {\n\t\t\tthis.sectionProperties.mouseIsOnVerticalScrollBar = false;\n\t\t\tthis.sectionProperties.mapPane.style.cursor = this.sectionProperties.defaultCursorStyle;\n\n\t\t\tif (!(<any>window).mode.isDesktop()) { // On desktop, we don't want to hide the vertical scroll bar.\n\t\t\t\tthis.sectionProperties.drawVerticalScrollBar = false;\n\t\t\t\tthis.fadeOutVerticalScrollBar();\n\t\t\t}\n\n\t\t\t// just in case if we have blinking cursor visible\n\t\t\t// we need to change cursor from default style\n\t\t\tif (this.map._docLayer._cursorMarker)\n\t\t\t\tthis.map._docLayer._cursorMarker.setMouseCursor();\n\t\t}\n\t}\n\n\tprivate showVerticalScrollBar () {\n\t\tif (this.isAnimating && this.sectionProperties.animatingVerticalScrollBar)\n\t\t\tthis.containerObject.stopAnimating();\n\n\t\tif (!this.sectionProperties.mouseIsOnVerticalScrollBar) {\n\t\t\tthis.sectionProperties.drawVerticalScrollBar = true;\n\t\t\tthis.sectionProperties.mouseIsOnVerticalScrollBar = true;\n\t\t\tthis.sectionProperties.mapPane.style.cursor = 'pointer';\n\t\t\tthis.containerObject.requestReDraw();\n\t\t}\n\t}\n\n\tprivate hideHorizontalScrollBar () {\n\t\tif (this.sectionProperties.mouseIsOnHorizontalScrollBar) {\n\t\t\tthis.sectionProperties.mouseIsOnHorizontalScrollBar = false;\n\t\t\tthis.sectionProperties.mapPane.style.cursor = this.sectionProperties.defaultCursorStyle;\n\n\t\t\tif (!(<any>window).mode.isDesktop()) {\n\t\t\t\tthis.sectionProperties.drawHorizontalScrollBar = false;\n\t\t\t\tthis.fadeOutHorizontalScrollBar();\n\t\t\t}\n\n\t\t\t// just in case if we have blinking cursor visible\n\t\t\t// we need to change cursor from default style\n\t\t\tif (this.map._docLayer._cursorMarker)\n\t\t\t\tthis.map._docLayer._cursorMarker.setMouseCursor();\n\t\t}\n\t}\n\n\tprivate showHorizontalScrollBar () {\n\t\tif (this.isAnimating && this.sectionProperties.animatingHorizontalScrollBar)\n\t\t\tthis.containerObject.stopAnimating();\n\n\t\tif (!this.sectionProperties.mouseIsOnHorizontalScrollBar) {\n\t\t\tthis.sectionProperties.drawHorizontalScrollBar = true;\n\t\t\tthis.sectionProperties.mouseIsOnHorizontalScrollBar = true;\n\t\t\tthis.sectionProperties.mapPane.style.cursor = 'pointer';\n\t\t\tthis.containerObject.requestReDraw();\n\t\t}\n\t}\n\n\tprivate isMouseOnScrollBar (point: Array<number>) {\n\t\tconst mirrorX = this.isCalcRTL();\n\t\tif (this.documentTopLeft[1] >= 0) {\n\t\t\tif ((!mirrorX && point[0] >= this.size[0] - this.sectionProperties.usableThickness)\n\t\t\t\t|| (mirrorX && point[0] <= this.sectionProperties.usableThickness)) {\n\t\t\t\tif (point[1] > this.sectionProperties.yOffset) {\n\t\t\t\t\tthis.showVerticalScrollBar();\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tthis.hideVerticalScrollBar();\n\t\t\t\t}\n\t\t\t}\n\t\t\telse {\n\t\t\t\tthis.hideVerticalScrollBar();\n\t\t\t}\n\t\t}\n\n\t\tif (this.documentTopLeft[0] >= 0) {\n\t\t\tif (point[1] >= this.size[1] - this.sectionProperties.usableThickness) {\n\t\t\t\tif ((!mirrorX && point[0] <= this.size[0] - this.sectionProperties.horizontalScrollRightOffset && point[0] >= this.sectionProperties.xOffset)\n\t\t\t\t\t|| (mirrorX && point[0] >= this.sectionProperties.horizontalScrollRightOffset && point[0] >= this.sectionProperties.xOffset)) {\n\t\t\t\t\tthis.showHorizontalScrollBar();\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tthis.hideHorizontalScrollBar();\n\t\t\t\t}\n\t\t\t}\n\t\t\telse {\n\t\t\t\tthis.hideHorizontalScrollBar();\n\t\t\t}\n\t\t}\n\t}\n\n\tpublic onMouseLeave () {\n\t\tthis.hideVerticalScrollBar();\n\t\tthis.hideHorizontalScrollBar();\n\t}\n\n\tpublic scrollVerticalWithOffset (offset: number) {\n\t\tvar go = true;\n\t\tif (offset > 0) {\n\t\t\tif (this.documentTopLeft[1] + offset > this.sectionProperties.yMax)\n\t\t\t\toffset = this.sectionProperties.yMax - this.documentTopLeft[1];\n\t\t\tif (offset < 0)\n\t\t\t\tgo = false;\n\t\t}\n\t\telse {\n\t\t\tif (this.documentTopLeft[1] + offset < this.sectionProperties.yMin)\n\t\t\t\toffset = this.sectionProperties.yMin - this.documentTopLeft[1];\n\t\t\tif (offset > 0)\n\t\t\t\tgo = false;\n\t\t}\n\n\t\tif (go) {\n\t\t\tthis.map.scroll(0, offset / app.dpiScale, {});\n\t\t\tthis.onUpdateScrollOffset();\n\t\t\tif (app.file.fileBasedView)\n\t\t\t\tthis.map._docLayer._checkSelectedPart();\n\t\t}\n\t}\n\n\tpublic scrollHorizontalWithOffset (offset: number) {\n\t\tvar go = true;\n\t\tif (offset > 0) {\n\t\t\tif (this.documentTopLeft[0] + offset > this.sectionProperties.xMax)\n\t\t\t\toffset = this.sectionProperties.xMax - this.documentTopLeft[0];\n\t\t\tif (offset < 0)\n\t\t\t\tgo = false;\n\t\t}\n\t\telse {\n\t\t\tif (this.documentTopLeft[0] + offset < this.sectionProperties.xMin)\n\t\t\t\toffset = this.sectionProperties.xMin - this.documentTopLeft[0];\n\t\t\tif (offset > 0)\n\t\t\t\tgo = false;\n\t\t}\n\n\t\tif (go) {\n\t\t\tthis.map.scroll(offset / app.dpiScale, 0, {});\n\t\t\tthis.onUpdateScrollOffset();\n\t\t}\n\t}\n\n\tprivate isMouseInsideDocumentAnchor (point: Array<number>): boolean {\n\t\tvar docSection = this.containerObject.getDocumentAnchorSection();\n\t\treturn this.containerObject.doesSectionIncludePoint(docSection, point);\n\t}\n\n\tprivate isMousePointerSycnWithVerticalScrollBar (scrollProps: any, position: Array<number>): boolean {\n\t\t// Keep this desktop-only for now.\n\t\tif (!(<any>window).mode.isDesktop())\n\t\t\treturn true;\n\n\t\tvar spacer = 0;\n\t\tif (!this.sectionProperties.pointerSyncWithVerticalScrollBar) {\n\t\t\tspacer = this.sectionProperties.pointerReCaptureSpacer;\n\t\t}\n\n\t\tvar pointerIsSyncWithScrollBar = false;\n\t\tif (this.sectionProperties.pointerSyncWithVerticalScrollBar) {\n\t\t\tpointerIsSyncWithScrollBar = scrollProps.startY < position[1] && scrollProps.startY + scrollProps.scrollSize - this.sectionProperties.scrollBarThickness > position[1];\n\t\t\tpointerIsSyncWithScrollBar = pointerIsSyncWithScrollBar || (this.isMouseInsideDocumentAnchor(position) && spacer === 0);\n\t\t}\n\t\telse {\n\t\t\t// See if the scroll bar is on top or bottom.\n\t\t\tvar docAncSectionY = this.containerObject.getDocumentAnchorSection().myTopLeft[1];\n\t\t\tif (scrollProps.startY < 30 * window.app.roundedDpiScale + docAncSectionY) {\n\t\t\t\tpointerIsSyncWithScrollBar = scrollProps.startY + spacer < position[1];\n\t\t\t}\n\t\t\telse {\n\t\t\t\tpointerIsSyncWithScrollBar = scrollProps.startY + spacer > position[1];\n\t\t\t}\n\t\t}\n\n\t\tthis.sectionProperties.pointerSyncWithVerticalScrollBar = pointerIsSyncWithScrollBar;\n\t\treturn pointerIsSyncWithScrollBar;\n\t}\n\n\tprivate isMousePointerSycnWithHorizontalScrollBar (scrollProps: any, position: Array<number>): boolean {\n\t\t// Keep this desktop-only for now.\n\t\tif (!(<any>window).mode.isDesktop())\n\t\t\treturn true;\n\n\t\tvar spacer = 0;\n\t\tif (!this.sectionProperties.pointerSyncWithHorizontalScrollBar) {\n\t\t\tspacer = this.sectionProperties.pointerReCaptureSpacer;\n\t\t}\n\n\t\tconst sizeX = scrollProps.scrollSize - this.sectionProperties.scrollBarThickness;\n\t\tconst docWidth: number = this.map.getPixelBoundsCore().getSize().x;\n\t\tconst startX = this.isCalcRTL() ? docWidth - scrollProps.startX - sizeX : scrollProps.startX;\n\t\tconst endX = startX + sizeX;\n\n\t\tvar pointerIsSyncWithScrollBar = false;\n\t\tif (this.sectionProperties.pointerSyncWithHorizontalScrollBar) {\n\t\t\tpointerIsSyncWithScrollBar = position[0] > startX && position[0] < endX;\n\t\t\tpointerIsSyncWithScrollBar = pointerIsSyncWithScrollBar || (this.isMouseInsideDocumentAnchor(position) && spacer === 0);\n\t\t}\n\t\telse {\n\t\t\t// See if the scroll bar is on left or right.\n\t\t\tvar docAncSectionX = this.containerObject.getDocumentAnchorSection().myTopLeft[0];\n\t\t\tif (startX < 30 * window.app.roundedDpiScale + docAncSectionX) {\n\t\t\t\tpointerIsSyncWithScrollBar = startX + spacer < position[0];\n\t\t\t}\n\t\t\telse {\n\t\t\t\tpointerIsSyncWithScrollBar = startX + spacer > position[0];\n\t\t\t}\n\t\t}\n\n\t\tthis.sectionProperties.pointerSyncWithHorizontalScrollBar = pointerIsSyncWithScrollBar;\n\t\treturn pointerIsSyncWithScrollBar;\n\t}\n\n\tpublic onMouseMove (position: Array<number>, dragDistance: Array<number>, e: MouseEvent) {\n\t\tif (this.sectionProperties.clickScrollVertical && this.containerObject.draggingSomething) {\n\t\t\tif (!this.sectionProperties.previousDragDistance) {\n\t\t\t\tthis.sectionProperties.previousDragDistance = [0, 0];\n\t\t\t}\n\n\t\t\tthis.showVerticalScrollBar();\n\n\t\t\tvar scrollProps: any = this.getVerticalScrollProperties();\n\n\t\t\tvar diffY: number = dragDistance[1] - this.sectionProperties.previousDragDistance[1];\n\t\t\tvar actualDistance = scrollProps.ratio * diffY;\n\n\t\t\tif (this.isMousePointerSycnWithVerticalScrollBar(scrollProps, position))\n\t\t\t\tthis.scrollVerticalWithOffset(actualDistance);\n\n\t\t\tthis.sectionProperties.previousDragDistance[1] = dragDistance[1];\n\n\t\t\te.stopPropagation(); // Don't propagate to map.\n\t\t\tthis.stopPropagating(); // Don't propagate to bound sections.\n\t\t}\n\t\telse if (this.sectionProperties.clickScrollHorizontal && this.containerObject.draggingSomething) {\n\t\t\tif (!this.sectionProperties.previousDragDistance) {\n\t\t\t\tthis.sectionProperties.previousDragDistance = [0, 0];\n\t\t\t}\n\n\t\t\tthis.showHorizontalScrollBar();\n\n\t\t\tvar signX = this.isCalcRTL() ? -1 : 1;\n\t\t\tvar scrollProps: any = this.getHorizontalScrollProperties();\n\t\t\tvar diffX: number = signX * (dragDistance[0] - this.sectionProperties.previousDragDistance[0]);\n\t\t\tvar actualDistance = scrollProps.ratio * diffX;\n\n\t\t\tif (this.isMousePointerSycnWithHorizontalScrollBar(scrollProps, position))\n\t\t\t\tthis.scrollHorizontalWithOffset(actualDistance);\n\n\t\t\tthis.sectionProperties.previousDragDistance[0] = dragDistance[0];\n\t\t\te.stopPropagation(); // Don't propagate to map.\n\t\t\tthis.stopPropagating(); // Don't propagate to bound sections.\n\t\t}\n\t\telse {\n\t\t\tthis.isMouseOnScrollBar(position);\n\t\t}\n\t}\n\n\t/*\n\t\tWhen user presses the button while the mouse pointer is on the railway of the scroll bar but not on the scroll bar directly,\n\t\twe quickly scroll the document to that position.\n\t*/\n\tprivate quickScrollVertical (point: Array<number>) {\n\t\t// Desktop only for now.\n\t\tif (!(<any>window).mode.isDesktop())\n\t\t\treturn;\n\n\t\tvar props = this.getVerticalScrollProperties();\n\t\tvar midY = (props.startY + props.startY + props.scrollSize - this.sectionProperties.scrollBarThickness) * 0.5;\n\t\tvar offset = Math.round((point[1] - midY) * props.ratio);\n\t\tthis.scrollVerticalWithOffset(offset);\n\t}\n\n\t/*\n\t\tWhen user presses the button while the mouse pointer is on the railway of the scroll bar but not on the scroll bar directly,\n\t\twe quickly scroll the document to that position.\n\t*/\n\tprivate quickScrollHorizontal (point: Array<number>) {\n\t\t// Desktop only for now.\n\t\tif (!(<any>window).mode.isDesktop())\n\t\t\treturn;\n\n\t\tvar props = this.getHorizontalScrollProperties();\n\t\tconst sizeX = props.scrollSize - this.sectionProperties.scrollBarThickness;\n\t\tconst docWidth: number = this.map.getPixelBoundsCore().getSize().x;\n\t\tconst startX = this.isCalcRTL() ? docWidth - props.startX - sizeX : props.startX;\n\t\tvar midX = startX + sizeX * 0.5;\n\t\tvar offset = Math.round((point[0] - midX) * props.ratio);\n\t\tthis.scrollHorizontalWithOffset(offset);\n\t}\n\n\tprivate getLocalYOnVerticalScrollBar (point: Array<number>): number {\n\t\tvar props = this.getVerticalScrollProperties();\n\t\treturn point[1] - props.startY;\n\t}\n\n\tprivate getLocalXOnHorizontalScrollBar (point: Array<number>): number {\n\t\tvar props = this.getHorizontalScrollProperties();\n\t\treturn point[0] - props.startX;\n\t}\n\n\tpublic onMouseDown (point: Array<number>, e: MouseEvent) {\n\t\tthis.onMouseMove(point, null, e);\n\t\tthis.isMouseOnScrollBar(point);\n\n\t\tconst mirrorX = this.isCalcRTL();\n\n\t\tif (this.documentTopLeft[1] >= 0) {\n\t\t\tif ((!mirrorX && point[0] >= this.size[0] - this.sectionProperties.usableThickness)\n\t\t\t\t|| (mirrorX && point[0] <= this.sectionProperties.usableThickness)) {\n\t\t\t\tif (point[1] > this.sectionProperties.yOffset) {\n\t\t\t\t\tthis.sectionProperties.clickScrollVertical = true;\n\t\t\t\t\tthis.map.scrollingIsHandled = true;\n\t\t\t\t\tthis.quickScrollVertical(point);\n\t\t\t\t\tthis.sectionProperties.pointerReCaptureSpacer = this.getLocalYOnVerticalScrollBar(point);\n\t\t\t\t\te.stopPropagation(); // Don't propagate to map.\n\t\t\t\t\tthis.stopPropagating(); // Don't propagate to bound sections.\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tthis.sectionProperties.clickScrollVertical = false;\n\t\t\t\t}\n\t\t\t}\n\t\t\telse {\n\t\t\t\tthis.sectionProperties.clickScrollVertical = false;\n\t\t\t}\n\t\t}\n\n\t\tif (this.documentTopLeft[0] >= 0) {\n\t\t\tif (point[1] >= this.size[1] - this.sectionProperties.usableThickness) {\n\t\t\t\tif ((!mirrorX && point[0] >= this.sectionProperties.xOffset && point[0] <= this.size[0] - this.sectionProperties.horizontalScrollRightOffset)\n\t\t\t\t\t|| (mirrorX && point[0] >= this.sectionProperties.xOffset && point[0] >= this.sectionProperties.horizontalScrollRightOffset)) {\n\t\t\t\t\tthis.sectionProperties.clickScrollHorizontal = true;\n\t\t\t\t\tthis.map.scrollingIsHandled = true;\n\t\t\t\t\tthis.quickScrollHorizontal(point);\n\t\t\t\t\tthis.sectionProperties.pointerReCaptureSpacer = this.getLocalXOnHorizontalScrollBar(point);\n\t\t\t\t\te.stopPropagation(); // Don't propagate to map.\n\t\t\t\t\tthis.stopPropagating(); // Don't propagate to bound sections.\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tthis.sectionProperties.clickScrollHorizontal = false;\n\t\t\t\t}\n\t\t\t}\n\t\t\telse {\n\t\t\t\tthis.sectionProperties.clickScrollHorizontal = false;\n\t\t\t}\n\t\t}\n\t}\n\n\tpublic onMouseUp (point: Array<number>, e: MouseEvent) {\n\t\tthis.map.scrollingIsHandled = false;\n\t\tif (this.sectionProperties.clickScrollVertical) {\n\t\t\te.stopPropagation(); // Don't propagate to map.\n\t\t\tthis.stopPropagating(); // Don't propagate to bound sections.\n\t\t\tthis.sectionProperties.clickScrollVertical = false;\n\t\t\tthis.sectionProperties.pointerSyncWithVerticalScrollBar = true; // Default.\n\t\t}\n\t\telse if (this.sectionProperties.clickScrollHorizontal) {\n\t\t\te.stopPropagation(); // Don't propagate to map.\n\t\t\tthis.stopPropagating(); // Don't propagate to bound sections.\n\t\t\tthis.sectionProperties.clickScrollHorizontal = false;\n\t\t\tthis.sectionProperties.pointerSyncWithHorizontalScrollBar = true; // Default.\n\t\t}\n\n\t\t// Unfortunately, dragging outside the map doesn't work for the map element.\n\t\t// We will keep this until we remove leaflet.\n\t\telse if (L.Map.THIS.mouse && L.Map.THIS.mouse._mouseDown && this.containerObject.targetBoundSectionListContains(L.CSections.Tiles.name) && (<any>window).mode.isDesktop() && this.containerObject.draggingSomething && L.Map.THIS._docLayer._docType === 'spreadsheet') {\n\t\t\tvar temp = this.containerObject.positionOnMouseUp;\n\t\t\tvar tempPos = [temp[0] * app.dpiScale, temp[1] * app.dpiScale];\n\t\t\tvar docTopLeft = app.sectionContainer.getDocumentTopLeft();\n\t\t\ttempPos = [tempPos[0] + docTopLeft[0], tempPos[1] + docTopLeft[1]];\n\t\t\ttempPos = [Math.round(tempPos[0] * app.pixelsToTwips), Math.round(tempPos[1] * app.pixelsToTwips)];\n\t\t\tthis.onScrollVelocity({ vx: 0, vy: 0 }); // Cancel auto scrolling.\n\t\t\tL.Map.THIS.mouse._mouseDown = false;\n\t\t\tL.Map.THIS._docLayer._postMouseEvent('buttonup', tempPos[0], tempPos[1], 1, 1, 0);\n\t\t}\n\n\t\tthis.sectionProperties.previousDragDistance = null;\n\t\tthis.onMouseMove(point, null, e);\n\t}\n\n\tprivate performVerticalScroll (delta: number) {\n\t\tthis.scrollVerticalWithOffset(delta);\n\t\tif (!this.sectionProperties.drawVerticalScrollBar) {\n\t\t\tif (this.isAnimating) {\n\t\t\t\tthis.resetAnimation();\n\t\t\t\tthis.sectionProperties.animatingVerticalScrollBar = true;\n\t\t\t}\n\t\t\telse\n\t\t\t\tthis.fadeOutVerticalScrollBar();\n\t\t}\n\t}\n\n\tprivate performHorizontalScroll (delta: number) {\n\t\tthis.scrollHorizontalWithOffset(delta);\n\t\tif (!this.sectionProperties.drawHorizontalScrollBar) {\n\t\t\tif (this.isAnimating) {\n\t\t\t\tthis.resetAnimation();\n\t\t\t\tthis.sectionProperties.animatingHorizontalScrollBar = true;\n\t\t\t}\n\t\t\telse\n\t\t\t\tthis.fadeOutHorizontalScrollBar();\n\t\t}\n\t}\n\n\tpublic onMouseWheel (point: Array<number>, delta: Array<number>, e: MouseEvent) {\n\t\tif (e.ctrlKey)\n\t\t\treturn;\n\n\t\tif (Math.abs(delta[1]) > Math.abs(delta[0])) {\n\t\t\tif (!e.shiftKey)\n\t\t\t\tthis.performVerticalScroll(delta[1]);\n\t\t\telse\n\t\t\t\tthis.performHorizontalScroll(delta[1]);\n\t\t}\n\t\telse {\n\t\t\tthis.performHorizontalScroll(delta[0]);\n\t\t}\n\t}\n\n\tpublic onMouseEnter () { return; }\n\tpublic onClick () { return; }\n\tpublic onDoubleClick () { return; }\n\tpublic onContextMenu () { return; }\n\tpublic onLongPress () { return; }\n\tpublic onMultiTouchStart () { return; }\n\tpublic onMultiTouchMove () { return; }\n\tpublic onMultiTouchEnd () { return; }\n\tpublic onResize () { return; }\n\tpublic onNewDocumentTopLeft () { return; }\n}\n\nL.getNewScrollSection = function () {\n\treturn new ScrollSection();\n};\n"]}