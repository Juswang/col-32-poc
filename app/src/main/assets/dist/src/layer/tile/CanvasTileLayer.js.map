{"version":3,"file":"CanvasTileLayer.js","sourceRoot":"","sources":["../../../../../../../../../browser/src/layer/tile/CanvasTileLayer.js"],"names":[],"mappings":"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","sourcesContent":["/* -*- js-indent-level: 8; fill-column: 100 -*- */\n/*\n * L.CanvasTileLayer is a layer with canvas based rendering.\n */\n\n/* global app L CanvasSectionContainer CanvasOverlay CDarkOverlay CSplitterLine CStyleData $ _ isAnyVexDialogActive CPointSet CPolyUtil CPolygon Cursor CCellCursor CCellSelection PathGroupType UNOKey UNOModifier */\n\n/*eslint no-extend-native:0*/\nif (typeof String.prototype.startsWith !== 'function') {\n\tString.prototype.startsWith = function (str) {\n\t\treturn this.slice(0, str.length) === str;\n\t};\n}\n\n// CStyleData is used to obtain CSS property values from style data\n// stored in DOM elements in the form of custom CSS properties/variables.\nvar CStyleData = L.Class.extend({\n\n\tinitialize: function (styleDataDiv) {\n\t\tthis._div = styleDataDiv;\n\t},\n\n\tgetPropValue: function (name) {\n\t\treturn getComputedStyle(this._div).getPropertyValue(name);\n\t},\n\n\tgetIntPropValue: function(name) { // (String) -> Number\n\t\treturn parseInt(this.getPropValue(name));\n\t},\n\n\tgetFloatPropValue: function(name) { // (String) -> Number\n\t\treturn parseFloat(this.getPropValue(name));\n\t},\n\n\tgetFloatPropWithoutUnit: function(name) { // (String) -> Number\n\t\tvar value = this.getPropValue(name);\n\t\tif (value.indexOf('px'))\n\t\t\tvalue = value.split('px')[0];\n\t\treturn parseFloat(value);\n\t}\n});\n\n// CSelections is used to add/modify/clear selections (text/cell-area(s)/ole)\n// on canvas using polygons (CPolygon).\nvar CSelections = L.Class.extend({\n\tinitialize: function (pointSet, canvasOverlay, selectionsDataDiv, map, isView, viewId, selectionType) {\n\t\tthis._pointSet = pointSet ? pointSet : new CPointSet();\n\t\tthis._overlay = canvasOverlay;\n\t\tthis._styleData = new CStyleData(selectionsDataDiv);\n\t\tthis._map = map;\n\t\tthis._name = 'selections' + (isView ? '-viewid-' + viewId : '');\n\t\tthis._isView = isView;\n\t\tthis._viewId = viewId;\n\t\tthis._isText = selectionType === 'text';\n\t\tthis._isOle = selectionType === 'ole';\n\t\tthis._selection = undefined;\n\t\tthis._updateSelection();\n\t},\n\n\tempty: function () {\n\t\treturn !this._pointSet || this._pointSet.empty();\n\t},\n\n\tclear: function () {\n\t\tthis.setPointSet(new CPointSet());\n\t},\n\n\tsetPointSet: function(pointSet) {\n\t\tthis._pointSet = pointSet;\n\t\tthis._updateSelection();\n\t},\n\n\tcontains: function(corePxPoint) {\n\t\tif (!this._selection)\n\t\t\treturn false;\n\n\t\treturn this._selection.anyRingBoundContains(corePxPoint);\n\t},\n\n\tgetBounds: function() {\n\t\treturn this._selection.getBounds();\n\t},\n\n\t_updateSelection: function() {\n\t\tif (!this._selection) {\n\t\t\tif (!this._isOle) {\n\t\t\t\tvar fillColor = this._isView ?\n\t\t\t\t\tL.LOUtil.rgbToHex(this._map.getViewColor(this._viewId)) :\n\t\t\t\t\tthis._styleData.getPropValue('background-color');\n\t\t\t\tvar opacity = this._styleData.getFloatPropValue('opacity');\n\t\t\t\tvar weight = this._styleData.getFloatPropWithoutUnit('border-top-width');\n\t\t\t\tvar attributes = this._isText ? {\n\t\t\t\t\tviewId: this._isView ? this._viewId : undefined,\n\t\t\t\t\tgroupType: PathGroupType.TextSelection,\n\t\t\t\t\tname: this._name,\n\t\t\t\t\tpointerEvents: 'none',\n\t\t\t\t\tfillColor: fillColor,\n\t\t\t\t\tfillOpacity: opacity,\n\t\t\t\t\tcolor: fillColor,\n\t\t\t\t\topacity: 0.60,\n\t\t\t\t\tstroke: true,\n\t\t\t\t\tfill: true,\n\t\t\t\t\tweight: 1.0\n\t\t\t\t} : {\n\t\t\t\t\tviewId: this._isView ? this._viewId : undefined,\n\t\t\t\t\tname: this._name,\n\t\t\t\t\tpointerEvents: 'none',\n\t\t\t\t\tcolor: fillColor,\n\t\t\t\t\tfillColor: fillColor,\n\t\t\t\t\tfillOpacity: opacity,\n\t\t\t\t\topacity: 1.0,\n\t\t\t\t\tweight: Math.round(weight * app.dpiScale)\n\t\t\t\t};\n\t\t\t}\n\t\t\telse {\n\t\t\t\tvar attributes = {\n\t\t\t\t\tpointerEvents: 'none',\n\t\t\t\t\tfillColor: 'black',\n\t\t\t\t\tfillOpacity: 0.25,\n\t\t\t\t\tweight: 0,\n\t\t\t\t\topacity: 0.25\n\t\t\t\t};\n\t\t\t}\n\n\t\t\tif (this._isText) {\n\t\t\t\tthis._selection = new CPolygon(this._pointSet, attributes);\n\t\t\t}\n\t\t\telse if (this._isOle) {\n\t\t\t\tthis._selection = new CDarkOverlay(this._pointSet, attributes);\n\t\t\t}\n\t\t\telse {\n\t\t\t\tthis._selection = new CCellSelection(this._pointSet, attributes);\n\t\t\t}\n\n\t\t\tif (this._isText)\n\t\t\t\tthis._overlay.initPath(this._selection);\n\t\t\telse\n\t\t\t\tthis._overlay.initPathGroup(this._selection);\n\t\t\treturn;\n\t\t}\n\n\t\tthis._selection.setPointSet(this._pointSet);\n\t},\n\n\tremove: function() {\n\t\tif (!this._selection)\n\t\t\treturn;\n\t\tif (this._isText)\n\t\t\tthis._overlay.removePath(this._selection);\n\t\telse\n\t\t\tthis._overlay.removePathGroup(this._selection);\n\t},\n});\n\n// CReferences is used to store and manage the CPath's of all\n// references in the current sheet.\nvar CReferences = L.Class.extend({\n\n\tinitialize: function (canvasOverlay) {\n\n\t\tthis._overlay = canvasOverlay;\n\t\tthis._marks = [];\n\t},\n\n\t// mark should be a CPath.\n\taddMark: function (mark) {\n\t\tthis._overlay.initPath(mark);\n\t\tthis._marks.push(mark);\n\t},\n\n\t// mark should be a CPath.\n\thasMark: function (mark) {\n\t\tfor (var i = 0; i < this._marks.length; ++i) {\n\t\t\tif (mark.getBounds().equals(this._marks[i].getBounds()))\n\t\t\t\treturn true;\n\t\t}\n\n\t\treturn false;\n\t},\n\n\tclear: function () {\n\t\tfor (var i = 0; i < this._marks.length; ++i)\n\t\t\tthis._overlay.removePath(this._marks[i]);\n\t\tthis._marks = [];\n\t}\n\n});\n\n\nL.TileCoordData = L.Class.extend({\n\n\tinitialize: function (left, top, zoom, part) {\n\t\tthis.x = left;\n\t\tthis.y = top;\n\t\tthis.z = zoom;\n\t\tthis.part = part;\n\t},\n\n\tgetPos: function () {\n\t\treturn new L.Point(this.x, this.y);\n\t},\n\n\tkey: function () {\n\t\treturn this.x + ':' + this.y + ':' + this.z + ':' + this.part;\n\t},\n\n\ttoString: function () {\n\t\treturn '{ left : ' + this.x + ', top : ' + this.y +\n\t\t\t', z : ' + this.z + ', part : ' + this.part + ' }';\n\t}\n});\n\nL.TileCoordData.parseKey = function (keyString) {\n\n\twindow.app.console.assert(typeof keyString === 'string', 'key should be a string');\n\tvar k = keyString.split(':');\n\twindow.app.console.assert(k.length >= 4, 'invalid key format');\n\treturn new L.TileCoordData(+k[0], +k[1], +k[2], +k[3]);\n};\n\nL.TileSectionManager = L.Class.extend({\n\n\tinitialize: function (layer) {\n\t\tthis._layer = layer;\n\t\tthis._canvas = this._layer._canvas;\n\t\tthis._map = this._layer._map;\n\t\tvar mapSize = this._map.getPixelBoundsCore().getSize();\n\t\tthis._oscCtxs = [];\n\t\tthis._tilesSection = null; // Shortcut.\n\n\t\tthis._sectionContainer = new CanvasSectionContainer(this._canvas, this._layer.isCalc() /* disableDrawing? */);\n\n\t\tif (this._layer.isCalc())\n\t\t\tthis._sectionContainer.setClearColor('white'); // will be overridden by 'documentbackgroundcolor' msg.\n\n\t\tapp.sectionContainer = this._sectionContainer;\n\t\tif (L.Browser.cypressTest) // If cypress is active, create test divs.\n\t\t\tthis._sectionContainer.testing = true;\n\n\t\tthis._sectionContainer.onResize(mapSize.x, mapSize.y);\n\n\t\tvar splitPanesContext = this._layer.getSplitPanesContext();\n\t\tthis._splitPos = splitPanesContext ?\n\t\t\tsplitPanesContext.getSplitPos() : new L.Point(0, 0);\n\t\tthis._updatesRunning = false;\n\t\tthis._mirrorEventsFromSourceToCanvasSectionContainer(document.getElementById('map'));\n\n\t\tvar canvasContainer = document.getElementById('document-container');\n\t\tvar that = this;\n\t\tthis.resObserver = new ResizeObserver(function() {\n\t\t\tthat._layer._syncTileContainerSize();\n\t\t});\n\t\tthis.resObserver.observe(canvasContainer);\n\t},\n\n\t// Map and TilesSection overlap entirely. Map is above tiles section. In order to handle events in tiles section, we need to mirror them from map.\n\t_mirrorEventsFromSourceToCanvasSectionContainer: function (sourceElement) {\n\t\tvar that = this;\n\t\tsourceElement.addEventListener('mousedown', function (e) { that._sectionContainer.onMouseDown(e); }, true);\n\t\tsourceElement.addEventListener('click', function (e) { that._sectionContainer.onClick(e); }, true);\n\t\tsourceElement.addEventListener('dblclick', function (e) { that._sectionContainer.onDoubleClick(e); }, true);\n\t\tsourceElement.addEventListener('contextmenu', function (e) { that._sectionContainer.onContextMenu(e); }, true);\n\t\tsourceElement.addEventListener('wheel', function (e) { that._sectionContainer.onMouseWheel(e); }, true);\n\t\tsourceElement.addEventListener('mouseleave', function (e) { that._sectionContainer.onMouseLeave(e); }, true);\n\t\tsourceElement.addEventListener('mouseenter', function (e) { that._sectionContainer.onMouseEnter(e); }, true);\n\t\tsourceElement.addEventListener('touchstart', function (e) { that._sectionContainer.onTouchStart(e); }, true);\n\t\tsourceElement.addEventListener('touchmove', function (e) { that._sectionContainer.onTouchMove(e); }, true);\n\t\tsourceElement.addEventListener('touchend', function (e) { that._sectionContainer.onTouchEnd(e); }, true);\n\t\tsourceElement.addEventListener('touchcancel', function (e) { that._sectionContainer.onTouchCancel(e); }, true);\n\t},\n\n\tstartUpdates: function () {\n\t\tif (this._updatesRunning === true) {\n\t\t\treturn false;\n\t\t}\n\n\t\tthis._updatesRunning = true;\n\t\tthis._updateWithRAF();\n\t\treturn true;\n\t},\n\n\tstopUpdates: function () {\n\t\tif (this._updatesRunning) {\n\t\t\tL.Util.cancelAnimFrame(this._canvasRAF);\n\t\t\tthis.update();\n\t\t\tthis._updatesRunning = false;\n\t\t\treturn true;\n\t\t}\n\n\t\treturn false;\n\t},\n\n\tdispose: function () {\n\t\tthis.stopUpdates();\n\t},\n\n\tgetSplitPos: function () {\n\t\tvar splitPanesContext = this._layer.getSplitPanesContext();\n\t\treturn splitPanesContext ?\n\t\t\tsplitPanesContext.getSplitPos().multiplyBy(app.dpiScale) :\n\t\t\tnew L.Point(0, 0);\n\t},\n\n\t// Details of tile areas to render\n\t_paintContext: function() {\n\t\tvar tileSize = new L.Point(this._layer._getTileSize(), this._layer._getTileSize());\n\n\t\tvar viewBounds = this._map.getPixelBoundsCore();\n\t\tvar splitPanesContext = this._layer.getSplitPanesContext();\n\t\tvar paneBoundsList = splitPanesContext ?\n\t\t    splitPanesContext.getPxBoundList(viewBounds) :\n\t\t    [viewBounds];\n\t\tvar canvasCorePx = new L.Point(this._pixWidth, this._pixHeight);\n\n\t\treturn { canvasSize: canvasCorePx,\n\t\t\t tileSize: tileSize,\n\t\t\t viewBounds: viewBounds,\n\t\t\t paneBoundsList: paneBoundsList,\n\t\t\t paneBoundsActive: splitPanesContext ? true: false,\n\t\t\t splitPos: this.getSplitPos(),\n\t\t};\n\t},\n\n\tcoordsIntersectVisible: function (coords) {\n\t\tif (!app.file.fileBasedView) {\n\t\t\tvar ctx = this._paintContext();\n\t\t\tvar tileBounds = new L.Bounds(new L.Point(coords.x, coords.y), new L.Point(coords.x + ctx.tileSize.x, coords.y + ctx.tileSize.y));\n\t\t\treturn tileBounds.intersectsAny(ctx.paneBoundsList);\n\t\t}\n\t\telse {\n\t\t\tvar ratio = this._layer._tileSize / this._layer._tileHeightTwips;\n\t\t\tvar partHeightPixels = Math.round((this._layer._partHeightTwips + this._layer._spaceBetweenParts) * ratio);\n\t\t\treturn L.LOUtil._doRectanglesIntersect(app.file.viewedRectangle, [coords.x, coords.y + partHeightPixels * coords.part, app.tile.size.pixels[0], app.tile.size.pixels[1]]);\n\t\t}\n\t},\n\n\t_addTilesSection: function () {\n\t\tthis._sectionContainer.addSection(L.getNewTilesSection());\n\t\tthis._tilesSection = this._sectionContainer.getSectionWithName('tiles');\n\t\tapp.sectionContainer.setDocumentAnchorSection(L.CSections.Tiles.name);\n\t},\n\n\t_addGridSection: function () {\n\t\tvar that = this;\n\t\tthis._sectionContainer.createSection({\n\t\t\tname: L.CSections.CalcGrid.name,\n\t\t\tanchor: 'top left',\n\t\t\tposition: [0, 0],\n\t\t\tsize: [0, 0],\n\t\t\texpand: '',\n\t\t\tprocessingOrder: L.CSections.CalcGrid.processingOrder, // Size and position will be copied, this value is not important.\n\t\t\tdrawingOrder: L.CSections.CalcGrid.drawingOrder,\n\t\t\tzIndex: L.CSections.CalcGrid.zIndex,\n\t\t\t// Even if this one is drawn on top, won't be able to catch events.\n\t\t\t// Sections with \"interactable: true\" can catch events even if they are under a section with property \"interactable: false\".\n\t\t\tinteractable: false,\n\t\t\tsectionProperties: {\n\t\t\t\tdocLayer: that._layer,\n\t\t\t\ttsManager: that,\n\t\t\t\tstrokeStyle: '#c0c0c0'\n\t\t\t},\n\t\t\tonDraw: that._onDrawGridSection,\n\t\t\tonDrawArea: that._drawGridSectionArea\n\t\t}, 'tiles'); // Its size and position will be copied from 'tiles' section.\n\t\tthis._calcGridSection = this._sectionContainer.getSectionWithName(L.CSections.CalcGrid.name);\n\t},\n\n\t_addOverlaySection: function () {\n\t\tvar tsMgr = this;\n\t\tvar canvasOverlay = this._layer._canvasOverlay = new CanvasOverlay(this._map, this._sectionContainer.getContext());\n\t\tthis._sectionContainer.createSection({\n\t\t\tname: L.CSections.Overlays.name,\n\t\t\tanchor: 'top left',\n\t\t\tposition: [0, 0],\n\t\t\tsize: [0, 0],\n\t\t\texpand: '',\n\t\t\tprocessingOrder: L.CSections.Overlays.processingOrder,\n\t\t\tdrawingOrder: L.CSections.Overlays.drawingOrder,\n\t\t\tzIndex: L.CSections.Overlays.zIndex,\n\t\t\tinteractable: true,\n\t\t\tsectionProperties: {\n\t\t\t\tdocLayer: tsMgr._layer,\n\t\t\t\ttsManager: tsMgr\n\t\t\t},\n\t\t\tonInitialize: canvasOverlay.onInitialize.bind(canvasOverlay),\n\t\t\tonResize: canvasOverlay.onResize.bind(canvasOverlay), // will call onDraw.\n\t\t\tonDraw: canvasOverlay.onDraw.bind(canvasOverlay),\n\t\t\tonMouseMove: canvasOverlay.onMouseMove.bind(canvasOverlay),\n\t\t}, L.CSections.Tiles.name); // 'tile' section is the parent.\n\t\tcanvasOverlay.setOverlaySection(this._sectionContainer.getSectionWithName(L.CSections.Overlays.name));\n\t},\n\n\tshouldDrawCalcGrid: function () {\n\t\tvar defaultBG = 'ffffff';\n\t\tif (this._layer.coreDocBGColor)\n\t\t\treturn (this._layer.coreDocBGColor === defaultBG);\n\t\telse\n\t\t\treturn true;\n\t},\n\n\t_onDrawGridSection: function () {\n\t\tif (this.containerObject.isInZoomAnimation() || this.sectionProperties.tsManager.waitForTiles())\n\t\t\treturn;\n\n\t\tif (this.sectionProperties.tsManager.shouldDrawCalcGrid()) {\n\t\t\t// grid-section's onDrawArea is TileSectionManager's _drawGridSectionArea().\n\t\t\tthis.onDrawArea();\n\t\t}\n\t},\n\n\t_drawGridSectionArea: function (repaintArea, paneTopLeft, canvasCtx) {\n\t\tif (!this.sectionProperties.docLayer.sheetGeometry)\n\t\t\treturn;\n\n\t\tvar context = canvasCtx ? canvasCtx : this.context;\n\t\tvar tsManager = this.sectionProperties.tsManager;\n\t\tcontext.strokeStyle = this.sectionProperties.strokeStyle;\n\t\tcontext.lineWidth = 1.0;\n\t\tvar scale = 1.0;\n\t\tif (tsManager._inZoomAnim && tsManager._zoomFrameScale)\n\t\t\tscale = tsManager._zoomFrameScale;\n\n\t\tvar ctx = this.sectionProperties.tsManager._paintContext();\n\t\tvar isRTL = this.sectionProperties.docLayer.isLayoutRTL();\n\t\tvar sectionWidth = this.size[0];\n\t\tvar xTransform = function (xcoord) {\n\t\t\treturn isRTL ? sectionWidth - xcoord : xcoord;\n\t\t};\n\n\t\tfor (var i = 0; i < ctx.paneBoundsList.length; ++i) {\n\t\t\t// co-ordinates of this pane in core document pixels\n\t\t\tvar paneBounds = ctx.paneBoundsList[i];\n\t\t\t// co-ordinates of the main-(bottom right) pane in core document pixels\n\t\t\tvar viewBounds = ctx.viewBounds;\n\t\t\t// into real pixel-land ...\n\t\t\tpaneBounds.round();\n\t\t\tviewBounds.round();\n\n\t\t\tvar paneOffset;\n\t\t\tvar doOnePane = false;\n\t\t\tif (!repaintArea || !paneTopLeft) {\n\t\t\t\trepaintArea = paneBounds;\n\t\t\t\tpaneOffset = paneBounds.getTopLeft(); // allocates\n\t\t\t\t// Cute way to detect the in-canvas pixel offset of each pane\n\t\t\t\tpaneOffset.x = Math.min(paneOffset.x, viewBounds.min.x);\n\t\t\t\tpaneOffset.y = Math.min(paneOffset.y, viewBounds.min.y);\n\t\t\t} else {\n\t\t\t\t// do only for the predefined pane (paneOffset/repaintArea)\n\t\t\t\tdoOnePane = true;\n\t\t\t\tpaneOffset = paneTopLeft.clone();\n\t\t\t}\n\n\t\t\t// Vertical line rendering on large areas is ~10x as expensive\n\t\t\t// as horizontal line rendering: due to cache effects - so to\n\t\t\t// help our poor CPU renderers - render in horizontal strips.\n\t\t\tvar bandSize = 256;\n\t\t\tfor (var miny = repaintArea.min.y; miny < repaintArea.max.y; miny += bandSize)\n\t\t\t{\n\t\t\t\tvar maxy = Math.min(repaintArea.max.y, miny + bandSize);\n\n\t\t\t\tcontext.beginPath();\n\n\t\t\t\t// vertical lines\n\t\t\t\tthis.sectionProperties.docLayer.sheetGeometry._columns.forEachInCorePixelRange(\n\t\t\t\t\trepaintArea.min.x, repaintArea.max.x,\n\t\t\t\t\tfunction(pos) {\n\t\t\t\t\t\tvar xcoord = xTransform(Math.floor(scale * (pos - paneOffset.x)) - 0.5);\n\t\t\t\t\t\tcontext.moveTo(xcoord, Math.floor(scale * (miny - paneOffset.y)) + 0.5);\n\t\t\t\t\t\tcontext.lineTo(xcoord, Math.floor(scale * (maxy - paneOffset.y)) - 0.5);\n\t\t\t\t\t\tcontext.stroke();\n\t\t\t\t\t});\n\n\t\t\t\t// horizontal lines\n\t\t\t\tthis.sectionProperties.docLayer.sheetGeometry._rows.forEachInCorePixelRange(\n\t\t\t\t\tminy, maxy,\n\t\t\t\t\tfunction(pos) {\n\t\t\t\t\t\tcontext.moveTo(\n\t\t\t\t\t\t\txTransform(Math.floor(scale * (repaintArea.min.x - paneOffset.x)) + 0.5),\n\t\t\t\t\t\t\tMath.floor(scale * (pos - paneOffset.y)) - 0.5);\n\t\t\t\t\t\tcontext.lineTo(\n\t\t\t\t\t\t\txTransform(Math.floor(scale * (repaintArea.max.x - paneOffset.x)) - 0.5),\n\t\t\t\t\t\t\tMath.floor(scale * (pos - paneOffset.y)) - 0.5);\n\t\t\t\t\t\tcontext.stroke();\n\t\t\t\t\t});\n\n\t\t\t\tcontext.closePath();\n\t\t\t}\n\n\t\t\tif (doOnePane)\n\t\t\t\tbreak;\n\t\t}\n\t},\n\n\t// This section is added when debug is enabled. Splits are enabled for only Calc for now.\n\t_addSplitsSection: function () {\n\t\tvar that = this;\n\t\tthis._sectionContainer.createSection({\n\t\t\tname: L.CSections.Debug.Splits.name,\n\t\t\tanchor: 'top left',\n\t\t\tposition: [0, 0],\n\t\t\tsize: [0, 0],\n\t\t\texpand: '',\n\t\t\tprocessingOrder: L.CSections.Debug.Splits.processingOrder,\n\t\t\tdrawingOrder: L.CSections.Debug.Splits.drawingOrder,\n\t\t\tzIndex: L.CSections.Debug.Splits.zIndex,\n\t\t\t// Even if this one is drawn on top, won't be able to catch events.\n\t\t\t// Sections with \"interactable: true\" can catch events even if they are under a section with property \"interactable: false\".\n\t\t\tinteractable: false,\n\t\t\tsectionProperties: {\n\t\t\t\tdocLayer: that._layer\n\t\t\t},\n\t\t\tonDraw: that._onDrawSplitsSection\n\t\t}, 'tiles'); // Its size and position will be copied from 'tiles' section.\n\t},\n\n\t// This section is added when debug is enabled.\n\t_addTilePixelGridSection: function () {\n\t\tvar that = this;\n\t\tthis._sectionContainer.createSection({\n\t\t\tname: L.CSections.Debug.TilePixelGrid.name,\n\t\t\tanchor: 'top left',\n\t\t\tposition: [0, 0],\n\t\t\tsize: [0, 0],\n\t\t\texpand: '',\n\t\t\tprocessingOrder: L.CSections.Debug.TilePixelGrid.processingOrder, // Size and position will be copied, this value is not important.\n\t\t\tdrawingOrder: L.CSections.Debug.TilePixelGrid.drawingOrder,\n\t\t\tzIndex: L.CSections.Debug.TilePixelGrid.zIndex,\n\t\t\tinteractable: false,\n\t\t\tsectionProperties: {},\n\t\t\tonDraw: that._onDrawTilePixelGrid\n\t\t}, 'tiles'); // Its size and position will be copied from 'tiles' section.\n\t},\n\n\t_onDrawTilePixelGrid: function() {\n\t\tvar offset = 8;\n\t\tvar count;\n\t\tthis.context.lineWidth = 1;\n\t\tvar currentPos;\n\t\tthis.context.strokeStyle = '#ff0000';\n\n\t\tcurrentPos = 0;\n\t\tcount = Math.round(this.context.canvas.height / offset);\n\t\tfor (var i = 0; i < count; i++) {\n\t\t\tthis.context.beginPath();\n\t\t\tthis.context.moveTo(0.5, currentPos + 0.5);\n\t\t\tthis.context.lineTo(this.context.canvas.width + 0.5, currentPos + 0.5);\n\t\t\tthis.context.stroke();\n\t\t\tcurrentPos += offset;\n\t\t}\n\n\t\tcurrentPos = 0;\n\t\tcount = Math.round(this.context.canvas.width / offset);\n\t\tfor (var i = 0; i < count; i++) {\n\t\t\tthis.context.beginPath();\n\t\t\tthis.context.moveTo(currentPos + 0.5, 0.5);\n\t\t\tthis.context.lineTo(currentPos + 0.5, this.context.canvas.height + 0.5);\n\t\t\tthis.context.stroke();\n\t\t\tcurrentPos += offset;\n\t\t}\n\t},\n\n\t_onDrawSplitsSection: function () {\n\t\tvar splitPanesContext = this.sectionProperties.docLayer.getSplitPanesContext();\n\t\tif (splitPanesContext) {\n\t\t\tvar splitPos = splitPanesContext.getSplitPos();\n\t\t\tthis.context.strokeStyle = 'red';\n\t\t\tthis.context.strokeRect(0, 0, splitPos.x * app.dpiScale, splitPos.y * app.dpiScale);\n\t\t}\n\t},\n\n\t_updateWithRAF: function () {\n\t\t// update-loop with requestAnimationFrame\n\t\tthis._canvasRAF = L.Util.requestAnimFrame(this._updateWithRAF, this, false /* immediate */);\n\t\tthis._sectionContainer.requestReDraw();\n\t},\n\n\tupdate: function () {\n\t\tthis._sectionContainer.requestReDraw();\n\t},\n\n\t_viewReset: function () {\n\t\tvar ctx = this._paintContext();\n\t\tfor (var i = 0; i < ctx.paneBoundsList.length; ++i) {\n\t\t\tthis._tilesSection.oscCtxs[i].fillStyle = this._sectionContainer.getClearColor();\n\t\t\tthis._tilesSection.oscCtxs[i].fillRect(0, 0, this._tilesSection.offscreenCanvases[i].width, this._tilesSection.offscreenCanvases[i].height);\n\t\t}\n\t},\n\n\t_getZoomDocPos: function (pinchCenter, paneBounds, splitPos, scale, findFreePaneCenter) {\n\t\tvar inXBounds = (pinchCenter.x >= paneBounds.min.x) && (pinchCenter.x <= paneBounds.max.x);\n\t\tvar inYBounds = (pinchCenter.y >= paneBounds.min.y) && (pinchCenter.y <= paneBounds.max.y);\n\n\t\t// Calculate the pinch-center in off-screen canvas coordinates.\n\t\tvar center = paneBounds.min.clone();\n\t\tif (inXBounds)\n\t\t\tcenter.x = pinchCenter.x;\n\t\tif (inYBounds)\n\t\t\tcenter.y = pinchCenter.y;\n\n\t\tvar xMin = 0;\n\t\tvar hasXMargin = !this._layer.isCalc();\n\t\tif (hasXMargin)\n\t\t\txMin = -Infinity;\n\t\telse if (paneBounds.min.x > 0)\n\t\t\txMin = splitPos.x;\n\n\t\tvar yMin = 0;\n\t\tif (paneBounds.min.y < 0)\n\t\t\tyMin = -Infinity;\n\t\telse if (paneBounds.min.y > 0)\n\t\t\tyMin = splitPos.y;\n\n\t\t// Top left in document coordinates.\n\t\tvar docTopLeft = new L.Point(\n\t\t\tMath.max(xMin,\n\t\t\t\tcenter.x - (center.x - paneBounds.min.x) / scale),\n\t\t\tMath.max(yMin,\n\t\t\t\tcenter.y - (center.y - paneBounds.min.y) / scale));\n\n\t\tif (!findFreePaneCenter)\n\t\t\treturn { topLeft: docTopLeft };\n\n\t\t// Assumes paneBounds is the bounds of the free pane.\n\t\tvar paneSize = paneBounds.getSize();\n\t\tvar newPaneCenter = new L.Point(\n\t\t\t(docTopLeft.x - splitPos.x + (paneSize.x + splitPos.x) / (2 * scale)) * scale / app.dpiScale,\n\t\t\t(docTopLeft.y - splitPos.y + (paneSize.y + splitPos.y) / (2 * scale)) * scale / app.dpiScale);\n\n\t\treturn {\n\t\t\ttopLeft: docTopLeft,\n\t\t\tcenter: newPaneCenter\n\t\t};\n\t},\n\n\t_getZoomMapCenter: function (zoom) {\n\t\tvar scale = this._calcZoomFrameScale(zoom);\n\t\tvar ctx = this._paintContext();\n\t\tvar splitPos = ctx.splitPos;\n\t\tvar viewBounds = ctx.viewBounds;\n\t\tvar freePaneBounds = new L.Bounds(viewBounds.min.add(splitPos), viewBounds.max);\n\n\t\treturn this._getZoomDocPos(this._newCenter, freePaneBounds, splitPos, scale, true /* findFreePaneCenter */).center;\n\t},\n\n\t_zoomAnimation: function () {\n\t\tvar painter = this;\n\t\tvar ctx = this._paintContext();\n\t\tvar canvasOverlay = this._layer._canvasOverlay;\n\n\t\tvar rafFunc = function (timeStamp, final) {\n\t\t\t// Draw zoom frame with grids and directly from the tiles.\n\t\t\t// This will clear the doc area first.\n\t\t\tpainter._tilesSection.drawZoomFrame(ctx);\n\t\t\t// Draw the overlay objects.\n\t\t\tcanvasOverlay.onDraw();\n\n\t\t\tif (!final)\n\t\t\t\tpainter._zoomRAF = requestAnimationFrame(rafFunc);\n\t\t};\n\t\tthis.rafFunc = rafFunc;\n\t\trafFunc();\n\t},\n\n\t_calcZoomFrameScale: function (zoom) {\n\t\tzoom = this._layer._map._limitZoom(zoom);\n\t\tvar origZoom = this._layer._map.getZoom();\n\t\t// Compute relative-multiplicative scale of this zoom-frame w.r.t the starting zoom(ie the current Map's zoom).\n\t\treturn this._layer._map.zoomToFactor(zoom - origZoom + this._layer._map.options.zoom);\n\t},\n\n\t_calcZoomFrameParams: function (zoom, newCenter) {\n\t\tthis._zoomFrameScale = this._calcZoomFrameScale(zoom);\n\t\tthis._newCenter = this._layer._map.project(newCenter).multiplyBy(app.dpiScale); // in core pixels\n\t},\n\n\tsetWaitForTiles: function (wait) {\n\t\tthis._waitForTiles = wait;\n\t},\n\n\twaitForTiles: function () {\n\t\treturn this._waitForTiles;\n\t},\n\n\tzoomStep: function (zoom, newCenter) {\n\t\tif (this._finishingZoom) // finishing steps of animation still going on.\n\t\t\treturn;\n\n\t\tthis._calcZoomFrameParams(zoom, newCenter);\n\n\t\tif (!this._inZoomAnim) {\n\t\t\tthis._sectionContainer.setInZoomAnimation(true);\n\t\t\tthis._inZoomAnim = true;\n\t\t\t// Start RAF loop for zoom-animation\n\t\t\tthis._zoomAnimation();\n\t\t}\n\t},\n\n\tzoomStepEnd: function (zoom, newCenter, mapUpdater, runAtFinish, noGap) {\n\n\t\tif (!this._inZoomAnim || this._finishingZoom)\n\t\t\treturn;\n\n\t\tthis._finishingZoom = true;\n\n\t\tthis._map.disableTextInput();\n\t\t// Do a another animation from current non-integral log-zoom to\n\t\t// the final integral zoom, but maintain the same center.\n\t\tvar steps = 10;\n\t\tvar stepId = noGap ? steps : 0;\n\n\t\tvar startZoom = this._zoomFrameScale;\n\t\tvar endZoom = this._calcZoomFrameScale(zoom);\n\t\tvar painter = this;\n\t\tvar map = this._map;\n\n\t\t// Calculate the final center at final zoom in advance.\n\t\tvar newMapCenter = this._getZoomMapCenter(zoom);\n\t\tvar newMapCenterLatLng = map.unproject(newMapCenter, zoom);\n\t\tpainter._sectionContainer.setZoomChanged(true);\n\n\t\tvar stopAnimation = noGap ? true : false;\n\t\tvar waitForTiles = false;\n\t\tvar waitTries = 30;\n\t\tvar finishingRAF = undefined;\n\n\t\tvar finishAnimation = function () {\n\n\t\t\tif (stepId < steps) {\n\t\t\t\t// continue animating till we reach \"close\" to 'final zoom'.\n\t\t\t\tpainter._zoomFrameScale = startZoom + (endZoom - startZoom) * stepId / steps;\n\t\t\t\tstepId += 1;\n\t\t\t\tif (stepId >= steps)\n\t\t\t\t\tstopAnimation = true;\n\t\t\t}\n\n\t\t\tif (stopAnimation) {\n\t\t\t\tstopAnimation = false;\n\t\t\t\tcancelAnimationFrame(painter._zoomRAF);\n\t\t\t\tpainter._calcZoomFrameParams(zoom, newCenter);\n\t\t\t\t// Draw one last frame at final zoom.\n\t\t\t\tpainter.rafFunc(undefined, true /* final? */);\n\t\t\t\tpainter._zoomFrameScale = undefined;\n\t\t\t\tpainter._sectionContainer.setInZoomAnimation(false);\n\t\t\t\tpainter._inZoomAnim = false;\n\n\t\t\t\tpainter.setWaitForTiles(true);\n\t\t\t\t// Set view and paint the tiles if all available.\n\t\t\t\tmapUpdater(newMapCenterLatLng);\n\t\t\t\twaitForTiles = true;\n\t\t\t}\n\n\t\t\tif (waitForTiles) {\n\t\t\t\t// Wait until we get all tiles or wait time exceeded.\n\t\t\t\tif (waitTries <= 0 || painter._tilesSection.haveAllTilesInView()) {\n\t\t\t\t\t// All done.\n\t\t\t\t\twaitForTiles = false;\n\t\t\t\t\tcancelAnimationFrame(finishingRAF);\n\t\t\t\t\tpainter.setWaitForTiles(false);\n\t\t\t\t\tpainter._sectionContainer.setZoomChanged(false);\n\t\t\t\t\tmap.enableTextInput();\n\t\t\t\t\tmap.focus(map.canAcceptKeyboardInput());\n\t\t\t\t\t// Paint everything.\n\t\t\t\t\tpainter._sectionContainer.requestReDraw();\n\t\t\t\t\t// Don't let a subsequent pinchZoom start before finishing all steps till this point.\n\t\t\t\t\tpainter._finishingZoom = false;\n\t\t\t\t\t// Run the finish callback.\n\t\t\t\t\trunAtFinish();\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t\twaitTries -= 1;\n\t\t\t}\n\n\t\t\tfinishingRAF = requestAnimationFrame(finishAnimation);\n\t\t};\n\n\t\tfinishAnimation();\n\t},\n\n\tgetTileSectionPos : function () {\n\t\treturn new L.Point(this._tilesSection.myTopLeft[0], this._tilesSection.myTopLeft[1]);\n\t}\n});\n\nL.CanvasTileLayer = L.Layer.extend({\n\n\tisMacClient: (navigator.appVersion.indexOf('Mac') != -1 || navigator.userAgent.indexOf('Mac') != -1),\n\n\toptions: {\n\t\tpane: 'tilePane',\n\n\t\ttileSize: window.tileSize,\n\t\topacity: 1,\n\n\t\tupdateWhenIdle: (window.mode.isMobile() || window.mode.isTablet()),\n\t\tupdateInterval: 200,\n\n\t\tattribution: null,\n\t\tzIndex: null,\n\t\tbounds: null,\n\n\t\tminZoom: 0,\n\n\t\tmaxZoom: 18,\n\n\t\tsubdomains: 'abc',\n\t\terrorTileUrl: '',\n\n\t\tdetectRetina: true,\n\t\tcrossOrigin: false,\n\t\tpreviewInvalidationTimeout: 1000,\n\t},\n\n\t_pngCache: [],\n\n\tinitialize: function (url, options) {\n\t\tthis._url = url;\n\t\toptions = L.setOptions(this, options);\n\n\t\tthis._tileWidthPx = options.tileSize;\n\t\tthis._tileHeightPx = options.tileSize;\n\n\t\t// Detecting retina displays, adjusting zoom levels\n\t\tif (options.detectRetina && L.Browser.retina && options.maxZoom > 0) {\n\t\t\toptions.minZoom = Math.max(0, options.minZoom);\n\t\t\toptions.maxZoom--;\n\t\t}\n\n\t\tif (typeof options.subdomains === 'string') {\n\t\t\toptions.subdomains = options.subdomains.split('');\n\t\t}\n\n\t\t// for https://github.com/Leaflet/Leaflet/issues/137\n\t\tif (!L.Browser.android) {\n\t\t\tthis.on('tileunload', this._onTileRemove);\n\t\t}\n\t\t// text, presentation, spreadsheet, etc\n\t\tthis._docType = options.docType;\n\t\tthis._documentInfo = '';\n\t\t// Position and size of the visible cursor.\n\t\tthis._visibleCursor = new L.LatLngBounds(new L.LatLng(0, 0), new L.LatLng(0, 0));\n\t\t// Last cursor position for invalidation\n\t\tthis.lastCursorPos = null;\n\t\t// Are we zooming currently ? - if so, no cursor.\n\t\tthis._isZooming = false;\n\t\t// Original rectangle graphic selection in twips\n\t\tthis._graphicSelectionTwips = new L.Bounds(new L.Point(0, 0), new L.Point(0, 0));\n\t\t// Rectangle graphic selection\n\t\tthis._graphicSelection = new L.LatLngBounds(new L.LatLng(0, 0), new L.LatLng(0, 0));\n\t\t// Rotation angle of selected graphic object\n\t\tthis._graphicSelectionAngle = 0;\n\t\t// Original rectangle of cell cursor in twips\n\t\tthis._cellCursorTwips = new L.Bounds(new L.Point(0, 0), new L.Point(0, 0));\n\t\t// Rectangle for cell cursor\n\t\tthis._cellCursor =  L.LatLngBounds.createDefault();\n\t\tthis._prevCellCursor = L.LatLngBounds.createDefault();\n\t\tthis._cellCursorOnPgUp = null;\n\t\tthis._cellCursorOnPgDn = null;\n\t\tthis._shapeGridOffset = new L.Point(0, 0);\n\t\tthis._masterPageChanged = false;\n\n\t\t// Position and size of the selection start (as if there would be a cursor caret there).\n\n\t\t// View cursors with viewId to 'cursor info' mapping\n\t\t// Eg: 1: {rectangle: 'x, y, w, h', visible: false}\n\t\tthis._viewCursors = {};\n\n\t\t// View cell cursors with viewId to 'cursor info' mapping.\n\t\tthis._cellViewCursors = {};\n\n\t\t// View selection of other views\n\t\tthis._viewSelections = {};\n\n\t\t// Graphic view selection rectangles\n\t\tthis._graphicViewMarkers = {};\n\n\t\tthis._lastValidPart = -1;\n\t\t// Cursor marker\n\t\tthis._cursorMarker = null;\n\t\t// Graphic marker\n\t\tthis._graphicMarker = null;\n\t\t// Graphic Selected?\n\t\tthis._hasActiveSelection = false;\n\t\t// Selection handle marker\n\t\tthis._selectionHandles = {};\n\t\t['start', 'end'].forEach(L.bind(function (handle) {\n\t\t\tthis._selectionHandles[handle] = L.marker(new L.LatLng(0, 0), {\n\t\t\t\ticon: L.divIcon({\n\t\t\t\t\tclassName: 'leaflet-selection-marker-' + handle,\n\t\t\t\t\ticonSize: null\n\t\t\t\t}),\n\t\t\t\tdraggable: true\n\t\t\t});\n\t\t}, this));\n\n\t\tthis._dropDownButton = L.marker(new L.LatLng(0, 0), {\n\t\t\ticon: L.divIcon({\n\t\t\t\tclassName: 'spreadsheet-drop-down-marker',\n\t\t\t\ticonSize: null\n\t\t\t}),\n\t\t\tinteractive: true\n\t\t});\n\n\t\tthis._cellResizeMarkerStart = L.marker(new L.LatLng(0, 0), {\n\t\t\ticon: L.divIcon({\n\t\t\t\tclassName: 'spreadsheet-cell-resize-marker',\n\t\t\t\ticonSize: null\n\t\t\t}),\n\t\t\tdraggable: true\n\t\t});\n\n\t\tthis._cellResizeMarkerEnd = L.marker(new L.LatLng(0, 0), {\n\t\t\ticon: L.divIcon({\n\t\t\t\tclassName: 'spreadsheet-cell-resize-marker',\n\t\t\t\ticonSize: null\n\t\t\t}),\n\t\t\tdraggable: true\n\t\t});\n\n\t\tthis._referenceMarkerStart = L.marker(new L.LatLng(0, 0), {\n\t\t\ticon: L.divIcon({\n\t\t\t\tclassName: 'spreadsheet-cell-resize-marker',\n\t\t\t\ticonSize: null\n\t\t\t}),\n\t\t\tdraggable: true\n\t\t});\n\n\t\tthis._referenceMarkerEnd = L.marker(new L.LatLng(0, 0), {\n\t\t\ticon: L.divIcon({\n\t\t\t\tclassName: 'spreadsheet-cell-resize-marker',\n\t\t\t\ticonSize: null\n\t\t\t}),\n\t\t\tdraggable: true\n\t\t});\n\n\t\tthis._initializeTableOverlay();\n\n\t\tthis._emptyTilesCount = 0;\n\t\tthis._msgQueue = [];\n\t\tthis._toolbarCommandValues = {};\n\t\tthis._previewInvalidations = [];\n\n\t\tthis._followThis = -1;\n\t\tthis._editorId = -1;\n\t\tthis._followUser = false;\n\t\tthis._followEditor = false;\n\t\tthis._selectedTextContent = '';\n\t},\n\n\t_initContainer: function () {\n\t\tif (this._canvasContainer) {\n\t\t\twindow.app.console.error('called _initContainer() when this._canvasContainer is present!');\n\t\t}\n\n\t\tif (this._container) { return; }\n\n\t\tthis._container = L.DomUtil.create('div', 'leaflet-layer');\n\t\tthis._updateZIndex();\n\n\t\tif (this.options.opacity < 1) {\n\t\t\tthis._updateOpacity();\n\t\t}\n\n\t\tthis.getPane().appendChild(this._container);\n\n\t\tvar mapContainer = document.getElementById('document-container');\n\t\tvar canvasContainerClass = 'leaflet-canvas-container';\n\t\tthis._canvasContainer = L.DomUtil.create('div', canvasContainerClass, mapContainer);\n\t\tthis._canvasContainer.id = 'canvas-container';\n\t\tthis._setup();\n\t},\n\n\t_setup: function () {\n\n\t\tif (!this._canvasContainer) {\n\t\t\twindow.app.console.error('canvas container not found. _initContainer failed ?');\n\t\t}\n\n\t\tthis._canvas = L.DomUtil.createWithId('canvas', 'document-canvas', this._canvasContainer);\n\t\tthis._container.style.position = 'absolute';\n\t\tthis._cursorDataDiv = L.DomUtil.create('div', 'cell-cursor-data', this._canvasContainer);\n\t\tthis._selectionsDataDiv = L.DomUtil.create('div', 'selections-data', this._canvasContainer);\n\t\tthis._splittersDataDiv = L.DomUtil.create('div', 'splitters-data', this._canvasContainer);\n\t\tthis._cursorOverlayDiv = L.DomUtil.create('div', 'cursor-overlay', this._canvasContainer);\n\t\tthis._splittersStyleData = new CStyleData(this._splittersDataDiv);\n\n\t\tthis._painter = new L.TileSectionManager(this);\n\t\tthis._painter._addTilesSection();\n\t\tthis._painter._sectionContainer.getSectionWithName('tiles').onResize();\n\t\tthis._painter._addOverlaySection();\n\t\tthis._painter._sectionContainer.addSection(L.getNewScrollSection());\n\n\t\t// For mobile/tablet the hammerjs swipe handler already uses a requestAnimationFrame to fire move/drag events\n\t\t// Using L.TileSectionManager's own requestAnimationFrame loop to do the updates in that case does not perform well.\n\t\tif (window.mode.isMobile() || window.mode.isTablet()) {\n\t\t\tthis._map.on('move', this._painter.update, this._painter);\n\t\t\tthis._map.on('moveend', function () {\n\t\t\t\tsetTimeout(this.update.bind(this), 200);\n\t\t\t}, this._painter);\n\t\t}\n\t\telse {\n\t\t\tthis._map.on('movestart', this._painter.startUpdates, this._painter);\n\t\t\tthis._map.on('moveend', this._painter.stopUpdates, this._painter);\n\t\t}\n\t\tthis._map.on('resize', this._syncTileContainerSize, this);\n\t\tthis._map.on('zoomend', this._painter.update, this._painter);\n\t\tthis._map.on('splitposchanged', this._painter.update, this._painter);\n\t\tthis._map.on('sheetgeometrychanged', this._painter.update, this._painter);\n\t\tthis._map.on('move', this._syncTilePanePos, this);\n\n\t\tthis._map.on('viewrowcolumnheaders', this._painter.update, this._painter);\n\n\t\tif (this._docType === 'spreadsheet') {\n\t\t\tthis._painter._addGridSection();\n\t\t}\n\n\t\t// Add it regardless of the file type.\n\t\tapp.sectionContainer.addSection(new app.definitions.CommentSection());\n\n\t\tthis._syncTileContainerSize();\n\t\tthis._setupTableOverlay();\n\t},\n\n\t// Returns true if the document type is Writer.\n\tisWriter: function() {\n\t\treturn this._docType === 'text';\n\t},\n\n\t// Returns true if the document type is Calc.\n\tisCalc: function() {\n\t\treturn this._docType === 'spreadsheet';\n\t},\n\n\t// Returns true if the document type is Impress.\n\tisImpress: function() {\n\t\treturn this._docType === 'presentation';\n\t},\n\n\tbringToFront: function () {\n\t\tif (this._map) {\n\t\t\tL.DomUtil.toFront(this._container);\n\t\t\tthis._setAutoZIndex(Math.max);\n\t\t}\n\t\treturn this;\n\t},\n\n\tbringToBack: function () {\n\t\tif (this._map) {\n\t\t\tL.DomUtil.toBack(this._container);\n\t\t\tthis._setAutoZIndex(Math.min);\n\t\t}\n\t\treturn this;\n\t},\n\n\tgetAttribution: function () {\n\t\treturn this.options.attribution;\n\t},\n\n\tgetContainer: function () {\n\t\treturn this._container;\n\t},\n\n\tsetOpacity: function (opacity) {\n\t\tthis.options.opacity = opacity;\n\n\t\tif (this._map) {\n\t\t\tthis._updateOpacity();\n\t\t}\n\t\treturn this;\n\t},\n\n\tsetZIndex: function (zIndex) {\n\t\tthis.options.zIndex = zIndex;\n\t\tthis._updateZIndex();\n\n\t\treturn this;\n\t},\n\n\tredraw: function () {\n\t\tif (this._map) {\n\t\t\tthis._removeAllTiles();\n\t\t\tthis._update();\n\t\t}\n\t\treturn this;\n\t},\n\n\t_updateZIndex: function () {\n\t\tif (this._container && this.options.zIndex !== undefined && this.options.zIndex !== null) {\n\t\t\tthis._container.style.zIndex = this.options.zIndex;\n\t\t}\n\t},\n\n\t_setAutoZIndex: function (compare) {\n\t\t// go through all other layers of the same pane, set zIndex to max + 1 (front) or min - 1 (back)\n\n\t\tvar layers = this.getPane().children,\n\t\t    edgeZIndex = -compare(-Infinity, Infinity); // -Infinity for max, Infinity for min\n\n\t\tfor (var i = 0, len = layers.length, zIndex; i < len; i++) {\n\n\t\t\tzIndex = layers[i].style.zIndex;\n\n\t\t\tif (layers[i] !== this._container && zIndex) {\n\t\t\t\tedgeZIndex = compare(edgeZIndex, +zIndex);\n\t\t\t}\n\t\t}\n\n\t\tif (isFinite(edgeZIndex)) {\n\t\t\tthis.options.zIndex = edgeZIndex + compare(-1, 1);\n\t\t\tthis._updateZIndex();\n\t\t}\n\t},\n\n\t_removeAllTiles: function () {\n\t\tfor (var key in this._tiles) {\n\t\t\tthis._removeTile(key);\n\t\t}\n\t},\n\n\t_retainParent: function (x, y, z, part, minZoom) {\n\t\tvar x2 = Math.floor(x / 1.2),\n\t\t    y2 = Math.floor(y / 1.2),\n\t\t    z2 = z - 1;\n\n\t\tvar key = x2 + ':' + y2 + ':' + z2 + ':' + part,\n\t\t    tile = this._tiles[key];\n\n\t\tif (tile && tile.active) {\n\t\t\ttile.retain = true;\n\t\t\treturn true;\n\n\t\t} else if (tile && tile.loaded) {\n\t\t\ttile.retain = true;\n\t\t}\n\n\t\tif (z2 > minZoom) {\n\t\t\treturn this._retainParent(x2, y2, z2, part, minZoom);\n\t\t}\n\n\t\treturn false;\n\t},\n\n\t_retainChildren: function (x, y, z, part, maxZoom) {\n\n\t\tfor (var i = 1.2 * x; i < 1.2 * x + 2; i++) {\n\t\t\tfor (var j = 1.2 * y; j < 1.2 * y + 2; j++) {\n\n\t\t\t\tvar key = Math.floor(i) + ':' + Math.floor(j) + ':' +\n\t\t\t\t\t(z + 1) + ':' + part,\n\t\t\t\t    tile = this._tiles[key];\n\n\t\t\t\tif (tile && tile.active) {\n\t\t\t\t\ttile.retain = true;\n\t\t\t\t\tcontinue;\n\n\t\t\t\t} else if (tile && tile.loaded) {\n\t\t\t\t\ttile.retain = true;\n\t\t\t\t}\n\n\t\t\t\tif (z + 1 < maxZoom) {\n\t\t\t\t\tthis._retainChildren(i, j, z + 1, part, maxZoom);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t},\n\n\t_reset: function (center, zoom, hard, noPrune, noUpdate) {\n\t\tvar tileZoom = Math.round(zoom),\n\t\t    tileZoomChanged = this._tileZoom !== tileZoom;\n\n\t\tif (!noUpdate && (hard || tileZoomChanged)) {\n\t\t\tthis._resetClientVisArea();\n\n\t\t\tif (this._abortLoading) {\n\t\t\t\tthis._abortLoading();\n\t\t\t}\n\n\t\t\tthis._tileZoom = tileZoom;\n\t\t\tif (tileZoomChanged) {\n\t\t\t\tthis._updateTileTwips();\n\t\t\t\tthis._updateMaxBounds();\n\t\t\t}\n\t\t\tthis._updateLevels();\n\t\t\tthis._resetGrid();\n\n\t\t\tif (!L.Browser.mobileWebkit) {\n\t\t\t\tthis._update(center, tileZoom);\n\t\t\t}\n\n\t\t\tif (!noPrune) {\n\t\t\t\tthis._pruneTiles();\n\t\t\t}\n\t\t}\n\n\t\tthis._setZoomTransforms(center, zoom);\n\t},\n\n\t// These variables indicates the clientvisiblearea sent to the server and stored by the server\n\t// We need to reset them when we are reconnecting to the server or reloading a document\n\t// because the server needs new data even if the client is unmodified.\n\t_resetClientVisArea: function ()  {\n\t\tthis._clientZoom = '';\n\t\tthis._clientVisibleArea = '';\n\t},\n\n\t_updateTileTwips: function () {\n\t\t// smaller zoom = zoom in\n\t\tvar factor = Math.pow(1.2, (this._map.options.zoom - this._tileZoom));\n\t\tthis._tileWidthTwips = Math.round(this.options.tileWidthTwips * factor);\n\t\tthis._tileHeightTwips = Math.round(this.options.tileHeightTwips * factor);\n\t\tapp.tile.size.twips = [this._tileWidthTwips, this._tileHeightTwips];\n\t\tapp.file.size.pixels = [Math.round(app.tile.size.pixels[0] * (app.file.size.twips[0] / app.tile.size.twips[0])), Math.round(app.tile.size.pixels[1] * (app.file.size.twips[1] / app.tile.size.twips[1]))];\n\t\tapp.view.size.pixels = app.file.size.pixels.slice();\n\n\t\tapp.twipsToPixels = app.tile.size.pixels[0] / app.tile.size.twips[0];\n\t\tapp.pixelsToTwips = app.tile.size.twips[0] / app.tile.size.pixels[0];\n\t},\n\n\t_checkSpreadSheetBounds: function (newZoom) {\n\t\t// for spreadsheets, when the document is smaller than the viewing area\n\t\t// we want it to be glued to the row/column headers instead of being centered\n\t\t// In the future we probably want to remove this and set the bonds only on the\n\t\t// left/upper side of the spreadsheet so that we can have an 'infinite' number of\n\t\t// cells downwards and to the right, like we have on desktop\n\t\tvar viewSize = this._map.getSize();\n\t\tvar scale = this._map.getZoomScale(newZoom);\n\t\tvar width = this._docWidthTwips / this._tileWidthTwips * this._tileSize * scale;\n\t\tvar height = this._docHeightTwips / this._tileHeightTwips * this._tileSize * scale;\n\t\tif (width < viewSize.x || height < viewSize.y) {\n\t\t\t// if after zoomimg the document becomes smaller than the viewing area\n\t\t\twidth = Math.max(width, viewSize.x);\n\t\t\theight = Math.max(height, viewSize.y);\n\t\t\tif (!this._map.options._origMaxBounds) {\n\t\t\t\tthis._map.options._origMaxBounds = this._map.options.maxBounds;\n\t\t\t}\n\t\t\tscale = this._map.options.crs.scale(1);\n\t\t\tthis._map.setMaxBounds(new L.LatLngBounds(\n\t\t\t\tthis._map.unproject(new L.Point(0, 0)),\n\t\t\t\tthis._map.unproject(new L.Point(width * scale, height * scale))));\n\t\t}\n\t\telse if (this._map.options._origMaxBounds) {\n\t\t\t// if after zoomimg the document becomes larger than the viewing area\n\t\t\t// we need to restore the initial bounds\n\t\t\tthis._map.setMaxBounds(this._map.options._origMaxBounds);\n\t\t\tthis._map.options._origMaxBounds = null;\n\t\t}\n\t},\n\n\t_updateScrollOffset: function () {\n\t\tif (!this._map) return;\n\t\tvar centerPixel = this._map.project(this._map.getCenter());\n\t\tvar newScrollPos = centerPixel.subtract(this._map.getSize().divideBy(2));\n\t\tvar x = Math.round(newScrollPos.x < 0 ? 0 : newScrollPos.x);\n\t\tvar y = Math.round(newScrollPos.y < 0 ? 0 : newScrollPos.y);\n\t\tthis._map.fire('updatescrolloffset', {x: x, y: y, updateHeaders: true});\n\t},\n\n\t_resetGrid: function () {\n\t\tvar map = this._map,\n\t\t    crs = map.options.crs,\n\t\t    tileSize = this._tileSize = this._getTileSize(),\n\t\t    tileZoom = this._tileZoom;\n\n\t\tapp.tile.size.pixels = [this._tileSize, this._tileSize];\n\t\tif (this._tileWidthTwips === undefined) {\n\t\t\tthis._tileWidthTwips = this.options.tileWidthTwips;\n\t\t\tapp.tile.size.twips[0] = this.options.tileWidthTwips;\n\t\t}\n\t\tif (this._tileHeightTwips === undefined) {\n\t\t\tthis._tileHeightTwips = this.options.tileHeightTwips;\n\t\t\tapp.tile.size.twips[1] = this.options.tileHeightTwips;\n\t\t}\n\n\t\tapp.twipsToPixels = app.tile.size.pixels[0] / app.tile.size.twips[0];\n\t\tapp.pixelsToTwips = app.tile.size.twips[0] / app.tile.size.pixels[0];\n\n\t\tvar bounds = this._map.getPixelWorldBounds(this._tileZoom);\n\t\tif (bounds) {\n\t\t\tthis._globalTileRange = this._pxBoundsToTileRange(bounds);\n\t\t}\n\n\t\tthis._wrapX = crs.wrapLng && [\n\t\t\tMath.floor(map.project([0, crs.wrapLng[0]], tileZoom).x / tileSize),\n\t\t\tMath.ceil(map.project([0, crs.wrapLng[1]], tileZoom).x / tileSize)\n\t\t];\n\t\tthis._wrapY = crs.wrapLat && [\n\t\t\tMath.floor(map.project([crs.wrapLat[0], 0], tileZoom).y / tileSize),\n\t\t\tMath.ceil(map.project([crs.wrapLat[1], 0], tileZoom).y / tileSize)\n\t\t];\n\t},\n\n\t_getTileSize: function () {\n\t\treturn this.options.tileSize;\n\t},\n\n\t_moveStart: function () {\n\t\tthis._resetPreFetching();\n\t},\n\n\t_move: function () {\n\t\tthis._update();\n\t\tthis._resetPreFetching(true);\n\t\tthis._onCurrentPageUpdate();\n\t},\n\n\t_requestNewTiles: function () {\n\t\tthis._onMessage('invalidatetiles: EMPTY', null);\n\t\tthis._update();\n\t},\n\n\ttoggleTileDebugMode: function() {\n\t\tthis.toggleTileDebugModeImpl();\n\t\tthis._requestNewTiles();\n\t},\n\n\t_sendClientZoom: function (forceUpdate) {\n\t\tif (!this._map._docLoaded)\n\t\t\treturn;\n\n\t\tvar newClientZoom = 'tilepixelwidth=' + this._tileWidthPx + ' ' +\n\t\t\t'tilepixelheight=' + this._tileHeightPx + ' ' +\n\t\t\t'tiletwipwidth=' + this._tileWidthTwips + ' ' +\n\t\t\t'tiletwipheight=' + this._tileHeightTwips;\n\n\t\tif (this._clientZoom !== newClientZoom || forceUpdate) {\n\t\t\t// the zoom level has changed\n\t\t\tapp.socket.sendMessage('clientzoom ' + newClientZoom);\n\n\t\t\tif (!this._map._fatal && this._map._active && app.socket.connected())\n\t\t\t\tthis._clientZoom = newClientZoom;\n\t\t}\n\t},\n\n\t_twipsRectangleToPixelBounds: function (strRectangle) {\n\t\t// TODO use this more\n\t\t// strRectangle = x, y, width, height\n\t\tvar strTwips = strRectangle.match(/\\d+/g);\n\t\tif (!strTwips) {\n\t\t\treturn null;\n\t\t}\n\t\tvar topLeftTwips = new L.Point(parseInt(strTwips[0]), parseInt(strTwips[1]));\n\t\tvar offset = new L.Point(parseInt(strTwips[2]), parseInt(strTwips[3]));\n\t\tvar bottomRightTwips = topLeftTwips.add(offset);\n\t\treturn new L.Bounds(\n\t\t\tthis._twipsToPixels(topLeftTwips),\n\t\t\tthis._twipsToPixels(bottomRightTwips));\n\t},\n\n\t_twipsRectanglesToPixelBounds: function (strRectangles) {\n\t\t// used when we have more rectangles\n\t\tstrRectangles = strRectangles.split(';');\n\t\tvar boundsList = [];\n\t\tfor (var i = 0; i < strRectangles.length; i++) {\n\t\t\tvar bounds = this._twipsRectangleToPixelBounds(strRectangles[i]);\n\t\t\tif (bounds) {\n\t\t\t\tboundsList.push(bounds);\n\t\t\t}\n\t\t}\n\t\treturn boundsList;\n\t},\n\n\t_noTilesToLoad: function () {\n\t\tfor (var key in this._tiles) {\n\t\t\tif (!this._tiles[key].loaded) { return false; }\n\t\t}\n\t\treturn true;\n\t},\n\n\t_sendTileCombineRequest: function(part, tilePositionsX, tilePositionsY) {\n\t\tvar msg = 'tilecombine ' +\n\t\t\t'nviewid=0 ' +\n\t\t\t'part=' + part + ' ' +\n\t\t\t'width=' + this._tileWidthPx + ' ' +\n\t\t\t'height=' + this._tileHeightPx + ' ' +\n\t\t\t'tileposx=' + tilePositionsX + ' '\t+\n\t\t\t'tileposy=' + tilePositionsY + ' ' +\n\t\t\t'tilewidth=' + this._tileWidthTwips + ' ' +\n\t\t\t'tileheight=' + this._tileHeightTwips;\n\t\tapp.socket.sendMessage(msg, '');\n\t},\n\n\tgetMaxDocSize: function () {\n\t\treturn undefined;\n\t},\n\n\tgetSnapDocPosX: function (docPosPixX) {\n\t\treturn docPosPixX;\n\t},\n\n\tgetSnapDocPosY: function (docPosPixY) {\n\t\treturn docPosPixY;\n\t},\n\n\tgetSplitPanesContext: function () {\n\t\treturn undefined;\n\t},\n\n\t_createNewMouseEvent: function (type, inputEvent) {\n\t\tvar event = inputEvent;\n\t\tif (inputEvent.type == 'touchstart' || inputEvent.type == 'touchmove') {\n\t\t\tevent = inputEvent.touches[0];\n\t\t}\n\t\telse if (inputEvent.type == 'touchend') {\n\t\t\tevent = inputEvent.changedTouches[0];\n\t\t}\n\t\tvar newEvent = document.createEvent('MouseEvents');\n\t\tnewEvent.initMouseEvent(\n\t\t\ttype, true, true, window, 1,\n\t\t\tevent.screenX, event.screenY,\n\t\t\tevent.clientX, event.clientY,\n\t\t\tfalse, false, false, false, 0, null\n\t\t);\n\t\treturn newEvent;\n\t},\n\n\tregisterExportFormat: function(label, format) {\n\t\tif (!this._exportFormats) {\n\t\t\tthis._exportFormats = [];\n\t\t}\n\n\t\tvar duplicate = false;\n\t\tfor (var i = 0; i < this._exportFormats.length; i++) {\n\t\t\tif (this._exportFormats[i].label == label && this._exportFormats[i].format == format) {\n\t\t\t\tduplicate = true;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\tif (duplicate == false) {\n\t\t\tthis._exportFormats.push({label: label, format: format});\n\t\t}\n\t},\n\n\tsetUrl: function (url, noRedraw) {\n\t\tthis._url = url;\n\n\t\tif (!noRedraw) {\n\t\t\tthis.redraw();\n\t\t}\n\t\treturn this;\n\t},\n\n\tcreateTile: function (coords, done) {\n\t\tvar tile = document.createElement('img');\n\n\t\ttile.onerror = L.bind(this._tileOnError, this, done, tile);\n\n\t\tif (this.options.crossOrigin) {\n\t\t\ttile.crossOrigin = '';\n\t\t}\n\n\t\t/*\n\t\t Alt tag is set to empty string to keep screen readers from reading URL and for compliance reasons\n\t\t http://www.w3.org/TR/WCAG20-TECHS/H67\n\t\t*/\n\t\ttile.alt = '';\n\t\tthis._emptyTilesCount += 1;\n\t\treturn tile;\n\t},\n\n\t_getToolbarCommandsValues: function() {\n\t\tfor (var i = 0; i < this._map.unoToolbarCommands.length; i++) {\n\t\t\tvar command = this._map.unoToolbarCommands[i];\n\t\t\tapp.socket.sendMessage('commandvalues command=' + command);\n\t\t}\n\t},\n\n\t_onMessage: function (textMsg, img) {\n\t\tthis._saveMessageForReplay(textMsg);\n\t\t// 'tile:' is the most common message type; keep this the first.\n\t\tif (textMsg.startsWith('tile:')) {\n\t\t\tthis._onTileMsg(textMsg, img);\n\t\t}\n\t\telse if (textMsg.startsWith('commandvalues:')) {\n\t\t\tthis._onCommandValuesMsg(textMsg);\n\t\t}\n\t\telse if (textMsg.startsWith('cursorvisible:')) {\n\t\t\tthis._onCursorVisibleMsg(textMsg);\n\t\t}\n\t\telse if (textMsg.startsWith('downloadas:')) {\n\t\t\tthis._onDownloadAsMsg(textMsg);\n\t\t}\n\t\telse if (textMsg.startsWith('error:')) {\n\t\t\tthis._onErrorMsg(textMsg);\n\t\t}\n\t\telse if (textMsg.startsWith('getchildid:')) {\n\t\t\tthis._onGetChildIdMsg(textMsg);\n\t\t}\n\t\telse if (textMsg.startsWith('shapeselectioncontent:')) {\n\t\t\tthis._onShapeSelectionContent(textMsg);\n\t\t}\n\t\telse if (textMsg.startsWith('graphicselection:')) {\n\t\t\tthis._onGraphicSelectionMsg(textMsg);\n\t\t}\n\t\telse if (textMsg.startsWith('cellcursor:')) {\n\t\t\tthis._onCellCursorMsg(textMsg);\n\t\t}\n\t\telse if (textMsg.startsWith('celladdress:')) {\n\t\t\tthis._onCellAddressMsg(textMsg);\n\t\t}\n\t\telse if (textMsg.startsWith('cellformula:')) {\n\t\t\tthis._onCellFormulaMsg(textMsg);\n\t\t}\n\t\telse if (textMsg.startsWith('referencemarks:')) {\n\t\t\tthis._onReferencesMsg(textMsg);\n\t\t}\n\t\telse if (textMsg.startsWith('referenceclear:')) {\n\t\t\tthis._clearReferences();\n\t\t}\n\t\telse if (textMsg.startsWith('invalidatecursor:')) {\n\t\t\tthis._onInvalidateCursorMsg(textMsg);\n\t\t}\n\t\telse if (textMsg.startsWith('invalidatetiles:')) {\n\t\t\tvar payload = textMsg.substring('invalidatetiles:'.length + 1);\n\t\t\tif (!payload.startsWith('EMPTY')) {\n\t\t\t\tthis._onInvalidateTilesMsg(textMsg);\n\t\t\t}\n\t\t\telse {\n\t\t\t\tvar msg = 'invalidatetiles: ';\n\t\t\t\tif (this.isWriter()) {\n\t\t\t\t\tmsg += 'part=0 ';\n\t\t\t\t} else {\n\t\t\t\t\tvar partNumber = parseInt(payload.substring('EMPTY'.length + 1));\n\t\t\t\t\tmsg += 'part=' + (isNaN(partNumber) ? this._selectedPart : partNumber) + ' ';\n\t\t\t\t}\n\t\t\t\tmsg += 'x=0 y=0 ';\n\t\t\t\tmsg += 'width=' + this._docWidthTwips + ' ';\n\t\t\t\tmsg += 'height=' + this._docHeightTwips;\n\t\t\t\tthis._onInvalidateTilesMsg(msg);\n\t\t\t}\n\t\t}\n\t\telse if (textMsg.startsWith('mousepointer:')) {\n\t\t\tthis._onMousePointerMsg(textMsg);\n\t\t}\n\t\telse if (textMsg.startsWith('renderfont:')) {\n\t\t\tthis._onRenderFontMsg(textMsg, img);\n\t\t}\n\t\telse if (textMsg.startsWith('searchnotfound:')) {\n\t\t\tthis._onSearchNotFoundMsg(textMsg);\n\t\t}\n\t\telse if (textMsg.startsWith('searchresultselection:')) {\n\t\t\tthis._onSearchResultSelection(textMsg);\n\t\t}\n\t\telse if (textMsg.startsWith('setpart:')) {\n\t\t\tthis._onSetPartMsg(textMsg);\n\t\t}\n\t\telse if (textMsg.startsWith('statechanged:')) {\n\t\t\tthis._onStateChangedMsg(textMsg);\n\t\t}\n\t\telse if (textMsg.startsWith('status:') || textMsg.startsWith('statusupdate:')) {\n\t\t\tthis._onStatusMsg(textMsg);\n\t\t}\n\t\telse if (textMsg.startsWith('textselection:')) {\n\t\t\tthis._onTextSelectionMsg(textMsg);\n\t\t}\n\t\telse if (textMsg.startsWith('textselectioncontent:')) {\n\t\t\tif (this._map._clip)\n\t\t\t\tthis._map._clip.setTextSelectionHTML(textMsg.substr(22));\n\t\t\telse\n\t\t\t\t// hack for ios and android to get selected text into hyperlink insertion dialog\n\t\t\t\tthis._selectedTextContent = textMsg.substr(22);\n\t\t}\n\t\telse if (textMsg.startsWith('clipboardchanged')) {\n\t\t\tvar jMessage = textMsg.substr(17);\n\t\t\tjMessage = JSON.parse(jMessage);\n\n\t\t\tif (jMessage.mimeType === 'text/plain') {\n\t\t\t\tthis._map._clip.setTextSelectionHTML(jMessage.content);\n\t\t\t\tthis._map._clip._execCopyCutPaste('copy');\n\t\t\t}\n\t\t}\n\t\telse if (textMsg.startsWith('textselectionend:')) {\n\t\t\tthis._onTextSelectionEndMsg(textMsg);\n\t\t}\n\t\telse if (textMsg.startsWith('textselectionstart:')) {\n\t\t\tthis._onTextSelectionStartMsg(textMsg);\n\t\t}\n\t\telse if (textMsg.startsWith('cellselectionarea:')) {\n\t\t\tthis._onCellSelectionAreaMsg(textMsg);\n\t\t}\n\t\telse if (textMsg.startsWith('cellautofillarea:')) {\n\t\t\tthis._onCellAutoFillAreaMsg(textMsg);\n\t\t}\n\t\telse if (textMsg.startsWith('complexselection:')) {\n\t\t\tif (this._map._clip)\n\t\t\t\tthis._map._clip.onComplexSelection(textMsg.substr('complexselection:'.length));\n\t\t}\n\t\telse if (textMsg.startsWith('windowpaint:')) {\n\t\t\tthis._onDialogPaintMsg(textMsg, img);\n\t\t}\n\t\telse if (textMsg.startsWith('window:')) {\n\t\t\tthis._onDialogMsg(textMsg);\n\t\t}\n\t\telse if (textMsg.startsWith('unocommandresult:')) {\n\t\t\tthis._onUnoCommandResultMsg(textMsg);\n\t\t}\n\t\telse if (textMsg.startsWith('rulerupdate:')) {\n\t\t\tthis._onRulerUpdate(textMsg);\n\t\t}\n\t\telse if (textMsg.startsWith('contextmenu:')) {\n\t\t\tthis._onContextMenuMsg(textMsg);\n\t\t}\n\t\telse if (textMsg.startsWith('invalidateviewcursor:')) {\n\t\t\tthis._onInvalidateViewCursorMsg(textMsg);\n\t\t}\n\t\telse if (textMsg.startsWith('viewcursorvisible:')) {\n\t\t\tthis._onViewCursorVisibleMsg(textMsg);\n\t\t}\n\t\telse if (textMsg.startsWith('cellviewcursor:')) {\n\t\t\tthis._onCellViewCursorMsg(textMsg);\n\t\t}\n\t\telse if (textMsg.startsWith('viewinfo:')) {\n\t\t\tthis._onViewInfoMsg(textMsg);\n\t\t}\n\t\telse if (textMsg.startsWith('textviewselection:')) {\n\t\t\tthis._onTextViewSelectionMsg(textMsg);\n\t\t}\n\t\telse if (textMsg.startsWith('graphicviewselection:')) {\n\t\t\tthis._onGraphicViewSelectionMsg(textMsg);\n\t\t}\n\t\telse if (textMsg.startsWith('tableselected:')) {\n\t\t\tthis._onTableSelectedMsg(textMsg);\n\t\t}\n\t\telse if (textMsg.startsWith('editor:')) {\n\t\t\tthis._updateEditor(textMsg);\n\t\t}\n\t\telse if (textMsg.startsWith('validitylistbutton:')) {\n\t\t\tthis._onValidityListButtonMsg(textMsg);\n\t\t}\n\t\telse if (textMsg.startsWith('validityinputhelp:')) {\n\t\t\tthis._onValidityInputHelpMsg(textMsg);\n\t\t}\n\t\telse if (textMsg.startsWith('signaturestatus:')) {\n\t\t\tvar signstatus = textMsg.substring('signaturestatus:'.length + 1);\n\t\t\tthis._map.onChangeSignStatus(signstatus);\n\t\t}\n\t\telse if (textMsg.startsWith('signeddocumentuploadstatus:')) {\n\t\t\tvar status = textMsg.substring('signeddocumentuploadstatus:'.length + 1);\n\t\t\tthis._map.onVereignUploadStatus(status);\n\t\t}\n\t\telse if (textMsg.startsWith('removesession')) {\n\t\t\tvar viewId = parseInt(textMsg.substring('removesession'.length + 1));\n\t\t\tif (this._map._docLayer._viewId === viewId) {\n\t\t\t\tthis._map.fire('postMessage', {msgId: 'close', args: {EverModified: this._map._everModified, Deprecated: true}});\n\t\t\t\tthis._map.fire('postMessage', {msgId: 'UI_Close', args: {EverModified: this._map._everModified}});\n\t\t\t\tif (!this._map._disableDefaultAction['UI_Close']) {\n\t\t\t\t\tthis._map.remove();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\telse if (textMsg.startsWith('calcfunctionlist:')) {\n\t\t\tthis._onCalcFunctionListMsg(textMsg.substring('calcfunctionlist:'.length + 1));\n\t\t}\n\t\telse if (textMsg.startsWith('tabstoplistupdate:')) {\n\t\t\tthis._onTabStopListUpdate(textMsg);\n\t\t}\n\t\telse if (textMsg.startsWith('context:')) {\n\t\t\tvar message = textMsg.substring('context:'.length + 1);\n\t\t\tmessage = message.split(' ');\n\t\t\tif (message.length > 1) {\n\t\t\t\tthis._map.context = {context: message[1]};\n\t\t\t\tthis._map.fire('contextchange', {context: message[1]});\n\t\t\t}\n\t\t}\n\t\telse if (textMsg.startsWith('formfieldbutton:')) {\n\t\t\tthis._onFormFieldButtonMsg(textMsg);\n\t\t}\n\t\telse if (textMsg.startsWith('comment:')) {\n\t\t\tvar obj = JSON.parse(textMsg.substring('comment:'.length + 1));\n\t\t\tif (obj.comment.cellPos) {\n\t\t\t\t// cellPos is in print-twips so convert to display twips.\n\t\t\t\tvar cellPos = L.Bounds.parse(obj.comment.cellPos);\n\t\t\t\tcellPos = this._convertToTileTwipsSheetArea(cellPos);\n\t\t\t\tobj.comment.cellPos = cellPos.toCoreString();\n\t\t\t}\n\t\t\tvar commentSection = app.sectionContainer.getSectionWithName(L.CSections.CommentList.name);\n\t\t\tif (commentSection)\n\t\t\t\tcommentSection.onACKComment(obj);\n\t\t}\n\t\telse if (textMsg.startsWith('redlinetablemodified:')) {\n\t\t\tobj = JSON.parse(textMsg.substring('redlinetablemodified:'.length + 1));\n\t\t\tcommentSection = app.sectionContainer.getSectionWithName(L.CSections.CommentList.name);\n\t\t\tif (commentSection)\n\t\t\t\tcommentSection.onACKComment(obj);\n\t\t}\n\t\telse if (textMsg.startsWith('redlinetablechanged:')) {\n\t\t\tobj = JSON.parse(textMsg.substring('redlinetablechanged:'.length + 1));\n\t\t\tcommentSection = app.sectionContainer.getSectionWithName(L.CSections.CommentList.name);\n\t\t\tif (commentSection)\n\t\t\t\tcommentSection.onACKComment(obj);\n\t\t}\n\t\telse if (textMsg.startsWith('documentbackgroundcolor:')) {\n\t\t\tif (this.isCalc()) {\n\t\t\t\tthis.coreDocBGColor = textMsg.substring('documentbackgroundcolor:'.length + 1).trim();\n\t\t\t\tapp.sectionContainer.setClearColor('#' + this.coreDocBGColor);\n\t\t\t}\n\t\t}\n\t},\n\n\t_onTabStopListUpdate: function (textMsg) {\n\t\ttextMsg = textMsg.substring('tabstoplistupdate:'.length + 1);\n\t\tvar json = JSON.parse(textMsg);\n\t\tthis._map.fire('tabstoplistupdate', json);\n\t},\n\n\ttoggleTileDebugModeImpl: function() {\n\t\tthis._debug = !this._debug;\n\t\tif (!this._debug) {\n\t\t\tthis._map.removeLayer(this._debugInfo);\n\t\t\tthis._map.removeLayer(this._debugInfo2);\n\t\t\t$('.leaflet-control-layers-expanded').css('display', 'none');\n\n\t\t\tif (this._map._docLayer._docType === 'spreadsheet') {\n\t\t\t\tvar section = this._map._docLayer._painter._sectionContainer.getSectionWithName('calc grid');\n\t\t\t\tif (section) {\n\t\t\t\t\tsection.setDrawingOrder(L.CSections.CalcGrid.drawingOrder);\n\t\t\t\t\tsection.sectionProperties.strokeStyle = '#c0c0c0';\n\t\t\t\t}\n\t\t\t\tthis._map._docLayer._painter._sectionContainer.removeSection('splits');\n\t\t\t\tthis._map._docLayer._painter._sectionContainer.reNewAllSections(true /* redraw */);\n\t\t\t}\n\t\t} else {\n\t\t\tif (this._debugInfo) {\n\t\t\t\tthis._map.addLayer(this._debugInfo);\n\t\t\t\tthis._map.addLayer(this._debugInfo2);\n\t\t\t\t$('.leaflet-control-layers-expanded').css('display', 'block');\n\t\t\t}\n\t\t\tthis._debugInit();\n\t\t}\n\t\tif (app.socket.traceEventRecordingToggle)\n\t\t\tthis._map.addLayer(this._debugTrace);\n\t\telse\n\t\t\tthis._map.removeLayer(this._debugTrace);\n\t},\n\n\t_onCommandValuesMsg: function (textMsg) {\n\t\tvar jsonIdx = textMsg.indexOf('{');\n\t\tif (jsonIdx === -1) {\n\t\t\treturn;\n\t\t}\n\t\tvar obj = JSON.parse(textMsg.substring(jsonIdx));\n\t\tif (obj.commandName === '.uno:DocumentRepair') {\n\t\t\tthis._onDocumentRepair(obj);\n\t\t}\n\t\telse if (obj.commandName === '.uno:CellCursor') {\n\t\t\tthis._onCellCursorMsg(obj.commandValues);\n\t\t}\n\t\telse if (this._map.unoToolbarCommands.indexOf(obj.commandName) !== -1) {\n\t\t\tthis._toolbarCommandValues[obj.commandName] = obj.commandValues;\n\t\t\tthis._map.fire('updatetoolbarcommandvalues', {\n\t\t\t\tcommandName: obj.commandName,\n\t\t\t\tcommandValues: obj.commandValues\n\t\t\t});\n\t\t}\n\t\telse {\n\t\t\tthis._map.fire('commandvalues', {\n\t\t\t\tcommandName: obj.commandName,\n\t\t\t\tcommandValues: obj.commandValues\n\t\t\t});\n\t\t}\n\t},\n\n\t_onCellAddressMsg: function (textMsg) {\n\t\t// When the user moves the focus to a different cell, a 'cellformula'\n\t\t// message is received from coolwsd, *then* a 'celladdress' message.\n\t\tvar address = textMsg.substring(13);\n\t\tif (this._map._clip && !this._map['wopi'].DisableCopy) {\n\t\t\tthis._map._clip.setTextSelectionText(this._lastFormula);\n\t\t}\n\t\tthis._map.fire('celladdress', {address: address});\n\t},\n\n\t_onCellFormulaMsg: function (textMsg) {\n\t\t// When a 'cellformula' message from coolwsd is received,\n\t\t// store the text contents of the cell, but don't push\n\t\t// them to the clipboard container (yet).\n\t\t// This is done because coolwsd will send several 'cellformula'\n\t\t// messages during text composition, and resetting the contents\n\t\t// of the clipboard container mid-composition will easily break it.\n\t\tvar formula = textMsg.substring(13);\n\t\tthis._lastFormula = formula;\n\t\tthis._map.fire('cellformula', {formula: formula});\n\t},\n\n\t_onCalcFunctionListMsg: function (textMsg) {\n\t\tvar funcData = JSON.parse(textMsg);\n\t\tthis._closeMobileWizard();\n\n\t\tvar data = {\n\t\t\tid: 'funclist',\n\t\t\ttype: '',\n\t\t\ttext: _('Functions'),\n\t\t\tenabled: true,\n\t\t\tchildren: []\n\t\t};\n\n\t\tif (funcData.categories)\n\t\t\tthis._onCalcFunctionListWithCategories(funcData, data);\n\t\telse\n\t\t\tthis._onCalcFunctionList(funcData, data);\n\n\t\tif (funcData.wholeList)\n\t\t\tthis._map._functionWizardData = data;\n\n\t\tthis._openMobileWizard(data);\n\t},\n\n\t_onCalcFunctionList: function (funcList, data) {\n\t\tvar entries = data.children;\n\t\tfor (var idx = 0; idx < funcList.length; ++idx) {\n\t\t\tvar func =  funcList[idx];\n\t\t\tvar name = func.signature.split('(')[0];\n\t\t\tvar entry = {\n\t\t\t\tid: '',\n\t\t\t\ttype: 'calcfuncpanel',\n\t\t\t\ttext: name,\n\t\t\t\tfunctionName: name,\n\t\t\t\tindex: func.index,\n\t\t\t\tenabled: true,\n\t\t\t\tchildren: []\n\t\t\t};\n\t\t\tentries.push(entry);\n\t\t\tentries[entries.length-1].children[0] = {\n\t\t\t\tid: '',\n\t\t\t\ttype: 'fixedtext',\n\t\t\t\ttext: '<div class=\"func-info-sig\">' + func.signature + '</div>' + '<div class=\"func-info-desc\">' + func.description + '</div>',\n\t\t\t\tenabled: true,\n\t\t\t\tstyle: 'func-info'\n\t\t\t};\n\t\t}\n\t},\n\n\t_onCalcFunctionListWithCategories: function (funcData, data) {\n\t\tvar categoryList = funcData.categories;\n\t\tvar categoryEntries = data.children;\n\t\tfor (var idx = 0; idx < categoryList.length; ++idx) {\n\t\t\tvar category = categoryList[idx];\n\t\t\tvar categoryEntry = {\n\t\t\t\tid: '',\n\t\t\t\ttype: 'panel',\n\t\t\t\ttext: category.name,\n\t\t\t\tindex: idx,\n\t\t\t\tenabled: true,\n\t\t\t\tchildren: []\n\t\t\t};\n\t\t\tcategoryEntries.push(categoryEntry);\n\t\t}\n\n\t\tvar funcList = funcData.functions;\n\t\tfor (idx = 0; idx < funcList.length; ++idx) {\n\t\t\tvar func =  funcList[idx];\n\t\t\tvar name = func.signature.split('(')[0];\n\t\t\tvar funcEntry = {\n\t\t\t\tid: '',\n\t\t\t\ttype: 'calcfuncpanel',\n\t\t\t\ttext: name,\n\t\t\t\tfunctionName: name,\n\t\t\t\tindex: func.index,\n\t\t\t\tcategory: func.category,\n\t\t\t\tenabled: true,\n\t\t\t\tchildren: []\n\t\t\t};\n\t\t\tvar funcEntries = categoryEntries[func.category].children;\n\t\t\tfuncEntries.push(funcEntry);\n\n\t\t\tfuncEntries[funcEntries.length-1].children[0] = {\n\t\t\t\tid: '',\n\t\t\t\ttype: 'fixedtext',\n\t\t\t\ttext: '<div class=\"func-info-sig\">' + func.signature + '</div>' + '<div class=\"func-info-desc\">' + func.description + '</div>',\n\t\t\t\tenabled: true,\n\t\t\t\tstyle: 'func-info'\n\t\t\t};\n\t\t}\n\t},\n\n\t_onCursorVisibleMsg: function(textMsg) {\n\t\tvar command = textMsg.match('cursorvisible: true');\n\t\tthis._map._isCursorVisible = command ? true : false;\n\t\tthis._removeSelection();\n\t\tthis._onUpdateCursor();\n\t},\n\n\t_setCursorVisible: function() {\n\t\tthis._map._isCursorVisible = true;\n\t},\n\n\t_onDownloadAsMsg: function (textMsg) {\n\t\tvar command = app.socket.parseServerCmd(textMsg);\n\t\tvar parser = document.createElement('a');\n\t\tparser.href = window.host;\n\n\t\tvar url = window.makeHttpUrlWopiSrc('/' + this._map.options.urlPrefix + '/',\n\t\t\tthis._map.options.doc, '/download/' + command.downloadid);\n\n\t\tthis._map.hideBusy();\n\t\tif (this._map['wopi'].DownloadAsPostMessage) {\n\t\t\tthis._map.fire('postMessage', {msgId: 'Download_As', args: {Type: command.id, URL: url}});\n\t\t}\n\t\telse if (command.id === 'print') {\n\t\t\tif (L.Browser.gecko || L.Browser.edge || L.Browser.ie || this._map.options.print === false || L.Browser.cypressTest) {\n\t\t\t\t// the print dialog doesn't work well on firefox\n\t\t\t\t// due to a pdf.js issue - https://github.com/mozilla/pdf.js/issues/5397\n\t\t\t\t// open the pdf file in a new tab so that that user can print it directly in the browser's\n\t\t\t\t// pdf viewer\n\t\t\t\turl = window.makeHttpUrlWopiSrc('/' + this._map.options.urlPrefix + '/',\n\t\t\t\t\tthis._map.options.doc, '/download/' + command.downloadid,\n\t\t\t\t\t'attachment=0');\n\n\t\t\t\tif ('processCoolUrl' in window) {\n\t\t\t\t\turl = window.processCoolUrl({ url: url, type: 'print' });\n\t\t\t\t}\n\n\t\t\t\twindow.open(url, '_blank');\n\t\t\t}\n\t\t\telse {\n\t\t\t\tif ('processCoolUrl' in window) {\n\t\t\t\t\turl = window.processCoolUrl({ url: url, type: 'print' });\n\t\t\t\t}\n\n\t\t\t\tthis._map.fire('filedownloadready', {url: url});\n\t\t\t}\n\t\t}\n\t\telse if (command.id === 'slideshow') {\n\t\t\tthis._map.fire('slidedownloadready', {url: url});\n\t\t}\n\t\telse if (command.id === 'export') {\n\t\t\tif ('processCoolUrl' in window) {\n\t\t\t\turl = window.processCoolUrl({ url: url, type: 'export' });\n\t\t\t}\n\n\t\t\t// Don't do a real download during testing\n\t\t\tif (!L.Browser.cypressTest)\n\t\t\t\tthis._map._fileDownloader.src = url;\n\t\t\telse\n\t\t\t\tthis._map._fileDownloader.setAttribute('data-src', url);\n\t\t}\n\t},\n\n\t_onErrorMsg: function (textMsg) {\n\t\tvar command = app.socket.parseServerCmd(textMsg);\n\n\t\t// let's provide some convenience error codes for the UI\n\t\tvar errorId = 1; // internal error\n\t\tif (command.errorCmd === 'load') {\n\t\t\terrorId = 2; // document cannot be loaded\n\t\t}\n\t\telse if (command.errorCmd === 'save' || command.errorCmd === 'saveas') {\n\t\t\terrorId = 5; // document cannot be saved\n\t\t}\n\n\t\tvar errorCode = -1;\n\t\tif (command.errorCode !== undefined) {\n\t\t\terrorCode = command.errorCode;\n\t\t}\n\n\t\tthis._map.fire('error', {cmd: command.errorCmd, kind: command.errorKind, id: errorId, code: errorCode});\n\t},\n\n\t_onGetChildIdMsg: function (textMsg) {\n\t\tvar command = app.socket.parseServerCmd(textMsg);\n\t\tthis._map.fire('childid', {id: command.id});\n\t},\n\n\t_isGraphicAngleDivisibleBy90: function() {\n\t\treturn (this._graphicSelectionAngle % 9000 === 0);\n\t},\n\n\t_shouldScaleUniform: function(extraInfo) {\n\t\treturn (!this._isGraphicAngleDivisibleBy90() || extraInfo.isWriterGraphic || extraInfo.type === 22);\n\t},\n\n\t_onShapeSelectionContent: function (textMsg) {\n\t\ttextMsg = textMsg.substring('shapeselectioncontent:'.length + 1);\n\t\tif (this._graphicMarker) {\n\t\t\tvar extraInfo = this._graphicSelection.extraInfo;\n\t\t\tif (extraInfo.id) {\n\t\t\t\tthis._map._cacheSVG[extraInfo.id] = textMsg;\n\t\t\t}\n\t\t\tvar wasVisibleSVG = this._graphicMarker._hasVisibleEmbeddedSVG();\n\t\t\tthis._graphicMarker.removeEmbeddedSVG();\n\t\t\tthis._graphicMarker.addEmbeddedSVG(textMsg);\n\t\t\tif (wasVisibleSVG)\n\t\t\t\tthis._graphicMarker._showEmbeddedSVG();\n\t\t}\n\t},\n\n\t_resetSelectionRanges: function() {\n\t\tthis._graphicSelectionTwips = new L.Bounds(new L.Point(0, 0), new L.Point(0, 0));\n\t\tthis._graphicSelection = new L.LatLngBounds(new L.LatLng(0, 0), new L.LatLng(0, 0));\n\t\tthis._hasActiveSelection = false;\n\t},\n\n\t_openMobileWizard: function(data) {\n\t\tthis._map.fire('mobilewizard', {data: data});\n\t},\n\n\t_closeMobileWizard: function() {\n\t\tthis._map.fire('closemobilewizard');\n\t},\n\n\t_extractAndSetGraphicSelection: function(messageJSON) {\n\t\tvar calcRTL = this.isCalcRTL();\n\t\tvar signX =  calcRTL ? -1 : 1;\n\t\tvar hasExtraInfo = messageJSON.length > 5;\n\t\tvar hasGridOffset = false;\n\t\tvar extraInfo = null;\n\t\tif (hasExtraInfo) {\n\t\t\textraInfo = messageJSON[5];\n\t\t\tif (extraInfo.gridOffsetX || extraInfo.gridOffsetY) {\n\t\t\t\tthis._shapeGridOffset = new L.Point(signX * parseInt(extraInfo.gridOffsetX), parseInt(extraInfo.gridOffsetY));\n\t\t\t\thasGridOffset = true;\n\t\t\t}\n\t\t}\n\n\t\t// Calc RTL: Negate positive X coordinates from core if grid offset is available.\n\t\tsignX = hasGridOffset && calcRTL ? -1 : 1;\n\t\tvar topLeftTwips = new L.Point(signX * messageJSON[0], messageJSON[1]);\n\t\tvar offset = new L.Point(signX * messageJSON[2], messageJSON[3]);\n\t\tvar bottomRightTwips = topLeftTwips.add(offset);\n\n\t\tif (hasGridOffset) {\n\t\t\tthis._graphicSelectionTwips = new L.Bounds(topLeftTwips.add(this._shapeGridOffset), bottomRightTwips.add(this._shapeGridOffset));\n\t\t} else {\n\t\t\tthis._graphicSelectionTwips = this._getGraphicSelectionRectangle(\n\t\t\t\tnew L.Bounds(topLeftTwips, bottomRightTwips));\n\t\t}\n\t\tthis._graphicSelection = new L.LatLngBounds(\n\t\t\tthis._twipsToLatLng(this._graphicSelectionTwips.getTopLeft(), this._map.getZoom()),\n\t\t\tthis._twipsToLatLng(this._graphicSelectionTwips.getBottomRight(), this._map.getZoom()));\n\n\t\tthis._graphicSelection.extraInfo = extraInfo;\n\t},\n\n\trenderDarkOverlay: function () {\n\t\tvar zoom = this._map.getZoom();\n\n\t\tvar northEastPoint = this._latLngToCorePixels(this._graphicSelection.getNorthEast(), zoom);\n\t\tvar southWestPoint = this._latLngToCorePixels(this._graphicSelection.getSouthWest(), zoom);\n\n\t\tif (this.isCalcRTL()) {\n\t\t\t// Dark overlays (like any other overlay) need regular document coordinates.\n\t\t\t// But in calc-rtl mode, charts (like shapes) have negative x document coordinate\n\t\t\t// internal representation.\n\t\t\tnorthEastPoint.x = Math.abs(northEastPoint.x);\n\t\t\tsouthWestPoint.x = Math.abs(southWestPoint.x);\n\t\t}\n\n\t\tvar bounds = new L.Bounds(northEastPoint, southWestPoint);\n\n\t\tthis._oleCSelections.setPointSet(CPointSet.fromBounds(bounds));\n\t},\n\n\t_onGraphicSelectionMsg: function (textMsg) {\n\t\tif (this._map.hyperlinkPopup !== null) {\n\t\t\tthis._closeURLPopUp();\n\t\t}\n\t\tif (textMsg.match('EMPTY')) {\n\t\t\tthis._resetSelectionRanges();\n\t\t}\n\t\telse if (textMsg.match('INPLACE EXIT')) {\n\t\t\tthis._oleCSelections.clear();\n\t\t}\n\t\telse if (textMsg.match('INPLACE')) {\n\t\t\tif (this._oleCSelections.empty()) {\n\t\t\t\ttextMsg = '[' + textMsg.substr('graphicselection:'.length) + ']';\n\t\t\t\ttry {\n\t\t\t\t\tvar msgData = JSON.parse(textMsg);\n\t\t\t\t\tif (msgData.length > 1)\n\t\t\t\t\t\tthis._extractAndSetGraphicSelection(msgData);\n\t\t\t\t}\n\t\t\t\tcatch (error) {\n\t\t\t\t\twindow.app.console.warn('cannot parse graphicselection command');\n\t\t\t\t}\n\t\t\t\tthis.renderDarkOverlay();\n\n\t\t\t\tthis._graphicSelection = new L.LatLngBounds(new L.LatLng(0, 0), new L.LatLng(0, 0));\n\t\t\t\tthis._onUpdateGraphicSelection();\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\ttextMsg = '[' + textMsg.substr('graphicselection:'.length) + ']';\n\t\t\tmsgData = JSON.parse(textMsg);\n\t\t\tthis._extractAndSetGraphicSelection(msgData);\n\n\t\t\t// Update the dark overlay on zooming & scrolling\n\t\t\tif (!this._oleCSelections.empty()) {\n\t\t\t\tthis._oleCSelections.clear();\n\t\t\t\tthis.renderDarkOverlay();\n\t\t\t}\n\n\t\t\tthis._graphicSelectionAngle = (msgData.length > 4) ? msgData[4] : 0;\n\n\t\t\tif (this._graphicSelection.extraInfo) {\n\t\t\t\tvar dragInfo = this._graphicSelection.extraInfo.dragInfo;\n\t\t\t\tif (dragInfo && dragInfo.dragMethod === 'PieSegmentDragging') {\n\t\t\t\t\tdragInfo.initialOffset /= 100.0;\n\t\t\t\t\tvar dragDir = dragInfo.dragDirection;\n\t\t\t\t\tdragInfo.dragDirection = this._twipsToPixels(new L.Point(dragDir[0], dragDir[1]));\n\t\t\t\t\tdragDir = dragInfo.dragDirection;\n\t\t\t\t\tdragInfo.range2 = dragDir.x * dragDir.x + dragDir.y * dragDir.y;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// defaults\n\t\t\tvar extraInfo = this._graphicSelection.extraInfo;\n\t\t\tif (extraInfo) {\n\t\t\t\tif (extraInfo.isDraggable === undefined)\n\t\t\t\t\textraInfo.isDraggable = true;\n\t\t\t\tif (extraInfo.isResizable === undefined)\n\t\t\t\t\textraInfo.isResizable = true;\n\t\t\t\tif (extraInfo.isRotatable === undefined)\n\t\t\t\t\textraInfo.isRotatable = true;\n\t\t\t}\n\n\t\t\t// Workaround for tdf#123874. For some reason the handling of the\n\t\t\t// shapeselectioncontent messages that we get back causes the WebKit process\n\t\t\t// to crash on iOS.\n\t\t\tif (!window.ThisIsTheiOSApp && this._graphicSelection.extraInfo.isDraggable && !this._graphicSelection.extraInfo.svg) {\n\t\t\t\tapp.socket.sendMessage('rendershapeselection mimetype=image/svg+xml');\n\t\t\t}\n\t\t}\n\n\t\t// Graphics are by default complex selections, unless Core tells us otherwise.\n\t\tif (this._map._clip)\n\t\t\tthis._map._clip.onComplexSelection('');\n\n\t\t// Reset text selection - important for textboxes in Impress\n\t\tif (this._selectionContentRequest)\n\t\t\tclearTimeout(this._selectionContentRequest);\n\t\tthis._onMessage('textselectioncontent:');\n\n\t\tthis._onUpdateGraphicSelection();\n\t},\n\n\t_onGraphicViewSelectionMsg: function (textMsg) {\n\t\tvar obj = JSON.parse(textMsg.substring('graphicviewselection:'.length + 1));\n\t\tvar viewId = parseInt(obj.viewId);\n\n\t\t// Ignore if viewid is ours or not in our db\n\t\tif (viewId === this._viewId || !this._map._viewInfo[viewId]) {\n\t\t\treturn;\n\t\t}\n\n\t\tvar strTwips = obj.selection.match(/\\d+/g);\n\t\tthis._graphicViewMarkers[viewId] = this._graphicViewMarkers[viewId] || {};\n\t\tthis._graphicViewMarkers[viewId].part = parseInt(obj.part);\n\t\tif (strTwips != null) {\n\t\t\tvar topLeftTwips = new L.Point(parseInt(strTwips[0]), parseInt(strTwips[1]));\n\t\t\tvar offset = new L.Point(parseInt(strTwips[2]), parseInt(strTwips[3]));\n\t\t\tvar bottomRightTwips = topLeftTwips.add(offset);\n\t\t\tvar boundRectTwips = this._getGraphicSelectionRectangle(\n\t\t\t\tnew L.Bounds(topLeftTwips, bottomRightTwips));\n\t\t\tthis._graphicViewMarkers[viewId].bounds = new L.LatLngBounds(\n\t\t\t\tthis._twipsToLatLng(boundRectTwips.getTopLeft(), this._map.getZoom()),\n\t\t\t\tthis._twipsToLatLng(boundRectTwips.getBottomRight(), this._map.getZoom()));\n\t\t}\n\t\telse {\n\t\t\tthis._graphicViewMarkers[viewId].bounds = L.LatLngBounds.createDefault();\n\t\t}\n\n\t\tthis._onUpdateGraphicViewSelection(viewId);\n\n\t\tif (this.isCalc()) {\n\t\t\tthis._saveMessageForReplay(textMsg, viewId);\n\t\t}\n\t},\n\n\t_onCellCursorMsg: function (textMsg) {\n\t\tvar autofillMarkerSection = app.sectionContainer.getSectionWithName(L.CSections.AutoFillMarker.name);\n\n\t\tif (!this._cellCursor) {\n\t\t\tthis._cellCursor = L.LatLngBounds.createDefault();\n\t\t}\n\t\tif (!this._prevCellCursor) {\n\t\t\tthis._prevCellCursor = L.LatLngBounds.createDefault();\n\t\t}\n\t\tif (!this._cellCursorXY) {\n\t\t\tthis._cellCursorXY = new L.Point(-1, -1);\n\t\t}\n\t\tif (!this._prevCellCursorXY) {\n\t\t\tthis._prevCellCursorXY = new L.Point(-1, -1);\n\t\t}\n\n\t\tif (textMsg.match('EMPTY') || !this._map.isPermissionEdit()) {\n\t\t\tapp.file.calc.cellCursor.visible = false;\n\t\t\tthis._cellCursorTwips = new L.Bounds(new L.Point(0, 0), new L.Point(0, 0));\n\t\t\tthis._cellCursor = L.LatLngBounds.createDefault();\n\t\t\tthis._cellCursorXY = new L.Point(-1, -1);\n\t\t\tthis._cellCursorPixels = null;\n\t\t\tapp.file.calc.cellCursor.visible = false;\n\t\t\tif (autofillMarkerSection)\n\t\t\t\tautofillMarkerSection.calculatePositionViaCellCursor(null);\n\t\t}\n\t\telse {\n\t\t\tvar strTwips = textMsg.match(/\\d+/g);\n\n\t\t\tvar topLeftTwips = new L.Point(parseInt(strTwips[0]), parseInt(strTwips[1]));\n\t\t\tvar offset = new L.Point(parseInt(strTwips[2]), parseInt(strTwips[3]));\n\t\t\tvar bottomRightTwips = topLeftTwips.add(offset);\n\t\t\tthis._cellCursorTwips = this._convertToTileTwipsSheetArea(\n\t\t\t\tnew L.Bounds(topLeftTwips, bottomRightTwips));\n\t\t\tthis._cellCursor = new L.LatLngBounds(\n\t\t\t\tthis._twipsToLatLng(this._cellCursorTwips.getTopLeft(), this._map.getZoom()),\n\t\t\t\tthis._twipsToLatLng(this._cellCursorTwips.getBottomRight(), this._map.getZoom()));\n\n\t\t\tvar start = this._twipsToCorePixels(this._cellCursorTwips.min);\n\t\t\tvar offsetPixels = this._twipsToCorePixels(this._cellCursorTwips.getSize());\n\t\t\tthis._cellCursorPixels = L.LOUtil.createRectangle(start.x, start.y, offsetPixels.x, offsetPixels.y);\n\t\t\tapp.file.calc.cellCursor.address = [parseInt(strTwips[4]), parseInt(strTwips[5])];\n\t\t\tapp.file.calc.cellCursor.rectangle.pixels = [Math.round(start.x), Math.round(start.y), Math.round(offsetPixels.x), Math.round(offsetPixels.y)];\n\t\t\tapp.file.calc.cellCursor.rectangle.twips = this._cellCursorTwips.toRectangle();\n\t\t\tapp.file.calc.cellCursor.visible = true;\n\t\t\tif (autofillMarkerSection)\n\t\t\t\tautofillMarkerSection.calculatePositionViaCellCursor([this._cellCursorPixels.getX2(), this._cellCursorPixels.getY2()]);\n\n\t\t\tthis._cellCursorXY = new L.Point(parseInt(strTwips[4]), parseInt(strTwips[5]));\n\n\t\t\tapp.file.calc.cellCursor.visible = true;\n\t\t\tapp.file.calc.cellCursor.rectangle.twips = this._cellCursorTwips.toRectangle();\n\t\t\tapp.file.calc.cellCursor.rectangle.pixels = [start.x, start.y, offsetPixels.x, offsetPixels.y];\n\t\t\tapp.file.calc.cellCursor.address = [parseInt(strTwips[4]), parseInt(strTwips[5])];\n\t\t}\n\n\t\tvar horizontalDirection = 0;\n\t\tvar verticalDirection = 0;\n\t\tvar sign = function(x) {\n\t\t\treturn x > 0 ? 1 : x < 0 ? -1 : x;\n\t\t};\n\t\tif (!this._isEmptyRectangle(this._prevCellCursor) && !this._isEmptyRectangle(this._cellCursor)) {\n\t\t\thorizontalDirection = sign(this._cellCursor.getWest() - this._prevCellCursor.getWest());\n\t\t\tverticalDirection = sign(this._cellCursor.getNorth() - this._prevCellCursor.getNorth());\n\t\t}\n\t\telse if (!this._isEmptyRectangle(this._cellCursor)) {\n\t\t\t// This is needed for jumping view to cursor position on tab switch\n\t\t\thorizontalDirection = sign(this._cellCursor.getWest());\n\t\t\tverticalDirection = sign(this._cellCursor.getNorth());\n\t\t}\n\n\t\tvar onPgUpDn = false;\n\t\tif (!this._isEmptyRectangle(this._cellCursor) && !this._prevCellCursor.equals(this._cellCursor)) {\n\t\t\tif ((this._cellCursorOnPgUp && this._cellCursorOnPgUp.equals(this._prevCellCursor)) ||\n\t\t\t\t(this._cellCursorOnPgDn && this._cellCursorOnPgDn.equals(this._prevCellCursor))) {\n\t\t\t\tonPgUpDn = true;\n\t\t\t}\n\t\t\tthis._prevCellCursor = new L.LatLngBounds(this._cellCursor.getSouthWest(), this._cellCursor.getNorthEast());\n\t\t}\n\n\t\tthis._onUpdateCellCursor(horizontalDirection, verticalDirection, onPgUpDn);\n\n\t\t// Remove input help if there is any:\n\t\tthis._removeInputHelpMarker();\n\t},\n\n\t_removeInputHelpMarker: function() {\n\t\tif (this._inputHelpPopUp) {\n\t\t\tthis._map.removeLayer(this._inputHelpPopUp);\n\t\t\tthis._inputHelpPopUp = null;\n\t\t}\n\t},\n\n\t_onDocumentRepair: function (textMsg) {\n\t\tif (!this._docRepair) {\n\t\t\tthis._docRepair = L.control.documentRepair();\n\t\t}\n\n\t\tif (!this._docRepair.isVisible()) {\n\t\t\tthis._docRepair.addTo(this._map);\n\t\t\tthis._docRepair.fillActions(textMsg);\n\t\t\tthis._docRepair.show();\n\t\t}\n\t},\n\n\t_onMousePointerMsg: function (textMsg) {\n\t\ttextMsg = textMsg.substring(14); // \"mousepointer: \"\n\t\ttextMsg = Cursor.getCustomCursor(textMsg) || textMsg;\n\t\tif (this._map._container.style.cursor !== textMsg) {\n\t\t\tthis._map._container.style.cursor = textMsg;\n\t\t}\n\t},\n\n\t_showURLPopUp: function(position, url) {\n\t\t// # for internal links\n\t\tif (!url.startsWith('#')) {\n\t\t\tvar link = L.DomUtil.createWithId('a', 'hyperlink-pop-up');\n\t\t\tlink.innerText = url;\n\t\t\tthis._map.hyperlinkPopup = new L.Popup({className: 'hyperlink-popup', closeButton: false, closeOnClick: false, autoPan: false})\n\t\t\t\t.setContent(link.outerHTML)\n\t\t\t\t.setLatLng(position)\n\t\t\t\t.openOn(this._map);\n\t\t\tvar offsetDiffTop = $('.hyperlink-popup').offset().top - $('#map').offset().top;\n\t\t\tvar offsetDiffLeft = $('.hyperlink-popup').offset().left - $('#map').offset().left;\n\t\t\tif (offsetDiffTop < 10) this._movePopUpBelow();\n\t\t\tif (offsetDiffLeft < 10) this._movePopUpRight();\n\t\t\tvar map_ = this._map;\n\t\t\tvar element = document.getElementById('hyperlink-pop-up');\n\t\t\telement.style.cursor = 'pointer';\n\t\t\telement.onclick = element.ontouchend = function() {\n\t\t\t\tmap_.fire('warn', {url: url, map: map_, cmd: 'openlink'});\n\t\t\t};\n\t\t}\n\t},\n\n\t_movePopUpBelow: function() {\n\t\tvar popUp = $('.hyperlink-popup').first();\n\t\tvar bottom = parseInt(popUp.css('bottom')) - popUp.height();\n\n\t\tpopUp.css({\n\t\t\t'bottom': bottom ? bottom + 'px': '',\n\t\t\t'display': 'flex',\n\t\t\t'flex-direction': 'column-reverse'\n\t\t});\n\t\t$('.leaflet-popup-tip-container').first().css('transform', 'rotate(180deg)');\n\t},\n\n\t_movePopUpRight: function() {\n\t\t$('.leaflet-popup-content-wrapper').first().css({\n\t\t\t'position': 'relative',\n\t\t\t'left': (this._map.hyperlinkPopup._containerWidth / 2)\n\t\t});\n\t\t$('.leaflet-popup-tip-container').first().css({\n\t\t\t'left': '25px'\n\t\t});\n\t},\n\n\t_closeURLPopUp: function() {\n\t\tthis._map.closePopup(this._map.hyperlinkPopup);\n\t\tthis._map.hyperlinkPopup = null;\n\t},\n\n\t_onInvalidateCursorMsg: function (textMsg) {\n\t\ttextMsg = textMsg.substring('invalidatecursor:'.length + 1);\n\t\tvar obj = JSON.parse(textMsg);\n\t\tvar recCursor = this._getEditCursorRectangle(obj);\n\t\tif (recCursor === undefined) {\n\t\t\treturn;\n\t\t}\n\t\tvar modifierViewId = parseInt(obj.viewId);\n\n\t\tthis._cursorAtMispelledWord = obj.mispelledWord ? Boolean(parseInt(obj.mispelledWord)).valueOf() : false;\n\n\t\t// Remember the last position of the caret (in core pixels).\n\t\tif (this._cursorCorePixels) {\n\t\t\tthis._cursorPreviousPositionCorePixels = this._cursorCorePixels.clone();\n\t\t}\n\n\t\tthis._visibleCursor = new L.LatLngBounds(\n\t\t\tthis._twipsToLatLng(recCursor.getTopLeft(), this._map.getZoom()),\n\t\t\tthis._twipsToLatLng(recCursor.getBottomRight(), this._map.getZoom()));\n\t\tthis._cursorCorePixels = this._twipsToCorePixelsBounds(recCursor);\n\n\t\tvar cursorPos = this._visibleCursor.getNorthWest();\n\t\tvar docLayer = this._map._docLayer;\n\t\tif ((docLayer._followEditor || docLayer._followUser) && this._map.lastActionByUser) {\n\t\t\tthis._map._setFollowing(false, null);\n\t\t}\n\t\tthis._map.lastActionByUser = false;\n\n\t\tthis._map.hyperlinkUnderCursor = obj.hyperlink;\n\t\tthis._closeURLPopUp();\n\t\tif (obj.hyperlink && obj.hyperlink.link) {\n\t\t\tthis._showURLPopUp(cursorPos, obj.hyperlink.link);\n\t\t}\n\n\t\tif (!this._map.editorHasFocus() && this._map._isCursorVisible && (modifierViewId === this._viewId) && (this._map.isPermissionEdit())) {\n\t\t\t// Regain cursor if we had been out of focus and now have input.\n\t\t\t// Unless the focus is in the Calc Formula-Bar, don't steal the focus.\n\t\t\tif (!this._map.calcInputBarHasFocus())\n\t\t\t\tthis._map.fire('editorgotfocus');\n\t\t}\n\n\t\t//first time document open, set last cursor position\n\t\tif (!this.lastCursorPos)\n\t\t\tthis.lastCursorPos = recCursor.getTopLeft();\n\n\t\tvar updateCursor = false;\n\t\tif (!this.lastCursorPos.equals(recCursor.getTopLeft())) {\n\t\t\tupdateCursor = true;\n\t\t\tthis.lastCursorPos = recCursor.getTopLeft();\n\t\t}\n\n\t\t// If modifier view is different than the current view, then set last variable to \"true\". We'll keep the caret position at the same point relative to screen.\n\t\tthis._onUpdateCursor(updateCursor && (modifierViewId === this._viewId), undefined /* zoom */, !(this._viewId === modifierViewId));\n\t\t// Only for reference equality comparison.\n\t\tthis._lastVisibleCursorRef = this._visibleCursor;\n\t},\n\n\t_updateEditor: function(textMsg) {\n\t\ttextMsg = textMsg.substring('editor:'.length + 1);\n\t\tvar editorId = parseInt(textMsg);\n\t\tvar docLayer = this._map._docLayer;\n\n\t\tdocLayer._editorId = editorId;\n\n\t\tif (docLayer._followEditor) {\n\t\t\tdocLayer._followThis = editorId;\n\t\t}\n\n\t\tif (this._map._viewInfo[editorId])\n\t\t\tthis._map.fire('updateEditorName', {username: this._map._viewInfo[editorId].username});\n\t},\n\n\t_onInvalidateViewCursorMsg: function (textMsg) {\n\t\tvar obj = JSON.parse(textMsg.substring('invalidateviewcursor:'.length + 1));\n\t\tvar viewId = parseInt(obj.viewId);\n\t\tvar docLayer = this._map._docLayer;\n\n\t\t// Ignore if viewid is same as ours or not in our db\n\t\tif (viewId === this._viewId || !this._map._viewInfo[viewId]) {\n\t\t\treturn;\n\t\t}\n\n\t\tvar rectangle = this._getEditCursorRectangle(obj);\n\t\tif (rectangle === undefined) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis._viewCursors[viewId] = this._viewCursors[viewId] || {};\n\t\tthis._viewCursors[viewId].bounds = new L.LatLngBounds(\n\t\t\tthis._twipsToLatLng(rectangle.getTopLeft(), this._map.getZoom()),\n\t\t\tthis._twipsToLatLng(rectangle.getBottomRight(), this._map.getZoom())),\n\t\tthis._viewCursors[viewId].corepxBounds = this._twipsToCorePixelsBounds(rectangle);\n\t\tthis._viewCursors[viewId].part = parseInt(obj.part);\n\n\t\t// FIXME. Server not sending view visible cursor\n\t\tif (typeof this._viewCursors[viewId].visible === 'undefined') {\n\t\t\tthis._viewCursors[viewId].visible = true;\n\t\t}\n\n\t\tthis._onUpdateViewCursor(viewId);\n\n\t\tif (docLayer._followThis === viewId && (docLayer._followEditor || docLayer._followUser)) {\n\t\t\tif (this._map.getDocType() === 'text' || this._map.getDocType() === 'presentation') {\n\t\t\t\tthis.goToViewCursor(viewId);\n\t\t\t}\n\t\t\telse if (this._map.getDocType() === 'spreadsheet') {\n\t\t\t\tthis.goToCellViewCursor(viewId);\n\t\t\t}\n\t\t}\n\n\t\tthis._saveMessageForReplay(textMsg, viewId);\n\t},\n\n\t_onCellViewCursorMsg: function (textMsg) {\n\t\tvar obj = JSON.parse(textMsg.substring('cellviewcursor:'.length + 1));\n\t\tvar viewId = parseInt(obj.viewId);\n\n\t\t// Ignore if viewid is same as ours\n\t\tif (viewId === this._viewId) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis._cellViewCursors[viewId] = this._cellViewCursors[viewId] || {};\n\t\tif (!this._cellViewCursors[viewId].bounds) {\n\t\t\tthis._cellViewCursors[viewId].bounds = L.LatLngBounds.createDefault();\n\t\t\tthis._cellViewCursors[viewId].corePixelBounds = new L.Bounds();\n\t\t}\n\t\tif (obj.rectangle.match('EMPTY')) {\n\t\t\tthis._cellViewCursors[viewId].bounds = L.LatLngBounds.createDefault();\n\t\t\tthis._cellViewCursors[viewId].corePixelBounds = new L.Bounds();\n\t\t}\n\t\telse {\n\t\t\tvar strTwips = obj.rectangle.match(/\\d+/g);\n\t\t\tvar topLeftTwips = new L.Point(parseInt(strTwips[0]), parseInt(strTwips[1]));\n\t\t\tvar offset = new L.Point(parseInt(strTwips[2]), parseInt(strTwips[3]));\n\t\t\tvar bottomRightTwips = topLeftTwips.add(offset);\n\t\t\tvar boundsTwips = this._convertToTileTwipsSheetArea(\n\t\t\t\tnew L.Bounds(topLeftTwips, bottomRightTwips));\n\t\t\tthis._cellViewCursors[viewId].bounds = new L.LatLngBounds(\n\t\t\t\tthis._twipsToLatLng(boundsTwips.getTopLeft(), this._map.getZoom()),\n\t\t\t\tthis._twipsToLatLng(boundsTwips.getBottomRight(), this._map.getZoom()));\n\t\t\tvar corePixelBounds = this._twipsToCorePixelsBounds(boundsTwips);\n\t\t\tcorePixelBounds.round();\n\t\t\tthis._cellViewCursors[viewId].corePixelBounds = corePixelBounds;\n\t\t}\n\n\t\tthis._cellViewCursors[viewId].part = parseInt(obj.part);\n\t\tthis._onUpdateCellViewCursor(viewId);\n\n\t\tif (this.isCalc()) {\n\t\t\tthis._saveMessageForReplay(textMsg, viewId);\n\t\t}\n\t},\n\n\t_onUpdateCellViewCursor: function (viewId) {\n\t\tif (!this._cellViewCursors[viewId] || !this._cellViewCursors[viewId].bounds)\n\t\t\treturn;\n\n\t\tvar cellViewCursorMarker = this._cellViewCursors[viewId].marker;\n\t\tvar viewPart = this._cellViewCursors[viewId].part;\n\n\t\tif (!this._isEmptyRectangle(this._cellViewCursors[viewId].bounds) && this._selectedPart === viewPart && this._map.hasInfoForView(viewId)) {\n\t\t\tif (!cellViewCursorMarker) {\n\t\t\t\tvar backgroundColor = L.LOUtil.rgbToHex(this._map.getViewColor(viewId));\n\t\t\t\tcellViewCursorMarker = new CCellCursor(this._cellViewCursors[viewId].corePixelBounds, {\n\t\t\t\t\tviewId: viewId,\n\t\t\t\t\tfill: false,\n\t\t\t\t\tcolor: backgroundColor,\n\t\t\t\t\tweight: 2 * app.dpiScale,\n\t\t\t\t\ttoCompatUnits: function (corePx) {\n\t\t\t\t\t\treturn this._map.unproject(L.point(corePx)\n\t\t\t\t\t\t\t.divideBy(app.dpiScale));\n\t\t\t\t\t}.bind(this)\n\t\t\t\t});\n\t\t\t\tthis._cellViewCursors[viewId].marker = cellViewCursorMarker;\n\t\t\t\tcellViewCursorMarker.bindPopup(this._map.getViewName(viewId), {autoClose: false, autoPan: false, backgroundColor: backgroundColor, color: 'white', closeButton: false});\n\t\t\t\tthis._canvasOverlay.initPathGroup(cellViewCursorMarker);\n\t\t\t}\n\t\t\telse {\n\t\t\t\tcellViewCursorMarker.setBounds(this._cellViewCursors[viewId].corePixelBounds);\n\t\t\t}\n\t\t}\n\t\telse if (cellViewCursorMarker) {\n\t\t\tthis._canvasOverlay.removePathGroup(cellViewCursorMarker);\n\t\t\tthis._cellViewCursors[viewId].marker = undefined;\n\t\t}\n\t},\n\n\tgoToCellViewCursor: function(viewId) {\n\t\tif (this._cellViewCursors[viewId] && !this._isEmptyRectangle(this._cellViewCursors[viewId].bounds)) {\n\t\t\tif (!this._map.getBounds().contains(this._cellViewCursors[viewId].bounds)) {\n\t\t\t\tvar mapBounds = this._map.getBounds();\n\t\t\t\tvar scrollX = 0;\n\t\t\t\tvar scrollY = 0;\n\t\t\t\tvar spacingX = Math.abs(this._cellViewCursors[viewId].bounds.getEast() - this._cellViewCursors[viewId].bounds.getWest()) / 4.0;\n\t\t\t\tvar spacingY = Math.abs(this._cellViewCursors[viewId].bounds.getSouth() - this._cellViewCursors[viewId].bounds.getNorth()) / 4.0;\n\t\t\t\tif (this._cellViewCursors[viewId].bounds.getWest() < mapBounds.getWest()) {\n\t\t\t\t\tscrollX = this._cellViewCursors[viewId].bounds.getWest() - mapBounds.getWest() - spacingX;\n\t\t\t\t} else if (this._cellViewCursors[viewId].bounds.getEast() > mapBounds.getEast()) {\n\t\t\t\t\tscrollX = this._cellViewCursors[viewId].bounds.getEast() - mapBounds.getEast() + spacingX;\n\t\t\t\t}\n\n\t\t\t\tif (this._cellViewCursors[viewId].bounds.getNorth() > mapBounds.getNorth()) {\n\t\t\t\t\tscrollY = this._cellViewCursors[viewId].bounds.getNorth() - mapBounds.getNorth() + spacingY;\n\t\t\t\t} else if (this._cellViewCursors[viewId].bounds.getSouth() < mapBounds.getSouth()) {\n\t\t\t\t\tscrollY = this._cellViewCursors[viewId].bounds.getSouth() - mapBounds.getSouth() - spacingY;\n\t\t\t\t}\n\n\t\t\t\tif (scrollX !== 0 || scrollY !== 0) {\n\t\t\t\t\tvar newCenter = mapBounds.getCenter();\n\t\t\t\t\tnewCenter.lat += scrollX;\n\t\t\t\t\tnewCenter.lat += scrollY;\n\t\t\t\t\tvar center = this._map.project(newCenter);\n\t\t\t\t\tcenter = center.subtract(this._map.getSize().divideBy(2));\n\t\t\t\t\tcenter.x = Math.round(center.x < 0 ? 0 : center.x);\n\t\t\t\t\tcenter.y = Math.round(center.y < 0 ? 0 : center.y);\n\t\t\t\t\tthis._map.fire('scrollto', {x: center.x, y: center.y});\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tvar backgroundColor = L.LOUtil.rgbToHex(this._map.getViewColor(viewId));\n\t\t\tthis._cellViewCursors[viewId].marker.bindPopup(this._map.getViewName(viewId), {autoClose: false, autoPan: false, backgroundColor: backgroundColor, color: 'white', closeButton: false});\n\t\t}\n\t},\n\n\t_onViewCursorVisibleMsg: function(textMsg) {\n\t\ttextMsg = textMsg.substring('viewcursorvisible:'.length + 1);\n\t\tvar obj = JSON.parse(textMsg);\n\t\tvar viewId = parseInt(obj.viewId);\n\n\t\t// Ignore if viewid is same as ours or not in our db\n\t\tif (viewId === this._viewId || !this._map._viewInfo[viewId]) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (typeof this._viewCursors[viewId] !== 'undefined') {\n\t\t\tthis._viewCursors[viewId].visible = (obj.visible === 'true');\n\t\t}\n\n\t\tthis._onUpdateViewCursor(viewId);\n\t},\n\n\t_addView: function(viewInfo) {\n\t\tif (viewInfo.color === 0 && this._map.getDocType() !== 'text') {\n\t\t\tviewInfo.color = L.LOUtil.getViewIdColor(viewInfo.id);\n\t\t}\n\n\t\tthis._map.addView(viewInfo);\n\n\t\t//TODO: We can initialize color and other properties here.\n\t\tif (typeof this._viewCursors[viewInfo.id] !== 'undefined') {\n\t\t\tthis._viewCursors[viewInfo.id] = {};\n\t\t}\n\n\t\tthis._onUpdateViewCursor(viewInfo.id);\n\t},\n\n\t_removeView: function(viewId) {\n\t\t// Remove selection, if any.\n\t\tif (this._viewSelections[viewId] && this._viewSelections[viewId].selection) {\n\t\t\tthis._viewSelections[viewId].selection.remove();\n\t\t\tthis._viewSelections[viewId].selection = undefined;\n\t\t}\n\n\t\t// Remove the view and update (to refresh as needed).\n\t\tif (typeof this._viewCursors[viewId] !== 'undefined') {\n\t\t\tthis._viewCursors[viewId].visible = false;\n\t\t\tthis._onUpdateViewCursor(viewId);\n\t\t\tdelete this._viewCursors[viewId];\n\t\t}\n\n\t\tthis._map.removeView(viewId);\n\t},\n\n\tremoveAllViews: function() {\n\t\tfor (var viewInfoIdx in this._map._viewInfo) {\n\t\t\tthis._removeView(parseInt(viewInfoIdx));\n\t\t}\n\t},\n\n\t_onViewInfoMsg: function(textMsg) {\n\t\ttextMsg = textMsg.substring('viewinfo: '.length);\n\t\tvar viewInfo = JSON.parse(textMsg);\n\t\tthis._map.fire('viewinfo', viewInfo);\n\n\t\t// A new view\n\t\tvar viewIds = [];\n\t\tfor (var viewInfoIdx in viewInfo) {\n\t\t\tif (!(parseInt(viewInfo[viewInfoIdx].id) in this._map._viewInfo)) {\n\t\t\t\tthis._addView(viewInfo[viewInfoIdx]);\n\t\t\t}\n\t\t\tviewIds.push(viewInfo[viewInfoIdx].id);\n\t\t}\n\n\t\t// Check if any view is deleted\n\t\tfor (viewInfoIdx in this._map._viewInfo) {\n\t\t\tif (viewIds.indexOf(parseInt(viewInfoIdx)) === -1) {\n\t\t\t\tthis._removeView(parseInt(viewInfoIdx));\n\t\t\t}\n\t\t}\n\n\t\t// Sending postMessage about View_Added / View_Removed is\n\t\t// deprecated, going forward we prefer sending the entire information.\n\t\tthis._map.fire('updateviewslist');\n\t},\n\n\t_onRenderFontMsg: function (textMsg, img) {\n\t\tvar command = app.socket.parseServerCmd(textMsg);\n\t\tthis._map.fire('renderfont', {\n\t\t\tfont: command.font,\n\t\t\tchar: command.char,\n\t\t\timg: img\n\t\t});\n\t},\n\n\t_onSearchNotFoundMsg: function (textMsg) {\n\t\tthis._clearSearchResults();\n\t\tthis._searchRequested = false;\n\t\tvar originalPhrase = textMsg.substring(16);\n\t\tthis._map.fire('search', {originalPhrase: originalPhrase, count: 0});\n\t},\n\n\t_getSearchResultRectangles: function (obj, results) {\n\t\tfor (var i = 0; i < obj.searchResultSelection.length; i++) {\n\t\t\tresults.push({\n\t\t\t\tpart: parseInt(obj.searchResultSelection[i].part),\n\t\t\t\trectangles: this._twipsRectanglesToPixelBounds(obj.searchResultSelection[i].rectangles),\n\t\t\t\ttwipsRectangles: obj.searchResultSelection[i].rectangles\n\t\t\t});\n\t\t}\n\t},\n\n\t_getSearchResultRectanglesFileBasedView: function (obj, results) {\n\t\tvar additionPerPart = this._partHeightTwips + this._spaceBetweenParts;\n\n\t\tfor (var i = 0; i < obj.searchResultSelection.length; i++) {\n\t\t\tvar rectangles = obj.searchResultSelection[i].rectangles;\n\t\t\tvar part = parseInt(obj.searchResultSelection[i].part);\n\t\t\trectangles = rectangles.split(',');\n\t\t\trectangles = rectangles.map(function(element, index) {\n\t\t\t\telement = parseInt(element);\n\t\t\t\tif (index < 2)\n\t\t\t\t\telement += additionPerPart * part;\n\t\t\t\treturn element;\n\t\t\t});\n\n\t\t\trectangles = String(rectangles[0]) + ', ' + String(rectangles[1]) + ', ' + String(rectangles[2]) + ', ' + String(rectangles[3]);\n\n\t\t\tresults.push({\n\t\t\t\tpart: parseInt(obj.searchResultSelection[i].part),\n\t\t\t\trectangles: this._twipsRectanglesToPixelBounds(rectangles),\n\t\t\t\ttwipsRectangles: rectangles\n\t\t\t});\n\t\t}\n\t},\n\n\t_onSearchResultSelection: function (textMsg) {\n\t\tthis._searchRequested = false;\n\t\ttextMsg = textMsg.substring(23);\n\t\tvar obj = JSON.parse(textMsg);\n\t\tvar originalPhrase = obj.searchString;\n\t\tvar count = obj.searchResultSelection.length;\n\t\tvar highlightAll = obj.highlightAll;\n\t\tvar results = [];\n\n\t\tif (!app.file.fileBasedView)\n\t\t\tthis._getSearchResultRectangles(obj, results);\n\t\telse\n\t\t\tthis._getSearchResultRectanglesFileBasedView(obj, results);\n\n\t\t// do not cache search results if there is only one result.\n\t\t// this way regular searches works fine\n\t\tif (count > 1)\n\t\t{\n\t\t\tthis._clearSearchResults();\n\t\t\tthis._searchResults = results;\n\t\t\tif (!app.file.fileBasedView)\n\t\t\t\tthis._map.setPart(results[0].part); // go to first result.\n\t\t\telse\n\t\t\t\tthis._map._docLayer._preview._scrollViewToPartPosition(results[0].part);\n\t\t} else if (count === 1) {\n\t\t\tthis._lastSearchResult = results[0];\n\t\t}\n\t\tthis._searchTerm = originalPhrase;\n\t\tthis._map.fire('search', {originalPhrase: originalPhrase, count: count, highlightAll: highlightAll, results: results});\n\t},\n\n\t_clearSearchResults: function() {\n\t\tif (this._searchTerm) {\n\t\t\tthis._textCSelections.clear();\n\t\t}\n\t\tthis._lastSearchResult = null;\n\t\tthis._searchResults = null;\n\t\tthis._searchTerm = null;\n\t\tthis._searchResultsLayer.clearLayers();\n\t},\n\n\t_drawSearchResults: function() {\n\t\tif (!this._searchResults) {\n\t\t\treturn;\n\t\t}\n\t\tthis._searchResultsLayer.clearLayers();\n\t\tfor (var k = 0; k < this._searchResults.length; k++)\n\t\t{\n\t\t\tvar result = this._searchResults[k];\n\t\t\tif (result.part === this._selectedPart)\n\t\t\t{\n\t\t\t\tvar _fillColor = '#CCCCCC';\n\t\t\t\tvar strTwips = result.twipsRectangles.match(/\\d+/g);\n\t\t\t\tvar rectangles = [];\n\t\t\t\tfor (var i = 0; i < strTwips.length; i += 4) {\n\t\t\t\t\tvar topLeftTwips = new L.Point(parseInt(strTwips[i]), parseInt(strTwips[i + 1]));\n\t\t\t\t\tvar offset = new L.Point(parseInt(strTwips[i + 2]), parseInt(strTwips[i + 3]));\n\t\t\t\t\tvar topRightTwips = topLeftTwips.add(new L.Point(offset.x, 0));\n\t\t\t\t\tvar bottomLeftTwips = topLeftTwips.add(new L.Point(0, offset.y));\n\t\t\t\t\tvar bottomRightTwips = topLeftTwips.add(offset);\n\t\t\t\t\trectangles.push([bottomLeftTwips, bottomRightTwips, topLeftTwips, topRightTwips]);\n\t\t\t\t}\n\t\t\t\tvar polygons = L.PolyUtil.rectanglesToPolygons(rectangles, this);\n\t\t\t\tvar selection = new L.Polygon(polygons, {\n\t\t\t\t\tpointerEvents: 'none',\n\t\t\t\t\tfillColor: _fillColor,\n\t\t\t\t\tfillOpacity: 0.25,\n\t\t\t\t\tweight: 2,\n\t\t\t\t\topacity: 0.25});\n\t\t\t\tthis._searchResultsLayer.addLayer(selection);\n\t\t\t}\n\t\t}\n\t},\n\n\t_onStateChangedMsg: function (textMsg) {\n\t\ttextMsg = textMsg.substr(14);\n\n\t\tvar isPureJSON = textMsg.indexOf('=') === -1 && textMsg.indexOf('{') !== -1;\n\t\tif (isPureJSON) {\n\t\t\tvar json = JSON.parse(textMsg);\n\t\t\tif (json.commandName && json.state) {\n\t\t\t\tthis._map.fire('commandstatechanged', json);\n\t\t\t}\n\t\t} else {\n\t\t\tvar index = textMsg.indexOf('=');\n\t\t\tvar commandName = index !== -1 ? textMsg.substr(0, index) : '';\n\t\t\tvar state = index !== -1 ? textMsg.substr(index + 1) : '';\n\t\t\tthis._map.fire('commandstatechanged', {commandName : commandName, state : state});\n\t\t}\n\t},\n\n\t_onUnoCommandResultMsg: function (textMsg) {\n\t\t// window.app.console.log('_onUnoCommandResultMsg: \"' + textMsg + '\"');\n\t\ttextMsg = textMsg.substring(18);\n\t\tvar obj = JSON.parse(textMsg);\n\t\tvar commandName = obj.commandName;\n\t\tif (obj.success === 'true' || obj.success === true) {\n\t\t\tvar success = true;\n\t\t}\n\t\telse if (obj.success === 'false' || obj.success === false) {\n\t\t\tsuccess = false;\n\t\t}\n\n\t\tthis._map.hideBusy();\n\t\tthis._map.fire('commandresult', {commandName: commandName, success: success, result: obj.result});\n\n\t\tif (this._map.CallPythonScriptSource != null) {\n\t\t\tthis._map.CallPythonScriptSource.postMessage(JSON.stringify({'MessageId': 'CallPythonScript-Result',\n\t\t\t\t\t\t\t\t\t\t     'SendTime': Date.now(),\n\t\t\t\t\t\t\t\t\t\t     'Values': obj\n\t\t\t\t\t\t\t\t\t\t    }),\n\t\t\t\t\t\t\t\t     '*');\n\t\t\tthis._map.CallPythonScriptSource = null;\n\t\t}\n\t},\n\n\t_onRulerUpdate: function (textMsg) {\n\t\ttextMsg = textMsg.substring(13);\n\t\tvar obj = JSON.parse(textMsg);\n\n\t\tthis._map.fire('rulerupdate', obj);\n\t},\n\n\t_onContextMenuMsg: function (textMsg) {\n\t\ttextMsg = textMsg.substring(13);\n\t\tvar obj = JSON.parse(textMsg);\n\n\t\tthis._map.fire('locontextmenu', obj);\n\t},\n\n\t_onTextSelectionMsg: function (textMsg) {\n\n\t\tvar rectArray = this._getTextSelectionRectangles(textMsg);\n\t\tvar inTextSearch = $('input#search-input').is(':focus');\n\t\tvar isTextSelection = this.isCursorVisible() || inTextSearch;\n\t\tif (rectArray.length) {\n\n\t\t\tvar rectangles = rectArray.map(function (rect) {\n\t\t\t\treturn rect.getPointArray();\n\t\t\t});\n\n\t\t\tif (app.file.fileBasedView && this._lastSearchResult) {\n\t\t\t\t// We rely on that _lastSearchResult has been updated before this function is called.\n\t\t\t\tvar additionPerPart = this._partHeightTwips + this._spaceBetweenParts;\n\t\t\t\tfor (var i = 0; i < rectangles.length; i++) {\n\t\t\t\t\tfor (var j = 0; j < rectangles[i].length; j++) {\n\t\t\t\t\t\trectangles[i][j].y += additionPerPart * this._lastSearchResult.part;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tthis._map._docLayer._preview._scrollViewToPartPosition(this._lastSearchResult.part);\n\t\t\t\tthis._updateFileBasedView();\n\t\t\t\tsetTimeout(function () {app.sectionContainer.requestReDraw();}, 100);\n\t\t\t}\n\n\t\t\tvar docLayer = this;\n\t\t\tvar pointSet = CPolyUtil.rectanglesToPointSet(rectangles,\n\t\t\t\tfunction (twipsPoint) {\n\t\t\t\t\tvar corePxPt = docLayer._twipsToCorePixels(twipsPoint);\n\t\t\t\t\tcorePxPt.round();\n\t\t\t\t\treturn corePxPt;\n\t\t\t\t});\n\n\t\t\tif (isTextSelection)\n\t\t\t\tthis._textCSelections.setPointSet(pointSet);\n\t\t\telse\n\t\t\t\tthis._cellCSelections.setPointSet(pointSet);\n\n\t\t\tthis._map.removeLayer(this._map._textInput._cursorHandler); // User selected a text, we remove the carret marker.\n\t\t\tif (this._selectionContentRequest) {\n\t\t\t\tclearTimeout(this._selectionContentRequest);\n\t\t\t}\n\t\t\tthis._selectionContentRequest = setTimeout(L.bind(function () {\n\t\t\t\tapp.socket.sendMessage('gettextselection mimetype=text/html');}, this), 100);\n\t\t}\n\t\telse {\n\t\t\tthis._textCSelections.clear();\n\t\t\tthis._cellCSelections.clear();\n\t\t}\n\n\t\tthis._onUpdateTextSelection();\n\t},\n\n\t_onTextViewSelectionMsg: function (textMsg) {\n\t\tvar obj = JSON.parse(textMsg.substring('textviewselection:'.length + 1));\n\t\tvar viewId = parseInt(obj.viewId);\n\t\tvar viewPart = parseInt(obj.part);\n\n\t\t// Ignore if viewid is same as ours or not in our db\n\t\tif (viewId === this._viewId || !this._map._viewInfo[viewId]) {\n\t\t\treturn;\n\t\t}\n\n\t\tvar rectArray = this._getTextSelectionRectangles(obj.selection);\n\t\tthis._viewSelections[viewId] = this._viewSelections[viewId] || {};\n\n\t\tif (rectArray.length) {\n\n\t\t\tvar rectangles = rectArray.map(function (rect) {\n\t\t\t\treturn rect.getPointArray();\n\t\t\t});\n\n\t\t\tthis._viewSelections[viewId].part = viewPart;\n\t\t\tvar docLayer = this;\n\t\t\tthis._viewSelections[viewId].pointSet = CPolyUtil.rectanglesToPointSet(rectangles,\n\t\t\t\tfunction (twipsPoint) {\n\t\t\t\t\tvar corePxPt = docLayer._twipsToCorePixels(twipsPoint);\n\t\t\t\t\tcorePxPt.round();\n\t\t\t\t\treturn corePxPt;\n\t\t\t\t});\n\t\t} else {\n\t\t\tthis._viewSelections[viewId].pointSet = new CPointSet();\n\t\t}\n\n\t\tthis._onUpdateTextViewSelection(viewId);\n\n\t\tthis._saveMessageForReplay(textMsg, viewId);\n\t},\n\n\t_updateReferenceMarks: function() {\n\t\tthis._clearReferences();\n\n\t\tif (!this._referencesAll)\n\t\t\treturn;\n\n\t\tfor (var i = 0; i < this._referencesAll.length; i++) {\n\t\t\t// Avoid doubled marks, add only marks for current sheet\n\t\t\tif (!this._references.hasMark(this._referencesAll[i].mark)\n\t\t\t\t&& this._selectedPart === this._referencesAll[i].part) {\n\t\t\t\tthis._references.addMark(this._referencesAll[i].mark);\n\t\t\t}\n\t\t\tif (!window.mode.isDesktop()) {\n\t\t\t\tif (!this._referenceMarkerStart.isDragged) {\n\t\t\t\t\tthis._map.addLayer(this._referenceMarkerStart);\n\t\t\t\t\tvar sizeStart = this._referenceMarkerStart._icon.getBoundingClientRect();\n\t\t\t\t\tvar posStart = this._referencesAll[i].mark.getBounds().getTopLeft().divideBy(app.dpiScale);\n\t\t\t\t\tposStart = posStart.subtract(new L.Point(sizeStart.width / 2, sizeStart.height / 2));\n\t\t\t\t\tposStart = this._map.unproject(posStart);\n\t\t\t\t\tthis._referenceMarkerStart.setLatLng(posStart);\n\t\t\t\t}\n\n\t\t\t\tif (!this._referenceMarkerEnd.isDragged) {\n\t\t\t\t\tthis._map.addLayer(this._referenceMarkerEnd);\n\t\t\t\t\tvar sizeEnd = this._referenceMarkerEnd._icon.getBoundingClientRect();\n\t\t\t\t\tvar posEnd = this._referencesAll[i].mark.getBounds().getBottomRight().divideBy(app.dpiScale);\n\t\t\t\t\tposEnd = posEnd.subtract(new L.Point(sizeEnd.width / 2, sizeEnd.height / 2));\n\t\t\t\t\tposEnd = this._map.unproject(posEnd);\n\t\t\t\t\tthis._referenceMarkerEnd.setLatLng(posEnd);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t},\n\n\t_onReferencesMsg: function (textMsg) {\n\t\ttextMsg = textMsg.substr(textMsg.indexOf(' ') + 1);\n\t\tvar marks = JSON.parse(textMsg);\n\t\tmarks = marks.marks;\n\t\tvar references = [];\n\t\tthis._referencesAll = [];\n\n\t\tfor (var mark = 0; mark < marks.length; mark++) {\n\t\t\tvar strTwips = marks[mark].rectangle.match(/\\d+/g);\n\t\t\tvar strColor = marks[mark].color;\n\t\t\tvar part = parseInt(marks[mark].part);\n\n\t\t\tif (strTwips != null) {\n\t\t\t\tvar rectangles = [];\n\t\t\t\tfor (var i = 0; i < strTwips.length; i += 4) {\n\t\t\t\t\tvar topLeftTwips = new L.Point(parseInt(strTwips[i]), parseInt(strTwips[i + 1]));\n\t\t\t\t\tvar offset = new L.Point(parseInt(strTwips[i + 2]), parseInt(strTwips[i + 3]));\n\t\t\t\t\tvar boundsTwips = this._convertToTileTwipsSheetArea(\n\t\t\t\t\t\tnew L.Bounds(topLeftTwips, topLeftTwips.add(offset)));\n\t\t\t\t\trectangles.push([boundsTwips.getBottomLeft(), boundsTwips.getBottomRight(),\n\t\t\t\t\t\tboundsTwips.getTopLeft(), boundsTwips.getTopRight()]);\n\t\t\t\t}\n\n\t\t\t\tvar docLayer = this;\n\t\t\t\tvar pointSet = CPolyUtil.rectanglesToPointSet(rectangles, function (twipsPoint) {\n\t\t\t\t\tvar corePxPt = docLayer._twipsToCorePixels(twipsPoint);\n\t\t\t\t\tcorePxPt.round();\n\t\t\t\t\treturn corePxPt;\n\t\t\t\t});\n\t\t\t\tvar reference = new CPolygon(pointSet, {\n\t\t\t\t\tpointerEvents: 'none',\n\t\t\t\t\tfillColor: '#' + strColor,\n\t\t\t\t\tfillOpacity: 0.25,\n\t\t\t\t\tweight: 2 * app.dpiScale,\n\t\t\t\t\topacity: 0.25});\n\n\t\t\t\treferences.push({mark: reference, part: part});\n\t\t\t}\n\t\t}\n\n\t\tfor (i = 0; i < references.length; i++) {\n\t\t\tthis._referencesAll.push(references[i]);\n\t\t}\n\n\t\tthis._updateReferenceMarks();\n\t},\n\n\t_getStringPart: function (string) {\n\t\tvar code = '';\n\t\tvar i = 0;\n\t\twhile (i < string.length) {\n\t\t\tif (string.charCodeAt(i) < 48 || string.charCodeAt(i) > 57) {\n\t\t\t\tcode += string.charAt(i);\n\t\t\t}\n\t\t\ti++;\n\t\t}\n\t\treturn code;\n\t},\n\n\t_getNumberPart: function (string) {\n\t\tvar number = '';\n\t\tvar i = 0;\n\t\twhile (i < string.length) {\n\t\t\tif (string.charCodeAt(i) >= 48 && string.charCodeAt(i) <= 57) {\n\t\t\t\tnumber += string.charAt(i);\n\t\t\t}\n\t\t\ti++;\n\t\t}\n\t\treturn parseInt(number);\n\t},\n\n\t_isWholeColumnSelected: function (cellAddress) {\n\t\tif (!cellAddress)\n\t\t\tcellAddress = document.getElementById('addressInput').value;\n\n\t\tvar startEnd = cellAddress.split(':');\n\t\tif (startEnd.length === 1)\n\t\t\treturn false; // Selection is not a range.\n\n\t\tvar rangeStart = this._getNumberPart(startEnd[0]);\n\t\tif (rangeStart !== 1)\n\t\t\treturn false; // Selection doesn't start at first row.\n\n\t\tvar rangeEnd = this._getNumberPart(startEnd[1]);\n\t\tif (rangeEnd === 1048576) // Last row's number.\n\t\t\treturn true;\n\t\telse\n\t\t\treturn false;\n\t},\n\n\t_isWholeRowSelected: function (cellAddress) {\n\t\tif (!cellAddress)\n\t\t\tcellAddress = document.getElementById('addressInput').value;\n\n\t\tvar startEnd = cellAddress.split(':');\n\t\tif (startEnd.length === 1)\n\t\t\treturn false; // Selection is not a range.\n\n\t\tvar rangeStart = this._getStringPart(startEnd[0]);\n\t\tif (rangeStart !== 'A')\n\t\t\treturn false; // Selection doesn't start at first column.\n\n\t\tvar rangeEnd = this._getStringPart(startEnd[1]);\n\t\tif (rangeEnd === 'AMJ') // Last column's code.\n\t\t\treturn true;\n\t\telse\n\t\t\treturn false;\n\t},\n\n\t_updateScrollOnCellSelection: function (oldSelection, newSelection) {\n\t\tif (this.isCalc() && oldSelection) {\n\t\t\tvar mapBounds = this._map.getBounds();\n\t\t\tif (!mapBounds.contains(newSelection) && !newSelection.equals(oldSelection)) {\n\t\t\t\tvar spacingX = Math.abs(this._cellCursor.getEast() - this._cellCursor.getWest()) / 4.0;\n\t\t\t\tvar spacingY = Math.abs((this._cellCursor.getSouth() - this._cellCursor.getNorth())) / 2.0;\n\n\t\t\t\tvar scrollX = 0, scrollY = 0;\n\t\t\t\tif (newSelection.getEast() > mapBounds.getEast() && newSelection.getEast() > oldSelection.getEast())\n\t\t\t\t\tscrollX = newSelection.getEast() - mapBounds.getEast() + spacingX;\n\t\t\t\telse if (newSelection.getWest() < mapBounds.getWest() && newSelection.getWest() < oldSelection.getWest())\n\t\t\t\t\tscrollX = newSelection.getWest() - mapBounds.getWest() - spacingX;\n\t\t\t\tif (newSelection.getNorth() > mapBounds.getNorth() && newSelection.getNorth() > oldSelection.getNorth())\n\t\t\t\t\tscrollY = newSelection.getNorth() - mapBounds.getNorth() + spacingY;\n\t\t\t\telse if (newSelection.getSouth() < mapBounds.getSouth() && newSelection.getSouth() < oldSelection.getSouth())\n\t\t\t\t\tscrollY = newSelection.getSouth() - mapBounds.getSouth() - spacingY;\n\t\t\t\tif (scrollX !== 0 || scrollY !== 0) {\n\t\t\t\t\tvar newCenter = mapBounds.getCenter();\n\t\t\t\t\tnewCenter.lng += scrollX;\n\t\t\t\t\tnewCenter.lat += scrollY;\n\t\t\t\t\tvar center = this._map.project(newCenter);\n\t\t\t\t\tcenter = center.subtract(this._map.getSize().divideBy(2));\n\t\t\t\t\tcenter.x = Math.round(center.x < 0 ? 0 : center.x);\n\t\t\t\t\tcenter.y = Math.round(center.y < 0 ? 0 : center.y);\n\t\t\t\t\tif (!this._map.wholeColumnSelected && !this._map.wholeRowSelected) {\n\t\t\t\t\t\tvar address = document.getElementById('addressInput').value;\n\t\t\t\t\t\tif (!this._isWholeColumnSelected(address) && !this._isWholeRowSelected(address))\n\t\t\t\t\t\t\tthis._map.fire('scrollto', {x: center.x, y: center.y});\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t},\n\n\t_onTextSelectionEndMsg: function (textMsg) {\n\t\tvar rectangles = this._getTextSelectionRectangles(textMsg);\n\n\t\tif (rectangles.length && this._map.isPermissionEdit()) {\n\t\t\tvar topLeftTwips = rectangles[0].getTopLeft();\n\t\t\tvar bottomRightTwips = rectangles[0].getBottomRight();\n\t\t\tvar oldSelection = this._textSelectionEnd;\n\t\t\tthis._textSelectionEnd = new L.LatLngBounds(\n\t\t\t\tthis._twipsToLatLng(topLeftTwips, this._map.getZoom()),\n\t\t\t\tthis._twipsToLatLng(bottomRightTwips, this._map.getZoom()));\n\n\t\t\tthis._updateScrollOnCellSelection(oldSelection, this._textSelectionEnd);\n\t\t\tthis._updateMarkers();\n\t\t}\n\t\telse {\n\t\t\tthis._textSelectionEnd = null;\n\t\t}\n\t},\n\n\t_onTextSelectionStartMsg: function (textMsg) {\n\t\tvar rectangles = this._getTextSelectionRectangles(textMsg);\n\n\t\tif (rectangles.length && this._map.isPermissionEdit()) {\n\t\t\tvar topLeftTwips = rectangles[0].getTopLeft();\n\t\t\tvar bottomRightTwips = rectangles[0].getBottomRight();\n\t\t\tvar oldSelection = this._textSelectionStart;\n\t\t\t//FIXME: The selection is really not two points, as they can be\n\t\t\t//FIXME: on top of each other, but on separate lines. We should\n\t\t\t//FIXME: capture the whole area in _onTextSelectionMsg.\n\t\t\tthis._textSelectionStart = new L.LatLngBounds(\n\t\t\t\tthis._twipsToLatLng(topLeftTwips, this._map.getZoom()),\n\t\t\t\tthis._twipsToLatLng(bottomRightTwips, this._map.getZoom()));\n\n\t\t\tthis._updateScrollOnCellSelection(oldSelection, this._textSelectionStart);\n\t\t}\n\t\telse {\n\t\t\tthis._textSelectionStart = null;\n\t\t}\n\t},\n\n\t_refreshRowColumnHeaders: function () {\n\t\tif (app.sectionContainer.doesSectionExist(L.CSections.RowHeader.name))\n\t\t\tapp.sectionContainer.getSectionWithName(L.CSections.RowHeader.name)._updateCanvas();\n\t\tif (app.sectionContainer.doesSectionExist(L.CSections.ColumnHeader.name))\n\t\t\tapp.sectionContainer.getSectionWithName(L.CSections.ColumnHeader.name)._updateCanvas();\n\t},\n\n\t_onCellSelectionAreaMsg: function (textMsg) {\n\t\tvar autofillMarkerSection = app.sectionContainer.getSectionWithName(L.CSections.AutoFillMarker.name);\n\t\tvar strTwips = textMsg.match(/\\d+/g);\n\t\tif (strTwips != null && this._map.isPermissionEdit()) {\n\t\t\tvar topLeftTwips = new L.Point(parseInt(strTwips[0]), parseInt(strTwips[1]));\n\t\t\tvar offset = new L.Point(parseInt(strTwips[2]), parseInt(strTwips[3]));\n\t\t\tvar bottomRightTwips = topLeftTwips.add(offset);\n\t\t\tvar boundsTwips = this._convertToTileTwipsSheetArea(\n\t\t\t\tnew L.Bounds(topLeftTwips, bottomRightTwips));\n\t\t\tvar oldSelection = this._cellSelectionArea;\n\t\t\tthis._cellSelectionArea = new L.LatLngBounds(\n\t\t\t\tthis._twipsToLatLng(boundsTwips.getTopLeft(), this._map.getZoom()),\n\t\t\t\tthis._twipsToLatLng(boundsTwips.getBottomRight(), this._map.getZoom()));\n\n\t\t\tvar offsetPixels = this._twipsToCorePixels(boundsTwips.getSize());\n\t\t\tvar start = this._twipsToCorePixels(boundsTwips.min);\n\t\t\tvar cellSelectionAreaPixels = L.LOUtil.createRectangle(start.x, start.y, offsetPixels.x, offsetPixels.y);\n\t\t\tif (autofillMarkerSection)\n\t\t\t\tautofillMarkerSection.calculatePositionViaCellSelection([cellSelectionAreaPixels.getX2(), cellSelectionAreaPixels.getY2()]);\n\n\t\t\tif (this._cellCursor === null) {\n\t\t\t\tthis._cellCursor = L.LatLngBounds.createDefault();\n\t\t\t}\n\t\t\tthis._updateScrollOnCellSelection(oldSelection, this._cellSelectionArea);\n\t\t} else {\n\t\t\tthis._cellSelectionArea = null;\n\t\t\tif (autofillMarkerSection)\n\t\t\t\tautofillMarkerSection.calculatePositionViaCellSelection(null);\n\t\t\tthis._cellSelections = Array(0);\n\t\t\tthis._map.wholeColumnSelected = false; // Message related to whole column/row selection should be on the way, we should update the variables now.\n\t\t\tthis._map.wholeRowSelected = false;\n\t\t\tif (this._refreshRowColumnHeaders)\n\t\t\t\tthis._refreshRowColumnHeaders();\n\t\t}\n\t},\n\n\t_onCellAutoFillAreaMsg: function (textMsg) {\n\t\tvar strTwips = textMsg.match(/\\d+/g);\n\t\tif (strTwips != null && this._map.isPermissionEdit()) {\n\t\t\tvar topLeftTwips = new L.Point(parseInt(strTwips[0]), parseInt(strTwips[1]));\n\t\t\tvar offset = new L.Point(parseInt(strTwips[2]), parseInt(strTwips[3]));\n\n\t\t\tvar topLeftPixels = this._twipsToCorePixels(topLeftTwips);\n\t\t\tvar offsetPixels = this._twipsToCorePixels(offset);\n\t\t\tthis._cellAutoFillAreaPixels = L.LOUtil.createRectangle(topLeftPixels.x, topLeftPixels.y, offsetPixels.x, offsetPixels.y);\n\t\t}\n\t\telse {\n\t\t\tthis._cellAutoFillAreaPixels = null;\n\t\t}\n\t},\n\n\t_onDialogPaintMsg: function(textMsg, img) {\n\t\tvar command = app.socket.parseServerCmd(textMsg);\n\n\t\t// app.socket.sendMessage('DEBUG _onDialogPaintMsg: hash=' + command.hash + ' img=' + typeof(img) + (typeof(img) == 'string' ? (' (length:' + img.length + ':\"' + img.substring(0, 30) + (img.length > 30 ? '...' : '') + '\")') : '') + ', cache size ' + this._pngCache.length);\n\t\tif (command.nopng) {\n\t\t\tvar found = false;\n\t\t\tfor (var i = 0; i < this._pngCache.length; i++) {\n\t\t\t\tif (this._pngCache[i].hash == command.hash) {\n\t\t\t\t\tfound = true;\n\t\t\t\t\t// app.socket.sendMessage('DEBUG - Found in cache');\n\t\t\t\t\timg = this._pngCache[i].img;\n\t\t\t\t\t// Remove item (and add it below at the start of the array)\n\t\t\t\t\tthis._pngCache.splice(i, 1);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (!found) {\n\t\t\t\tvar message = 'windowpaint: message assumed PNG for hash ' + command.hash\n\t\t\t\t    + ' is cached here in the client but not found';\n\t\t\t\tif (L.Browser.cypressTest)\n\t\t\t\t\tthrow new Error(message);\n\t\t\t\tapp.socket.sendMessage('ERROR ' + message);\n\t\t\t\t// Not sure what to do. Ask the server to re-send the windowpaint: message but this time including the PNG?\n\t\t\t}\n\t\t} else {\n\t\t\t// Sanity check: If we get a PNG it should be for a hash that we don't have cached\n\t\t\tfor (i = 0; i < this._pngCache.length; i++) {\n\t\t\t\tif (this._pngCache[i].hash == command.hash) {\n\t\t\t\t\tmessage = 'windowpaint: message included PNG for hash ' + command.hash\n\t\t\t\t\t    + ' even if it was already cached here in the client';\n\t\t\t\t\tif (L.Browser.cypressTest)\n\t\t\t\t\t\tthrow new Error(message);\n\t\t\t\t\tapp.socket.sendMessage('ERROR ' + message);\n\t\t\t\t\t// Remove the extra copy, code below will add it at the start of the array\n\t\t\t\t\tthis._pngCache.splice(i, 1);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// If cache is max size, drop the last element\n\t\tif (this._pngCache.length == app.socket.TunnelledDialogImageCacheSize) {\n\t\t\t// app.socket.sendMessage('DEBUG - Dropping last cache element');\n\t\t\tthis._pngCache.pop();\n\t\t}\n\n\t\t// Add element to cache\n\t\tthis._pngCache.unshift({hash: command.hash, img:img});\n\n\t\t// app.socket.sendMessage('DEBUG - Cache size now ' + this._pngCache.length);\n\n\t\tthis._map.fire('windowpaint', {\n\t\t\tid: command.id,\n\t\t\timg: img,\n\t\t\twidth: command.width,\n\t\t\theight: command.height,\n\t\t\trectangle: command.rectangle,\n\t\t\thash: command.hash\n\t\t});\n\t},\n\n\t_onDialogMsg: function(textMsg) {\n\t\ttextMsg = textMsg.substring('window: '.length);\n\t\tvar dialogMsg = JSON.parse(textMsg);\n\t\t// e.type refers to signal type\n\t\tdialogMsg.winType = dialogMsg.type;\n\t\tthis._map.fire('window', dialogMsg);\n\t},\n\n\t_tileOnError: function (done, tile, e) {\n\t\tvar errorUrl = this.options.errorTileUrl;\n\t\tif (errorUrl) {\n\t\t\ttile.src = errorUrl;\n\t\t}\n\t\tdone(e, tile);\n\t},\n\n\t_mapOnError: function (e) {\n\t\tif (e.msg && this._map.isPermissionEdit()) {\n\t\t\tthis._map.setPermission('view');\n\t\t}\n\t},\n\n\t_onTileRemove: function (e) {\n\t\te.tile.onload = null;\n\t},\n\n\t_clearSelections: function (calledFromSetPartHandler) {\n\t\t// hide the cursor if not editable\n\t\tthis._onUpdateCursor(calledFromSetPartHandler);\n\t\t// hide the text selection\n\t\tthis._textCSelections.clear();\n\t\t// hide the cell selection\n\t\tthis._cellCSelections.clear();\n\t\t// hide the ole selection\n\t\tthis._oleCSelections.clear();\n\t\t// hide the selection handles\n\t\tthis._onUpdateTextSelection();\n\t\t// hide the graphic selection\n\t\tthis._graphicSelection = new L.LatLngBounds(new L.LatLng(0, 0), new L.LatLng(0, 0));\n\t\tthis._onUpdateGraphicSelection();\n\t\tthis._cellCursor = null;\n\t\tthis._cellCursorXY = null;\n\t\tthis._prevCellCursor = null;\n\t\tthis._prevCellCursorXY = null;\n\t\tthis._onUpdateCellCursor();\n\t\tif (this._map._clip)\n\t\t\tthis._map._clip.clearSelection();\n\t\telse\n\t\t\tthis._selectedTextContent = '';\n\t},\n\n\tcontainsSelection: function (latlng) {\n\t\tvar corepxPoint = this._map.project(latlng);\n\t\treturn this._textCSelections.empty() ?\n\t\t\tthis._cellCSelections.contains(corepxPoint) :\n\t\t\tthis._textCSelections.contains(corepxPoint);\n\t},\n\n\t_clearReferences: function () {\n\t\tthis._references.clear();\n\n\t\tif (!this._referenceMarkerStart.isDragged)\n\t\t\tthis._map.removeLayer(this._referenceMarkerStart);\n\t\tif (!this._referenceMarkerEnd.isDragged)\n\t\t\tthis._map.removeLayer(this._referenceMarkerEnd);\n\t},\n\n\t_postMouseEvent: function(type, x, y, count, buttons, modifier) {\n\t\tif (!this._map._docLoaded)\n\t\t\treturn;\n\n\t\tif (this._map.calcInputBarHasFocus() && type === 'move') {\n\t\t\t// When the Formula-bar has the focus, sending\n\t\t\t// mouse move with the document coordinates\n\t\t\t// hides the cursor (lost focus?). This is clearly\n\t\t\t// a bug in Core, but we need to work around it\n\t\t\t// until fixed. Just don't send mouse move.\n\t\t\treturn;\n\t\t}\n\n\t\tthis._sendClientZoom();\n\n\t\tthis._sendClientVisibleArea();\n\n\t\tapp.socket.sendMessage('mouse type=' + type +\n\t\t\t\t' x=' + x + ' y=' + y + ' count=' + count +\n\t\t\t\t' buttons=' + buttons + ' modifier=' + modifier);\n\n\n\t\tif (type === 'buttondown') {\n\t\t\tthis._clearSearchResults();\n\t\t}\n\t},\n\n\t// Given a character code and a UNO keycode, send a \"key\" message to coolwsd.\n\t//\n\t// \"type\" is either \"input\" for key presses (akin to the DOM \"keypress\"\n\t// / \"beforeinput\" events) and \"up\" for key releases (akin to the DOM\n\t// \"keyup\" event).\n\t//\n\t// PageUp/PageDown and select column & row are handled as special cases for spreadsheets - in\n\t// addition of sending messages to coolwsd, they move the cell cursor around.\n\tpostKeyboardEvent: function(type, charCode, unoKeyCode) {\n\t\tif (!this._map._docLoaded)\n\t\t\treturn;\n\n\t\tif (this.isMacClient) {\n\t\t\t// Map Mac standard shortcuts to the LO shortcuts for the corresponding\n\t\t\t// functions when possible. Note that the Cmd modifier comes here as CTRL.\n\n\t\t\t// Cmd+UpArrow -> Ctrl+Home\n\t\t\tif (unoKeyCode == UNOKey.UP + UNOModifier.CTRL)\n\t\t\t\tunoKeyCode = UNOKey.HOME + UNOModifier.CTRL;\n\t\t\t// Cmd+DownArrow -> Ctrl+End\n\t\t\telse if (unoKeyCode == UNOKey.DOWN + UNOModifier.CTRL)\n\t\t\t\tunoKeyCode = UNOKey.END + UNOModifier.CTRL;\n\t\t\t// Cmd+LeftArrow -> Home\n\t\t\telse if (unoKeyCode == UNOKey.LEFT + UNOModifier.CTRL)\n\t\t\t\tunoKeyCode = UNOKey.HOME;\n\t\t\t// Cmd+RightArrow -> End\n\t\t\telse if (unoKeyCode == UNOKey.RIGHT + UNOModifier.CTRL)\n\t\t\t\tunoKeyCode = UNOKey.END;\n\t\t\t// Option+LeftArrow -> Ctrl+LeftArrow\n\t\t\telse if (unoKeyCode == UNOKey.LEFT + UNOModifier.ALT)\n\t\t\t\tunoKeyCode = UNOKey.LEFT + UNOModifier.CTRL;\n\t\t\t// Option+RightArrow -> Ctrl+RightArrow (Not entirely equivalent, should go\n\t\t\t// to end of word (or next), LO goes to beginning of next word.)\n\t\t\telse if (unoKeyCode == UNOKey.RIGHT + UNOModifier.ALT)\n\t\t\t\tunoKeyCode = UNOKey.RIGHT + UNOModifier.CTRL;\n\t\t}\n\n\t\tvar completeEvent = app.socket.createCompleteTraceEvent('L.TileSectionManager.postKeyboardEvent', { type: type, charCode: charCode });\n\n\t\tvar winId = this._map.getWinId();\n\t\tif (\n\t\t\tthis.isCalc() &&\n\t\t\tthis._prevCellCursor &&\n\t\t\ttype === 'input' &&\n\t\t\twinId === 0\n\t\t) {\n\t\t\tif (unoKeyCode === UNOKey.PAGEUP) {\n\t\t\t\tif (this._cellCursorOnPgUp) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tthis._cellCursorOnPgUp = new L.LatLngBounds(this._prevCellCursor.getSouthWest(), this._prevCellCursor.getNorthEast());\n\t\t\t}\n\t\t\telse if (unoKeyCode === UNOKey.PAGEDOWN) {\n\t\t\t\tif (this._cellCursorOnPgDn) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tthis._cellCursorOnPgDn = new L.LatLngBounds(this._prevCellCursor.getSouthWest(), this._prevCellCursor.getNorthEast());\n\t\t\t}\n\t\t\telse if (unoKeyCode === UNOKey.SPACE + UNOModifier.CTRL) { // Select whole column.\n\t\t\t\tthis._map.wholeColumnSelected = true;\n\t\t\t}\n\t\t\telse if (unoKeyCode === UNOKey.SPACE + UNOModifier.SHIFT) { // Select whole row.\n\t\t\t\tthis._map.wholeRowSelected = true;\n\t\t\t}\n\t\t}\n\n\t\tthis._sendClientZoom();\n\n\t\tthis._sendClientVisibleArea();\n\n\t\tif (winId === 0) {\n\t\t\tapp.socket.sendMessage(\n\t\t\t\t'key' +\n\t\t\t\t' type=' + type +\n\t\t\t\t' char=' + charCode +\n\t\t\t\t' key=' + unoKeyCode +\n\t\t\t\t'\\n'\n\t\t\t);\n\t\t} else {\n\t\t\tapp.socket.sendMessage(\n\t\t\t\t'windowkey id=' + winId +\n\t\t\t\t' type=' + type +\n\t\t\t\t' char=' + charCode +\n\t\t\t\t' key=' + unoKeyCode +\n\t\t\t\t'\\n'\n\t\t\t);\n\t\t}\n\t\tif (completeEvent)\n\t\t\tcompleteEvent.finish();\n\t},\n\n\t_postSelectTextEvent: function(type, x, y) {\n\t\tapp.socket.sendMessage('selecttext type=' + type +\n\t\t\t\t' x=' + x + ' y=' + y);\n\t},\n\n\t// Is rRectangle empty?\n\t_isEmptyRectangle: function (bounds) {\n\t\tif (!bounds) {\n\t\t\treturn true;\n\t\t}\n\t\treturn bounds.getSouthWest().equals(new L.LatLng(0, 0)) && bounds.getNorthEast().equals(new L.LatLng(0, 0));\n\t},\n\n\t_onZoomStart: function () {\n\t\tthis._isZooming = true;\n\t},\n\n\n\t_onZoomEnd: function () {\n\t\tthis._isZooming = false;\n\t\tif (!this.isCalc())\n\t\t\tthis._replayPrintTwipsMsgs();\n\t\tthis._onUpdateCursor(null, true);\n\t\tthis.updateAllViewCursors();\n\t},\n\n\t_updateCursorPos: function () {\n\t\tvar cursorPos = this._cursorCorePixels.getTopLeft();\n\t\tvar cursorSize = this._cursorCorePixels.getSize();\n\n\t\tif (!this._cursorMarker) {\n\t\t\tthis._cursorMarker = new Cursor(cursorPos, cursorSize, this._map, { blink: true });\n\t\t} else {\n\t\t\tthis._cursorMarker.setPositionSize(cursorPos, cursorSize);\n\t\t}\n\t},\n\n\t_allowViewJump: function() {\n\t\treturn (!this._map._clip || this._map._clip._selectionType !== 'complex') &&\n\t\t!this._referenceMarkerStart.isDragged && !this._referenceMarkerEnd.isDragged;\n\t},\n\n\t// Update cursor layer (blinking cursor).\n\t_onUpdateCursor: function (scroll, zoom, keepCaretPositionRelativeToScreen) {\n\n\t\tif (!this._visibleCursor ||\n\t\t\tthis._isEmptyRectangle(this._visibleCursor) ||\n\t\t\tthis._referenceMarkerStart.isDragged ||\n\t\t\tthis._referenceMarkerEnd.isDragged ||\n\t\t\tthis._map.ignoreCursorUpdate()) {\n\t\t\treturn;\n\t\t}\n\n\t\tvar cursorPos = this._visibleCursor.getNorthWest();\n\t\tvar docLayer = this._map._docLayer;\n\n\t\tif (!zoom\n\t\t&& scroll !== false\n\t\t&& this._map._isCursorVisible\n\t\t// Do not center view in Calc if no new cursor coordinates have arrived yet.\n\t\t// ie, 'invalidatecursor' has not arrived after 'cursorvisible' yet.\n\t\t&& (!this.isCalc() || this._lastVisibleCursorRef !== this._visibleCursor)\n\t\t&& this._allowViewJump()) {\n\n\t\t\tvar paneRectsInLatLng = this.getPaneLatLngRectangles();\n\n\t\t\tif (!this._visibleCursor.isInAny(paneRectsInLatLng)) {\n\t\t\t\tvar center = this._map.project(cursorPos);\n\t\t\t\tcenter = center.subtract(this._map.getSize().divideBy(2));\n\t\t\t\tcenter.x = Math.round(center.x < 0 ? 0 : center.x);\n\t\t\t\tcenter.y = Math.round(center.y < 0 ? 0 : center.y);\n\n\t\t\t\tif (!(this._selectionHandles.start && this._selectionHandles.start.isDragged) &&\n\t\t\t\t    !(this._selectionHandles.end && this._selectionHandles.end.isDragged) &&\n\t\t\t\t    !(docLayer._followEditor || docLayer._followUser) &&\n\t\t\t\t    !this._map.calcInputBarHasFocus()) {\n\t\t\t\t\tthis._map.fire('scrollto', {x: center.x, y: center.y});\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\telse if (keepCaretPositionRelativeToScreen) {\n\t\t\t/* We should be here when:\n\t\t\t\tAnother view updated the text.\n\t\t\t\tThat edit changed our cursor position.\n\t\t\tNow we already set the cursor position to another point.\n\t\t\tWe want to keep the cursor position at the same point relative to screen.\n\t\t\t*/\n\t\t\tvar y = this._cursorCorePixels.min.y - this._cursorPreviousPositionCorePixels.min.y;\n\t\t\tvar section = this._painter._sectionContainer.getSectionWithName(L.CSections.Scroll.name);\n\t\t\tif (section)\n\t\t\t\tsection.scrollVerticalWithOffset(y);\n\t\t}\n\n\t\tthis._updateCursorAndOverlay();\n\n\t\tthis.eachView(this._viewCursors, function (item) {\n\t\t\tvar viewCursorMarker = item.marker;\n\t\t\tif (viewCursorMarker) {\n\t\t\t\tviewCursorMarker.setOpacity(this.isCursorVisible() && this._cursorMarker.getPosition().equals(viewCursorMarker.getPosition()) ? 0 : 1);\n\t\t\t}\n\t\t}, this, true);\n\t},\n\n\tactivateCursor: function () {\n\t\tthis._replayPrintTwipsMsg('invalidatecursor');\n\t},\n\n\t_isAnyInputFocused: function() {\n\t\treturn $('input:focus').length > 0 || $('textarea.jsdialog:focus').length > 0;\n\t},\n\n\t// enable or disable blinking cursor and  the cursor overlay depending on\n\t// the state of the document (if the falgs are set)\n\t_updateCursorAndOverlay: function (/*update*/) {\n\t\tif (this._map.isPermissionEdit()\n\t\t&& this._map._isCursorVisible   // only when LOK has told us it is ok\n\t\t&& this._map.editorHasFocus()   // not when document is not focused\n\t\t&& !this._map.isSearching()  \t// not when searching within the doc\n\t\t&& !this._isZooming             // not when zooming\n\t\t&& !this._isEmptyRectangle(this._visibleCursor)) {\n\n\t\t\tthis._updateCursorPos();\n\n\t\t\tvar scrollSection = app.sectionContainer.getSectionWithName(L.CSections.Scroll.name);\n\t\t\tif (!scrollSection.sectionProperties.mouseIsOnVerticalScrollBar && !scrollSection.sectionProperties.mouseIsOnHorizontalScrollBar) {\n\t\t\t\tthis._map._textInput.showCursor();\n\t\t\t}\n\n\t\t\tvar hasMobileWizardOpened = this._map.uiManager.mobileWizard ? this._map.uiManager.mobileWizard.isOpen() : false;\n\t\t\tvar hasIframeModalOpened = $('.iframe-dialog-modal').is(':visible');\n\t\t\t// Don't show the keyboard when the Wizard is visible.\n\t\t\tif (!window.mobileWizard && !window.pageMobileWizard &&\n\t\t\t\t!window.insertionMobileWizard && !hasMobileWizardOpened &&\n\t\t\t\t!this._isAnyInputFocused() && !hasIframeModalOpened) {\n\t\t\t\t// If the user is editing, show the keyboard, but don't change\n\t\t\t\t// anything if nothing is changed.\n\n\t\t\t\t// We will focus map if no comment is being edited (writer only for now).\n\t\t\t\tif (this._docType === 'text') {\n\t\t\t\t\tvar section = app.sectionContainer.getSectionWithName(L.CSections.CommentList.name);\n\t\t\t\t\tif (!section || !section.sectionProperties.selectedComment || !section.sectionProperties.selectedComment.isEdit())\n\t\t\t\t\t\tthis._map.focus(true);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t\tthis._map.focus(true);\n\t\t\t}\n\t\t} else {\n\t\t\tthis._map._textInput.hideCursor();\n\t\t\t// Maintain input if a dialog or search-box has the focus.\n\t\t\tif (this._map.editorHasFocus() && !isAnyVexDialogActive() && !this._map.isSearching()\n\t\t\t\t&& !this._isAnyInputFocused())\n\t\t\t\tthis._map.focus(false);\n\t\t}\n\t},\n\n\t// Update colored non-blinking view cursor\n\t_onUpdateViewCursor: function (viewId) {\n\t\tif (typeof this._viewCursors[viewId] !== 'object' ||\n\t\t    typeof this._viewCursors[viewId].bounds !== 'object') {\n\t\t\treturn;\n\t\t}\n\n\t\tvar pixBounds = this._viewCursors[viewId].corepxBounds;\n\t\tvar viewCursorPos = pixBounds.getTopLeft();\n\t\tvar viewCursorMarker = this._viewCursors[viewId].marker;\n\t\tvar viewCursorVisible = this._viewCursors[viewId].visible;\n\t\tvar viewPart = this._viewCursors[viewId].part;\n\n\t\tif (!this._map.isViewReadOnly(viewId) &&\n\t\t    viewCursorVisible &&\n\t\t    !this._isZooming &&\n\t\t    !this._isEmptyRectangle(this._viewCursors[viewId].bounds) &&\n\t\t    (this.isWriter() || this._selectedPart === viewPart)) {\n\t\t\tif (!viewCursorMarker) {\n\t\t\t\tvar viewCursorOptions = {\n\t\t\t\t\tcolor: L.LOUtil.rgbToHex(this._map.getViewColor(viewId)),\n\t\t\t\t\tblink: false,\n\t\t\t\t\theader: true, // we want a 'hat' to our view cursors (which will contain view user names)\n\t\t\t\t\theaderTimeout: 3000, // hide after some interval\n\t\t\t\t\tzIndex: viewId,\n\t\t\t\t\theaderName: this._map.getViewName(viewId)\n\t\t\t\t};\n\t\t\t\tviewCursorMarker = new Cursor(viewCursorPos, pixBounds.getSize(), this._map, viewCursorOptions);\n\t\t\t\tthis._viewCursors[viewId].marker = viewCursorMarker;\n\t\t\t}\n\t\t\telse {\n\t\t\t\tviewCursorMarker.setPositionSize(viewCursorPos, pixBounds.getSize());\n\t\t\t}\n\t\t\tviewCursorMarker.setOpacity(this.isCursorVisible() && this._cursorMarker.getPosition().equals(viewCursorMarker.getPosition()) ? 0 : 1);\n\t\t\tif (!viewCursorMarker.isDomAttached())\n\t\t\t\tviewCursorMarker.add();\n\t\t}\n\t\telse if (viewCursorMarker && viewCursorMarker.isDomAttached()) {\n\t\t\tviewCursorMarker.remove();\n\t\t}\n\n\t\tif (this._viewCursors[viewId].marker && this._viewCursors[viewId].marker.isDomAttached())\n\t\t\tthis._viewCursors[viewId].marker.showCursorHeader();\n\t},\n\n\tupdateAllViewCursors: function() {\n\t\tfor (var key in this._viewCursors) {\n\t\t\tthis._onUpdateViewCursor(key);\n\t\t}\n\t},\n\n\tisCursorVisible: function() {\n\t\treturn this._cursorMarker ? this._cursorMarker.isDomAttached() : false;\n\t},\n\n\tgoToViewCursor: function(viewId) {\n\t\tif (viewId === this._viewId) {\n\t\t\tthis._onUpdateCursor();\n\t\t\treturn;\n\t\t}\n\n\t\tif (this._viewCursors[viewId] && this._viewCursors[viewId].visible && !this._isEmptyRectangle(this._viewCursors[viewId].bounds)) {\n\t\t\tif (!this._map.getBounds().contains(this._viewCursors[viewId].bounds)) {\n\t\t\t\tvar viewCursorPos = this._viewCursors[viewId].bounds.getNorthWest();\n\t\t\t\tvar center = this._map.project(viewCursorPos);\n\t\t\t\tcenter = center.subtract(this._map.getSize().divideBy(2));\n\t\t\t\tcenter.x = Math.round(center.x < 0 ? 0 : center.x);\n\t\t\t\tcenter.y = Math.round(center.y < 0 ? 0 : center.y);\n\n\t\t\t\tthis._map.fire('scrollto', {x: center.x, y: center.y});\n\t\t\t}\n\n\t\t\tthis._viewCursors[viewId].marker.showCursorHeader();\n\t\t}\n\t},\n\n\t_onUpdateTextViewSelection: function (viewId) {\n\t\tviewId = parseInt(viewId);\n\t\tvar viewPointSet = this._viewSelections[viewId].pointSet;\n\t\tvar viewSelection = this._viewSelections[viewId].selection;\n\t\tvar viewPart = this._viewSelections[viewId].part;\n\n\t\tif (viewPointSet &&\n\t\t    (this.isWriter() || this._selectedPart === viewPart)) {\n\n\t\t\tif (viewSelection) {\n\t\t\t\tif (!this._map.hasInfoForView(viewId)) {\n\t\t\t\t\tviewSelection.clear();\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\t// change previous selections\n\t\t\t\tviewSelection.setPointSet(viewPointSet);\n\t\t\t} else {\n\t\t\t\tviewSelection = new CSelections(viewPointSet, this._canvasOverlay,\n\t\t\t\t\tthis._selectionsDataDiv, this._map, true /* isView */, viewId, true /* isText */);\n\t\t\t\tthis._viewSelections[viewId].selection = viewSelection;\n\t\t\t}\n\t\t}\n\t\telse if (viewSelection) {\n\t\t\tviewSelection.clear();\n\t\t}\n\t},\n\n\t_onUpdateGraphicViewSelection: function (viewId) {\n\t\tvar viewBounds = this._graphicViewMarkers[viewId].bounds;\n\t\tvar viewMarker = this._graphicViewMarkers[viewId].marker;\n\t\tvar viewPart = this._graphicViewMarkers[viewId].part;\n\n\t\tif (!this._isEmptyRectangle(viewBounds) &&\n\t\t   (this.isWriter() || this._selectedPart === viewPart)) {\n\t\t\tif (!viewMarker) {\n\t\t\t\tvar color = L.LOUtil.rgbToHex(this._map.getViewColor(viewId));\n\t\t\t\tviewMarker = L.rectangle(viewBounds, {\n\t\t\t\t\tpointerEvents: 'auto',\n\t\t\t\t\tfill: false,\n\t\t\t\t\tcolor: color\n\t\t\t\t});\n\t\t\t\t// Disable autoPan, so the graphic view selection doesn't make the view jump to the popup.\n\t\t\t\tviewMarker.bindPopup(this._map.getViewName(viewId), {autoClose: false, autoPan: false, backgroundColor: color, color: 'white', closeButton: false});\n\t\t\t\tthis._graphicViewMarkers[viewId].marker = viewMarker;\n\t\t\t}\n\t\t\telse {\n\t\t\t\tviewMarker.setBounds(viewBounds);\n\t\t\t}\n\t\t\tthis._viewLayerGroup.addLayer(viewMarker);\n\t\t}\n\t\telse if (viewMarker) {\n\t\t\tthis._viewLayerGroup.removeLayer(viewMarker);\n\t\t}\n\t},\n\n\teachView: function (views, method, context, item) {\n\t\tfor (var key in views) {\n\t\t\tmethod.call(context, item ? views[key] : key);\n\t\t}\n\t},\n\n\t// Update dragged graphics selection\n\t_onGraphicMove: function (e) {\n\t\tif (!e.pos) { return; }\n\t\tvar aPos = this._latLngToTwips(e.pos);\n\t\tvar calcRTL = this.isCalcRTL();\n\t\tif (e.type === 'graphicmovestart') {\n\t\t\tthis._graphicMarker.isDragged = true;\n\t\t\tthis._graphicMarker.setVisible(true);\n\t\t\tthis._graphicMarker._startPos = aPos;\n\t\t}\n\t\telse if (e.type === 'graphicmoveend' && this._graphicMarker._startPos) {\n\t\t\tvar deltaPos = aPos.subtract(this._graphicMarker._startPos);\n\t\t\tif (deltaPos.x === 0 && deltaPos.y === 0) {\n\t\t\t\tthis._graphicMarker.isDragged = false;\n\t\t\t\tthis._graphicMarker.setVisible(false);\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tvar param;\n\t\t\tvar dragConstraint = this._graphicSelection.extraInfo.dragInfo;\n\t\t\tif (dragConstraint) {\n\t\t\t\tif (dragConstraint.dragMethod === 'PieSegmentDragging') {\n\n\t\t\t\t\tdeltaPos = this._twipsToPixels(deltaPos);\n\t\t\t\t\tvar dx = deltaPos.x;\n\t\t\t\t\tvar dy = deltaPos.y;\n\n\t\t\t\t\tvar initialOffset = dragConstraint.initialOffset;\n\t\t\t\t\tvar dragDirection = dragConstraint.dragDirection;\n\t\t\t\t\tvar additionalOffset = (dx * dragDirection.x + dy * dragDirection.y) / dragConstraint.range2;\n\t\t\t\t\tif (additionalOffset < -initialOffset)\n\t\t\t\t\t\tadditionalOffset = -initialOffset;\n\t\t\t\t\telse if (additionalOffset > (1.0 - initialOffset))\n\t\t\t\t\t\tadditionalOffset = 1.0 - initialOffset;\n\n\t\t\t\t\tvar offset = Math.round((initialOffset + additionalOffset) * 100);\n\n\t\t\t\t\t// hijacking the uno:TransformDialog msg for sending the new offset value\n\t\t\t\t\t// for the pie segment dragging method;\n\t\t\t\t\t// indeed there isn't any uno msg dispatching on the core side, but a chart controller dispatching\n\t\t\t\t\tparam = {\n\t\t\t\t\t\tAction: {\n\t\t\t\t\t\t\ttype: 'string',\n\t\t\t\t\t\t\tvalue: 'PieSegmentDragging'\n\t\t\t\t\t\t},\n\t\t\t\t\t\tOffset: {\n\t\t\t\t\t\t\ttype: 'long',\n\t\t\t\t\t\t\tvalue: offset\n\t\t\t\t\t\t}\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t}\n\t\t\telse {\n\t\t\t\tvar newPos = new L.Point(\n\t\t\t\t\t// Choose the logical left of the shape.\n\t\t\t\t\tthis._graphicSelectionTwips.min.x + deltaPos.x,\n\t\t\t\t\tthis._graphicSelectionTwips.min.y + deltaPos.y);\n\n\t\t\t\tvar size = this._graphicSelectionTwips.getSize();\n\n\t\t\t\tif (calcRTL) {\n\t\t\t\t\t// make x coordinate of newPos +ve\n\t\t\t\t\tnewPos.x = -newPos.x;\n\t\t\t\t}\n\n\t\t\t\t// try to keep shape inside document\n\t\t\t\tif (newPos.x + size.x > this._docWidthTwips)\n\t\t\t\t\tnewPos.x = this._docWidthTwips - size.x;\n\t\t\t\tif (newPos.x < 0)\n\t\t\t\t\tnewPos.x = 0;\n\n\t\t\t\tif (newPos.y + size.y > this._docHeightTwips)\n\t\t\t\t\tnewPos.y = this._docHeightTwips - size.y;\n\t\t\t\tif (newPos.y < 0)\n\t\t\t\t\tnewPos.y = 0;\n\n\t\t\t\tif (this.isCalc() && this.options.printTwipsMsgsEnabled) {\n\t\t\t\t\tnewPos = this.sheetGeometry.getPrintTwipsPointFromTile(newPos);\n\t\t\t\t}\n\n\t\t\t\t// restore the sign(negative) of x coordinate.\n\t\t\t\tif (calcRTL) {\n\t\t\t\t\tnewPos.x = -newPos.x;\n\t\t\t\t}\n\n\t\t\t\tparam = {\n\t\t\t\t\tTransformPosX: {\n\t\t\t\t\t\ttype: 'long',\n\t\t\t\t\t\tvalue: newPos.x\n\t\t\t\t\t},\n\t\t\t\t\tTransformPosY: {\n\t\t\t\t\t\ttype: 'long',\n\t\t\t\t\t\tvalue: newPos.y\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t}\n\t\t\tthis._map.sendUnoCommand('.uno:TransformDialog ', param);\n\t\t\tthis._graphicMarker.isDragged = false;\n\t\t\tthis._graphicMarker.setVisible(false);\n\t\t}\n\t},\n\n\t// Update dragged graphics selection resize.\n\t_onGraphicEdit: function (e) {\n\t\tif (!e.pos) { return; }\n\t\tif (!e.handleId) { return; }\n\n\t\tvar calcRTL = this.isCalcRTL();\n\t\tvar aPos = this._latLngToTwips(e.pos);\n\t\tvar selMin = this._graphicSelectionTwips.min;\n\t\tvar selMax = this._graphicSelectionTwips.max;\n\n\t\tvar handleId = e.handleId;\n\n\t\tif (e.type === 'scalestart') {\n\t\t\tthis._graphicMarker.isDragged = true;\n\t\t\tthis._graphicMarker.setVisible(true);\n\t\t\tif (selMax.x - selMin.x < 2)\n\t\t\t\tthis._graphicMarker.dragHorizDir = 0; // overlapping handles\n\t\t\telse if (Math.abs(selMin.x - aPos.x) < 2)\n\t\t\t\tthis._graphicMarker.dragHorizDir = -1; // left handle\n\t\t\telse if (Math.abs(selMax.x - aPos.x) < 2)\n\t\t\t\tthis._graphicMarker.dragHorizDir = 1; // right handle\n\t\t\tif (selMax.y - selMin.y < 2)\n\t\t\t\tthis._graphicMarker.dragVertDir = 0; // overlapping handles\n\t\t\telse if (Math.abs(selMin.y - aPos.y) < 2)\n\t\t\t\tthis._graphicMarker.dragVertDir = -1; // up handle\n\t\t\telse if (Math.abs(selMax.y - aPos.y) < 2)\n\t\t\t\tthis._graphicMarker.dragVertDir = 1; // down handle\n\t\t}\n\t\telse if (e.type === 'scaleend') {\n\t\t\t// fill params for uno command\n\t\t\tvar param = {\n\t\t\t\tHandleNum: {\n\t\t\t\t\ttype: 'long',\n\t\t\t\t\tvalue: handleId\n\t\t\t\t},\n\t\t\t\tNewPosX: {\n\t\t\t\t\ttype: 'long',\n\t\t\t\t\t// In Calc RTL mode ensure that we send positive X coordinates.\n\t\t\t\t\tvalue: calcRTL ? -aPos.x : aPos.x\n\t\t\t\t},\n\t\t\t\tNewPosY: {\n\t\t\t\t\ttype: 'long',\n\t\t\t\t\tvalue: aPos.y\n\t\t\t\t}\n\t\t\t};\n\t\t\tif (e.ordNum)\n\t\t\t{\n\t\t\t\tvar glueParams = {\n\t\t\t\t\tOrdNum: {\n\t\t\t\t\t\ttype: 'long',\n\t\t\t\t\t\tvalue: e.ordNum\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t\tparam = L.Util.extend({}, param, glueParams);\n\t\t\t}\n\n\t\t\tthis._map.sendUnoCommand('.uno:MoveShapeHandle', param);\n\t\t\tthis._graphicMarker.isDragged = false;\n\t\t\tthis._graphicMarker.setVisible(false);\n\t\t\tthis._graphicMarker.dragHorizDir = undefined;\n\t\t\tthis._graphicMarker.dragVertDir = undefined;\n\t\t}\n\t},\n\n\t_onGraphicRotate: function (e) {\n\t\tif (e.type === 'rotatestart') {\n\t\t\tthis._graphicMarker.isDragged = true;\n\t\t\tthis._graphicMarker.setVisible(true);\n\t\t}\n\t\telse if (e.type === 'rotateend') {\n\t\t\tvar center = this._graphicSelectionTwips.getCenter();\n\t\t\tif (this.isCalc() && this.options.printTwipsMsgsEnabled) {\n\t\t\t\tcenter = this.sheetGeometry.getPrintTwipsPointFromTile(center);\n\t\t\t}\n\t\t\tvar param = {\n\t\t\t\tTransformRotationDeltaAngle: {\n\t\t\t\t\ttype: 'long',\n\t\t\t\t\tvalue: (((e.rotation * 18000) / Math.PI))\n\t\t\t\t},\n\t\t\t\tTransformRotationX: {\n\t\t\t\t\ttype: 'long',\n\t\t\t\t\tvalue: center.x\n\t\t\t\t},\n\t\t\t\tTransformRotationY: {\n\t\t\t\t\ttype: 'long',\n\t\t\t\t\tvalue: center.y\n\t\t\t\t}\n\t\t\t};\n\t\t\tthis._map.sendUnoCommand('.uno:TransformDialog ', param);\n\t\t\tthis._graphicMarker.isDragged = false;\n\t\t\tthis._graphicMarker.setVisible(false);\n\t\t}\n\t},\n\n\t// Update dragged text selection.\n\t_onSelectionHandleDrag: function (e) {\n\t\tif (e.type === 'drag') {\n\t\t\twindow.IgnorePanning = true;\n\t\t\te.target.isDragged = true;\n\n\t\t\tif (!e.originalEvent.pageX && !e.originalEvent.pageY) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// This is rather hacky, but it seems to be the only way to make the\n\t\t\t// marker follow the mouse cursor if the document is autoscrolled under\n\t\t\t// us. (This can happen when we're changing the selection if the cursor\n\t\t\t// moves somewhere that is considered off screen.)\n\n\t\t\t// Onscreen position of the cursor, i.e. relative to the browser window\n\t\t\tvar boundingrect = e.target._icon.getBoundingClientRect();\n\t\t\tvar cursorPos = L.point(boundingrect.left, boundingrect.top);\n\n\t\t\tvar expectedPos = L.point(e.originalEvent.pageX, e.originalEvent.pageY).subtract(e.target.dragging._draggable.startOffset);\n\n\t\t\t// Dragging the selection handles vertically more than one line on a touch\n\t\t\t// device is more or less impossible without this hack.\n\t\t\tif (!(typeof e.originalEvent.type === 'string' && e.originalEvent.type === 'touchmove')) {\n\t\t\t\t// If the map has been scrolled, but the cursor hasn't been updated yet, then\n\t\t\t\t// the current mouse position differs.\n\t\t\t\tif (!expectedPos.equals(cursorPos)) {\n\t\t\t\t\tvar correction = expectedPos.subtract(cursorPos);\n\n\t\t\t\t\te.target.dragging._draggable._startPoint = e.target.dragging._draggable._startPoint.add(correction);\n\t\t\t\t\te.target.dragging._draggable._startPos = e.target.dragging._draggable._startPos.add(correction);\n\t\t\t\t\te.target.dragging._draggable._newPos = e.target.dragging._draggable._newPos.add(correction);\n\n\t\t\t\t\te.target.dragging._draggable._updatePosition();\n\t\t\t\t}\n\t\t\t}\n\t\t\tvar containerPos = new L.Point(expectedPos.x - this._map._container.getBoundingClientRect().left,\n\t\t\t\texpectedPos.y - this._map._container.getBoundingClientRect().top);\n\n\t\t\tcontainerPos = containerPos.add(e.target.dragging._draggable.startOffset);\n\t\t\tthis._map.fire('handleautoscroll', {pos: containerPos, map: this._map});\n\t\t}\n\t\tif (e.type === 'dragend') {\n\t\t\twindow.IgnorePanning = undefined;\n\t\t\te.target.isDragged = false;\n\t\t\tthis._map.fire('scrollvelocity', {vx: 0, vy: 0});\n\t\t}\n\n\t\tvar aPos = this._latLngToTwips(e.target.getLatLng());\n\n\t\tif (this._selectionHandles.start === e.target) {\n\t\t\tthis._postSelectTextEvent('start', aPos.x, aPos.y);\n\t\t}\n\t\telse if (this._selectionHandles.end === e.target) {\n\t\t\tthis._postSelectTextEvent('end', aPos.x, aPos.y);\n\t\t}\n\t},\n\n\t// Update dragged text selection.\n\t_onCellResizeMarkerDrag: function (e) {\n\t\tif (e.type === 'dragstart') {\n\t\t\te.target.isDragged = true;\n\t\t}\n\t\telse if (e.type === 'drag') {\n\t\t\tvar event = e.originalEvent;\n\t\t\tif (e.originalEvent.touches && e.originalEvent.touches.length > 0) {\n\t\t\t\tevent = e.originalEvent.touches[0];\n\t\t\t}\n\t\t\tif (!event.pageX && !event.pageY) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// handle scrolling\n\n\t\t\t// This is rather hacky, but it seems to be the only way to make the\n\t\t\t// marker follow the mouse cursor if the document is autoscrolled under\n\t\t\t// us. (This can happen when we're changing the selection if the cursor\n\t\t\t// moves somewhere that is considered off screen.)\n\n\t\t\t// Onscreen position of the cursor, i.e. relative to the browser window\n\t\t\tvar boundingrect = e.target._icon.getBoundingClientRect();\n\t\t\tvar cursorPos = L.point(boundingrect.left, boundingrect.top);\n\t\t\tvar expectedPos = L.point(event.pageX, event.pageY).subtract(e.target.dragging._draggable.startOffset);\n\n\t\t\t// Dragging the selection handles vertically more than one line on a touch\n\t\t\t// device is more or less impossible without this hack.\n\t\t\tif (!(typeof e.originalEvent.type === 'string' && e.originalEvent.type === 'touchmove')) {\n\t\t\t\t// If the map has been scrolled, but the cursor hasn't been updated yet, then\n\t\t\t\t// the current mouse position differs.\n\t\t\t\tif (!expectedPos.equals(cursorPos)) {\n\t\t\t\t\tvar correction = expectedPos.subtract(cursorPos);\n\n\t\t\t\t\te.target.dragging._draggable._startPoint = e.target.dragging._draggable._startPoint.add(correction);\n\t\t\t\t\te.target.dragging._draggable._startPos = e.target.dragging._draggable._startPos.add(correction);\n\t\t\t\t\te.target.dragging._draggable._newPos = e.target.dragging._draggable._newPos.add(correction);\n\n\t\t\t\t\te.target.dragging._draggable._updatePosition();\n\t\t\t\t}\n\t\t\t}\n\t\t\tvar containerPos = new L.Point(expectedPos.x - this._map._container.getBoundingClientRect().left,\n\t\t\t\texpectedPos.y - this._map._container.getBoundingClientRect().top);\n\n\t\t\tcontainerPos = containerPos.add(e.target.dragging._draggable.startOffset);\n\t\t\tthis._map.fire('handleautoscroll', {pos: containerPos, map: this._map});\n\t\t}\n\t\telse if (e.type === 'dragend') {\n\t\t\te.target.isDragged = false;\n\n\t\t\t// handle scrolling\n\t\t\tthis._map.focus();\n\t\t\tthis._map.fire('scrollvelocity', {vx: 0, vy: 0});\n\t\t}\n\n\t\t// modify the mouse position - move to center of the marker\n\t\tvar aMousePosition = e.target.getLatLng();\n\t\taMousePosition = this._map.project(aMousePosition);\n\t\tvar size;\n\t\tif (this._cellResizeMarkerStart === e.target) {\n\t\t\tsize = this._cellResizeMarkerStart._icon.getBoundingClientRect();\n\t\t}\n\t\telse if (this._cellResizeMarkerEnd === e.target) {\n\t\t\tsize = this._cellResizeMarkerEnd._icon.getBoundingClientRect();\n\t\t}\n\n\t\taMousePosition = aMousePosition.add(new L.Point(size.width / 2, size.height / 2));\n\t\taMousePosition = this._map.unproject(aMousePosition);\n\t\taMousePosition = this._latLngToTwips(aMousePosition);\n\n\t\tif (this._cellResizeMarkerStart === e.target) {\n\t\t\tthis._postSelectTextEvent('start', aMousePosition.x, aMousePosition.y);\n\t\t\tif (e.type === 'dragend') {\n\t\t\t\tthis._onUpdateCellResizeMarkers();\n\t\t\t\twindow.IgnorePanning = undefined;\n\t\t\t}\n\t\t}\n\t\telse if (this._cellResizeMarkerEnd === e.target) {\n\t\t\tthis._postSelectTextEvent('end', aMousePosition.x, aMousePosition.y);\n\t\t\tif (e.type === 'dragend') {\n\t\t\t\tthis._onUpdateCellResizeMarkers();\n\t\t\t\twindow.IgnorePanning = undefined;\n\t\t\t}\n\t\t}\n\t},\n\n\t_onReferenceMarkerDrag: function(e) {\n\t\tif (e.type === 'dragstart') {\n\t\t\te.target.isDragged = true;\n\t\t\twindow.IgnorePanning = true;\n\t\t}\n\t\telse if (e.type === 'drag') {\n\t\t\tvar startPos = this._map.project(this._referenceMarkerStart.getLatLng());\n\t\t\tvar startSize = this._referenceMarkerStart._icon.getBoundingClientRect();\n\t\t\tstartPos = startPos.add(new L.Point(startSize.width, startSize.height));\n\t\t\tvar start = this.sheetGeometry.getCellFromPos(this._latLngToTwips(this._map.unproject(startPos)), 'tiletwips');\n\n\t\t\tvar endPos = this._map.project(this._referenceMarkerEnd.getLatLng());\n\t\t\tvar endSize = this._referenceMarkerEnd._icon.getBoundingClientRect();\n\t\t\tendPos = endPos.subtract(new L.Point(endSize.width / 2, endSize.height / 2));\n\t\t\tvar end = this.sheetGeometry.getCellFromPos(this._latLngToTwips(this._map.unproject(endPos)), 'tiletwips');\n\n\t\t\tthis._sendReferenceRangeCommand(start.x, start.y, end.x, end.y);\n\t\t}\n\t\telse if (e.type === 'dragend') {\n\t\t\te.target.isDragged = false;\n\t\t\twindow.IgnorePanning = undefined;\n\t\t\tthis._updateReferenceMarks();\n\t\t}\n\t},\n\n\t_sendReferenceRangeCommand: function(startCol, startRow, endCol, endRow) {\n\t\tthis._map.sendUnoCommand(\n\t\t\t'.uno:CurrentFormulaRange?StartCol=' + startCol +\n\t\t\t'&StartRow=' + startRow +\n\t\t\t'&EndCol=' + endCol +\n\t\t\t'&EndRow=' + endRow +\n\t\t\t'&Table=' + this._map._docLayer._selectedPart\n\t\t);\n\t},\n\n\t_onDropDownButtonClick: function () {\n\t\tif (this._validatedCellXY && this._cellCursorXY && this._validatedCellXY.equals(this._cellCursorXY)) {\n\t\t\tthis._map.sendUnoCommand('.uno:DataSelect');\n\t\t}\n\t},\n\n\t// Update group layer selection handler.\n\t_onUpdateGraphicSelection: function () {\n\t\tif (this._graphicSelection && !this._isEmptyRectangle(this._graphicSelection)) {\n\t\t\t// Hide the keyboard on graphic selection, unless cursor is visible.\n\t\t\t// Don't interrupt editing in dialogs\n\t\t\tif (!this._isAnyInputFocused())\n\t\t\t\tthis._map.focus(this.isCursorVisible());\n\n\t\t\tif (this._graphicMarker) {\n\t\t\t\tthis._graphicMarker.removeEventParent(this._map);\n\t\t\t\tthis._graphicMarker.off('scalestart scaleend', this._onGraphicEdit, this);\n\t\t\t\tthis._graphicMarker.off('rotatestart rotateend', this._onGraphicRotate, this);\n\t\t\t\tif (this._graphicMarker.dragging)\n\t\t\t\t\tthis._graphicMarker.dragging.disable();\n\t\t\t\tthis._graphicMarker.transform.disable();\n\t\t\t\tthis._map.removeLayer(this._graphicMarker);\n\t\t\t}\n\n\t\t\tif (!this._map.isPermissionEdit()) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tvar extraInfo = this._graphicSelection.extraInfo;\n\t\t\tthis._graphicMarker = L.svgGroup(this._graphicSelection, {\n\t\t\t\tdraggable: extraInfo.isDraggable,\n\t\t\t\tdragConstraint: extraInfo.dragInfo,\n\t\t\t\tsvg: this._map._cacheSVG[extraInfo.id],\n\t\t\t\ttransform: true,\n\t\t\t\tstroke: false,\n\t\t\t\tfillOpacity: 0,\n\t\t\t\tfill: true\n\t\t\t});\n\n\t\t\tif (!this._graphicMarker) {\n\t\t\t\tthis._map.fire('error', {msg: 'Graphic marker initialization', cmd: 'marker', kind: 'failed', id: 1});\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis._graphicMarker.on('graphicmovestart graphicmoveend', this._onGraphicMove, this);\n\t\t\tthis._graphicMarker.on('scalestart scaleend', this._onGraphicEdit, this);\n\t\t\tthis._graphicMarker.on('rotatestart rotateend', this._onGraphicRotate, this);\n\t\t\tthis._map.addLayer(this._graphicMarker);\n\t\t\tif (extraInfo.isDraggable)\n\t\t\t\tthis._graphicMarker.dragging.enable();\n\t\t\tthis._graphicMarker.transform.enable({\n\t\t\t\tscaling: extraInfo.isResizable,\n\t\t\t\trotation: extraInfo.isRotatable && !this.hasTableSelection(),\n\t\t\t\tuniformScaling: this._shouldScaleUniform(extraInfo),\n\t\t\t\tisRotated: !this._isGraphicAngleDivisibleBy90(),\n\t\t\t\thandles: (extraInfo.handles) ? extraInfo.handles.kinds || [] : [],\n\t\t\t\tshapes: (extraInfo.GluePoints) ? extraInfo.GluePoints.shapes : [],\n\t\t\t\tshapeType: extraInfo.type,\n\t\t\t\tscaleSouthAndEastOnly: this.hasTableSelection()});\n\t\t\tif (extraInfo.dragInfo && extraInfo.dragInfo.svg) {\n\t\t\t\tthis._graphicMarker.removeEmbeddedSVG();\n\t\t\t\tthis._graphicMarker.addEmbeddedSVG(extraInfo.dragInfo.svg);\n\t\t\t}\n\t\t\tthis._hasActiveSelection = true;\n\t\t}\n\t\telse if (this._graphicMarker) {\n\t\t\tthis._graphicMarker.off('graphicmovestart graphicmoveend', this._onGraphicMove, this);\n\t\t\tthis._graphicMarker.off('scalestart scaleend', this._onGraphicEdit, this);\n\t\t\tthis._graphicMarker.off('rotatestart rotateend', this._onGraphicRotate, this);\n\t\t\tif (this._graphicMarker.dragging)\n\t\t\t\tthis._graphicMarker.dragging.disable();\n\t\t\tthis._graphicMarker.transform.disable();\n\t\t\tthis._map.removeLayer(this._graphicMarker);\n\t\t\tthis._graphicMarker.isDragged = false;\n\t\t\tthis._graphicMarker.setVisible(false);\n\t\t}\n\t\tthis._updateCursorAndOverlay();\n\t},\n\n\t_onUpdateCellCursor: function (horizontalDirection, verticalDirection, onPgUpDn) {\n\t\tthis._onUpdateCellResizeMarkers();\n\t\tif (this._cellCursor && !this._isEmptyRectangle(this._cellCursor)) {\n\t\t\tvar mapBounds = this._map.getBounds();\n\t\t\tif (!this._cellCursorXY.equals(this._prevCellCursorXY) &&\n\t\t\t    !this._map.calcInputBarHasFocus()) {\n\t\t\t\tvar scroll = this._calculateScrollForNewCellCursor();\n\t\t\t\twindow.app.console.assert(scroll instanceof L.LatLng, '_calculateScrollForNewCellCursor returned wrong type');\n\t\t\t\tif (scroll.lng !== 0 || scroll.lat !== 0) {\n\t\t\t\t\tvar newCenter = mapBounds.getCenter();\n\t\t\t\t\tnewCenter.lng += scroll.lng;\n\t\t\t\t\tnewCenter.lat += scroll.lat;\n\t\t\t\t\tvar center = this._map.project(newCenter);\n\t\t\t\t\tcenter = center.subtract(this._map.getSize().divideBy(2));\n\t\t\t\t\tcenter.x = Math.round(center.x < 0 ? 0 : center.x);\n\t\t\t\t\tcenter.y = Math.round(center.y < 0 ? 0 : center.y);\n\t\t\t\t\tthis._map.fire('scrollto', {x: center.x, y: center.y});\n\t\t\t\t}\n\t\t\t\tthis._prevCellCursorXY = this._cellCursorXY;\n\t\t\t}\n\n\t\t\tif (onPgUpDn) {\n\t\t\t\tthis._cellCursorOnPgUp = null;\n\t\t\t\tthis._cellCursorOnPgDn = null;\n\t\t\t}\n\n\t\t\tvar corePxBounds = this._twipsToCorePixelsBounds(this._cellCursorTwips);\n\t\t\tcorePxBounds.round();\n\t\t\tif (this._cellCursorMarker) {\n\t\t\t\tthis._cellCursorMarker.setBounds(corePxBounds);\n\t\t\t\tthis._map.removeLayer(this._dropDownButton);\n\t\t\t}\n\t\t\telse {\n\t\t\t\tvar cursorStyle = new CStyleData(this._cursorDataDiv);\n\t\t\t\tvar weight = cursorStyle.getFloatPropWithoutUnit('border-top-width');\n\t\t\t\tthis._cellCursorMarker = new CCellCursor(\n\t\t\t\t\tcorePxBounds,\n\t\t\t\t\t{\n\t\t\t\t\t\tname: 'cell-cursor',\n\t\t\t\t\t\tpointerEvents: 'none',\n\t\t\t\t\t\tfill: false,\n\t\t\t\t\t\tcolor: cursorStyle.getPropValue('border-top-color'),\n\t\t\t\t\t\tweight: Math.round(weight * app.dpiScale)\n\t\t\t\t\t});\n\t\t\t\tif (!this._cellCursorMarker) {\n\t\t\t\t\tthis._map.fire('error', {msg: 'Cell Cursor marker initialization', cmd: 'cellCursor', kind: 'failed', id: 1});\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tthis._canvasOverlay.initPathGroup(this._cellCursorMarker);\n\t\t\t}\n\n\t\t\tthis._addDropDownMarker();\n\n\t\t\tvar hasTunneledDialogOpened = this._map.dialog ? this._map.dialog.hasOpenedDialog() : false;\n\t\t\tvar hasJSDialogOpened = this._map.jsdialog ? this._map.jsdialog.hasDialogOpened() : false;\n\n\t\t\tvar dontFocusDocument = hasTunneledDialogOpened || hasJSDialogOpened || app.view.commentHasFocus || this._isAnyInputFocused();\n\n\t\t\t// when the cell cursor is moving, the user is in the document,\n\t\t\t// and the focus should leave the cell input bar\n\t\t\t// exception: when dialog opened don't focus the document\n\t\t\tif (!dontFocusDocument)\n\t\t\t\tthis._map.fire('editorgotfocus');\n\t\t}\n\t\telse if (this._cellCursorMarker) {\n\t\t\tthis._canvasOverlay.removePathGroup(this._cellCursorMarker);\n\t\t\tthis._cellCursorMarker = undefined;\n\t\t}\n\t\tthis._removeDropDownMarker();\n\n\t\t//hyperlink pop-up from here\n\t\tif (this._lastFormula && this._cellCursorMarker && this._lastFormula.substring(1, 10) == 'HYPERLINK')\n\t\t{\n\t\t\tvar formula = this._lastFormula;\n\t\t\tvar targetURL = formula.substring(11, formula.length - 1).split(',')[0];\n\t\t\ttargetURL = targetURL.split('\"').join('');\n\t\t\ttargetURL = this._map.makeURLFromStr(targetURL);\n\n\t\t\tthis._closeURLPopUp();\n\t\t\tif (targetURL) {\n\t\t\t\tthis._showURLPopUp(this._cellCursor.getNorthEast(), targetURL);\n\t\t\t}\n\n\t\t}\n\t\telse if (this._map.hyperlinkPopup)\n\t\t{\n\t\t\tthis._closeURLPopUp();\n\t\t}\n\t},\n\n\t_onValidityListButtonMsg: function(textMsg) {\n\t\tvar strXY = textMsg.match(/\\d+/g);\n\t\tvar validatedCell = new L.Point(parseInt(strXY[0]), parseInt(strXY[1]));\n\t\tvar show = parseInt(strXY[2]) === 1;\n\t\tif (show) {\n\t\t\tif (this._validatedCellXY && !this._validatedCellXY.equals(validatedCell)) {\n\t\t\t\tthis._validatedCellXY = null;\n\t\t\t\tthis._removeDropDownMarker();\n\t\t\t}\n\t\t\tthis._validatedCellXY = validatedCell;\n\t\t\tthis._addDropDownMarker();\n\t\t}\n\t\telse if (this._validatedCellXY && this._validatedCellXY.equals(validatedCell)) {\n\t\t\tthis._validatedCellXY = null;\n\t\t\tthis._removeDropDownMarker();\n\t\t}\n\t},\n\n\t_onValidityInputHelpMsg: function(textMsg) {\n\t\tvar message = textMsg.replace('validityinputhelp: ', '');\n\t\tmessage = JSON.parse(message);\n\n\t\tvar icon = L.divIcon({\n\t\t\thtml: '<div class=\"input-help\"><h4 id=\"input-help-title\"></h4><p id=\"input-help-content\"></p></div>',\n\t\t\ticonSize: [0, 0],\n\t\t\ticonAnchor: [0, 0]\n\t\t});\n\n\t\tthis._removeInputHelpMarker();\n\t\tvar inputHelpMarker = L.marker(this._cellCursor.getNorthEast(), { icon: icon });\n\t\tinputHelpMarker.addTo(this._map);\n\t\tdocument.getElementById('input-help-title').innerText = message.title;\n\t\tdocument.getElementById('input-help-content').innerText = message.content;\n\t\tthis._inputHelpPopUp = inputHelpMarker;\n\t},\n\n\t_addDropDownMarker: function () {\n\t\tif (this._validatedCellXY && this._cellCursorXY && this._validatedCellXY.equals(this._cellCursorXY)) {\n\t\t\tvar pos = this._cellCursor.getNorthEast();\n\t\t\tvar dropDownMarker = this._getDropDownMarker(16);\n\t\t\tdropDownMarker.setLatLng(pos);\n\t\t\tthis._map.addLayer(dropDownMarker);\n\t\t}\n\t},\n\n\t_removeDropDownMarker: function () {\n\t\tif (!this._validatedCellXY && this._dropDownButton)\n\t\t\tthis._map.removeLayer(this._dropDownButton);\n\t},\n\n\t_getDropDownMarker: function (dropDownSize) {\n\t\tif (dropDownSize) {\n\t\t\tvar icon =  L.divIcon({\n\t\t\t\tclassName: 'spreadsheet-drop-down-marker',\n\t\t\t\ticonSize: [dropDownSize, dropDownSize],\n\t\t\t\ticonAnchor: [0, 0]\n\t\t\t});\n\t\t\tthis._dropDownButton.setIcon(icon);\n\t\t}\n\t\treturn this._dropDownButton;\n\t},\n\n\t_onUpdateCellResizeMarkers: function () {\n\t\tvar selectionOnDesktop = window.mode.isDesktop()\n\t\t\t\t\t\t\t\t\t&& (this._cellSelectionArea\n\t\t\t\t\t\t\t\t\t|| (this._cellCursor && !this._isEmptyRectangle(this._cellCursor)));\n\n\t\tif (!selectionOnDesktop &&\n\t\t\t(!this._cellCSelections.empty() || (this._cellCursor && !this._isEmptyRectangle(this._cellCursor)))) {\n\t\t\tif (this._isEmptyRectangle(this._cellSelectionArea) && this._isEmptyRectangle(this._cellCursor)) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tvar cellRectangle = this._cellSelectionArea ? this._cellSelectionArea : this._cellCursor;\n\n\t\t\tif (!this._cellResizeMarkerStart.isDragged) {\n\t\t\t\tthis._map.addLayer(this._cellResizeMarkerStart);\n\t\t\t\tvar posStart = this._map.project(cellRectangle.getNorthWest());\n\t\t\t\tvar sizeStart = this._cellResizeMarkerStart._icon.getBoundingClientRect();\n\t\t\t\tposStart = posStart.subtract(new L.Point(sizeStart.width / 2, sizeStart.height / 2));\n\t\t\t\tposStart = this._map.unproject(posStart);\n\t\t\t\tthis._cellResizeMarkerStart.setLatLng(posStart);\n\t\t\t}\n\t\t\tif (!this._cellResizeMarkerEnd.isDragged) {\n\t\t\t\tthis._map.addLayer(this._cellResizeMarkerEnd);\n\t\t\t\tvar posEnd = this._map.project(cellRectangle.getSouthEast());\n\t\t\t\tvar sizeEnd = this._cellResizeMarkerEnd._icon.getBoundingClientRect();\n\t\t\t\tposEnd = posEnd.subtract(new L.Point(sizeEnd.width / 2, sizeEnd.height / 2));\n\t\t\t\tposEnd = this._map.unproject(posEnd);\n\t\t\t\tthis._cellResizeMarkerEnd.setLatLng(posEnd);\n\t\t\t}\n\t\t}\n\t\telse if (selectionOnDesktop) {\n\t\t\tthis._map.removeLayer(this._cellResizeMarkerStart);\n\t\t\tthis._map.removeLayer(this._cellResizeMarkerEnd);\n\t\t} else {\n\t\t\tthis._map.removeLayer(this._cellResizeMarkerStart);\n\t\t\tthis._map.removeLayer(this._cellResizeMarkerEnd);\n\t\t}\n\t},\n\n\t// Update text selection handlers.\n\t_onUpdateTextSelection: function () {\n\t\tthis._onUpdateCellResizeMarkers();\n\n\t\tvar startMarker = this._selectionHandles['start'];\n\t\tvar endMarker = this._selectionHandles['end'];\n\n\t\tif (this._map.editorHasFocus() && (!this._textCSelections.empty() || startMarker.isDragged || endMarker.isDragged)) {\n\t\t\tthis._updateMarkers();\n\t\t}\n\t\telse {\n\t\t\tthis._updateMarkers();\n\t\t\tthis._removeSelection();\n\t\t}\n\t},\n\n\t_removeSelection: function() {\n\t\tthis._textSelectionStart = null;\n\t\tthis._textSelectionEnd = null;\n\t\tthis._selectedTextContent = '';\n\t\tfor (var key in this._selectionHandles) {\n\t\t\tthis._map.removeLayer(this._selectionHandles[key]);\n\t\t\tthis._selectionHandles[key].isDragged = false;\n\t\t}\n\t\tthis._textCSelections.clear();\n\t},\n\n\t_updateMarkers: function() {\n\t\tif (!this._map._isCursorVisible)\n\t\t\treturn;\n\t\tvar startMarker = this._selectionHandles['start'];\n\t\tvar endMarker = this._selectionHandles['end'];\n\n\t\tif (!startMarker || !endMarker ||\n\t\t    this._isEmptyRectangle(this._textSelectionStart) ||\n\t\t    this._isEmptyRectangle(this._textSelectionEnd)) {\n\t\t\treturn;\n\t\t}\n\n\t\tvar startPos = this._map.project(this._textSelectionStart.getSouthWest());\n\t\tvar endPos = this._map.project(this._textSelectionEnd.getSouthWest());\n\t\tvar startMarkerPos = this._map.project(startMarker.getLatLng());\n\t\t// CalcRTL: position from core are in document coordinates. Conversion to layer coordinates for each maker is done\n\t\t// in L.Layer.getLayerPositionVisibility(). Icons of RTL \"start\" and \"end\" has to be interchanged.\n\t\tvar calcRTL = this.isCalcRTL();\n\t\tif (startMarkerPos.distanceTo(endPos) < startMarkerPos.distanceTo(startPos) && startMarker._icon && endMarker._icon) {\n\t\t\t// if the start marker is actually closer to the end of the selection\n\t\t\t// reverse icons and markers\n\t\t\tL.DomUtil.removeClass(startMarker._icon, calcRTL ? 'leaflet-selection-marker-end' : 'leaflet-selection-marker-start');\n\t\t\tL.DomUtil.removeClass(endMarker._icon, calcRTL ? 'leaflet-selection-marker-start' : 'leaflet-selection-marker-end');\n\t\t\tL.DomUtil.addClass(startMarker._icon, calcRTL ? 'leaflet-selection-marker-start' : 'leaflet-selection-marker-end');\n\t\t\tL.DomUtil.addClass(endMarker._icon, calcRTL ? 'leaflet-selection-marker-end' : 'leaflet-selection-marker-start');\n\t\t\tvar tmp = startMarker;\n\t\t\tstartMarker = endMarker;\n\t\t\tendMarker = tmp;\n\t\t}\n\t\telse if (startMarker._icon && endMarker._icon) {\n\t\t\t// normal markers and normal icons\n\t\t\tL.DomUtil.removeClass(startMarker._icon, calcRTL ? 'leaflet-selection-marker-start' : 'leaflet-selection-marker-end');\n\t\t\tL.DomUtil.removeClass(endMarker._icon, calcRTL ? 'leaflet-selection-marker-end' : 'leaflet-selection-marker-start');\n\t\t\tL.DomUtil.addClass(startMarker._icon, calcRTL ? 'leaflet-selection-marker-end' : 'leaflet-selection-marker-start');\n\t\t\tL.DomUtil.addClass(endMarker._icon, calcRTL ? 'leaflet-selection-marker-start' : 'leaflet-selection-marker-end');\n\t\t}\n\n\t\tif (!startMarker.isDragged) {\n\t\t\tvar pos = this._map.project(this._textSelectionStart.getSouthWest());\n\t\t\tpos = this._map.unproject(pos);\n\t\t\tstartMarker.setLatLng(pos);\n\t\t\tthis._map.addLayer(startMarker);\n\t\t}\n\n\t\tif (!endMarker.isDragged) {\n\t\t\tpos = this._map.project(this._textSelectionEnd.getSouthEast());\n\t\t\tpos = this._map.unproject(pos);\n\t\t\tendMarker.setLatLng(pos);\n\t\t\tthis._map.addLayer(endMarker);\n\t\t}\n\t},\n\n\thasGraphicSelection: function() {\n\t\treturn (this._graphicSelection !== null &&\n\t\t\t!this._isEmptyRectangle(this._graphicSelection));\n\t},\n\n\t_onDragOver: function (e) {\n\t\te = e.originalEvent;\n\t\te.preventDefault();\n\t},\n\n\t_onDrop: function (e) {\n\t\t// Move the cursor, so that the insert position is as close to the drop coordinates as possible.\n\t\tvar latlng = e.latlng;\n\t\tvar docLayer = this._map._docLayer;\n\t\tvar mousePos = docLayer._latLngToTwips(latlng);\n\t\tvar count = 1;\n\t\tvar buttons = 1;\n\t\tvar modifier = this._map.keyboard.modifier;\n\t\tthis._postMouseEvent('buttondown', mousePos.x, mousePos.y, count, buttons, modifier);\n\t\tthis._postMouseEvent('buttonup', mousePos.x, mousePos.y, count, buttons, modifier);\n\n\t\te = e.originalEvent;\n\t\te.preventDefault();\n\n\t\tif (this._map._clip) {\n\t\t\t// Always capture the html content separate as we may lose it when we\n\t\t\t// pass the clipboard data to a different context (async calls, f.e.).\n\t\t\tvar htmlText = e.dataTransfer.getData('text/html');\n\t\t\tthis._map._clip.dataTransferToDocument(e.dataTransfer, /* preferInternal = */ false, htmlText);\n\t\t}\n\t},\n\n\t_onDragStart: function () {\n\t\tthis._map.on('moveend', this._updateScrollOffset, this);\n\t},\n\n\t_onRequestLOKSession: function () {\n\t\tapp.socket.sendMessage('requestloksession');\n\t},\n\n\t// This is really just called on zoomend\n\t_fitWidthZoom: function (e, maxZoom) {\n\t\tif (this.isCalc())\n\t\t\treturn;\n\n\t\tif (isNaN(this._docWidthTwips)) { return; }\n\t\tvar oldSize = e ? e.oldSize : this._map.getSize();\n\t\tvar newSize = e ? e.newSize : this._map.getSize();\n\n\t\tnewSize.x *= app.dpiScale;\n\t\tnewSize.y *= app.dpiScale;\n\t\toldSize.x *= app.dpiScale;\n\t\toldSize.y *= app.dpiScale;\n\n\t\tif (this.isWriter() && newSize.x - oldSize.x === 0) { return; }\n\n\t\tvar widthTwips = newSize.x * this._tileWidthTwips / this._tileSize;\n\t\tvar ratio = widthTwips / this._docWidthTwips;\n\n\t\tmaxZoom = maxZoom ? maxZoom : 10;\n\t\tvar zoom = this._map.getScaleZoom(ratio, 10);\n\n\t\tzoom = Math.min(maxZoom, Math.max(0.1, zoom));\n\t\t// Not clear why we wanted to zoom in the past.\n\t\t// This resets the view & scroll area and does a 'panTo'\n\t\t// to keep the cursor in view.\n\t\t// But of course, zoom to fit the first time.\n\t\tif (this._firstFitDone)\n\t\t\tzoom = this._map._zoom;\n\t\tthis._firstFitDone = true;\n\n\t\tif (zoom > 1)\n\t\t\tzoom = Math.floor(zoom);\n\n\t\tthis._map.setZoom(zoom, {animate: false});\n\t},\n\n\t_onCurrentPageUpdate: function () {\n\t\tif (!this._map)\n\t\t\treturn;\n\n\t\tvar mapCenter = this._map.project(this._map.getCenter());\n\t\tif (!this._partPageRectanglesPixels || !(this._currentPage >= 0) || this._currentPage >= this._partPageRectanglesPixels.length ||\n\t\t\t\tthis._partPageRectanglesPixels[this._currentPage].contains(mapCenter)) {\n\t\t\t// page number has not changed\n\t\t\treturn;\n\t\t}\n\t\tfor (var i = 0; i < this._partPageRectanglesPixels.length; i++) {\n\t\t\tif (this._partPageRectanglesPixels[i].contains(mapCenter)) {\n\t\t\t\tthis._currentPage = i;\n\t\t\t\tthis._map.fire('pagenumberchanged', {\n\t\t\t\t\tcurrentPage: this._currentPage,\n\t\t\t\t\tpages: this._pages,\n\t\t\t\t\tdocType: this._docType\n\t\t\t\t});\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t},\n\n\t// Cells can change position during changes of zoom level in calc\n\t// hence we need to request an updated cell cursor position for this level.\n\t_onCellCursorShift: function (force) {\n\t\tif ((this._cellCursorMarker && !this.options.sheetGeometryDataEnabled) || force) {\n\t\t\tthis.requestCellCursor();\n\t\t}\n\t},\n\n\trequestCellCursor: function() {\n\t\tapp.socket.sendMessage('commandvalues command=.uno:CellCursor'\n\t\t\t+ '?outputHeight=' + this._tileWidthPx\n\t\t\t+ '&outputWidth=' + this._tileHeightPx\n\t\t\t+ '&tileHeight=' + this._tileWidthTwips\n\t\t\t+ '&tileWidth=' + this._tileHeightTwips);\n\t},\n\n\t_invalidatePreviews: function () {\n\t\tif (this._map && this._map._docPreviews && this._previewInvalidations.length > 0) {\n\t\t\tvar toInvalidate = {};\n\t\t\tfor (var i = 0; i < this._previewInvalidations.length; i++) {\n\t\t\t\tvar invalidBounds = this._previewInvalidations[i];\n\t\t\t\tfor (var key in this._map._docPreviews) {\n\t\t\t\t\t// find preview tiles that need to be updated and add them in a set\n\t\t\t\t\tvar preview = this._map._docPreviews[key];\n\t\t\t\t\tif (preview.index >= 0 && this.isWriter()) {\n\t\t\t\t\t\t// we have a preview for a page\n\t\t\t\t\t\tif (preview.invalid || (this._partPageRectanglesTwips.length > preview.index &&\n\t\t\t\t\t\t\t\tinvalidBounds.intersects(this._partPageRectanglesTwips[preview.index]))) {\n\t\t\t\t\t\t\ttoInvalidate[key] = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\telse if (preview.index >= 0) {\n\t\t\t\t\t\t// we have a preview for a part\n\t\t\t\t\t\tif (preview.invalid || preview.index === this._selectedPart ||\n\t\t\t\t\t\t\t\t(preview.index === this._prevSelectedPart && this._prevSelectedPartNeedsUpdate)) {\n\t\t\t\t\t\t\t// if the current part needs its preview updated OR\n\t\t\t\t\t\t\t// the part has been changed and we need to update the previous part preview\n\t\t\t\t\t\t\tif (preview.index === this._prevSelectedPart) {\n\t\t\t\t\t\t\t\tthis._prevSelectedPartNeedsUpdate = false;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\ttoInvalidate[key] = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\t// we have a custom preview\n\t\t\t\t\t\tvar bounds = new L.Bounds(\n\t\t\t\t\t\t\tnew L.Point(preview.tilePosX, preview.tilePosY),\n\t\t\t\t\t\t\tnew L.Point(preview.tilePosX + preview.tileWidth, preview.tilePosY + preview.tileHeight));\n\t\t\t\t\t\tif (preview.invalid || (preview.part === this._selectedPart ||\n\t\t\t\t\t\t\t\t(preview.part === this._prevSelectedPart && this._prevSelectedPartNeedsUpdate)) &&\n\t\t\t\t\t\t\t\tinvalidBounds.intersects(bounds)) {\n\t\t\t\t\t\t\t// if the current part needs its preview updated OR\n\t\t\t\t\t\t\t// the part has been changed and we need to update the previous part preview\n\t\t\t\t\t\t\tif (preview.index === this._prevSelectedPart) {\n\t\t\t\t\t\t\t\tthis._prevSelectedPartNeedsUpdate = false;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\ttoInvalidate[key] = true;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tfor (key in toInvalidate) {\n\t\t\t\t// update invalid preview tiles\n\t\t\t\tpreview = this._map._docPreviews[key];\n\t\t\t\tif (preview.autoUpdate) {\n\t\t\t\t\tif (preview.index >= 0) {\n\t\t\t\t\t\tthis._map.getPreview(preview.id, preview.index, preview.maxWidth, preview.maxHeight, {autoUpdate: true});\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tthis._map.getCustomPreview(preview.id, preview.part, preview.width, preview.height, preview.tilePosX,\n\t\t\t\t\t\t\tpreview.tilePosY, preview.tileWidth, preview.tileHeight, {autoUpdate: true});\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tthis._previewInvalidations = [];\n\t},\n\n\t_onFormFieldButtonMsg: function (textMsg) {\n\t\ttextMsg = textMsg.substring('formfieldbutton:'.length + 1);\n\t\tvar json = JSON.parse(textMsg);\n\t\tif (json.action === 'show') {\n\t\t\tthis._formFieldButton = new L.FormFieldButton(json);\n\t\t\tthis._map.addLayer(this._formFieldButton);\n\t\t} else if (this._formFieldButton) {\n\t\t\tthis._map.removeLayer(this._formFieldButton);\n\t\t}\n\t},\n\n\t// converts rectangle in print-twips to tile-twips rectangle of the smallest cell-range that encloses it.\n\t_convertToTileTwipsSheetArea: function (rectangle) {\n\t\tif (!(rectangle instanceof L.Bounds) || !this.options.printTwipsMsgsEnabled || !this.sheetGeometry) {\n\t\t\treturn rectangle;\n\t\t}\n\n\t\treturn this.sheetGeometry.getTileTwipsSheetAreaFromPrint(rectangle);\n\t},\n\n\t_getGraphicSelectionRectangle: function (rectangle) {\n\t\tif (!(rectangle instanceof L.Bounds) || !this.options.printTwipsMsgsEnabled || !this.sheetGeometry) {\n\t\t\treturn rectangle;\n\t\t}\n\n\t\t// Calc\n\t\tvar rectSize = rectangle.getSize();\n\t\tvar newTopLeft = this.sheetGeometry.getTileTwipsPointFromPrint(rectangle.getTopLeft());\n\t\tif (this.isLayoutRTL()) { // Convert to negative display-twips coordinates.\n\t\t\tnewTopLeft.x = -newTopLeft.x;\n\t\t\trectSize.x = -rectSize.x;\n\t\t}\n\n\t\treturn new L.Bounds(newTopLeft, newTopLeft.add(rectSize));\n\t},\n\n\t_convertCalcTileTwips: function (point, offset) {\n\t\tif (!this.options.printTwipsMsgsEnabled || !this.sheetGeometry)\n\t\t\treturn point;\n\t\tvar newPoint = new L.Point(parseInt(point.x), parseInt(point.y));\n\t\tvar _offset = offset ? new L.Point(parseInt(offset.x), parseInt(offset.y)) : this._shapeGridOffset;\n\t\treturn newPoint.add(_offset);\n\t},\n\n\t_getEditCursorRectangle: function (msgObj) {\n\n\t\tif (typeof msgObj !== 'object' || !Object.prototype.hasOwnProperty.call(msgObj,'rectangle')) {\n\t\t\twindow.app.console.error('invalid edit cursor message');\n\t\t\treturn undefined;\n\t\t}\n\n\t\treturn L.Bounds.parse(msgObj.rectangle);\n\t},\n\n\t_getTextSelectionRectangles: function (textMsg) {\n\n\t\tif (typeof textMsg !== 'string') {\n\t\t\twindow.app.console.error('invalid text selection message');\n\t\t\treturn [];\n\t\t}\n\n\t\treturn L.Bounds.parseArray(textMsg);\n\t},\n\n\t// Needed for the split-panes feature to determine the active split-pane.\n\t// Needs to be implemented by the app specific TileLayer.\n\tgetCursorPos: function () {\n\t\twindow.app.console.error('No implementations available for getCursorPos!');\n\t\treturn new L.Point(0, 0);\n\t},\n\n\tgetPaneLatLngRectangles: function () {\n\t\tvar map = this._map;\n\n\t\tif (!this._splitPanesContext) {\n\t\t\treturn [ map.getBounds() ];\n\t\t}\n\n\t\t// These paneRects are in core pixels.\n\t\tvar paneRects = this._splitPanesContext.getPxBoundList();\n\t\twindow.app.console.assert(paneRects.length, 'number of panes cannot be zero!');\n\n\t\treturn paneRects.map(function (pxBound) {\n\t\t\treturn new L.LatLngBounds(\n\t\t\t\tmap.unproject(pxBound.getTopLeft().divideBy(app.dpiScale)),\n\t\t\t\tmap.unproject(pxBound.getBottomRight().divideBy(app.dpiScale))\n\t\t\t);\n\t\t});\n\t},\n\n\t_debugGetTimeArray: function() {\n\t\treturn {count: 0, ms: 0, best: Number.MAX_SAFE_INTEGER, worst: 0, date: 0};\n\t},\n\n\t_debugShowTileData: function() {\n\t\tthis._debugData['loadCount'].setPrefix('Total of requested tiles: ' +\n\t\t\t\tthis._debugInvalidateCount + ', received: ' + this._debugLoadCount +\n\t\t\t\t', cancelled: ' + this._debugCancelledTiles);\n\t},\n\n\t_debugInit: function() {\n\t\tthis._debugTiles = {};\n\t\tthis._debugInvalidBounds = {};\n\t\tthis._debugInvalidBoundsMessage = {};\n\t\tthis._debugTimeout();\n\t\tthis._debugId = 0;\n\t\tthis._debugCancelledTiles = 0;\n\t\tthis._debugLoadCount = 0;\n\t\tthis._debugInvalidateCount = 0;\n\t\tthis._debugRenderCount = 0;\n\t\tif (!this._debugData) {\n\t\t\tthis._debugData = {};\n\t\t\tthis._debugDataNames = ['tileCombine', 'fromKeyInputToInvalidate', 'ping', 'loadCount', 'postMessage'];\n\t\t\tfor (var i = 0; i < this._debugDataNames.length; i++) {\n\t\t\t\tthis._debugData[this._debugDataNames[i]] = L.control.attribution({prefix: '', position: 'bottomleft'}).addTo(this._map);\n\t\t\t}\n\t\t\tthis._debugInfo = new L.LayerGroup();\n\t\t\tthis._debugInfo2 = new L.LayerGroup();\n\t\t\tthis._debugAlwaysActive = new L.LayerGroup();\n\t\t\tthis._debugShowClipboard = new L.LayerGroup();\n\t\t\tthis._tilesDevicePixelGrid = new L.LayerGroup();\n\t\t\tthis._debugSidebar = new L.LayerGroup();\n\t\t\tthis._debugTyper = new L.LayerGroup();\n\t\t\tthis._debugTrace = new L.LayerGroup();\n\t\t\tthis._debugLogging = new L.LayerGroup();\n\t\t\tthis._map.addLayer(this._debugInfo);\n\t\t\tthis._map.addLayer(this._debugInfo2);\n\t\t\tvar overlayMaps = {\n\t\t\t\t'Tile overlays': this._debugInfo,\n\t\t\t\t'Screen overlays': this._debugInfo2,\n\t\t\t\t'Show Clipboard': this._debugShowClipboard,\n\t\t\t\t'Always active': this._debugAlwaysActive,\n\t\t\t\t'Typing': this._debugTyper,\n\t\t\t\t'Tiles device pixel grid': this._tilesDevicePixelGrid,\n\t\t\t\t'Sidebar Rerendering': this._debugSidebar,\n\t\t\t\t'Performance Tracing': this._debugTrace,\n\t\t\t\t'Protocol logging': this._debugLogging,\n\t\t\t};\n\t\t\tL.control.layers({}, overlayMaps, {collapsed: false}).addTo(this._map);\n\n\t\t\tthis._map.on('layeradd', function(e) {\n\t\t\t\tif (e.layer === this._debugAlwaysActive) {\n\t\t\t\t\tthis._map._debugAlwaysActive = true;\n\t\t\t\t} else if (e.layer === this._debugShowClipboard) {\n\t\t\t\t\tthis._map._textInput.debug(true);\n\t\t\t\t} else if (e.layer === this._debugTyper) {\n\t\t\t\t\tthis._debugTypeTimeout();\n\t\t\t\t} else if (e.layer === this._debugInfo2) {\n\t\t\t\t\tfor (var i = 0; i < this._debugDataNames.length; i++) {\n\t\t\t\t\t\tthis._debugData[this._debugDataNames[i]].addTo(this._map);\n\t\t\t\t\t}\n\t\t\t\t} else if (e.layer === this._tilesDevicePixelGrid) {\n\t\t\t\t\tthis._map._docLayer._painter._addTilePixelGridSection();\n\t\t\t\t\tthis._map._docLayer._painter._sectionContainer.reNewAllSections(true);\n\t\t\t\t} else if (e.layer === this._debugSidebar) {\n\t\t\t\t\tthis._map._debugSidebar = true;\n\t\t\t\t} else if (e.layer === this._debugTrace) {\n\t\t\t\t\tapp.socket.setTraceEventLogging(true);\n\t\t\t\t} else if (e.layer === this._debugLogging) {\n\t\t\t\t\twindow.setLogging(true);\n\t\t\t\t}\n\t\t\t}, this);\n\t\t\tthis._map.on('layerremove', function(e) {\n\t\t\t\tif (e.layer === this._debugAlwaysActive) {\n\t\t\t\t\tthis._map._debugAlwaysActive = false;\n\t\t\t\t} else if (e.layer === this._debugShowClipboard) {\n\t\t\t\t\tthis._map._textInput.debug(false);\n\t\t\t\t} else if (e.layer === this._debugTyper) {\n\t\t\t\t\tclearTimeout(this._debugTypeTimeoutId);\n\t\t\t\t} else if (e.layer === this._debugInfo2) {\n\t\t\t\t\tfor (var i in this._debugData) {\n\t\t\t\t\t\tthis._debugData[i].remove();\n\t\t\t\t\t}\n\t\t\t\t} else if (e.layer === this._tilesDevicePixelGrid) {\n\t\t\t\t\tthis._map._docLayer._painter._sectionContainer.removeSection('tile pixel grid');\n\t\t\t\t\tthis._map._docLayer._painter._sectionContainer.reNewAllSections(true);\n\t\t\t\t} else if (e.layer === this._debugSidebar) {\n\t\t\t\t\tthis._map._debugSidebar = false;\n\t\t\t\t} else if (e.layer === this._debugTrace) {\n\t\t\t\t\tapp.socket.setTraceEventLogging(false);\n\t\t\t\t} else if (e.layer === this._debugLogging) {\n\t\t\t\t\twindow.setLogging(false);\n\t\t\t\t}\n\t\t\t}, this);\n\t\t}\n\t\tthis._debugTimePING = this._debugGetTimeArray();\n\t\tthis._debugPINGQueue = [];\n\t\tthis._debugTimeKeypress = this._debugGetTimeArray();\n\t\tthis._debugKeypressQueue = [];\n\t\tthis._debugLorem = 'Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.';\n\t\tthis._debugLorem += ' ' + this._debugLorem + '\\n';\n\t\tthis._debugLoremPos = 0;\n\n\t\tif (this._map._docLayer._docType === 'spreadsheet') {\n\t\t\tvar section = this._map._docLayer._painter._sectionContainer.getSectionWithName('calc grid');\n\t\t\tif (section) {\n\t\t\t\tsection.setDrawingOrder(L.CSections.CalcGrid.drawingOrderDebug);\n\t\t\t\tsection.sectionProperties.strokeStyle = 'blue';\n\t\t\t}\n\t\t\tthis._map._docLayer._painter._addSplitsSection();\n\t\t\tthis._map._docLayer._painter._sectionContainer.reNewAllSections(true /* redraw */);\n\t\t}\n\t},\n\n\t_debugSetPostMessage: function(type,msg) {\n\t\tthis._debugData['postMessage'].setPrefix(type+': '+ msg);\n\t},\n\n\t_debugSetTimes: function(times, value) {\n\t\tif (value < times.best) {\n\t\t\ttimes.best = value;\n\t\t}\n\t\tif (value > times.worst) {\n\t\t\ttimes.worst = value;\n\t\t}\n\t\ttimes.ms += value;\n\t\ttimes.count++;\n\t\treturn 'best: ' + times.best + ' ms, avg: ' + Math.round(times.ms/times.count) + ' ms, worst: ' + times.worst + ' ms, last: ' + value + ' ms';\n\t},\n\n\t_debugAddInvalidationRectangle: function(topLeftTwips, bottomRightTwips, command) {\n\t\tvar now = +new Date();\n\n\t\tvar invalidBoundCoords = new L.LatLngBounds(this._twipsToLatLng(topLeftTwips, this._tileZoom),\n\t\t\tthis._twipsToLatLng(bottomRightTwips, this._tileZoom));\n\t\tvar rect = L.rectangle(invalidBoundCoords, {color: 'red', weight: 1, opacity: 1, fillOpacity: 0.4, pointerEvents: 'none'});\n\t\tthis._debugInvalidBounds[this._debugId] = rect;\n\t\tthis._debugInvalidBoundsMessage[this._debugId] = command;\n\t\tthis._debugId++;\n\t\tthis._debugInfo.addLayer(rect);\n\n\t\tvar oldestKeypress = this._debugKeypressQueue.shift();\n\t\tif (oldestKeypress) {\n\t\t\tvar timeText = this._debugSetTimes(this._debugTimeKeypress, now - oldestKeypress);\n\t\t\tthis._debugData['fromKeyInputToInvalidate'].setPrefix('Elapsed time between key input and next invalidate: ' + timeText);\n\t\t}\n\n\t\t// query server ping time after invalidation messages\n\t\t// pings will be paired with the pong messages\n\t\tthis._debugPINGQueue.push(+new Date());\n\t\tapp.socket.sendMessage('ping');\n\t},\n\n\t_debugAddInvalidationData: function(tile) {\n\t\tif (tile._debugTile) {\n\t\t\ttile._debugTile.setStyle({fillOpacity: 0.5, fillColor: 'blue'});\n\t\t\ttile._debugTime.date = +new Date();\n\t\t\ttile._debugTile.date = +new Date();\n\t\t\ttile._debugInvalidateCount++;\n\t\t\tthis._debugInvalidateCount++;\n\t\t}\n\t},\n\n\t_debugAddInvalidationMessage: function(message) {\n\t\tthis._debugInvalidBoundsMessage[this._debugId - 1] = message;\n\t\tvar messages = '';\n\t\tfor (var i = this._debugId - 1; i > this._debugId - 6; i--) {\n\t\t\tif (i >= 0 && this._debugInvalidBoundsMessage[i]) {\n\t\t\t\tmessages += '' + i + ': ' + this._debugInvalidBoundsMessage[i] + ' <br>';\n\t\t\t}\n\t\t}\n\t\tthis._debugData['tileCombine'].setPrefix(messages);\n\t\tthis._debugShowTileData();\n\t},\n\n\t_debugTimeout: function() {\n\t\tif (this._debug) {\n\t\t\tfor (var key in this._debugInvalidBounds) {\n\t\t\t\tvar rect = this._debugInvalidBounds[key];\n\t\t\t\tvar opac = rect.options.fillOpacity;\n\t\t\t\tif (opac <= 0.04) {\n\t\t\t\t\tif (key < this._debugId - 5) {\n\t\t\t\t\t\tthis._debugInfo.removeLayer(rect);\n\t\t\t\t\t\tdelete this._debugInvalidBounds[key];\n\t\t\t\t\t\tdelete this._debugInvalidBoundsMessage[key];\n\t\t\t\t\t} else {\n\t\t\t\t\t\trect.setStyle({fillOpacity: 0, opacity: 1 - (this._debugId - key) / 7});\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\trect.setStyle({fillOpacity: opac - 0.04});\n\t\t\t\t}\n\t\t\t}\n\t\t\tfor (key in this._debugTiles) {\n\t\t\t\trect = this._debugTiles[key];\n\t\t\t\tvar col = rect.options.fillColor;\n\t\t\t\topac = rect.options.fillOpacity;\n\t\t\t\tif (col === 'blue' && opac >= 0.04 && rect.date + 1000 < +new Date()) {\n\t\t\t\t\trect.setStyle({fillOpacity: opac - 0.04});\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis._debugTimeoutId = setTimeout(L.bind(this._debugTimeout, this), 50);\n\t\t}\n\t},\n\n\t_debugTypeTimeout: function() {\n\t\tvar letter = this._debugLorem.charCodeAt(this._debugLoremPos % this._debugLorem.length);\n\t\tthis._debugKeypressQueue.push(+new Date());\n\t\tif (letter === '\\n'.charCodeAt(0)) {\n\t\t\tthis.postKeyboardEvent('input', 0, 1280);\n\t\t} else {\n\t\t\tthis.postKeyboardEvent('input', this._debugLorem.charCodeAt(this._debugLoremPos % this._debugLorem.length), 0);\n\t\t}\n\t\tthis._debugLoremPos++;\n\t\tthis._debugTypeTimeoutId = setTimeout(L.bind(this._debugTypeTimeout, this), 50);\n\t},\n\n\t/// onlyThread - takes annotation indicating which thread will be generated\n\tgetCommentWizardStructure: function(menuStructure, onlyThread) {\n\t\tvar customTitleBar = L.DomUtil.create('div');\n\t\tvar title = L.DomUtil.create('span', '', customTitleBar);\n\t\ttitle.innerText = _('Comment');\n\t\tvar button = L.DomUtil.createWithId('button', 'insert_comment', customTitleBar);\n\t\tbutton.innerText = '+';\n\t\tbutton.onclick = this._map.insertComment.bind(this._map);\n\n\t\tif (menuStructure === undefined) {\n\t\t\tmenuStructure = {\n\t\t\t\tid : 'comment',\n\t\t\t\ttype : 'mainmenu',\n\t\t\t\tenabled : true,\n\t\t\t\ttext : _('Comment'),\n\t\t\t\texecutionType : 'menu',\n\t\t\t\tdata : [],\n\t\t\t\tchildren : []\n\t\t\t};\n\n\t\t\tif (this._map.isPermissionEditForComments())\n\t\t\t\tmenuStructure['customTitle'] = customTitleBar;\n\t\t}\n\n\t\tvar section = app.sectionContainer.getSectionWithName(L.CSections.CommentList.name);\n\t\tif (section)\n\t\t\tsection.createCommentStructure(menuStructure, onlyThread);\n\n\t\tif (menuStructure.children.length === 0) {\n\t\t\tvar noComments = {\n\t\t\t\tid: 'emptyWizard',\n\t\t\t\tenable: true,\n\t\t\t\ttype: 'emptyCommentWizard',\n\t\t\t\ttext: _('No Comments'),\n\t\t\t\tchildren: []\n\t\t\t};\n\t\t\tmenuStructure['children'].push(noComments);\n\t\t}\n\t\treturn menuStructure;\n\t},\n\n\t_openCommentWizard: function(annotation) {\n\t\twindow.commentWizard = true;\n\t\tvar menuData = this._map._docLayer.getCommentWizardStructure();\n\t\tthis._map.fire('mobilewizard', {data: menuData});\n\n\t\t// if annotation is provided we can select perticular comment\n\t\tif (annotation) {\n\t\t\t$('#comment' + annotation.sectionProperties.data.id).click();\n\t\t}\n\t},\n\n\t_saveMessageForReplay: function (textMsg, viewId) {\n\t\t// We will not get some messages (with coordinates)\n\t\t// from core when zoom changes because print-twips coordinates are zoom-invariant. So we need to\n\t\t// remember the last version of them and replay, when zoom is changed.\n\t\t// In calc we need to replay the messages when sheet-geometry changes too. This is because it is possible for\n\t\t// the updated print-twips messages to arrive before the sheet-geometry update message arrives.\n\n\t\tif (!this._printTwipsMessagesForReplay) {\n\t\t\tvar ownViewTypes = this.isCalc() ? [\n\t\t\t\t'cellcursor',\n\t\t\t\t'referencemarks',\n\t\t\t\t'cellselectionarea',\n\t\t\t\t'textselection',\n\t\t\t\t'invalidatecursor',\n\t\t\t\t'textselectionstart',\n\t\t\t\t'textselectionend',\n\t\t\t\t'graphicselection',\n\t\t\t] : [\n\t\t\t\t'invalidatecursor',\n\t\t\t\t'textselection',\n\t\t\t\t'graphicselection'\n\t\t\t];\n\n\t\t\tvar otherViewTypes = this.isCalc() ? [\n\t\t\t\t'cellviewcursor',\n\t\t\t\t'textviewselection',\n\t\t\t\t'invalidateviewcursor',\n\t\t\t\t'graphicviewselection',\n\t\t\t] : [\n\t\t\t\t'textviewselection',\n\t\t\t\t'invalidateviewcursor'\n\t\t\t];\n\n\t\t\tthis._printTwipsMessagesForReplay = new L.MessageStore(ownViewTypes, otherViewTypes);\n\t\t}\n\n\t\tvar colonIndex = textMsg.indexOf(':');\n\t\tif (colonIndex === -1) {\n\t\t\treturn;\n\t\t}\n\n\t\tvar msgType = textMsg.substring(0, colonIndex);\n\t\tthis._printTwipsMessagesForReplay.save(msgType, textMsg, viewId);\n\t},\n\n\t_clearMsgReplayStore: function () {\n\t\tif (!this._printTwipsMessagesForReplay) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis._printTwipsMessagesForReplay.clear();\n\t},\n\n\t_replayPrintTwipsMsgs: function () {\n\t\tif (!this._printTwipsMessagesForReplay) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis._printTwipsMessagesForReplay.forEach(this._onMessage.bind(this));\n\t},\n\n\t_replayPrintTwipsMsg: function (msgType) {\n\t\tvar msg = this._printTwipsMessagesForReplay.get(msgType);\n\t\tthis._onMessage(msg);\n\t},\n\n\t_replayPrintTwipsMsgAllViews: function (msgType) {\n\t\tObject.keys(this._cellViewCursors).forEach(function (viewId) {\n\t\t\tvar msg = this._printTwipsMessagesForReplay.get(msgType, parseInt(viewId));\n\t\t\tif (msg)\n\t\t\t\tthis._onMessage(msg);\n\t\t}.bind(this));\n\t},\n\n\t_syncTilePanePos: function () {\n\t\tvar tilePane = this._container.parentElement;\n\t\tif (tilePane) {\n\t\t\tvar mapPanePos = this._map._getMapPanePos();\n\t\t\tL.DomUtil.setPosition(tilePane, new L.Point(-mapPanePos.x , -mapPanePos.y));\n\t\t\tvar documentBounds = this._map.getPixelBoundsCore();\n\t\t\tvar documentPos = documentBounds.min;\n\t\t\tvar documentEndPos = documentBounds.max;\n\t\t\tthis._painter._sectionContainer.setDocumentBounds([documentPos.x, documentPos.y, documentEndPos.x, documentEndPos.y]);\n\t\t}\n\t},\n\n\tpauseDrawing: function () {\n\t\tif (this._painter && this._painter._sectionContainer)\n\t\t\tthis._painter._sectionContainer.pauseDrawing();\n\t},\n\n\tresumeDrawing: function (topLevel) {\n\t\tif (this._painter && this._painter._sectionContainer)\n\t\t\tthis._painter._sectionContainer.resumeDrawing(topLevel);\n\t},\n\n\tenableDrawing: function () {\n\t\tif (this._painter && this._painter._sectionContainer)\n\t\t\tthis._painter._sectionContainer.enableDrawing();\n\t},\n\n\t_getUIWidth: function () {\n\t\tvar section = this._painter._sectionContainer.getSectionWithName(L.CSections.RowHeader.name);\n\t\tif (section) {\n\t\t\treturn Math.round(section.size[0] / app.dpiScale);\n\t\t}\n\t\telse {\n\t\t\treturn 0;\n\t\t}\n\t},\n\n\t_getUIHeight: function () {\n\t\tvar section = this._painter._sectionContainer.getSectionWithName(L.CSections.ColumnHeader.name);\n\t\tif (section) {\n\t\t\treturn Math.round(section.size[1] / app.dpiScale);\n\t\t}\n\t\telse {\n\t\t\treturn 0;\n\t\t}\n\t},\n\n\t_getGroupWidth: function () {\n\t\tvar section = this._painter._sectionContainer.getSectionWithName(L.CSections.RowGroup.name);\n\t\tif (section) {\n\t\t\treturn Math.round(section.size[0] / app.dpiScale);\n\t\t}\n\t\telse {\n\t\t\treturn 0;\n\t\t}\n\t},\n\n\t_getGroupHeight: function () {\n\t\tvar section = this._painter._sectionContainer.getSectionWithName(L.CSections.ColumnGroup.name);\n\t\tif (section) {\n\t\t\treturn Math.round(section.size[1] / app.dpiScale);\n\t\t}\n\t\telse {\n\t\t\treturn 0;\n\t\t}\n\t},\n\n\t_getTilesSectionRectangle: function () {\n\t\tvar section = app.sectionContainer.getSectionWithName(L.CSections.Tiles.name);\n\t\tif (section) {\n\t\t\treturn L.LOUtil.createRectangle(section.myTopLeft[0] / app.dpiScale, section.myTopLeft[1] / app.dpiScale, section.size[0] / app.dpiScale, section.size[1] / app.dpiScale);\n\t\t}\n\t\telse {\n\t\t\treturn L.LOUtil.createRectangle(0, 0, 0, 0);\n\t\t}\n\t},\n\n\t_getRealMapSize: function() {\n\t\tthis._map._sizeChanged = true; // force using real size\n\t\treturn this._map.getPixelBounds().getSize();\n\t},\n\n\t_syncTileContainerSize: function () {\n\t\tif (this._docType === 'presentation' || this._docType === 'drawing') {\n\t\t\tthis.onResizeImpress();\n\t\t}\n\n\t\tvar tileContainer = this._container;\n\t\tif (tileContainer) {\n\t\t\tvar documentContainerSize = document.getElementById('document-container');\n\t\t\tdocumentContainerSize = documentContainerSize.getBoundingClientRect();\n\t\t\tdocumentContainerSize = [documentContainerSize.width, documentContainerSize.height];\n\n\t\t\tthis._painter._sectionContainer.onResize(documentContainerSize[0], documentContainerSize[1]); // Canvas's size = documentContainer's size.\n\n\t\t\tvar oldSize = this._getRealMapSize();\n\n\t\t\tvar rectangle = this._getTilesSectionRectangle();\n\t\t\tvar mapElement = document.getElementById('map'); // map's size = tiles section's size.\n\t\t\tmapElement.style.left = rectangle.getPxX1() + 'px';\n\t\t\tmapElement.style.top = rectangle.getPxY1() + 'px';\n\t\t\tmapElement.style.width = rectangle.getPxWidth() + 'px';\n\t\t\tmapElement.style.height = rectangle.getPxHeight() + 'px';\n\n\t\t\ttileContainer.style.width = rectangle.getPxWidth() + 'px';\n\t\t\ttileContainer.style.height = rectangle.getPxHeight() + 'px';\n\n\t\t\tvar newSize = this._getRealMapSize();\n\t\t\tvar heightIncreased = oldSize.y < newSize.y;\n\t\t\tvar widthIncreased = oldSize.x < newSize.x;\n\n\t\t\tif (this._docType === 'spreadsheet') {\n\t\t\t\tif (this._painter._sectionContainer.doesSectionExist(L.CSections.RowHeader.name))\n\t\t\t\t\tthis._painter._sectionContainer.getSectionWithName(L.CSections.RowHeader.name)._updateCanvas();\n\t\t\t\tif (this._painter._sectionContainer.doesSectionExist(L.CSections.ColumnHeader.name))\n\t\t\t\t\tthis._painter._sectionContainer.getSectionWithName(L.CSections.ColumnHeader.name)._updateCanvas();\n\t\t\t}\n\n\t\t\tif (oldSize.x !== newSize.x || oldSize.y !== newSize.y) {\n\t\t\t\tthis._map.invalidateSize();\n\t\t\t}\n\n\t\t\tvar hasMobileWizardOpened = this._map.uiManager.mobileWizard ? this._map.uiManager.mobileWizard.isOpen() : false;\n\t\t\tvar hasIframeModalOpened = $('.iframe-dialog-modal').is(':visible');\n\t\t\tif (window.mode.isMobile() && !hasMobileWizardOpened && !hasIframeModalOpened) {\n\t\t\t\tif (heightIncreased) {\n\t\t\t\t\t// if the keyboard is hidden - be sure we setup correct state in TextInput\n\t\t\t\t\tthis._map.setAcceptInput(false);\n\t\t\t\t} else\n\t\t\t\t\tthis._onUpdateCursor(true);\n\t\t\t}\n\n\t\t\tthis._fitWidthZoom();\n\n\t\t\t// Center the view w.r.t the new map-pane position using the current zoom.\n\t\t\tthis._map.setView(this._map.getCenter());\n\n\t\t\t// We want to keep cursor visible when we show the keyboard on mobile device or tablet\n\t\t\tvar isTabletOrMobile = window.mode.isMobile() || window.mode.isTablet();\n\t\t\tvar hasVisibleCursor = this._map._docLayer._visibleCursor\n\t\t\t\t&& this._map._docLayer._cursorMarker && this._map._docLayer._cursorMarker.isDomAttached();\n\t\t\tif (!heightIncreased && isTabletOrMobile && this._map._docLoaded && hasVisibleCursor) {\n\t\t\t\tvar cursorPos = this._map._docLayer._visibleCursor.getSouthWest();\n\t\t\t\tvar centerOffset = this._map._getCenterOffset(cursorPos);\n\t\t\t\tvar viewHalf = this._map.getSize()._divideBy(2);\n\t\t\t\tvar cursorPositionInView =\n\t\t\t\t\tcenterOffset.x > -viewHalf.x && centerOffset.x < viewHalf.x &&\n\t\t\t\t\tcenterOffset.y > -viewHalf.y && centerOffset.y < viewHalf.y;\n\t\t\t\tif (!cursorPositionInView)\n\t\t\t\t\tthis._map.panTo(cursorPos);\n\t\t\t}\n\n\t\t\tif (heightIncreased || widthIncreased) {\n\t\t\t\tthis._painter._sectionContainer.requestReDraw();\n\t\t\t\tthis._map.fire('sizeincreased');\n\t\t\t}\n\t\t}\n\t},\n\n\thasSplitPanesSupport: function () {\n\t\t// Only enabled for Calc for now\n\t\t// It may work without this.options.sheetGeometryDataEnabled but not tested.\n\t\t// The overlay-pane with split-panes is still based on svg renderer,\n\t\t// and not available for VML or canvas yet.\n\t\tif (this.isCalc() &&\n\t\t\tthis.options.sheetGeometryDataEnabled &&\n\t\t\tL.Browser.svg) {\n\t\t\treturn true;\n\t\t}\n\n\t\treturn false;\n\t},\n\n\tsetZoomChanged: function (zoomChanged) {\n\t\tthis._painter._sectionContainer.setZoomChanged(zoomChanged);\n\t},\n\n\tonAdd: function (map) {\n\t\tthis._tileWidthPx = this.options.tileSize;\n\t\tthis._tileHeightPx = this.options.tileSize;\n\n\t\tthis._initContainer();\n\t\tthis._getToolbarCommandsValues();\n\t\tthis._textCSelections = new CSelections(undefined, this._canvasOverlay,\n\t\t\tthis._selectionsDataDiv, this._map, false /* isView */, undefined, 'text');\n\t\tthis._cellCSelections = new CSelections(undefined, this._canvasOverlay,\n\t\t\tthis._selectionsDataDiv, this._map, false /* isView */, undefined, 'cell');\n\t\tthis._oleCSelections = new CSelections(undefined, this._canvasOverlay,\n\t\t\tthis._selectionsDataDiv, this._map, false /* isView */, undefined, 'ole');\n\t\tthis._references = new CReferences(this._canvasOverlay);\n\t\tthis._referencesAll = [];\n\n\t\t// This layergroup contains all the layers corresponding to other's view\n\t\tthis._viewLayerGroup = new L.LayerGroup();\n\t\tif (this.options.permission !== 'readonly') {\n\t\t\tmap.addLayer(this._viewLayerGroup);\n\t\t}\n\n\t\tthis._debug = map.options.debug;\n\t\tif (this._debug) {\n\t\t\tthis._debugInit();\n\t\t}\n\n\t\tthis._searchResultsLayer = new L.LayerGroup();\n\t\tmap.addLayer(this._searchResultsLayer);\n\n\t\tthis._levels = {};\n\t\tthis._tiles = {};\n\t\tthis._tileCache = {};\n\n\t\tapp.socket.sendMessage('commandvalues command=.uno:AcceptTrackedChanges');\n\n\t\tmap._fadeAnimated = false;\n\t\tthis._viewReset();\n\t\tmap.on('drag resize zoomend', this._updateScrollOffset, this);\n\n\t\tmap.on('dragover', this._onDragOver, this);\n\t\tmap.on('drop', this._onDrop, this);\n\n\t\tmap.on('zoomstart', this._onZoomStart, this);\n\t\tmap.on('zoomend', this._onZoomEnd, this);\n\t\tif (this._docType === 'spreadsheet') {\n\t\t\tmap.on('zoomend', this._onCellCursorShift, this);\n\t\t}\n\t\tmap.on('zoomend', L.bind(this.eachView, this, this._viewCursors, this._onUpdateViewCursor, this, false));\n\t\tmap.on('dragstart', this._onDragStart, this);\n\t\tmap.on('requestloksession', this._onRequestLOKSession, this);\n\t\tmap.on('error', this._mapOnError, this);\n\t\tif (map.options.autoFitWidth !== false) {\n\t\t\t// always true since autoFitWidth is never set\n\t\t\tmap.on('resize', this._fitWidthZoom, this);\n\t\t}\n\t\t// Retrieve the initial cell cursor position (as LOK only sends us an\n\t\t// updated cell cursor when the selected cell is changed and not the initial\n\t\t// cell).\n\t\tmap.on('statusindicator',\n\t\t\tfunction (e) {\n\t\t\t\tif (e.statusType === 'alltilesloaded' && this._docType === 'spreadsheet') {\n\t\t\t\t\tif (!isAnyVexDialogActive())\n\t\t\t\t\t\tthis._onCellCursorShift(true);\n\t\t\t\t}\n\t\t\t},\n\t\t\tthis);\n\n\t\tmap.on('updatepermission', function(e) {\n\t\t\tif (e.perm !== 'edit') {\n\t\t\t\tthis._clearSelections();\n\t\t\t}\n\t\t}, this);\n\n\t\tfor (var key in this._selectionHandles) {\n\t\t\tthis._selectionHandles[key].on('drag dragend', this._onSelectionHandleDrag, this);\n\t\t}\n\n\t\tthis._cellResizeMarkerStart.on('dragstart drag dragend', this._onCellResizeMarkerDrag, this);\n\t\tthis._cellResizeMarkerEnd.on('dragstart drag dragend', this._onCellResizeMarkerDrag, this);\n\t\tthis._referenceMarkerStart.on('dragstart drag dragend', this._onReferenceMarkerDrag, this);\n\t\tthis._referenceMarkerEnd.on('dragstart drag dragend', this._onReferenceMarkerDrag, this);\n\t\tthis._dropDownButton.on('click', this._onDropDownButtonClick, this);\n\t\t// The 'tap' events are not broadcasted by L.Map.TouchGesture, A specialized 'dropdownmarkertapped' event is\n\t\t// generated just for the validity-dropdown-icon.\n\t\tmap.on('dropdownmarkertapped', this._onDropDownButtonClick, this);\n\n\t\tmap.setPermission(this.options.permission);\n\n\t\tmap.fire('statusindicator', {statusType: 'coolloaded'});\n\n\t\tthis._map.sendInitUNOCommands();\n\n\t\tthis._resetClientVisArea();\n\t\tthis._requestNewTiles();\n\n\t\tmap.setZoom();\n\t},\n\n\tonRemove: function (map) {\n\t\tthis._painter.dispose();\n\n\t\tL.DomUtil.remove(this._container);\n\t\tmap._removeZoomLimit(this);\n\t\tthis._container = null;\n\t\tthis._tileZoom = null;\n\t\tthis._clearPreFetch();\n\t\tclearTimeout(this._previewInvalidator);\n\n\t\tif (!this._cellCSelections.empty()) {\n\t\t\tthis._cellCSelections.clear();\n\t\t}\n\n\t\tif (!this._textCSelections.empty()) {\n\t\t\tthis._textCSelections.clear();\n\t\t}\n\n\t\tif (!this._oleCSelections.empty()) {\n\t\t\tthis._oleCSelections.clear();\n\t\t}\n\n\t\tif (this._cursorMarker && this._cursorMarker.isDomAttached()) {\n\t\t\tthis._cursorMarker.remove();\n\t\t}\n\t\tif (this._graphicMarker) {\n\t\t\tthis._graphicMarker.remove();\n\t\t}\n\t\tfor (var key in this._selectionHandles) {\n\t\t\tthis._selectionHandles[key].remove();\n\t\t}\n\n\t\tthis._removeSplitters();\n\t\tL.DomUtil.remove(this._canvasContainer);\n\t},\n\n\tgetEvents: function () {\n\t\tvar events = {\n\t\t\tviewreset: this._viewReset,\n\t\t\tmovestart: this._moveStart,\n\t\t\tmoveend: this._move,\n\t\t\t// update tiles on move, but not more often than once per given interval\n\t\t\tmove: L.Util.throttle(this._move, this.options.updateInterval, this),\n\t\t\tsplitposchanged: this._move,\n\t\t};\n\n\t\treturn events;\n\t},\n\n\t// zoom is the new intermediate zoom level (log scale : 1 to 14)\n\tzoomStep: function (zoom, newCenter) {\n\t\tthis._painter.zoomStep(zoom, newCenter);\n\t},\n\n\tzoomStepEnd: function (zoom, newCenter, mapUpdater, runAtFinish, noGap) {\n\t\tthis._painter.zoomStepEnd(zoom, newCenter, mapUpdater, runAtFinish, noGap);\n\t},\n\n\tpreZoomAnimation: function () {\n\t\tif (this.isCursorVisible()) {\n\t\t\tthis._cursorMarker.setOpacity(0);\n\t\t}\n\t\tif (this._map._textInput._cursorHandler) {\n\t\t\tthis._map._textInput._cursorHandler.setOpacity(0);\n\t\t}\n\t\tif (this._cellCursorMarker) {\n\t\t\tthis._map.setOverlaysOpacity(0);\n\t\t\tthis._map.setMarkersOpacity(0);\n\t\t}\n\t\tif (this._selectionHandles['start']) {\n\t\t\tthis._selectionHandles['start'].setOpacity(0);\n\t\t}\n\t\tif (this._selectionHandles['end']) {\n\t\t\tthis._selectionHandles['end'].setOpacity(0);\n\t\t}\n\t\tthis.eachView(this._viewCursors, function (item) {\n\t\t\tvar viewCursorMarker = item.marker;\n\t\t\tif (viewCursorMarker) {\n\t\t\t\tviewCursorMarker.setOpacity(0);\n\t\t\t}\n\t\t}, this, true);\n\t},\n\n\tpostZoomAnimation: function () {\n\t\tif (this.isCursorVisible()) {\n\t\t\tthis._cursorMarker.setOpacity(1);\n\t\t}\n\t\tif (this._map._textInput._cursorHandler) {\n\t\t\tthis._map._textInput._cursorHandler.setOpacity(1);\n\t\t}\n\t\tif (this._cellCursorMarker) {\n\t\t\tthis._map.setOverlaysOpacity(1);\n\t\t\tthis._map.setMarkersOpacity(1);\n\t\t}\n\t\tif (this._selectionHandles['start']) {\n\t\t\tthis._selectionHandles['start'].setOpacity(1);\n\t\t}\n\t\tif (this._selectionHandles['end']) {\n\t\t\tthis._selectionHandles['end'].setOpacity(1);\n\t\t}\n\n\t\tif (this._annotations) {\n\t\t\tvar annotations = this._annotations;\n\t\t\tif (annotations.update)\n\t\t\t\tsetTimeout(function() {\n\t\t\t\t\tannotations.update();\n\t\t\t\t}, 250 /* ms */);\n\t\t}\n\t},\n\n\t// Meant for desktop case, where the ending zoom and centers are all known in advance.\n\trunZoomAnimation: function (zoomEnd, pinchCenter, mapUpdater, runAtFinish) {\n\n\t\tthis.preZoomAnimation();\n\t\tthis.zoomStep(this._map.getZoom(), pinchCenter);\n\t\tvar thisObj = this;\n\t\tthis.zoomStepEnd(zoomEnd, pinchCenter,\n\t\t\tmapUpdater,\n\t\t\t// runAtFinish\n\t\t\tfunction () {\n\t\t\t\tthisObj.postZoomAnimation();\n\t\t\t\trunAtFinish();\n\t\t\t});\n\t},\n\n\t_viewReset: function (e) {\n\t\tthis._reset(this._map.getCenter(), this._map.getZoom(), e && e.hard);\n\t\tif (this._docType === 'spreadsheet' && this._annotations !== 'undefined') {\n\t\t\tapp.socket.sendMessage('commandvalues command=.uno:ViewAnnotationsPosition');\n\t\t}\n\n\t\tthis._painter._viewReset();\n\t},\n\n\t_removeSplitters: function () {\n\t\tif (this._xSplitter) {\n\t\t\tthis._canvasOverlay.removePath(this._xSplitter);\n\t\t\tthis._xSplitter = undefined;\n\t\t}\n\n\t\tif (this._ySplitter) {\n\t\t\tthis._canvasOverlay.removePath(this._ySplitter);\n\t\t\tthis._ySplitter = undefined;\n\t\t}\n\t},\n\n\t_updateOpacity: function () {\n\t\tthis._pruneTiles();\n\t},\n\n\t_updateLevels: function () {\n\t},\n\n\t_initTile: function () {\n\t},\n\n\t_pruneTiles: function () {\n\t\tif (app.file.fileBasedView)\n\t\t\tthis._updateFileBasedView(true);\n\n\t\tvar key, tile;\n\n\t\tfor (key in this._tiles) {\n\t\t\ttile = this._tiles[key];\n\t\t\ttile.retain = tile.current;\n\t\t}\n\n\t\tfor (key in this._tiles) {\n\t\t\ttile = this._tiles[key];\n\t\t\tif (tile.current && !tile.active) {\n\t\t\t\tvar coords = tile.coords;\n\t\t\t\tif (!this._retainParent(coords.x, coords.y, coords.z, coords.part, coords.z - 5)) {\n\t\t\t\t\tthis._retainChildren(coords.x, coords.y, coords.z, coords.part, coords.z + 2);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tfor (key in this._tiles) {\n\t\t\tif (!this._tiles[key].retain) {\n\t\t\t\tthis._removeTile(key);\n\t\t\t}\n\t\t}\n\t},\n\n\t_setZoomTransforms: function () {\n\t},\n\n\t_setZoomTransform: function () {\n\t},\n\n\t_getTilePos: function (coords) {\n\t\treturn coords.getPos();\n\t},\n\n\t_wrapCoords: function (coords) {\n\t\treturn new L.TileCoordData(\n\t\t\tthis._wrapX ? L.Util.wrapNum(coords.x, this._wrapX) : coords.x,\n\t\t\tthis._wrapY ? L.Util.wrapNum(coords.y, this._wrapY) : coords.y,\n\t\t\tcoords.z,\n\t\t\tcoords.part);\n\t},\n\n\t_pxBoundsToTileRanges: function (bounds) {\n\t\tif (!this._splitPanesContext) {\n\t\t\treturn [this._pxBoundsToTileRange(bounds)];\n\t\t}\n\n\t\tvar boundList = this._splitPanesContext.getPxBoundList(bounds);\n\t\treturn boundList.map(this._pxBoundsToTileRange, this);\n\t},\n\n\t_pxBoundsToTileRange: function (bounds) {\n\t\treturn new L.Bounds(\n\t\t\tbounds.min.divideBy(this._tileSize).floor(),\n\t\t\tbounds.max.divideBy(this._tileSize).floor());\n\t},\n\n\t_corePixelsToCss: function (corePixels) {\n\t\treturn corePixels.divideBy(app.dpiScale);\n\t},\n\n\t_cssPixelsToCore: function (cssPixels) {\n\t\treturn cssPixels.multiplyBy(app.dpiScale);\n\t},\n\n\t_cssBoundsToCore: function (bounds) {\n\t\treturn new L.Bounds(\n\t\t\tthis._cssPixelsToCore(bounds.min),\n\t\t\tthis._cssPixelsToCore(bounds.max)\n\t\t);\n\t},\n\n\t_twipsToCorePixels: function (twips) {\n\t\treturn new L.Point(\n\t\t\ttwips.x / this._tileWidthTwips * this._tileSize,\n\t\t\ttwips.y / this._tileHeightTwips * this._tileSize);\n\t},\n\n\t_twipsToCorePixelsBounds: function (twips) {\n\t\treturn new L.Bounds(\n\t\t\tthis._twipsToCorePixels(twips.min),\n\t\t\tthis._twipsToCorePixels(twips.max)\n\t\t);\n\t},\n\n\t_corePixelsToTwips: function (corePixels) {\n\t\treturn new L.Point(\n\t\t\tcorePixels.x / this._tileSize * this._tileWidthTwips,\n\t\t\tcorePixels.y / this._tileSize * this._tileHeightTwips);\n\t},\n\n\t_twipsToCssPixels: function (twips) {\n\t\treturn new L.Point(\n\t\t\t(twips.x / this._tileWidthTwips) * (this._tileSize / app.dpiScale),\n\t\t\t(twips.y / this._tileHeightTwips) * (this._tileSize / app.dpiScale));\n\t},\n\n\t_cssPixelsToTwips: function (pixels) {\n\t\treturn new L.Point(\n\t\t\t((pixels.x * app.dpiScale) / this._tileSize) * this._tileWidthTwips,\n\t\t\t((pixels.y * app.dpiScale) / this._tileSize) * this._tileHeightTwips);\n\t},\n\n\t_twipsToLatLng: function (twips, zoom) {\n\t\tvar pixels = this._twipsToCssPixels(twips);\n\t\treturn this._map.unproject(pixels, zoom);\n\t},\n\n\t_latLngToTwips: function (latLng, zoom) {\n\t\tvar pixels = this._map.project(latLng, zoom);\n\t\treturn this._cssPixelsToTwips(pixels);\n\t},\n\n\t_latLngToCorePixels: function(latLng, zoom) {\n\t\tvar pixels = this._map.project(latLng, zoom);\n\t\treturn new L.Point (\n\t\t\tpixels.x * app.dpiScale,\n\t\t\tpixels.y * app.dpiScale);\n\t},\n\n\t_twipsToPixels: function (twips) { // css pixels\n\t\treturn this._twipsToCssPixels(twips);\n\t},\n\n\t_pixelsToTwips: function (pixels) { // css pixels\n\t\treturn this._cssPixelsToTwips(pixels);\n\t},\n\n\t_twipsToCoords: function (twips) {\n\t\treturn new L.TileCoordData(\n\t\t\tMath.round(twips.x / twips.tileWidth) * this._tileSize,\n\t\t\tMath.round(twips.y / twips.tileHeight) * this._tileSize);\n\t},\n\n\t_coordsToTwips: function (coords) {\n\t\treturn new L.Point(\n\t\t\tMath.floor(coords.x / this._tileSize) * this._tileWidthTwips,\n\t\t\tMath.floor(coords.y / this._tileSize) * this._tileHeightTwips);\n\t},\n\n\t_isValidTile: function (coords) {\n\t\tif (coords.x < 0 || coords.y < 0) {\n\t\t\treturn false;\n\t\t}\n\t\telse if ((coords.x / this._tileSize) * this._tileWidthTwips > this._docWidthTwips ||\n\t\t\t(coords.y / this._tileSize) * this._tileHeightTwips > this._docHeightTwips) {\n\t\t\treturn false;\n\t\t}\n\t\telse\n\t\t\treturn true;\n\t},\n\n\t_updateMaxBounds: function (sizeChanged) {\n\t\tif (this._docWidthTwips === undefined || this._docHeightTwips === undefined) {\n\t\t\treturn;\n\t\t}\n\n\t\tvar docPixelLimits = new L.Point(app.file.size.pixels[0] / app.dpiScale, app.file.size.pixels[1] / app.dpiScale);\n\t\tvar scrollPixelLimits = new L.Point(app.view.size.pixels[0] / app.dpiScale, app.view.size.pixels[1] / app.dpiScale);\n\t\tvar topLeft = this._map.unproject(new L.Point(0, 0));\n\n\t\tif (this._documentInfo === '' || sizeChanged) {\n\t\t\t// we just got the first status so we need to center the document\n\t\t\tthis._map.setDocBounds(new L.LatLngBounds(topLeft, this._map.unproject(docPixelLimits)));\n\t\t\tthis._map.setMaxBounds(new L.LatLngBounds(topLeft, this._map.unproject(scrollPixelLimits)));\n\t\t}\n\n\t\tthis._docPixelSize = {x: docPixelLimits.x, y: docPixelLimits.y};\n\t\tthis._map.fire('scrolllimits', {x: scrollPixelLimits.x, y: scrollPixelLimits.y});\n\t},\n\n\t// Used with filebasedview.\n\t_getMostVisiblePart: function (queue) {\n\t\tvar parts = [];\n\t\tvar found = false;\n\n\t\tfor (var i = 0; i < queue.length; i++) {\n\t\t\tfor (var j = 0; j < parts.length; j++) {\n\t\t\t\tif (parts[j].part === queue[i].part) {\n\t\t\t\t\tfound = true;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (!found)\n\t\t\t\tparts.push({part: queue[i].part});\n\t\t\tfound = false;\n\t\t}\n\n\t\tvar ratio = this._tileSize / this._tileHeightTwips;\n\t\tvar partHeightPixels = Math.round((this._partHeightTwips + this._spaceBetweenParts) * ratio);\n\t\tvar partWidthPixels = Math.round(this._partWidthTwips * ratio);\n\n\t\tvar rectangle;\n\t\tvar maxArea = -1;\n\t\tvar mostVisiblePart = 0;\n\t\tvar docBoundsRectangle = app.sectionContainer.getDocumentBounds();\n\t\tdocBoundsRectangle[2] = docBoundsRectangle[2] - docBoundsRectangle[0];\n\t\tdocBoundsRectangle[3] = docBoundsRectangle[3] - docBoundsRectangle[1];\n\t\tfor (i = 0; i < parts.length; i++) {\n\t\t\trectangle = [0, partHeightPixels * parts[i].part, partWidthPixels, partHeightPixels];\n\t\t\trectangle = L.LOUtil._getIntersectionRectangle(rectangle, docBoundsRectangle);\n\t\t\tif (rectangle) {\n\t\t\t\tif (rectangle[2] * rectangle[3] > maxArea) {\n\t\t\t\t\tmaxArea = rectangle[2] * rectangle[3];\n\t\t\t\t\tmostVisiblePart = parts[i].part;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn mostVisiblePart;\n\t},\n\n\t_doesQueueIncludeTileInfo: function (queue, part, x, y) {\n\t\tfor (var i = 0; i < queue.length; i++) {\n\t\t\tif (queue[i].part === part && queue[i].x === x && queue[i].y === y)\n\t\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t},\n\n\t_sortFileBasedQueue: function (queue) {\n\t\tfor (var i = 0; i < queue.length - 1; i++) {\n\t\t\tfor (var j = i + 1; j < queue.length; j++) {\n\t\t\t\tvar a = queue[i];\n\t\t\t\tvar b = queue[j];\n\t\t\t\tvar switchTiles = false;\n\n\t\t\t\tif (a.part === b.part) {\n\t\t\t\t\tif (a.y > b.y) {\n\t\t\t\t\t\tswitchTiles = true;\n\t\t\t\t\t}\n\t\t\t\t\telse if (a.y === b.y) {\n\t\t\t\t\t\tswitchTiles = a.x > b.x;\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tswitchTiles = false;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tswitchTiles = a.part > b.part;\n\t\t\t\t}\n\n\t\t\t\tif (switchTiles) {\n\t\t\t\t\tvar temp = a;\n\t\t\t\t\tqueue[i] = b;\n\t\t\t\t\tqueue[j] = temp;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t},\n\n\thighlightCurrentPart: function (part) {\n\t\tvar previews = document.getElementsByClassName('preview-frame');\n\t\tfor (var i = 0; i < previews.length; i++) {\n\t\t\tif (parseInt(previews[i].id.replace('preview-frame-part-', '')) === part) {\n\t\t\t\tpreviews[i].style.border = '2px solid darkgrey';\n\t\t\t}\n\t\t\telse {\n\t\t\t\tpreviews[i].style.border = 'none';\n\t\t\t}\n\t\t}\n\t},\n\n\t// Used with file based view. Check the most visible part and set the selected part if needed.\n\t_checkSelectedPart: function () {\n\t\tvar queue = this._updateFileBasedView(true);\n\t\tif (queue.length > 0) {\n\t\t\tvar partToSelect = this._getMostVisiblePart(queue);\n\t\t\tif (this._selectedPart !== partToSelect) {\n\t\t\t\tthis._selectedPart = partToSelect;\n\t\t\t\tthis._preview._scrollToPart();\n\t\t\t\tthis.highlightCurrentPart(partToSelect);\n\t\t\t\tapp.socket.sendMessage('setclientpart part=' + this._selectedPart);\n\t\t\t}\n\t\t}\n\t},\n\n\t_updateFileBasedView: function (checkOnly, zoomFrameBounds, forZoom) {\n\t\tif (this._partHeightTwips === 0) // This is true before status message is handled.\n\t\t\treturn [];\n\t\tif (this._isZooming)\n\t\t\treturn [];\n\n\t\tif (!checkOnly) {\n\t\t\t// zoomFrameBounds and forZoom params were introduced to work only in checkOnly mode.\n\t\t\twindow.app.console.assert(zoomFrameBounds === undefined, 'zoomFrameBounds must only be supplied when checkOnly is true');\n\t\t\twindow.app.console.assert(forZoom === undefined, 'forZoom must only be supplied when checkOnly is true');\n\t\t}\n\n\t\tif (forZoom !== undefined) {\n\t\t\twindow.app.console.assert(zoomFrameBounds, 'zoomFrameBounds must be valid when forZoom is specified');\n\t\t}\n\n\t\tvar zoom = forZoom || Math.round(this._map.getZoom());\n\t\tvar currZoom = Math.round(this._map.getZoom());\n\t\tvar relScale = currZoom == zoom ? 1 : this._map.getZoomScale(zoom, currZoom);\n\n\t\tvar ratio = this._tileSize * relScale / this._tileHeightTwips;\n\t\tvar partHeightPixels = Math.round((this._partHeightTwips + this._spaceBetweenParts) * ratio);\n\t\tvar partWidthPixels = Math.round((this._partWidthTwips) * ratio);\n\n\t\tvar intersectionAreaRectangle = L.LOUtil._getIntersectionRectangle(app.file.viewedRectangle, [0, 0, partWidthPixels, partHeightPixels * this._parts]);\n\n\t\tvar queue = [];\n\n\t\tif (intersectionAreaRectangle) {\n\t\t\tvar minLocalX = Math.floor(intersectionAreaRectangle[0] / app.tile.size.pixels[0]) * app.tile.size.pixels[0];\n\t\t\tvar maxLocalX = Math.floor((intersectionAreaRectangle[0] + intersectionAreaRectangle[2]) / app.tile.size.pixels[0]) * app.tile.size.pixels[0];\n\n\t\t\tvar startPart = Math.floor(intersectionAreaRectangle[1] / partHeightPixels);\n\t\t\tvar startY = app.file.viewedRectangle[1] - startPart * partHeightPixels;\n\t\t\tstartY = Math.floor(startY / app.tile.size.pixels[1]) * app.tile.size.pixels[1];\n\n\t\t\tvar endPart = Math.ceil((intersectionAreaRectangle[1] + intersectionAreaRectangle[3]) / partHeightPixels);\n\t\t\tvar endY = app.file.viewedRectangle[1] + app.file.viewedRectangle[3] - endPart * partHeightPixels;\n\t\t\tendY = Math.floor(endY / app.tile.size.pixels[1]) * app.tile.size.pixels[1];\n\n\t\t\tvar vTileCountPerPart = Math.ceil(partHeightPixels / app.tile.size.pixels[1]);\n\n\t\t\tfor (var i = startPart; i < endPart; i++) {\n\t\t\t\tfor (var j = minLocalX; j <= maxLocalX; j += app.tile.size.pixels[0]) {\n\t\t\t\t\tfor (var k = 0; k <= vTileCountPerPart * app.tile.size.pixels[0]; k += app.tile.size.pixels[1])\n\t\t\t\t\t\tif ((i !== startPart || k >= startY) && (i !== endPart || k <= endY))\n\t\t\t\t\t\t\tqueue.push(new L.TileCoordData(j, k, zoom, i));\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis._sortFileBasedQueue(queue);\n\n\t\t\tfor (i = 0; i < this._tiles.length; i++) {\n\t\t\t\tthis._tiles[i].current = false; // Visible ones's \"current\" property will be set to true below.\n\t\t\t}\n\n\t\t\tvar allNewTiles = true;\n\t\t\tfor (i = 0; i < queue.length; i++) {\n\t\t\t\tvar tempTile = this._tiles[this._tileCoordsToKey(queue[i])];\n\t\t\t\tif (tempTile && tempTile.loaded) {\n\t\t\t\t\ttempTile.current = true;\n\t\t\t\t\tallNewTiles = false;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (allNewTiles && !checkOnly)\n\t\t\t\tthis._cancelTiles();\n\t\t}\n\n\t\tif (checkOnly) {\n\t\t\treturn queue;\n\t\t}\n\t\telse {\n\t\t\tthis._sendClientVisibleArea();\n\t\t\tthis._sendClientZoom();\n\n\t\t\tfor (var i = 0; i < queue.length; i++) {\n\t\t\t\tvar key = this._tileCoordsToKey(queue[i]);\n\t\t\t\tvar tile = this._tiles[key];\n\t\t\t\tif (!tile) {\n\t\t\t\t\ttile = this.createTile(this._wrapCoords(queue[i]), L.bind(this._tileReady, this, queue[i]));\n\n\t\t\t\t\t// save tile in cache\n\t\t\t\t\tthis._tiles[key] = {\n\t\t\t\t\t\tel: tile,\n\t\t\t\t\t\twid: 0,\n\t\t\t\t\t\tcoords: queue[i],\n\t\t\t\t\t\tcurrent: true\n\t\t\t\t\t};\n\n\t\t\t\t\tif (tile && this._tileCache[key]) {\n\t\t\t\t\t\ttile.el = this._tileCache[key];\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tthis._sendTileCombineRequest(queue[i].part, (queue[i].x / this._tileSize) * this._tileWidthTwips, (queue[i].y / this._tileSize) * this._tileHeightTwips);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse if (!tile.loaded) {\n\t\t\t\t\tthis._sendTileCombineRequest(queue[i].part, (queue[i].x / this._tileSize) * this._tileWidthTwips, (queue[i].y / this._tileSize) * this._tileHeightTwips);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t},\n\n\t_update: function (center, zoom) {\n\t\tvar map = this._map;\n\t\tif (!map || this._documentInfo === '') {\n\t\t\treturn;\n\t\t}\n\n\t\t// Calc: do not set view area too early after load and before we get the cursor position.\n\t\tif (this.isCalc() && !this._gotFirstCellCursor)\n\t\t\treturn;\n\n\t\t// be sure canvas is initialized already and has correct size\n\t\tvar size = map.getSize();\n\t\tif (size.x === 0 || size.y === 0) {\n\t\t\tsetTimeout(function () { this._update(); }.bind(this), 1);\n\t\t\treturn;\n\t\t}\n\n\t\tif (app.file.fileBasedView) {\n\t\t\tthis._updateFileBasedView();\n\t\t\treturn;\n\t\t}\n\n\t\tif (center === undefined) { center = map.getCenter(); }\n\t\tif (zoom === undefined) { zoom = Math.round(map.getZoom()); }\n\n\t\tvar pixelBounds = map.getPixelBoundsCore(center, zoom);\n\t\tvar tileRanges = this._pxBoundsToTileRanges(pixelBounds);\n\t\tvar queue = [];\n\n\t\tfor (var key in this._tiles) {\n\t\t\tvar thiscoords = this._keyToTileCoords(key);\n\t\t\tif (thiscoords.z !== zoom ||\n\t\t\t\tthiscoords.part !== this._selectedPart) {\n\t\t\t\tthis._tiles[key].current = false;\n\t\t\t}\n\t\t}\n\n\t\t// If there are panes that need new tiles for its entire area, cancel previous requests.\n\t\tvar cancelTiles = false;\n\t\tvar paneNewView;\n\t\t// create a queue of coordinates to load tiles from\n\t\tfor (var rangeIdx = 0; rangeIdx < tileRanges.length; ++rangeIdx) {\n\t\t\tpaneNewView = true;\n\t\t\tvar tileRange = tileRanges[rangeIdx];\n\t\t\tfor (var j = tileRange.min.y; j <= tileRange.max.y; ++j) {\n\t\t\t\tfor (var i = tileRange.min.x; i <= tileRange.max.x; ++i) {\n\t\t\t\t\tvar coords = new L.TileCoordData(\n\t\t\t\t\t\ti * this._tileSize,\n\t\t\t\t\t\tj * this._tileSize,\n\t\t\t\t\t\tzoom,\n\t\t\t\t\t\tthis._selectedPart);\n\n\t\t\t\t\tif (!this._isValidTile(coords)) { continue; }\n\n\t\t\t\t\tkey = this._tileCoordsToKey(coords);\n\t\t\t\t\tvar tile = this._tiles[key];\n\t\t\t\t\tvar invalid = tile && tile._invalidCount && tile._invalidCount > 0;\n\t\t\t\t\tif (tile && tile.loaded && !invalid) {\n\t\t\t\t\t\ttile.current = true;\n\t\t\t\t\t\tpaneNewView = false;\n\t\t\t\t\t} else if (invalid) {\n\t\t\t\t\t\ttile._invalidCount = 1;\n\t\t\t\t\t\tqueue.push(coords);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tqueue.push(coords);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (paneNewView) {\n\t\t\t\tcancelTiles = true;\n\t\t\t}\n\t\t}\n\n\t\tthis._sendClientVisibleArea();\n\t\tthis._sendClientZoom();\n\n\t\tif (this._masterPageChanged) {\n\t\t\t// avoid cancelling tiles on masterpage view switches\n\t\t\t// it will be cancelled updateOnPartChange when necessary\n\t\t\tthis._masterPageChanged = false;\n\t\t\tcancelTiles = false;\n\t\t}\n\n\t\tif (queue.length !== 0) {\n\t\t\tif (cancelTiles) {\n\t\t\t\t// we know that a new set of tiles (that completely cover one/more panes) has been requested\n\t\t\t\t// so we're able to cancel the previous requests that are being processed\n\t\t\t\tthis._cancelTiles();\n\t\t\t}\n\n\t\t\tthis._addTiles(queue);\n\t\t}\n\t},\n\n\t_sendClientVisibleArea: function (forceUpdate) {\n\t\tif (!this._map._docLoaded)\n\t\t\treturn;\n\n\t\tvar splitPos = this._splitPanesContext ? this._splitPanesContext.getSplitPos() : new L.Point(0, 0);\n\n\t\tvar visibleArea = this._map.getPixelBounds();\n\t\tvisibleArea = new L.Bounds(\n\t\t\tthis._pixelsToTwips(visibleArea.min),\n\t\t\tthis._pixelsToTwips(visibleArea.max)\n\t\t);\n\t\tsplitPos = this._corePixelsToTwips(splitPos);\n\t\tvar size = visibleArea.getSize();\n\t\tvar visibleTopLeft = visibleArea.min;\n\t\tvar newClientVisibleArea = 'clientvisiblearea x=' + Math.round(visibleTopLeft.x)\n\t\t\t\t\t+ ' y=' + Math.round(visibleTopLeft.y)\n\t\t\t\t\t+ ' width=' + Math.round(size.x)\n\t\t\t\t\t+ ' height=' + Math.round(size.y)\n\t\t\t\t\t+ ' splitx=' + Math.round(splitPos.x)\n\t\t\t\t\t+ ' splity=' + Math.round(splitPos.y);\n\n\t\tif (this._clientVisibleArea !== newClientVisibleArea || forceUpdate) {\n\t\t\t// Visible area is dirty, update it on the server\n\t\t\tapp.socket.sendMessage(newClientVisibleArea);\n\t\t\tif (!this._map._fatal && this._map._active && app.socket.connected())\n\t\t\t\tthis._clientVisibleArea = newClientVisibleArea;\n\t\t\tif (this._debug) {\n\t\t\t\tthis._debugInfo.clearLayers();\n\t\t\t\tfor (var key in this._tiles) {\n\t\t\t\t\tthis._tiles[key]._debugPopup = null;\n\t\t\t\t\tthis._tiles[key]._debugTile = null;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t},\n\n\t_updateOnChangePart: function () {\n\t\tvar map = this._map;\n\t\tif (!map || this._documentInfo === '') {\n\t\t\treturn;\n\t\t}\n\t\tvar key, coords, tile;\n\t\tvar center = map.getCenter();\n\t\tvar zoom = Math.round(map.getZoom());\n\n\t\tvar pixelBounds = map.getPixelBoundsCore(center, zoom);\n\t\tvar tileRanges = this._pxBoundsToTileRanges(pixelBounds);\n\t\tvar queue = [];\n\n\t\tfor (key in this._tiles) {\n\t\t\tvar thiscoords = this._keyToTileCoords(key);\n\t\t\tif (thiscoords.z !== zoom ||\n\t\t\t\tthiscoords.part !== this._selectedPart) {\n\t\t\t\tthis._tiles[key].current = false;\n\t\t\t}\n\t\t}\n\n\t\t// If there are panes that need new tiles for its entire area, cancel previous requests.\n\t\tvar cancelTiles = false;\n\t\tvar paneNewView;\n\t\t// create a queue of coordinates to load tiles from\n\t\tfor (var rangeIdx = 0; rangeIdx < tileRanges.length; ++rangeIdx) {\n\t\t\tpaneNewView = true;\n\t\t\tvar tileRange = tileRanges[rangeIdx];\n\t\t\tfor (var j = tileRange.min.y; j <= tileRange.max.y; j++) {\n\t\t\t\tfor (var i = tileRange.min.x; i <= tileRange.max.x; i++) {\n\t\t\t\t\tcoords = new L.TileCoordData(\n\t\t\t\t\t\ti * this._tileSize,\n\t\t\t\t\t\tj * this._tileSize,\n\t\t\t\t\t\tzoom,\n\t\t\t\t\t\tthis._selectedPart);\n\n\t\t\t\t\tif (!this._isValidTile(coords)) { continue; }\n\n\t\t\t\t\tkey = this._tileCoordsToKey(coords);\n\t\t\t\t\ttile = this._tiles[key];\n\t\t\t\t\tif (tile) {\n\t\t\t\t\t\ttile.current = true;\n\t\t\t\t\t\tpaneNewView = false;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tqueue.push(coords);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (paneNewView) {\n\t\t\t\tcancelTiles = true;\n\t\t\t}\n\t\t}\n\n\t\tif (queue.length !== 0) {\n\t\t\tif (cancelTiles) {\n\t\t\t\t// we know that a new set of tiles (that completely cover one/more panes) has been requested\n\t\t\t\t// so we're able to cancel the previous requests that are being processed\n\t\t\t\tthis._cancelTiles();\n\t\t\t}\n\n\t\t\tvar tilePositionsX = '';\n\t\t\tvar tilePositionsY = '';\n\n\t\t\tfor (i = 0; i < queue.length; i++) {\n\t\t\t\tcoords = queue[i];\n\t\t\t\tkey = this._tileCoordsToKey(coords);\n\t\t\t\ttile = undefined;\n\t\t\t\tif (coords.part === this._selectedPart) {\n\t\t\t\t\tvar tileImg = this.createTile(this._wrapCoords(coords), L.bind(this._tileReady, this, coords));\n\n\t\t\t\t\t// if createTile is defined with a second argument (\"done\" callback),\n\t\t\t\t\t// we know that tile is async and will be ready later; otherwise\n\t\t\t\t\tif (this.createTile.length < 2) {\n\t\t\t\t\t\t// mark tile as ready, but delay one frame for opacity animation to happen\n\t\t\t\t\t\tsetTimeout(L.bind(this._tileReady, this, coords, null, tileImg), 0);\n\t\t\t\t\t}\n\n\t\t\t\t\t// save tile in cache\n\t\t\t\t\tthis._tiles[key] = tile = {\n\t\t\t\t\t\tel: tileImg,\n\t\t\t\t\t\tcoords: coords,\n\t\t\t\t\t\tcurrent: true\n\t\t\t\t\t};\n\t\t\t\t}\n\n\t\t\t\tif (!this._tileCache[key]) {\n\t\t\t\t\tvar twips = this._coordsToTwips(coords);\n\t\t\t\t\tif (tilePositionsX !== '') {\n\t\t\t\t\t\ttilePositionsX += ',';\n\t\t\t\t\t}\n\t\t\t\t\ttilePositionsX += twips.x;\n\t\t\t\t\tif (tilePositionsY !== '') {\n\t\t\t\t\t\ttilePositionsY += ',';\n\t\t\t\t\t}\n\t\t\t\t\ttilePositionsY += twips.y;\n\t\t\t\t}\n\t\t\t\telse if (tile) {\n\t\t\t\t\ttile.el = this._tileCache[key];\n\t\t\t\t\ttile.loaded = true;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (tilePositionsX !== '' && tilePositionsY !== '') {\n\t\t\t\tthis._sendTileCombineRequest(this._selectedPart, tilePositionsX, tilePositionsY);\n\t\t\t}\n\t\t\telse {\n\t\t\t\t// We have all necessary tile images in the cache, schedule a paint..\n\t\t\t\t// This may not be immediate if we are now in a slurp events call.\n\t\t\t\tthis._painter.update();\n\t\t\t}\n\t\t}\n\t},\n\n\t_tileReady: function (coords, err, tile) {\n\t\tif (!this._map) { return; }\n\n\t\tif (err) {\n\t\t\tthis.fire('tileerror', {\n\t\t\t\terror: err,\n\t\t\t\ttile: tile,\n\t\t\t\tcoords: coords\n\t\t\t});\n\t\t}\n\n\t\tvar key = this._tileCoordsToKey(coords);\n\n\t\ttile = this._tiles[key];\n\t\tif (!tile) { return; }\n\n\t\tvar emptyTilesCountChanged = false;\n\t\tif (this._emptyTilesCount > 0) {\n\t\t\tthis._emptyTilesCount -= 1;\n\t\t\temptyTilesCountChanged = true;\n\t\t}\n\n\t\tif (emptyTilesCountChanged && this._emptyTilesCount === 0) {\n\t\t\tthis._map.fire('statusindicator', { statusType: 'alltilesloaded' });\n\t\t}\n\n\t\ttile.loaded = +new Date();\n\t\ttile.active = true;\n\n\t\t// Don't paint the tile, only dirty the sectionsContainer if it is in the visible area.\n\t\t// _emitSlurpedTileEvents() will repaint canvas (if it is dirty).\n\t\tif (this._painter.coordsIntersectVisible(coords)) {\n\t\t\tthis._painter._sectionContainer.setDirty();\n\t\t}\n\n\t\tif (this._noTilesToLoad()) {\n\t\t\tthis.fire('load');\n\t\t\tthis._pruneTiles();\n\t\t}\n\t},\n\n\t_addTiles: function (coordsQueue) {\n\t\tvar coords, key, tile;\n\t\t// first take care of the DOM\n\t\tfor (var i = 0; i < coordsQueue.length; i++) {\n\t\t\tcoords = coordsQueue[i];\n\n\t\t\tkey = this._tileCoordsToKey(coords);\n\n\t\t\tif (coords.part === this._selectedPart) {\n\t\t\t\tif (!this._tiles[key]) {\n\t\t\t\t\tvar tileImg = this.createTile(this._wrapCoords(coords), L.bind(this._tileReady, this, coords));\n\n\t\t\t\t\t// if createTile is defined with a second argument (\"done\" callback),\n\t\t\t\t\t// we know that tile is async and will be ready later; otherwise\n\t\t\t\t\tif (this.createTile.length < 2) {\n\t\t\t\t\t\t// mark tile as ready, but delay one frame for opacity animation to happen\n\t\t\t\t\t\tsetTimeout(L.bind(this._tileReady, this, coords, null, tileImg), 0);\n\t\t\t\t\t}\n\n\t\t\t\t\t// save tile in cache\n\t\t\t\t\tthis._tiles[key] = tile = {\n\t\t\t\t\t\tel: tileImg,\n\t\t\t\t\t\twid: 0,\n\t\t\t\t\t\tcoords: coords,\n\t\t\t\t\t\tcurrent: true\n\t\t\t\t\t};\n\n\t\t\t\t\tif (tile && this._tileCache[key]) {\n\t\t\t\t\t\ttile.el = this._tileCache[key];\n\t\t\t\t\t\ttile.loaded = true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// sort the tiles by the rows\n\t\tcoordsQueue.sort(function (a, b) {\n\t\t\tif (a.y !== b.y) {\n\t\t\t\treturn a.y - b.y;\n\t\t\t} else {\n\t\t\t\treturn a.x - b.x;\n\t\t\t}\n\t\t});\n\n\t\t// try group the tiles into rectangular areas\n\t\tvar rectangles = [];\n\t\twhile (coordsQueue.length > 0) {\n\t\t\tcoords = coordsQueue[0];\n\n\t\t\t// tiles that do not interest us\n\t\t\tkey = this._tileCoordsToKey(coords);\n\t\t\tif (this._tileCache[key] || coords.part !== this._selectedPart) {\n\t\t\t\tcoordsQueue.splice(0, 1);\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tvar rectQueue = [coords];\n\t\t\tvar bound = coords.getPos(); // L.Point\n\n\t\t\t// remove it\n\t\t\tcoordsQueue.splice(0, 1);\n\n\t\t\t// find the close ones\n\t\t\tvar rowLocked = false;\n\t\t\tvar hasHole = false;\n\t\t\ti = 0;\n\t\t\twhile (i < coordsQueue.length) {\n\t\t\t\tvar current = coordsQueue[i];\n\n\t\t\t\t// extend the bound vertically if possible (so far it was\n\t\t\t\t// continuous)\n\t\t\t\tif (!hasHole && (current.y === bound.y + this._tileSize)) {\n\t\t\t\t\trowLocked = true;\n\t\t\t\t\tbound.y += this._tileSize;\n\t\t\t\t}\n\n\t\t\t\tif (current.y > bound.y) {\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t\tif (!rowLocked) {\n\t\t\t\t\tif (current.y === bound.y && current.x === bound.x + this._tileSize) {\n\t\t\t\t\t\t// extend the bound horizontally\n\t\t\t\t\t\tbound.x += this._tileSize;\n\t\t\t\t\t\trectQueue.push(current);\n\t\t\t\t\t\tcoordsQueue.splice(i, 1);\n\t\t\t\t\t} else {\n\t\t\t\t\t\t// ignore the rest of the row\n\t\t\t\t\t\trowLocked = true;\n\t\t\t\t\t\t++i;\n\t\t\t\t\t}\n\t\t\t\t} else if (current.x <= bound.x && current.y <= bound.y) {\n\t\t\t\t\t// we are inside the bound\n\t\t\t\t\trectQueue.push(current);\n\t\t\t\t\tcoordsQueue.splice(i, 1);\n\t\t\t\t} else {\n\t\t\t\t\t// ignore this one, but there still may be other tiles\n\t\t\t\t\thasHole = true;\n\t\t\t\t\t++i;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\trectangles.push(rectQueue);\n\t\t}\n\n\t\tvar twips;\n\t\tfor (var r = 0; r < rectangles.length; ++r) {\n\t\t\trectQueue = rectangles[r];\n\t\t\tvar tilePositionsX = '';\n\t\t\tvar tilePositionsY = '';\n\t\t\tvar tileWids = '';\n\t\t\tfor (i = 0; i < rectQueue.length; i++) {\n\t\t\t\tcoords = rectQueue[i];\n\t\t\t\tkey = this._tileCoordsToKey(coords);\n\n\t\t\t\ttwips = this._coordsToTwips(coords);\n\n\t\t\t\tif (tilePositionsX !== '')\n\t\t\t\t\ttilePositionsX += ',';\n\t\t\t\ttilePositionsX += twips.x;\n\n\t\t\t\tif (tilePositionsY !== '')\n\t\t\t\t\ttilePositionsY += ',';\n\t\t\t\ttilePositionsY += twips.y;\n\n\t\t\t\ttile = this._tiles[this._tileCoordsToKey(coords)];\n\t\t\t\tif (tileWids !== '')\n\t\t\t\t\ttileWids += ',';\n\t\t\t\ttileWids += tile && tile.wireId !== undefined ? tile.wireId : 0;\n\t\t\t}\n\n\t\t\ttwips = this._coordsToTwips(coords);\n\t\t\tthis._sendTileCombineRequest(coords.part, tilePositionsX, tilePositionsY);\n\t\t}\n\t},\n\n\t_cancelTiles: function () {\n\t\tapp.socket.sendMessage('canceltiles');\n\t\tfor (var key in this._tiles) {\n\t\t\tvar tile = this._tiles[key];\n\t\t\t// When _invalidCount > 0 the tile has been invalidated, however the new tile content\n\t\t\t// has not yet been fetched and because of `canceltiles` message it will never be\n\t\t\t// so we need to remove the tile, or when the tile is back inside the visible area\n\t\t\t// its content would be the old invalidated one. Drop only those tiles which are not in\n\t\t\t// the new visible area.\n\t\t\t// example: a tile is invalidated but a sudden scroll to the cell cursor position causes\n\t\t\t// to move the tile out of the visible area before the new content is fetched\n\n\t\t\tvar dropTile = !tile.loaded;\n\t\t\tvar coords = tile.coords;\n\t\t\tif (coords.part === this._selectedPart) {\n\n\t\t\t\tvar tileBounds;\n\t\t\t\tif (!this._splitPanesContext) {\n\t\t\t\t\tvar tileTopLeft = this._coordsToTwips(coords);\n\t\t\t\t\tvar tileBottomRight = new L.Point(this._tileWidthTwips, this._tileHeightTwips);\n\t\t\t\t\ttileBounds = new L.Bounds(tileTopLeft, tileTopLeft.add(tileBottomRight));\n\t\t\t\t\tvar visibleTopLeft = this._latLngToTwips(this._map.getBounds().getNorthWest());\n\t\t\t\t\tvar visibleBottomRight = this._latLngToTwips(this._map.getBounds().getSouthEast());\n\t\t\t\t\tvar visibleArea = new L.Bounds(visibleTopLeft, visibleBottomRight);\n\n\t\t\t\t\tdropTile |= (tile._invalidCount > 0 && !visibleArea.intersects(tileBounds));\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tvar tilePos = coords.getPos();\n\t\t\t\t\ttileBounds = new L.Bounds(tilePos, tilePos.add(new L.Point(this._tileSize, this._tileSize)));\n\t\t\t\t\tdropTile |= (tile._invalidCount > 0 &&\n\t\t\t\t\t\t!this._splitPanesContext.intersectsVisible(tileBounds));\n\t\t\t\t}\n\t\t\t}\n\t\t\telse {\n\t\t\t\tdropTile |= tile._invalidCount > 0;\n\t\t\t}\n\n\n\t\t\tif (dropTile) {\n\t\t\t\tdelete this._tiles[key];\n\t\t\t\tif (this._debug && this._debugDataCancelledTiles) {\n\t\t\t\t\tthis._debugCancelledTiles++;\n\t\t\t\t\tthis._debugDataCancelledTiles.setPrefix('Cancelled tiles: ' + this._debugCancelledTiles);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tthis._emptyTilesCount = 0;\n\t},\n\n\t_checkTileMsgObject: function (msgObj) {\n\t\tif (typeof msgObj !== 'object' ||\n\t\t\ttypeof msgObj.x !== 'number' ||\n\t\t\ttypeof msgObj.y !== 'number' ||\n\t\t\ttypeof msgObj.tileWidth !== 'number' ||\n\t\t\ttypeof msgObj.tileHeight !== 'number' ||\n\t\t\ttypeof msgObj.part !== 'number') {\n\t\t\twindow.app.console.error('Unexpected content in the parsed tile message.');\n\t\t}\n\t},\n\n\t_tileMsgToCoords: function (tileMsg) {\n\t\tvar coords = this._twipsToCoords(tileMsg);\n\t\tcoords.z = tileMsg.zoom;\n\t\tcoords.part = tileMsg.part;\n\t\treturn coords;\n\t},\n\n\t_tileCoordsToKey: function (coords) {\n\t\treturn coords.key();\n\t},\n\n\t_keyToTileCoords: function (key) {\n\t\treturn L.TileCoordData.parseKey(key);\n\t},\n\n\t_keyToBounds: function (key) {\n\t\treturn this._tileCoordsToBounds(this._keyToTileCoords(key));\n\t},\n\n\t_tileCoordsToBounds: function (coords) {\n\n\t\tvar map = this._map;\n\t\tvar tileSize = this._getTileSize();\n\n\t\tvar nwPoint = new L.Point(coords.x, coords.y);\n\t\tvar sePoint = nwPoint.add([tileSize, tileSize]);\n\t\tnwPoint = this._corePixelsToCss(nwPoint);\n\t\tsePoint = this._corePixelsToCss(sePoint);\n\n\t\tvar nw = map.wrapLatLng(map.unproject(nwPoint, coords.z));\n\t\tvar se = map.wrapLatLng(map.unproject(sePoint, coords.z));\n\n\t\treturn new L.LatLngBounds(nw, se);\n\t},\n\n\t_removeTile: function (key) {\n\t\tvar tile = this._tiles[key];\n\t\tif (!tile) { return; }\n\n\t\t// FIXME: this _tileCache is used for prev/next slide; but it is\n\t\t// dangerous in connection with typing / invalidation\n\t\tif (!(this._tiles[key]._invalidCount > 0) && tile.el.src) {\n\t\t\tthis._tileCache[key] = tile.el;\n\t\t}\n\n\t\tif (!tile.loaded && this._emptyTilesCount > 0) {\n\t\t\tthis._emptyTilesCount -= 1;\n\t\t}\n\n\t\tif (this._debug && this._debugInfo && this._tiles[key]._debugPopup) {\n\t\t\tthis._debugInfo.removeLayer(this._tiles[key]._debugPopup);\n\t\t}\n\t\tdelete this._tiles[key];\n\n\t\tthis.fire('tileunload', {\n\t\t\ttile: tile.el,\n\t\t\tcoords: this._keyToTileCoords(key)\n\t\t});\n\t},\n\n\t_prefetchTilesSync: function () {\n\t\tif (!this._prefetcher)\n\t\t\tthis._prefetcher = new L.TilesPreFetcher(this, this._map);\n\t\tthis._prefetcher.preFetchTiles(true /* forceBorderCalc */, true /* immediate */);\n\t},\n\n\t_preFetchTiles: function (forceBorderCalc) {\n\t\tif (this._prefetcher) {\n\t\t\tthis._prefetcher.preFetchTiles(forceBorderCalc);\n\t\t}\n\t},\n\n\t_resetPreFetching: function (resetBorder) {\n\t\tif (!this._prefetcher) {\n\t\t\tthis._prefetcher = new L.TilesPreFetcher(this, this._map);\n\t\t}\n\n\t\tthis._prefetcher.resetPreFetching(resetBorder);\n\t},\n\n\t_clearPreFetch: function () {\n\t\tif (this._prefetcher) {\n\t\t\tthis._prefetcher.clearPreFetch();\n\t\t}\n\t},\n\n\t_clearTilesPreFetcher: function () {\n\t\tif (this._prefetcher) {\n\t\t\tthis._prefetcher.clearTilesPreFetcher();\n\t\t}\n\t},\n\n\t_onTileMsgFileBasedView: function (textMsg, img) {\n\t\tvar tileMsgObj = app.socket.parseServerCmd(textMsg);\n\t\tvar coords = this._tileMsgToCoords(tileMsgObj);\n\t\tvar tile = this._tiles[this._tileCoordsToKey(coords)];\n\n\t\tif (tileMsgObj.id !== undefined) {\n\t\t\tthis._map.fire('tilepreview', {\n\t\t\t\ttile: img,\n\t\t\t\tid: tileMsgObj.id,\n\t\t\t\twidth: tileMsgObj.width,\n\t\t\t\theight: tileMsgObj.height,\n\t\t\t\tpart: tileMsgObj.part,\n\t\t\t\tdocType: this._docType\n\t\t\t});\n\t\t}\n\t\telse if (tile) {\n\t\t\tif (tile._invalidCount > 0) {\n\t\t\t\ttile._invalidCount -= 1;\n\t\t\t}\n\n\t\t\ttile.el = img;\n\t\t\ttile.wireId = tileMsgObj.wireId;\n\t\t\ttile.loaded = true;\n\t\t\tthis._tileReady(coords, null, tile);\n\t\t}\n\n\t\t// Send acknowledgment, that the tile message arrived\n\t\tvar tileID = tileMsgObj.part + ':' + tileMsgObj.x + ':' + tileMsgObj.y + ':' + tileMsgObj.tileWidth + ':' + tileMsgObj.tileHeight + ':' + tileMsgObj.nviewid;\n\t\tapp.socket.sendMessage('tileprocessed tile=' + tileID);\n\t},\n\n\t_onTileMsg: function (textMsg, img) {\n\t\tif (app.file.fileBasedView) {\n\t\t\tthis._onTileMsgFileBasedView(textMsg, img);\n\t\t\treturn;\n\t\t}\n\n\t\tvar tileMsgObj = app.socket.parseServerCmd(textMsg);\n\t\tthis._checkTileMsgObject(tileMsgObj);\n\t\tvar coords = this._tileMsgToCoords(tileMsgObj);\n\t\tvar key = this._tileCoordsToKey(coords);\n\t\tvar tile = this._tiles[key];\n\t\tif (this._debug && tile) {\n\t\t\tif (tile._debugLoadCount) {\n\t\t\t\ttile._debugLoadCount++;\n\t\t\t\tthis._debugLoadCount++;\n\t\t\t} else {\n\t\t\t\ttile._debugLoadCount = 1;\n\t\t\t\ttile._debugInvalidateCount = 1;\n\t\t\t}\n\t\t\tif (!tile._debugPopup) {\n\t\t\t\tvar tileBound = this._keyToBounds(key);\n\t\t\t\ttile._debugPopup = L.popup({ className: 'debug', offset: new L.Point(0, 0), autoPan: false, closeButton: false, closeOnClick: false })\n\t\t\t\t\t.setLatLng(new L.LatLng(tileBound.getSouth(), tileBound.getWest() + (tileBound.getEast() - tileBound.getWest()) / 5));\n\t\t\t\tthis._debugInfo.addLayer(tile._debugPopup);\n\t\t\t\tif (this._debugTiles[key]) {\n\t\t\t\t\tthis._debugInfo.removeLayer(this._debugTiles[key]);\n\t\t\t\t}\n\t\t\t\ttile._debugTile = L.rectangle(tileBound, { color: 'blue', weight: 1, fillOpacity: 0, pointerEvents: 'none' });\n\t\t\t\tthis._debugTiles[key] = tile._debugTile;\n\t\t\t\ttile._debugTime = this._debugGetTimeArray();\n\t\t\t\tthis._debugInfo.addLayer(tile._debugTile);\n\t\t\t}\n\t\t\tif (tile._debugTime.date === 0) {\n\t\t\t\ttile._debugPopup.setContent('requested: ' + this._tiles[key]._debugInvalidateCount + '<br>received: ' + this._tiles[key]._debugLoadCount);\n\t\t\t} else {\n\t\t\t\ttile._debugPopup.setContent('requested: ' + this._tiles[key]._debugInvalidateCount + '<br>received: ' + this._tiles[key]._debugLoadCount +\n\t\t\t\t\t'<br>' + this._debugSetTimes(tile._debugTime, +new Date() - tile._debugTime.date).replace(/, /g, '<br>'));\n\t\t\t}\n\t\t\tif (tile._debugTile) {\n\t\t\t\ttile._debugTile.setStyle({ fillOpacity: (tileMsgObj.renderid === 'cached') ? 0.1 : 0, fillColor: 'yellow' });\n\t\t\t}\n\t\t\tthis._debugShowTileData();\n\t\t}\n\t\tif (tileMsgObj.id !== undefined) {\n\t\t\tthis._map.fire('tilepreview', {\n\t\t\t\ttile: img,\n\t\t\t\tid: tileMsgObj.id,\n\t\t\t\twidth: tileMsgObj.width,\n\t\t\t\theight: tileMsgObj.height,\n\t\t\t\tpart: tileMsgObj.part,\n\t\t\t\tdocType: this._docType\n\t\t\t});\n\t\t}\n\t\telse if (tile) {\n\t\t\tif (this._tiles[key]._invalidCount > 0) {\n\t\t\t\tthis._tiles[key]._invalidCount -= 1;\n\t\t\t}\n\n\t\t\ttile.wireId = tileMsgObj.wireId;\n\t\t\tif (this._map._canvasDevicePixelGrid)\n\t\t\t\t// browser/test/pixel-test.png\n\t\t\t\ttile.el.src = 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQAAAAEACAIAAADTED8xAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH5QEIChoQ0oROpwAAAB1pVFh0Q29tbWVudAAAAAAAQ3JlYXRlZCB3aXRoIEdJTVBkLmUHAAACfklEQVR42u3dO67CQBBFwbnI+9/yJbCQLDIkPsZdFRAQjjiv3S8YZ63VNsl6aLvgop5+6vFzZ3QP/uQz2c0RIAAQAAzcASwAmAAgABAACAAEAAIAAYAAQAAgABAACAAEAAIAAYAAQAAgABAACADGBnC8iQ5MABAACAB+zsVYjLZ9dOvd3zzg/QOYADByB/BvUCzBIAAQAFiCwQQAAYAAQAAgABAACAAEAAIAAYAAQAAgABAACAAEAAIAAYAAQAAwIgAXb2ECgABAAPDaI7SLsZhs+79kvX8AEwDsAM8DASzBIAAQAFiCwQQAAYAAQAAgABAAAgABgABAACAAEAAIAAQAAgABgABAACAAEAAIAAQAAgABgABAACAAEAAIAAQAAgABgABAACAAEAAIAAQAAgABgABAACAAEAAIAAQAAgABgABAACAAEAAI4LSSOAQBgABAAPDVR9C2ToGxNkfww623bZL98/ilUzIBwA4wbCAgABAACAAswWACgABAACAAEAAIAAQAAgABgABAACAAEAAIAAQAAgABgABAAAjAESAAEAAIAAQAAgABgABAACAAEAAIAAQAAgABgABAACAAEAAIAAQAAgABgABAACAAEAAIAAQAAgABgABAACAAEAAIAAQAAgABgABAACAAEAAIAAQAAgABgABAACAAEAAIAAGAAEAAIAAQAAgABAACAAGAAEAAIAAQAAgAPiaJAEAAIAB48yNWW6fAWJsj4LRbb9sk++fxSxMA7AAMGwgCAAGAAMASDCYACAAEAAIAAYAAQAAgABAACAAEAAIAASAAR4AAQAAgABAACAAEANeW9e675sAEAAGAAODUO4AFgMnu7t9h2ahA0pgAAAAASUVORK5CYII=';\n\t\t\telse {\n\t\t\t\ttile.el = img;\n\t\t\t\ttile.loaded = true;\n\t\t\t\tthis._tileReady(coords, null /* err */, tile);\n\t\t\t}\n\t\t}\n\t\tL.Log.log(textMsg, 'INCOMING', key);\n\n\t\t// Send acknowledgment, that the tile message arrived\n\t\tvar tileID = tileMsgObj.part + ':' + tileMsgObj.x + ':' + tileMsgObj.y + ':' + tileMsgObj.tileWidth + ':' + tileMsgObj.tileHeight + ':' + tileMsgObj.nviewid;\n\t\tapp.socket.sendMessage('tileprocessed tile=' + tileID);\n\t},\n\n\t_coordsToPixBounds: function (coords) {\n\t\t// coords.x and coords.y are the pixel coordinates of the top-left corner of the tile.\n\t\tvar topLeft = new L.Point(coords.x, coords.y);\n\t\tvar bottomRight = topLeft.add(new L.Point(this._tileSize, this._tileSize));\n\t\treturn new L.Bounds(topLeft, bottomRight);\n\t},\n\n\tupdateHorizPaneSplitter: function () {\n\n\t\tvar map = this._map;\n\n\t\tif (!this._xSplitter) {\n\t\t\tthis._xSplitter = new CSplitterLine(\n\t\t\t\tmap, {\n\t\t\t\t\tname: 'horiz-pane-splitter',\n\t\t\t\t\tfillColor: this._splittersStyleData.getPropValue('color'),\n\t\t\t\t\tfillOpacity: this._splittersStyleData.getFloatPropValue('opacity'),\n\t\t\t\t\tthickness: Math.round(\n\t\t\t\t\t\tthis._splittersStyleData.getFloatPropWithoutUnit('border-top-width')\n\t\t\t\t\t\t* app.dpiScale),\n\t\t\t\t\tisHoriz: true\n\t\t\t\t});\n\n\t\t\tthis._canvasOverlay.initPath(this._xSplitter);\n\t\t}\n\t\telse {\n\t\t\tthis._xSplitter.onPositionChange();\n\t\t}\n\t},\n\n\tupdateVertPaneSplitter: function () {\n\n\t\tvar map = this._map;\n\n\t\tif (!this._ySplitter) {\n\t\t\tthis._ySplitter = new CSplitterLine(\n\t\t\t\tmap, {\n\t\t\t\t\tname: 'vert-pane-splitter',\n\t\t\t\t\tfillColor: this._splittersStyleData.getPropValue('color'),\n\t\t\t\t\tfillOpacity: this._splittersStyleData.getFloatPropValue('opacity'),\n\t\t\t\t\tthickness: Math.round(\n\t\t\t\t\t\tthis._splittersStyleData.getFloatPropWithoutUnit('border-top-width')\n\t\t\t\t\t\t* app.dpiScale),\n\t\t\t\t\tisHoriz: false\n\t\t\t\t});\n\n\t\t\tthis._canvasOverlay.initPath(this._ySplitter);\n\t\t}\n\t\telse {\n\t\t\tthis._ySplitter.onPositionChange();\n\t\t}\n\t},\n\n\thasXSplitter: function () {\n\t\treturn !!(this._xSplitter);\n\t},\n\n\thasYSplitter: function () {\n\t\treturn !!(this._ySplitter);\n\t},\n\n\tgetTileSectionPos: function () {\n\t\treturn this._painter.getTileSectionPos();\n\t},\n\n\t_coordsToTileBounds: function (coords) {\n\t\tvar zoomFactor = this._map.zoomToFactor(coords.z);\n\t\tvar tileTopLeft = new L.Point(\n\t\t\tcoords.x * this.options.tileWidthTwips / this._tileSize / zoomFactor,\n\t\t\tcoords.y * this.options.tileHeightTwips / this._tileSize / zoomFactor);\n\t\tvar tileSize = new L.Point(this.options.tileWidthTwips / zoomFactor, this.options.tileHeightTwips / zoomFactor);\n\t\treturn new L.Bounds(tileTopLeft, tileTopLeft.add(tileSize));\n\t},\n\n\tisLayoutRTL: function () {\n\t\treturn !!this._layoutIsRTL;\n\t},\n\n\tisCalcRTL: function () {\n\t\treturn this.isCalc() && this.isLayoutRTL();\n\t}\n\n});\n\nL.TilesPreFetcher = L.Class.extend({\n\n\tinitialize: function (docLayer, map) {\n\t\tthis._docLayer = docLayer;\n\t\tthis._map = map;\n\t},\n\n\tpreFetchTiles: function (forceBorderCalc, immediate) {\n\t\tif (app.file.fileBasedView && this._docLayer)\n\t\t\tthis._docLayer._updateFileBasedView();\n\n\t\tif (this._docLayer._emptyTilesCount > 0 || !this._map || !this._docLayer) {\n\t\t\treturn;\n\t\t}\n\n\t\tvar center = this._map.getCenter();\n\t\tvar zoom = this._map.getZoom();\n\t\tvar part = this._docLayer._selectedPart;\n\t\tvar hasEditPerm = this._map.isPermissionEdit();\n\n\t\tif (this._zoom === undefined) {\n\t\t\tthis._zoom = zoom;\n\t\t}\n\n\t\tif (this._preFetchPart === undefined) {\n\t\t\tthis._preFetchPart = part;\n\t\t}\n\n\t\tif (this._hasEditPerm === undefined) {\n\t\t\tthis._hasEditPerm = hasEditPerm;\n\t\t}\n\n\t\tvar maxTilesToFetch = 10;\n\t\t// don't search on a border wider than 5 tiles because it will freeze the UI\n\t\tvar maxBorderWidth = 5;\n\n\t\tif (hasEditPerm) {\n\t\t\tmaxTilesToFetch = 5;\n\t\t\tmaxBorderWidth = 3;\n\t\t}\n\n\t\tvar tileSize = this._docLayer._tileSize;\n\t\tvar pixelBounds = this._map.getPixelBoundsCore(center, zoom);\n\n\t\tif (this._pixelBounds === undefined) {\n\t\t\tthis._pixelBounds = pixelBounds;\n\t\t}\n\n\t\tvar splitPanesContext = this._docLayer.getSplitPanesContext();\n\t\tvar splitPos = splitPanesContext ? splitPanesContext.getSplitPos() : new L.Point(0, 0);\n\n\t\tif (this._splitPos === undefined) {\n\t\t\tthis._splitPos = splitPos;\n\t\t}\n\n\t\tvar paneXFixed = false;\n\t\tvar paneYFixed = false;\n\n\t\tif (forceBorderCalc ||\n\t\t\t!this._borders || this._borders.length === 0 ||\n\t\t\tzoom !== this._zoom ||\n\t\t\tpart !== this._preFetchPart ||\n\t\t\thasEditPerm !== this._hasEditPerm ||\n\t\t\t!pixelBounds.equals(this._pixelBounds) ||\n\t\t\t!splitPos.equals(this._splitPos)) {\n\n\t\t\tthis._zoom = zoom;\n\t\t\tthis._preFetchPart = part;\n\t\t\tthis._hasEditPerm = hasEditPerm;\n\t\t\tthis._pixelBounds = pixelBounds;\n\t\t\tthis._splitPos = splitPos;\n\n\t\t\t// Need to compute borders afresh and fetch tiles for them.\n\t\t\tthis._borders = []; // Stores borders for each split-pane.\n\t\t\tvar tileRanges = this._docLayer._pxBoundsToTileRanges(pixelBounds);\n\t\t\tvar paneStatusList = splitPanesContext ? splitPanesContext.getPanesProperties() :\n\t\t\t\t[ { xFixed: false, yFixed: false} ];\n\n\t\t\twindow.app.console.assert(tileRanges.length === paneStatusList.length, 'tileRanges and paneStatusList should agree on the number of split-panes');\n\n\t\t\tfor (var paneIdx = 0; paneIdx < tileRanges.length; ++paneIdx) {\n\t\t\t\tpaneXFixed = paneStatusList[paneIdx].xFixed;\n\t\t\t\tpaneYFixed = paneStatusList[paneIdx].yFixed;\n\n\t\t\t\tif (paneXFixed && paneYFixed) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tvar tileRange = tileRanges[paneIdx];\n\t\t\t\tvar paneBorder = new L.Bounds(\n\t\t\t\t\ttileRange.min.add(new L.Point(-1, -1)),\n\t\t\t\t\ttileRange.max.add(new L.Point(1, 1))\n\t\t\t\t);\n\n\t\t\t\tthis._borders.push(new L.TilesPreFetcher.PaneBorder(paneBorder, paneXFixed, paneYFixed));\n\t\t\t}\n\n\t\t}\n\n\t\tvar finalQueue = [];\n\t\tvar visitedTiles = {};\n\n\t\tvar validTileRange = new L.Bounds(\n\t\t\tnew L.Point(0, 0),\n\t\t\tnew L.Point(\n\t\t\t\tMath.floor((this._docLayer._docWidthTwips - 1) / this._docLayer._tileWidthTwips),\n\t\t\t\tMath.floor((this._docLayer._docHeightTwips - 1) / this._docLayer._tileHeightTwips)\n\t\t\t)\n\t\t);\n\n\t\tvar tilesToFetch = immediate ? Infinity : maxTilesToFetch; // total tile limit per call of preFetchTiles()\n\t\tvar doneAllPanes = true;\n\n\t\tfor (paneIdx = 0; paneIdx < this._borders.length; ++paneIdx) {\n\n\t\t\tvar queue = [];\n\t\t\tpaneBorder = this._borders[paneIdx];\n\t\t\tvar borderBounds = paneBorder.getBorderBounds();\n\n\t\t\tpaneXFixed = paneBorder.isXFixed();\n\t\t\tpaneYFixed = paneBorder.isYFixed();\n\n\t\t\twhile (tilesToFetch > 0 && paneBorder.getBorderIndex() < maxBorderWidth) {\n\n\t\t\t\tvar clampedBorder = validTileRange.clamp(borderBounds);\n\t\t\t\tvar fetchTopBorder = !paneYFixed && borderBounds.min.y === clampedBorder.min.y;\n\t\t\t\tvar fetchBottomBorder = !paneYFixed && borderBounds.max.y === clampedBorder.max.y;\n\t\t\t\tvar fetchLeftBorder = !paneXFixed && borderBounds.min.x === clampedBorder.min.x;\n\t\t\t\tvar fetchRightBorder = !paneXFixed && borderBounds.max.x === clampedBorder.max.x;\n\n\t\t\t\tif (!fetchLeftBorder && !fetchRightBorder && !fetchTopBorder && !fetchBottomBorder) {\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t\tif (fetchBottomBorder) {\n\t\t\t\t\tfor (var i = clampedBorder.min.x; i <= clampedBorder.max.x; i++) {\n\t\t\t\t\t\t// tiles below the visible area\n\t\t\t\t\t\tvar coords = new L.TileCoordData(\n\t\t\t\t\t\t\ti * tileSize,\n\t\t\t\t\t\t\tborderBounds.max.y * tileSize);\n\t\t\t\t\t\tqueue.push(coords);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (fetchTopBorder) {\n\t\t\t\t\tfor (i = clampedBorder.min.x; i <= clampedBorder.max.x; i++) {\n\t\t\t\t\t\t// tiles above the visible area\n\t\t\t\t\t\tcoords = new L.TileCoordData(\n\t\t\t\t\t\t\ti * tileSize,\n\t\t\t\t\t\t\tborderBounds.min.y * tileSize);\n\t\t\t\t\t\tqueue.push(coords);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (fetchRightBorder) {\n\t\t\t\t\tfor (i = clampedBorder.min.y; i <= clampedBorder.max.y; i++) {\n\t\t\t\t\t\t// tiles to the right of the visible area\n\t\t\t\t\t\tcoords = new L.TileCoordData(\n\t\t\t\t\t\t\tborderBounds.max.x * tileSize,\n\t\t\t\t\t\t\ti * tileSize);\n\t\t\t\t\t\tqueue.push(coords);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (fetchLeftBorder) {\n\t\t\t\t\tfor (i = clampedBorder.min.y; i <= clampedBorder.max.y; i++) {\n\t\t\t\t\t\t// tiles to the left of the visible area\n\t\t\t\t\t\tcoords = new L.TileCoordData(\n\t\t\t\t\t\t\tborderBounds.min.x * tileSize,\n\t\t\t\t\t\t\ti * tileSize);\n\t\t\t\t\t\tqueue.push(coords);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tvar tilesPending = false;\n\t\t\t\tfor (i = 0; i < queue.length; i++) {\n\t\t\t\t\tcoords = queue[i];\n\t\t\t\t\tcoords.z = zoom;\n\t\t\t\t\tcoords.part = this._preFetchPart;\n\t\t\t\t\tvar key = this._docLayer._tileCoordsToKey(coords);\n\n\t\t\t\t\tif (!this._docLayer._isValidTile(coords) ||\n\t\t\t\t\t\tthis._docLayer._tiles[key] ||\n\t\t\t\t\t\tthis._docLayer._tileCache[key] ||\n\t\t\t\t\t\tvisitedTiles[key]) {\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (tilesToFetch > 0) {\n\t\t\t\t\t\tvisitedTiles[key] = true;\n\t\t\t\t\t\tfinalQueue.push(coords);\n\t\t\t\t\t\ttilesToFetch -= 1;\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\ttilesPending = true;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (tilesPending) {\n\t\t\t\t\t// don't update the border as there are still\n\t\t\t\t\t// some tiles to be fetched\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tif (!paneXFixed) {\n\t\t\t\t\tif (borderBounds.min.x > 0) {\n\t\t\t\t\t\tborderBounds.min.x -= 1;\n\t\t\t\t\t}\n\t\t\t\t\tif (borderBounds.max.x < validTileRange.max.x) {\n\t\t\t\t\t\tborderBounds.max.x += 1;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (!paneYFixed) {\n\t\t\t\t\tif (borderBounds.min.y > 0) {\n\t\t\t\t\t\tborderBounds.min.y -= 1;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (borderBounds.max.y < validTileRange.max.y) {\n\t\t\t\t\t\tborderBounds.max.y += 1;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tpaneBorder.incBorderIndex();\n\n\t\t\t} // border width loop end\n\n\t\t\tif (paneBorder.getBorderIndex() < maxBorderWidth) {\n\t\t\t\tdoneAllPanes = false;\n\t\t\t}\n\t\t} // pane loop end\n\n\t\tif (!immediate)\n\t\t\twindow.app.console.assert(finalQueue.length <= maxTilesToFetch,\n\t\t\t\t'finalQueue length(' + finalQueue.length + ') exceeded maxTilesToFetch(' + maxTilesToFetch + ')');\n\n\t\tvar tilesRequested = false;\n\n\t\tif (finalQueue.length > 0) {\n\t\t\tthis._cumTileCount += finalQueue.length;\n\t\t\tthis._docLayer._addTiles(finalQueue);\n\t\t\ttilesRequested = true;\n\t\t}\n\n\t\tif (!tilesRequested || doneAllPanes) {\n\t\t\tthis.clearTilesPreFetcher();\n\t\t\tthis._borders = undefined;\n\t\t}\n\t},\n\n\tresetPreFetching: function (resetBorder) {\n\n\t\tif (!this._map) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis.clearPreFetch();\n\n\t\tif (resetBorder) {\n\t\t\tthis._borders = undefined;\n\t\t}\n\n\t\tvar interval = 750;\n\t\tvar idleTime = 5000;\n\t\tthis._preFetchPart = this._docLayer._selectedPart;\n\t\tthis._preFetchIdle = setTimeout(L.bind(function () {\n\t\t\tthis._tilesPreFetcher = setInterval(L.bind(this.preFetchTiles, this), interval);\n\t\t\tthis._preFetchIdle = undefined;\n\t\t\tthis._cumTileCount = 0;\n\t\t}, this), idleTime);\n\t},\n\n\tclearPreFetch: function () {\n\t\tthis.clearTilesPreFetcher();\n\t\tif (this._preFetchIdle !== undefined) {\n\t\t\tclearTimeout(this._preFetchIdle);\n\t\t\tthis._preFetchIdle = undefined;\n\t\t}\n\t},\n\n\tclearTilesPreFetcher: function () {\n\t\tif (this._tilesPreFetcher !== undefined) {\n\t\t\tclearInterval(this._tilesPreFetcher);\n\t\t\tthis._tilesPreFetcher = undefined;\n\t\t}\n\t},\n\n});\n\nL.TilesPreFetcher.PaneBorder = L.Class.extend({\n\n\tinitialize: function(paneBorder, paneXFixed, paneYFixed) {\n\t\tthis._border = paneBorder;\n\t\tthis._xFixed = paneXFixed;\n\t\tthis._yFixed = paneYFixed;\n\t\tthis._index = 0;\n\t},\n\n\tgetBorderIndex: function () {\n\t\treturn this._index;\n\t},\n\n\tincBorderIndex: function () {\n\t\tthis._index += 1;\n\t},\n\n\tgetBorderBounds: function () {\n\t\treturn this._border;\n\t},\n\n\tisXFixed: function () {\n\t\treturn this._xFixed;\n\t},\n\n\tisYFixed: function () {\n\t\treturn this._yFixed;\n\t},\n\n});\n\nL.MessageStore = L.Class.extend({\n\n\t// ownViewTypes : The types of messages related to own view.\n\t// otherViewTypes: The types of messages related to other views.\n\tinitialize: function (ownViewTypes, otherViewTypes) {\n\n\t\tif (!Array.isArray(ownViewTypes) || !Array.isArray(otherViewTypes)) {\n\t\t\twindow.app.console.error('Unexpected argument types');\n\t\t\treturn;\n\t\t}\n\n\t\tvar ownMessages = {};\n\t\townViewTypes.forEach(function (msgType) {\n\t\t\townMessages[msgType] = '';\n\t\t});\n\t\tthis._ownMessages = ownMessages;\n\n\t\tvar othersMessages = {};\n\t\totherViewTypes.forEach(function (msgType) {\n\t\t\tothersMessages[msgType] = [];\n\t\t});\n\t\tthis._othersMessages = othersMessages;\n\t},\n\n\tclear: function () {\n\t\tvar msgs = this._ownMessages;\n\t\tObject.keys(msgs).forEach(function (msgType) {\n\t\t\tmsgs[msgType] = '';\n\t\t});\n\n\t\tmsgs = this._othersMessages;\n\t\tObject.keys(msgs).forEach(function (msgType) {\n\t\t\tmsgs[msgType] = [];\n\t\t});\n\t},\n\n\tsave: function (msgType, textMsg, viewId) {\n\n\t\tvar othersMessage = (typeof viewId === 'number');\n\n\t\tif (!othersMessage && Object.prototype.hasOwnProperty.call(this._ownMessages, msgType)) {\n\t\t\tthis._ownMessages[msgType] = textMsg;\n\t\t\treturn;\n\t\t}\n\n\t\tif (othersMessage && Object.prototype.hasOwnProperty.call(this._othersMessages, msgType)) {\n\t\t\tthis._othersMessages[msgType][viewId] = textMsg;\n\t\t}\n\t},\n\n\tget: function (msgType, viewId) {\n\n\t\tvar othersMessage = (typeof viewId === 'number');\n\n\t\tif (!othersMessage && Object.prototype.hasOwnProperty.call(this._ownMessages, msgType)) {\n\t\t\treturn this._ownMessages[msgType];\n\t\t}\n\n\t\tif (othersMessage && Object.prototype.hasOwnProperty.call(this._othersMessages, msgType)) {\n\t\t\treturn this._othersMessages[msgType][viewId];\n\t\t}\n\t},\n\n\tforEach: function (callback) {\n\t\tif (typeof callback !== 'function') {\n\t\t\twindow.app.console.error('Invalid callback type');\n\t\t\treturn;\n\t\t}\n\n\t\tthis._cleanUpSelectionMessages(this._ownMessages);\n\n\t\tvar ownMessages = this._ownMessages;\n\t\tObject.keys(this._ownMessages).forEach(function (msgType) {\n\t\t\tcallback(ownMessages[msgType]);\n\t\t});\n\n\t\tvar othersMessages = this._othersMessages;\n\t\tObject.keys(othersMessages).forEach(function (msgType) {\n\t\t\tothersMessages[msgType].forEach(callback);\n\t\t});\n\t},\n\n\t_cleanUpSelectionMessages: function(messages) {\n\t\t// must be called only from _replayPrintTwipsMsg !!\n\t\t// check if textselection is empty\n\t\t// if it is, we need to handle textselectionstart and textselectionend\n\t\t// otherwise we get handles without selection and they also may appear in the wrong cell\n\t\t// but it is also reproducible on the same cell too. e.g. selection handles without selection\n\t\tif (!messages && !messages['textselection'] && messages['textselection'] !== 'textselection: ')\n\t\t\treturn;\n\t\tmessages['textselectionstart'] = 'textselectionstart: ';\n\t\tmessages['textselectionend'] = 'textselectionend: ';\n\t}\n});\n"]}