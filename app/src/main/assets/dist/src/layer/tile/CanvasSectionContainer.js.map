{"version":3,"file":"CanvasSectionContainer.js","sourceRoot":"","sources":["../../../../../../../../../browser/src/layer/tile/CanvasSectionContainer.ts"],"names":[],"mappings":"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","sourcesContent":["declare var L: any;\ndeclare var app: any;\n\n// Below classes are for managing the canvas layout.\n/*\n\tPotential values are separated with '|'\n\tAll pixels are in core pixels.\n \tSupports multi touch with 2 fingers.\n \tThis class uses only native events. There is: No timer for anything & no longpress for desktop & no doubleclick for touch screen & no wheel for touchscreen etc.\n\n\tPropagated events:  All events are propagated between \"bound sections\".\n\t\t\t\t\t\tIf 2 sections overlap but not bound, only top section gets the event.\n\n\tlowestPropagatedBoundSection:\n\t\t\tThis property applies to bound sections.\n\t\t\tBound sections are like layers. They overlap entirely.\n\t\t\tEvery bound section should share same zIndex unless there is a very good reason for different zIndex values.\n\t\t\tTo make a section \"bound\" to another, one can use \"boundToSection\" property (section name - string).\n\t\t\tWhen 2 or more sections are bound, the top section will get the event first.\n\t\t\tIf a section handles the event and calls stopPropagating function, the bound sections after that section won't get the event.\n\t\t\tExample scenario:\n\t\t\t\tEvent: drag\n\t\t\t\tTop section handles event.\n\t\t\t\tMiddle section handles the event and then calls \"stopPropagating\" function. From this point, top section still handles the event until the end of the event.\n\t\t\t\tBottom section doesn't get the event.\n\n\t\t\tIf stopPropagating function is called, it is valid until the end of the event. So for events like dragging, calling\n\t\t\tthe function only once is enough. When the event is lasted, lowestPropagatedBoundSection variable is set to null automatically.\n\n\tNew section's options:\n\tname: 'tiles' | 'row headers' | 'column headers' | 'markers & cursor' | 'shapes' | 'scroll' etc.\n\tanchor: 'top left' | 'top right' | 'bottom left' | 'bottom right' (Examples: For row & column headers, anchor will be 'top left'; If we would want to draw something sticked to bottom, it would be 'bottom left' or 'bottom right').\n\t\tOne can also anchor sections to other sections' edges.\n\t\tOrder is important, first variables are related to top or bottom, next ones are related to left or right.\n\t\tExamples:\n\t\t1- [[\"column header\", \"bottom\", \"some section name\", \"top\", \"top\"], \"left\"]\n\t\t\t^ If \"column header\" section exists, its bottom will be section's top\n\t\t\tIf \"some section name\" exists, its top will be section's top.\n\t\t\tIf none of them exists, canvas's top will be used as anchor.\n\t\t\tCanvas's left will be used as horizontal anchor.\n\t\t2- [[\"column header\", \"bottom\", \"ruler\", \"bottom\", \"top\"], [\"row header\", \"right\", \"left\"]]\n\t\tIt is also possible to position a section's right edge anchor to another section's left edge by using a special option '-left'.\n\n\tposition: [0, 0] | [10, 50] | [x, y] // Related to anchor. Example 'bottom right': P(0, 0) is bottom right etc. myTopLeft is updated according to position and anchor.\n\n\tdocumentObject:\n\t\t* This means that the section is a document object. So its anchor can only be \"top left\", it doesn't need to be set.\n\t\t* Container's documentAnchorSectionName should be set for enabling document objects.\n\t\t* For this type of sections, only \"size\" and \"position\" are meaningful.\n\t\t* Position is the object's position inside the document.\n\t\t* So a document object is not a UI element, other sections are UI elements and their positions and sizes can be managed by the section container.\n\t\t* Document objects' positions and sizes are not managed by the section container.\n\t\t* When \"onDraw\" function of a document-object section is called, the canvas pen is positioned to the coordinate of the document object. So the section can draw from point (0, 0)\n\t\t* Before \"onDraw\" function is called, section's \"isVisible\" property is set. If the object is visible inside the viewed area (even partially), the property value will be true, if not, it will be false.\n\n\twindowSection:\tBound sections overlap entirely, their sizes and locations are the same.\n\t\t\t\t\tEvents are propagated \"only\" between bound sections.\n\t\t\t\t\tWhen an event occurs, the target section is found and local coordinates are calculated.\n\t\t\t\t\tSince the same coordinates are valid for the bound sections beneath the target section, we can easily propagate the event to those bound sections.\n\t\t\t\t\tIf 2 sections intersect but not bound, the top section gets the event and event is not propagated to the intersecting section.\n\t\t\t\t\tThis type of propagation reduces the computational load of the CanvasSectionContainer.\n\n\t\t\t\t\tNow, the document is placed inside TilesSection and we need to scroll / zoom the document.\n\t\t\t\t\tIf we bind the ScrollSection to TilesSection, we can easily scroll the document using event propagation.\n\t\t\t\t\tBut now we have CommentListSection next to TilesSection. We also want to be able to scroll the document when mouse is above CommentListSection.\n\t\t\t\t\tThis request needs a top handler to be met.\n\t\t\t\t\tTop handlers (sections) will handle events like scroll & zoom universally.\n\t\t\t\t\tUsers will be able to scroll the document while the mouse pointer is above CommentListSection.\n\t\t\t\t\tSo the solution to problems like scrolling is using \"windowSection\"s.\n\n\t\t\t\t\tA window section is always the first to handle an event and its size is equal to canvas element's size.\n\t\t\t\t\tAn event is propagated for the target section after window section handles it.\n\t\t\t\t\tA window section can stop propagation of the event.\n\t\t\t\t\t\"Window section\"s drawing order and zIndex can be set. So it will be drawn accordingly.\n\n\t\t\t\t\tIf:\n\t\t\t\t\t\tWe don't want to handle the event with the window section while mouse is above \"section X\".\n\t\t\t\t\t\t\tCheck canvasSectionContainer.targetSection property. It shows the actual target of the event.\n\t\t\t\t\t\t\t\tExample:\tA document object is being moved and window section shouldn't scroll the document.\n\t\t\t\t\t\t\t\t\t\t\tWindow section will check the containerObject.targetSection (string) and see it is a document object.\n\t\t\t\t\t\tWe are handling keyboard events with a window section so there is no target section?\n\t\t\t\t\t\t\tCheck the containerObject.activeSection property, if it is not included in your list, don't handle the keyboard event with the window section.\n\t\t\t\t\t\t\tOne should set and keep up to date the containerObject.activeSection (string) property accordingly.\n\n\tsize: [100, 100] | [10, 20] | [maxX, maxY] // This doesn't restrict the drawable area, that is up to implementation. Size is not important for expanded directions. Expandable size is assigned after calculations.\n\tzIndex: Elements with highest zIndex will be drawn on top.\n\texpand: '' | 'right' | 'left' | 'top' | 'bottom' | 'left right top bottom' (any combination)\n\tinteractable: true | false // If false, only general events will be fired (onDraw, newDocumentTopLeft, onResize). Example: editing mode, background drawings etc.\n\tdrawingOrder: Sections with the same zIndex value are drawn according to their drawing order values.\n\t\tSection with the highest drawing order is drawn on top (for specific zIndex).\n\t\tSo, in terms of being drawn on top, priority is: zIndex > drawingOrder.\n\tprocessingOrder:\n\n\tProcessing order feature is tricky, let's say you want something like this:\n\n\t--------------------\n\t|     top bar      |\n\t--------------------\n\t--------- ----------\n\t| left  | | tiles  |\n\t| bar   | | area   |\n\t--------- ----------\n\n\tTop bar's height will be static most probably. It needs to be drawn first, so it can be expanded to right.\n\tIf top bar is processed after tiles area, since \"tiles area\" will most probably be expanded to all directions, it will leave no space for top bar.\n\tSo, tiles area will be processed last.\n\tFor above situation, processing orders would be (with the same zIndex):\n\t* top bar -> 1\n\t* left bar -> 2\n\t* tiles area -> 3\n\n\tAnd \"expand\" properties would be like below:\n\t\ttop bar: 'right' from position (0, 0)\n\t\tleft bar: 'top bottom' from position (0, 200) -> So it will go up and find where top bar ends, then go down and find where canvas ends.\n\t\ttiles area: 'top bottom left right' from position like (300, 300) -> So it won't overlap with resulting positions of others (or it can stuck inside one of them).\n\n\tExpandable sections' dimensions are calculated according to other sections with the same zIndex.\n\n\tBelow events trigger a redraw:\n\t* Adding a new section.\n\t* Click.\n\t* Double click.\n\t* Renewing all sections (optional redraw).\n\t* Requesting a redraw.\n\n\tEvery section has a \"section\" property inside \"sectionProperties\".\n\n\tEvent handling:\n\t\tMouse event combinations:\n\t\t\tmouse down + mouse up + click\n\t\t\tmouse down + mouse up + click + mouse down + mouse up + click + double click\n\t\t\tmouse move (if mouse is down, \"draggingSomething\" = true)\n\t\t\tmouse down + mouse move (dragging) + mouse up\n\t\t\tmouse wheel\n\t\t\tmouse enter\n\t\t\tmouse leave\n\n\t\tTouch event combinations:\n\t\t\tmouse down + mouse up + click\n\t\t\tmouse down + long press + mouse up\n\t\t\tmouse down + mouse move (it means dragging, \"draggingSomething\" = true) + mouse up // There is no \"mouse move\" event without dragging (for touch events)\n\t\t\tmouse down + multi touch start + multi touch move + multi touch end\n*/\n\n// This class will be used internally by CanvasSectionContainer.\nclass CanvasSectionObject {\n\tcontext: CanvasRenderingContext2D = null;\n\tmyTopLeft: Array<number> = null;\n\tdocumentTopLeft: Array<number> = null; // Document top left will be updated by container.\n\tcontainerObject: CanvasSectionContainer = null;\n\tname: string = null;\n\tbackgroundColor: string = null; // Defult is null (container's background color will be used).\n\tbackgroundOpacity: number = 1; // Valid when backgroundColor is valid.\n\tborderColor: string = null; // Default is null (no borders).\n\tboundToSection: string = null;\n\tanchor: Array<string> = new Array(0);\n\tdocumentObject: boolean = false; // If true, the section is a document object.\n\t// When section is a document object, its position should be the real position inside the document, in core pixels.\n\tisVisible: boolean = false; // Is section visible on the viewed area of the document? This property is valid for document objects. This is managed by the section container.\n\tshowSection: boolean = true; // Show / hide section.\n\tposition: Array<number> = new Array(0);\n\tisCollapsed: boolean = false;\n\tsize: Array<number> = new Array(0);\n\torigSizeHint: undefined | Array<number> = undefined; // This is used to preserve the original size provided on construct.\n\texpand: Array<string> = new Array(0);\n\tisLocated: boolean = false; // location and size of the section computed yet ?\n\tprocessingOrder: number = null;\n\tdrawingOrder: number = null;\n\tzIndex: number = null;\n\tinteractable: boolean = true;\n\tisAnimating: boolean = false;\n\twindowSection: boolean = false;\n\tsectionProperties: any = {};\n\t/// Paramaters: null (use sectionProperties).\n\tonInitialize: () => void;\n\n\t/// Parameters: Point [x, y], DragDistance [x, y] (null when not dragging), e (native event object)\n\tonMouseMove: (point: Array<number>, dragDistance: Array<number>, e: MouseEvent) => void;\n\n\t/// Parameters: Point [x, y], e (native event object)\n\tonMouseDown: (point: Array<number>, e: MouseEvent) => void;\n\n\t/// Parameters: Point [x, y], e (native event object)\n\tonMouseUp: (point: Array<number>, e: MouseEvent) => void;\n\n\t/// Parameters: Point [x, y], e (native event object)\n\tonMouseEnter: (point: Array<number>, e: MouseEvent) => void;\n\n\t/// Parameters: Point [x, y], e (native event object)\n\tonMouseLeave: (point: Array<number>, e: MouseEvent) => void;\n\n\t/// Parameters: Point [x, y], e (native event object)\n\tonClick: (point: Array<number>, e: MouseEvent) => void;\n\n\t/// Parameters: Point [x, y], e (native event object)\n\tonDoubleClick: (point: Array<number>, e: MouseEvent) => void;\n\n\t/// Parameters: e (native event object)\n\tonContextMenu: (e?: MouseEvent) => void;\n\n\t/// Parameters: Point [x, y], Delta [X, Y], e (native event object)\n\tonMouseWheel: (point: Array<number>, delta: Array<number>, e: MouseEvent) => void;\n\n\t/// Parameters: Point [x, y], e (native event object)\n\tonLongPress: (point: Array<number>, e: MouseEvent) => void;\n\n\t/// Parameters: e (native event object)\n\tonMultiTouchStart: (e: TouchEvent) => void;\n\n\t/// Parameters: Point [x, y], DragDistance, e (native event object)\n\tonMultiTouchMove: (point: Array<number>, dragDistance: number, e: TouchEvent) => void;\n\n\t/// Parameters: e (native event object)\n\tonMultiTouchEnd: (e: TouchEvent) => void;\n\n\t/// Parameters: null (Section's size is up to date when this callback is called.)\n\tonResize: () => void;\n\n\t/// Parameters: null || (frameCount, elapsedTime)\n\tonDraw: (frameCount?: number, elapsedTime?: number) => void;\n\n\t/// Optional Parameters: (area, paneTopLeft, canvasContext) - area is the area to be painted using canvasContext.\n\tonDrawArea: (area?: cool.Bounds, paneTopLeft?: cool.Point, canvasContext?: CanvasRenderingContext2D) => void;\n\n\t/// frameCount, elapsedTime. Sections that will use animation, have to have this function defined.\n\tonAnimationEnded: (frameCount: number, elapsedTime: number) => void;\n\n\t/// Parameters: Size [x, y]\n\tonNewDocumentTopLeft: (size: Array<number>) => void;\n\n\t/// This Function is called right before section is removed.\n\tonRemove: () => void;\n\n\t/// Parameters: integer. Do not implement this. This function is added by section container.\n\tsetDrawingOrder: (drawingOrder: number) => void;\n\n\t/// Parameters: integer. Do not implement this. This function is added by section container.\n\tsetZIndex: (zIndex: number) => void;\n\n\t/// Parameters: string. Do not implement this. This function is added by section container.\n\tbindToSection: (sectionName: string) => void;\n\n\t/// The sections those this section can propagate events to. Updated by container.\n\tboundsList: Array<CanvasSectionObject>;\n\n\t/// Do not implement this. This function is added by section container.\n\tstopPropagating: () => void;\n\n\t/// Do not implement this. This function is added by section container. Return value: boolean.\n\tstartAnimating: (options: any) => boolean;\n\n\t/// Do not implement this. This function is added by section container.\n\tresetAnimation: () => void;\n\n\t/// Do not implement this. This function is added by section container.\n\tgetTestDiv: () => HTMLDivElement;\n\n\t/// Document objects only. Do not implement this. This function is added by section container.\n\tsetPosition: (x: number, y: number) => void;\n\n\t/// Do not implement this. This function is added by section container. This returns if Calc document is in RTL mode\n\tisCalcRTL: () => boolean;\n\n\tconstructor (options: any) {\n\t\tthis.name = options.name;\n\t\tthis.backgroundColor = options.backgroundColor ? options.backgroundColor: null;\n\t\tthis.borderColor = options.borderColor ? options.borderColor: null;\n\t\tthis.anchor = typeof options.anchor === 'string' ? options.anchor.split(' '): options.anchor;\n\t\tthis.position = options.position;\n\t\tthis.size = options.size;\n\t\tthis.expand = options.expand.split(' ');\n\t\tthis.processingOrder = options.processingOrder;\n\t\tthis.drawingOrder = options.drawingOrder;\n\t\tthis.zIndex = options.zIndex;\n\t\tthis.interactable = options.interactable;\n\t\tthis.showSection = options.showSection;\n\t\tthis.sectionProperties = options.sectionProperties ? options.sectionProperties: {};\n\t\tthis.onInitialize = options.onInitialize ? options.onInitialize: function() { return; };\n\t\tthis.onMouseMove = options.onMouseMove ? options.onMouseMove: function() { return; };\n\t\tthis.onMouseDown = options.onMouseDown ? options.onMouseDown: function() { return; };\n\t\tthis.onMouseUp = options.onMouseUp ? options.onMouseUp: function() { return; };\n\t\tthis.onMouseEnter = options.onMouseEnter ? options.onMouseEnter: function() { return; };\n\t\tthis.onMouseLeave = options.onMouseLeave ? options.onMouseLeave: function() { return; };\n\t\tthis.onClick = options.onClick ? options.onClick: function() { return; };\n\t\tthis.onDoubleClick = options.onDoubleClick ? options.onDoubleClick: function() { return; };\n\t\tthis.onContextMenu = options.onContextMenu ? options.onContextMenu: function() { return; };\n\t\tthis.onMouseWheel = options.onMouseWheel ? options.onMouseWheel: function() { return; };\n\t\tthis.onLongPress = options.onLongPress ? options.onLongPress: function() { return; };\n\t\tthis.onMultiTouchStart = options.onMultiTouchStart ? options.onMultiTouchStart: function() { return; };\n\t\tthis.onMultiTouchMove = options.onMultiTouchMove ? options.onMultiTouchMove: function() { return; };\n\t\tthis.onMultiTouchEnd = options.onMultiTouchEnd ? options.onMultiTouchEnd: function() { return; };\n\t\tthis.onResize = options.onResize ? options.onResize: function() { return; };\n\t\tthis.onDraw = options.onDraw ? options.onDraw: function() { return; };\n\t\tthis.onDrawArea = options.onDrawArea ? options.onDrawArea: function() { return; };\n\t\tthis.onNewDocumentTopLeft = options.onNewDocumentTopLeft ? options.onNewDocumentTopLeft: function() { return; };\n\t\tthis.onRemove = options.onRemove ? options.onRemove: function() { return; };\n\t\tthis.onAnimationEnded = options.onAnimationEnded ? options.onAnimationEnded: function() { return; };\n\t}\n}\n\nclass CanvasSectionContainer {\n\t/*\n\t\tAll events will be cached by this class and propagated to sections.\n\t\tThis class should work also mouse & touch enabled (at the same time) devices. Users should be able to use both.\n\t*/\n\n\tprivate sections: Array<any> = new Array(0);\n\tprivate documentTopLeft: Array<number> = [0, 0];\n\tprivate documentBottomRight: Array<number> = [0, 0];\n\tprivate canvas: HTMLCanvasElement;\n\tprivate context: CanvasRenderingContext2D;\n\tprivate right: number;\n\tprivate bottom: number;\n\tprivate positionOnMouseDown: Array<number> = null;\n\tprivate positionOnMouseUp: Array<number> = null;\n\tprivate positionOnClick: Array<number> = null;\n\tprivate positionOnDoubleClick: Array<number> = null;\n\tprivate mousePosition: Array<number> = null;\n\tprivate dragDistance: Array<number> = null;\n\tprivate draggingSomething: boolean = false; // This will be managed by container, used by sections.\n\tprivate sectionOnMouseDown: string = null; // (Will contain section name) When dragging, user can leave section borders, dragging will continue. Target section will be informed.\n\tprivate sectionUnderMouse: string = null; // For mouse enter & leave events.\n\tprivate draggingTolerance: number = 5; // This is for only desktop, mobile browsers seem to distinguish dragging and clicking nicely.\n\tprivate multiTouch: boolean = false;\n\tprivate touchCenter: Array<number> = null;\n\tprivate potentialLongPress: boolean = false;\n\tprivate clearColor: string = '#f8f9fa'; // '#f8f9fa';\n\tprivate touchEventInProgress: boolean = false; // This prevents multiple calling of mouse down and up events.\n\tpublic testing: boolean = false; // If this set to true, container will create a div element for every section. So, cypress tests can find where to click etc.\n\tpublic lowestPropagatedBoundSection: string = null; // Event propagating to bound sections. The first section which stops propagating and the sections those are on top of that section, get the event.\n\tpublic targetSection: string = null;\n\tpublic activeSection: string = null;\n\tprivate scrollLineHeight: number = 30; // This will be overridden.\n\tprivate mouseIsInside: boolean = false;\n\tprivate inZoomAnimation: boolean = false;\n\tprivate zoomChanged: boolean = false;\n\tprivate documentAnchorSectionName: string = null; // This section's top left point declares the point where document starts.\n\tprivate documentAnchor: Array<number> = null; // This is the point where document starts inside canvas element. Initial value shouldn't be [0, 0].\n\t// Above 2 properties can be used with documentBounds.\n\tprivate drawingPaused: number = 0;\n\tprivate drawingEnabled: boolean = true;\n\tprivate dirty: boolean = false;\n\tprivate sectionsDirty: boolean = false;\n\tprivate paintedEver: boolean = false;\n\n\t// For window sections.\n\tprivate windowSectionList: Array<CanvasSectionObject> = [];\n\n\t// Below variables are related to animation feature.\n\tprivate animatingSectionName: string = null; // The section that called startAnimating function. This variable is null when animations are not running.\n\tprivate lastFrameStamp: number = null;\n\tprivate continueAnimating: boolean = null;\n\tprivate frameCount: number = null; // Frame count of the current animation.\n\tprivate duration: number = null; // Duration for the animation.\n\tprivate elapsedTime: number = null; // Time that passed since the animation started.\n\tprivate stoppingFunctionList: Array<EventListener>; // Event listeners need to be removed from the canvas object. So we keep track of their functions.\n\tprivate stoppingEventTypes: Array<string>; // Events those stop the animation.\n\n\tconstructor (canvasDOMElement: HTMLCanvasElement, disableDrawing?: boolean) {\n\t\tthis.canvas = canvasDOMElement;\n\t\tthis.context = canvasDOMElement.getContext('2d', { alpha: false });\n\t\tthis.context.setTransform(1,0,0,1,0,0);\n\t\tdocument.addEventListener('mousemove', this.onMouseMove.bind(this));\n\t\tthis.canvas.onmousedown = this.onMouseDown.bind(this);\n\t\tdocument.addEventListener('mouseup', this.onMouseUp.bind(this));\n\t\tthis.canvas.onclick = this.onClick.bind(this);\n\t\tthis.canvas.ondblclick = this.onDoubleClick.bind(this);\n\t\tthis.canvas.oncontextmenu = this.onContextMenu.bind(this);\n\t\tthis.canvas.onwheel = this.onMouseWheel.bind(this);\n\t\tthis.canvas.onmouseleave = this.onMouseLeave.bind(this);\n\t\tthis.canvas.onmouseenter = this.onMouseEnter.bind(this);\n\t\tthis.canvas.ontouchstart = this.onTouchStart.bind(this);\n\t\tthis.canvas.ontouchmove = this.onTouchMove.bind(this);\n\t\tthis.canvas.ontouchend = this.onTouchEnd.bind(this);\n\t\tthis.canvas.ontouchcancel = this.onTouchCancel.bind(this);\n\n\t\t// Some explanation first.\n\t\t// When the user uses the mouse wheel for scrolling, different browsers use different technics for calculating the deltaY and deltaX values.\n\t\t// For example FireFox uses \"deltaMode=1\" which corresponds to \"lines\". So it creates the event with the number of lines to scroll.\n\t\t// Chrome uses \"deltaMode=0\" which corresponds to \"pixels\". So it creates the event with the number of pixels to scroll.\n\t\t// When \"deltaMode=1\" is used, we need to know the height of the line, so we will convert it to pixels.\n\t\t// For that purpose, we'll create a temporary div element, get the font size and delete the temporary element.\n\t\tconst tempElement = document.createElement('div');\n\t\ttempElement.style.fontSize = 'initial'; // IE doesn't support this property, but it uses \"deltaMode=0\" (so we don't need to get the line height).\n\t\ttempElement.style.display = 'none';\n\t\tdocument.body.appendChild(tempElement);\n\t\tthis.scrollLineHeight = parseInt(window.getComputedStyle(tempElement).fontSize);\n\t\tdocument.body.removeChild(tempElement); // Remove the temporary element.\n\n\t\tif (disableDrawing)\n\t\t\tthis.disableDrawing();\n\t}\n\n\tprivate clearCanvas() {\n\t\tthis.context.fillStyle = this.clearColor;\n\t\tthis.context.clearRect(0, 0, this.canvas.width, this.canvas.height);\n\t\tthis.context.fillRect(0, 0, this.canvas.width, this.canvas.height);\n\t}\n\n\tgetContext () {\n\t\treturn this.context;\n\t}\n\n\tpublic setDocumentAnchorSection(sectionName: string) {\n\t\tvar section: CanvasSectionObject = this.getSectionWithName(sectionName);\n\t\tif (section) {\n\t\t\tthis.documentAnchorSectionName = sectionName;\n\t\t}\n\t\telse {\n\t\t\tthis.documentAnchorSectionName = null;\n\t\t\tthis.documentAnchor = null;\n\t\t}\n\t}\n\n\tpublic getDocumentAnchorSection (): CanvasSectionObject {\n\t\treturn this.getSectionWithName(this.documentAnchorSectionName);\n\t}\n\n\tpublic getViewSize (): Array<number> {\n\t\treturn [this.canvas.width, this.canvas.height];\n\t}\n\n\tsetClearColor (color: string) {\n\t\tthis.clearColor = color;\n\t}\n\n\tgetClearColor () {\n\t\treturn this.clearColor;\n\t}\n\n\tsetInZoomAnimation (inZoomAnimation: boolean) {\n\t\tthis.inZoomAnimation = inZoomAnimation;\n\t}\n\n\tisInZoomAnimation (): boolean {\n\t\treturn this.inZoomAnimation;\n\t}\n\n\tsetZoomChanged (zoomChanged: boolean) {\n\t\tthis.zoomChanged = zoomChanged;\n\t}\n\n\tisZoomChanged (): boolean {\n\t\treturn this.zoomChanged;\n\t}\n\n\tdrawingAllowed (): boolean {\n\t\treturn this.drawingEnabled && this.drawingPaused <= 0;\n\t}\n\n\t// This is used for making sure rendering does not happen for multiple runs of\n\t// Socket._emitSlurpedEvents(). Currently this is used in Calc to disable rendering\n\t// from docload till we get tiles of the correct view area to render.\n\t// After calling this, only enableDrawing() can undo this call.\n\tdisableDrawing () {\n\t\tthis.drawingEnabled = false;\n\t}\n\n\tenableDrawing () {\n\t\tif (this.drawingEnabled)\n\t\t\treturn;\n\n\t\tthis.drawingEnabled = true;\n\t\tif (this.drawingPaused === 0) {\n\t\t\t// Trigger a forced repaint as drawing is not paused currently.\n\t\t\tthis.dirty = true;\n\t\t\tthis.paintOnResumeOrEnable();\n\t\t}\n\t}\n\n\tpauseDrawing () {\n\n\t\tif (this.drawingPaused++ === 0) {\n\t\t\tthis.dirty = false;\n\t\t}\n\t}\n\n\t// set topLevel if we are sure that we are the top of call nesting\n\t// eg. in a browser event handler. Avoids JS exceptions poisoning\n\t// the count, since we have no RAII helpers here.\n\tresumeDrawing(topLevel?: boolean) {\n\t\tvar wasNonZero: boolean = this.drawingPaused !== 0;\n\t\tif (topLevel)\n\t\t   this.drawingPaused = 0;\n\t\telse if (this.drawingPaused > 0)  // ensure non-negative value.\n\t\t   this.drawingPaused--;\n\n\t\tif (this.drawingEnabled && wasNonZero && this.drawingPaused === 0) {\n\t\t\tthis.paintOnResumeOrEnable();\n\t\t}\n\t}\n\n\tprivate paintOnResumeOrEnable() {\n\t\tif (this.sectionsDirty) {\n\t\t\tthis.updateBoundSectionLists();\n\t\t\tthis.reNewAllSections(false);\n\t\t\tthis.sectionsDirty = false;\n\t\t}\n\n\t\tvar scrollSection = <any> this.getSectionWithName(L.CSections.Scroll.name);\n\t\tif (scrollSection)\n\t\t\tscrollSection.completePendingScroll(); // No painting, only dirtying.\n\n\t\tif (this.dirty) {\n\t\t\tthis.requestReDraw();\n\t\t\tthis.dirty = false;\n\t\t}\n\t}\n\n\tprivate setDirty() {\n\t\tthis.dirty = true;\n\t}\n\n\t/**\n\t * IE11 doesn't support Array.includes, use replacement\n\t*/\n\tprivate arrayIncludes<T> (array: Array<T>, element: T) {\n\t\treturn array.indexOf(element) >= 0;\n\t}\n\n\tprivate clearMousePositions () {\n\t\tthis.positionOnClick = this.positionOnDoubleClick = this.positionOnMouseDown = this.positionOnMouseUp = this.dragDistance = this.sectionOnMouseDown = null;\n\t\tthis.touchCenter = null;\n\t\tthis.draggingSomething = false;\n\t\tthis.touchEventInProgress = false;\n\t\tthis.lowestPropagatedBoundSection = null;\n\t\tthis.targetSection = null;\n\t}\n\n\tprivate convertPositionToSectionLocale (section: CanvasSectionObject, point: Array<number>): Array<number> {\n\t\treturn [point[0] - section.myTopLeft[0], point[1] - section.myTopLeft[1]];\n\t}\n\n\tprivate convertPositionToCanvasLocale (e: any): Array<number> {\n\t\tvar rect: any = this.canvas.getBoundingClientRect();\n\t\tvar x: number, y: number;\n\n\t\tif (e.touches !== undefined && e.touches.length > 0) {\n\t\t\tx = e.touches[0].clientX - rect.left;\n\t\t\ty = e.touches[0].clientY - rect.top;\n\t\t}\n\t\telse if (e.changedTouches !== undefined && e.changedTouches.length > 0) {\n\t\t\tx = e.changedTouches[0].clientX - rect.left;\n\t\t\ty = e.changedTouches[0].clientY - rect.top;\n\t\t}\n\t\telse {\n\t\t\tx = e.clientX - rect.left;\n\t\t\ty = e.clientY - rect.top;\n\t\t}\n\t\treturn [Math.round(x * app.dpiScale), Math.round(y * app.dpiScale)];\n\t}\n\n\tprivate convertPointToCanvasLocale (point: Array<number>): Array<number> {\n\t\tvar rect: any = this.canvas.getBoundingClientRect();\n\t\tvar x: number, y: number;\n\n\t\tx = point[0] - rect.left;\n\t\ty = point[1] - rect.top;\n\n\t\treturn [Math.round(x * app.dpiScale), Math.round(y * app.dpiScale)];\n\t}\n\n\tgetSectionWithName (name: string): CanvasSectionObject {\n\t\tif (name) {\n\t\t\tfor (var i: number = 0; i < this.sections.length; i++) {\n\t\t\t\tif (this.sections[i].name === name) {\n\t\t\t\t\treturn this.sections[i];\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn null;\n\t\t}\n\t\telse {\n\t\t\treturn null;\n\t\t}\n\t}\n\n\tpublic getDocumentTopLeft (): Array<number> {\n\t\treturn [this.documentTopLeft[0], this.documentTopLeft[1]];\n\t}\n\n\tpublic getDocumentBottomRight (): Array<number> {\n\t\treturn [this.documentBottomRight[0], this.documentBottomRight[1]];\n\t}\n\n\t// Returns top-left and bottom-right coordinates respectively.\n\tpublic getDocumentBounds (): Array<number> {\n\t\treturn [this.documentTopLeft[0], this.documentTopLeft[1], this.documentBottomRight[0], this.documentBottomRight[1]];\n\t}\n\n\tpublic getDocumentSize (): Array<number> {\n\t\treturn [this.documentBottomRight[0] - this.documentTopLeft[0], this.documentBottomRight[1] - this.documentTopLeft[1]];\n\t}\n\n\tprivate isDocumentObjectVisible (section: CanvasSectionObject): boolean {\n\t\tif (\n\t\t\t(\n\t\t\t\tsection.position[0] >= this.documentTopLeft[0] && section.position[0] <= this.documentBottomRight[0] ||\n\t\t\t\tsection.position[0] + section.size[0] >= this.documentTopLeft[0] && section.position[0] + section.size[0] <= this.documentBottomRight[0]\n\t\t\t)\n\t\t\t&&\n\t\t\t(\n\t\t\t\tsection.position[1] >= this.documentTopLeft[1] && section.position[1] <= this.documentBottomRight[1] ||\n\t\t\t\tsection.position[1] + section.size[1] >= this.documentTopLeft[1] && section.position[1] + section.size[1] <= this.documentBottomRight[1]\n\t\t\t)\n\t\t) {\n\t\t\treturn true;\n\t\t}\n\t\telse\n\t\t\treturn false;\n\t}\n\n\t// For window sections, there is a \"targetSection\" property in CanvasSectionContainer.\n\t// Because a window section is above all sections and cover entire canvas, it may need to act according to the actual target of the event.\n\t// In this case, \"targetSection\" property gives the window section the first target of the event.\n\t// This (below) function gives the window section if a section will sooner or later get the event.\n\t// But this function cannot know if the event will be stopped by a prior section before the event reaches the section specified with the \"sectionName\" variable.\n\t// This function doesn't neither check the \"interactable\" property of the section in question (\"sectionName\"). Though that check can be added here, as an optional one.\n\tpublic targetBoundSectionListContains (sectionName: string): boolean {\n\t\tif (!this.targetSection)\n\t\t\treturn false;\n\t\telse {\n\t\t\tvar section: CanvasSectionObject = this.getSectionWithName(this.targetSection);\n\t\t\tif (section && section.boundsList) {\n\t\t\t\tfor (var i: number = 0; i < section.boundsList.length; i++) {\n\t\t\t\t\tif (section.boundsList[i].name === sectionName)\n\t\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\telse\n\t\t\t\treturn false;\n\t\t}\n\t}\n\n\tpublic setDocumentBounds (points: Array<number>) {\n\t\tthis.documentTopLeft[0] = Math.round(points[0]);\n\t\tthis.documentTopLeft[1] = Math.round(points[1]);\n\n\t\tthis.documentBottomRight[0] = Math.round(points[2]);\n\t\tthis.documentBottomRight[1] = Math.round(points[3]);\n\n\t\tapp.file.viewedRectangle = [this.documentTopLeft[0], this.documentTopLeft[1], this.documentBottomRight[0] - this.documentTopLeft[0], this.documentBottomRight[1] - this.documentTopLeft[1]];\n\n\t\tfor (var i: number = 0; i < this.sections.length; i++) {\n\t\t\tvar section: CanvasSectionObject = this.sections[i];\n\n\t\t\tif (section.documentObject === true) {\n\t\t\t\tsection.myTopLeft = [this.documentAnchor[0] + section.position[0] - this.documentTopLeft[0], this.documentAnchor[1] + section.position[1] - this.documentTopLeft[1]];\n\t\t\t\tsection.isVisible = this.isDocumentObjectVisible(section);\n\t\t\t}\n\n\t\t\tthis.sections[i].onNewDocumentTopLeft(this.getDocumentTopLeft());\n\t\t}\n\t}\n\n\tprivate updateBoundSectionList(section: CanvasSectionObject, sectionList: Array<CanvasSectionObject> = null): Array<CanvasSectionObject> {\n\t\tif (sectionList === null)\n\t\t\tsectionList = new Array(0);\n\n\t\tsectionList.push(section);\n\n\t\tvar tempSectionList: Array<CanvasSectionObject> = new Array(0);\n\n\t\tif (section.boundToSection) {\n\t\t\tvar tempSection = this.getSectionWithName(section.boundToSection);\n\t\t\tif (tempSection && tempSection.isLocated) {\n\t\t\t\tif (!this.arrayIncludes(sectionList, tempSection))\n\t\t\t\t\ttempSectionList.push(tempSection);\n\t\t\t}\n\t\t}\n\n\t\tfor (var i: number = 0; i < this.sections.length; i++) {\n\t\t\tif (this.sections[i].isLocated && this.sections[i].boundToSection === section.name) {\n\t\t\t\tif (!this.arrayIncludes(sectionList, this.sections[i]))\n\t\t\t\t\ttempSectionList.push(this.sections[i]);\n\t\t\t}\n\t\t}\n\n\t\tfor (var i: number = 0; i < tempSectionList.length; i++) {\n\t\t\tthis.updateBoundSectionList(tempSectionList[i], sectionList);\n\t\t}\n\n\t\treturn sectionList;\n\t}\n\n\tprivate orderBoundsList(section: CanvasSectionObject) {\n\t\t// According to zIndex & drawingOrder.\n\t\tfor (var i: number = 0; i < section.boundsList.length - 1; i++) {\n\t\t\tfor (var j = i + 1; j < section.boundsList.length; j++) {\n\t\t\t\tif (section.boundsList[i].zIndex > section.boundsList[j].zIndex\n\t\t\t\t\t|| (section.boundsList[i].zIndex === section.boundsList[j].zIndex && section.boundsList[i].drawingOrder > section.boundsList[j].drawingOrder)) {\n\t\t\t\t\tvar temp = section.boundsList[i];\n\t\t\t\t\tsection.boundsList[i] = section.boundsList[j];\n\t\t\t\t\tsection.boundsList[j] = temp;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// Remove the sections those are above this section. Events will not be propagated to them.\n\t\tfor (var i: number = section.boundsList.length - 1; i > -1; i--) {\n\t\t\tif (section.boundsList[i].name !== section.name) {\n\t\t\t\tsection.boundsList.splice(i, 1);\n\t\t\t}\n\t\t\telse {\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate updateBoundSectionLists() {\n\t\tfor (var i: number = 0; i < this.sections.length; i++) {\n\t\t\tthis.sections[i].boundsList = null;\n\t\t\tthis.sections[i].boundsList = this.updateBoundSectionList(this.sections[i]);\n\t\t\tthis.orderBoundsList(this.sections[i]);\n\t\t}\n\t}\n\n\trequestReDraw() {\n\t\tif (!this.drawingAllowed()) {\n\t\t\t// Someone requested a redraw, but we're paused => schedule a redraw.\n\t\t\tthis.setDirty();\n\t\t\treturn;\n\t\t}\n\n\t\tif (!this.getAnimatingSectionName())\n\t\t\tthis.drawSections();\n\t}\n\n\tprivate propagateOnClick(section: CanvasSectionObject, position: Array<number>, e: MouseEvent) {\n\t\tthis.targetSection = section.name;\n\n\t\tvar propagate: boolean = true;\n\t\tvar windowPosition: Array<number> = position ? [position[0] + section.myTopLeft[0], position[1] + section.myTopLeft[1]]: null;\n\t\tfor (var j: number = 0; j < this.windowSectionList.length; j++) {\n\t\t\tvar windowSection = this.windowSectionList[j];\n\t\t\tif (windowSection.interactable)\n\t\t\t\twindowSection.onClick(windowPosition, e);\n\n\t\t\tif (this.lowestPropagatedBoundSection === windowSection.name)\n\t\t\t\tpropagate = false; // Window sections can not stop the propagation of the event for other window sections.\n\t\t}\n\n\t\tif (propagate) {\n\t\t\tfor (var i: number = section.boundsList.length - 1; i > -1; i--) {\n\t\t\t\tif (section.boundsList[i].interactable)\n\t\t\t\t\tsection.boundsList[i].onClick((position ? [position[0], position[1]]: null), e);\n\n\t\t\t\tif (section.boundsList[i].name === this.lowestPropagatedBoundSection)\n\t\t\t\t\tbreak; // Stop propagation.\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate propagateOnDoubleClick(section: CanvasSectionObject, position: Array<number>, e: MouseEvent) {\n\t\tthis.targetSection = section.name;\n\n\t\tvar propagate: boolean = true;\n\t\tvar windowPosition: Array<number> = position ? [position[0] + section.myTopLeft[0], position[1] + section.myTopLeft[1]]: null;\n\t\tfor (var j: number = 0; j < this.windowSectionList.length; j++) {\n\t\t\tvar windowSection = this.windowSectionList[j];\n\t\t\tif (windowSection.interactable)\n\t\t\t\twindowSection.onDoubleClick(windowPosition, e);\n\n\t\t\tif (this.lowestPropagatedBoundSection === windowSection.name)\n\t\t\t\tpropagate = false; // Window sections can not stop the propagation of the event for other window sections.\n\t\t}\n\n\t\tif (propagate) {\n\t\t\tfor (var i: number = section.boundsList.length - 1; i > -1; i--) {\n\t\t\t\tif (section.boundsList[i].interactable)\n\t\t\t\t\tsection.boundsList[i].onDoubleClick((position ? [position[0], position[1]]: null), e);\n\n\t\t\t\tif (section.boundsList[i].name === this.lowestPropagatedBoundSection)\n\t\t\t\t\tbreak; // Stop propagation.\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate propagateOnMouseLeave(section: CanvasSectionObject, position: Array<number>, e: MouseEvent) {\n\t\tthis.targetSection = section.name;\n\n\t\tvar windowPosition: Array<number> = position ? [position[0] + section.myTopLeft[0], position[1] + section.myTopLeft[1]]: null;\n\t\tif (!windowPosition) { // This event is valid only if the windowPosition is null for window sections. Otherwise mouse cannot leave from a section that is covering entire canvas element.\n\t\t\tfor (var j: number = 0; j < this.windowSectionList.length; j++) {\n\t\t\t\tvar windowSection = this.windowSectionList[j];\n\t\t\t\tif (windowSection.interactable)\n\t\t\t\t\twindowSection.onMouseLeave(windowPosition, e);\n\t\t\t\t// This event's propagation shouldn't be cancelled.\n\t\t\t}\n\t\t}\n\n\t\tfor (var i: number = section.boundsList.length - 1; i > -1; i--) {\n\t\t\tif (section.boundsList[i].interactable)\n\t\t\t\tsection.boundsList[i].onMouseLeave((position ? [position[0], position[1]]: null), e);\n\n\t\t\tif (section.boundsList[i].name === this.lowestPropagatedBoundSection)\n\t\t\t\tbreak; // Stop propagation.\n\t\t}\n\t}\n\n\tprivate propagateOnMouseEnter(section: CanvasSectionObject, position: Array<number>, e: MouseEvent) {\n\t\tthis.targetSection = section.name;\n\n\t\t// This event is handled in the mouseEnter event of the canvas itself (for window sections).\n\n\t\tfor (var i: number = section.boundsList.length - 1; i > -1; i--) {\n\t\t\tif (section.boundsList[i].interactable)\n\t\t\t\tsection.boundsList[i].onMouseEnter((position ? [position[0], position[1]]: null), e);\n\n\t\t\tif (section.boundsList[i].name === this.lowestPropagatedBoundSection)\n\t\t\t\tbreak; // Stop propagation.\n\t\t}\n\t}\n\n\tprivate propagateOnMouseMove(section: CanvasSectionObject, position: Array<number>, dragDistance: Array<number>, e: MouseEvent) {\n\t\tthis.targetSection = section.name;\n\n\t\tvar propagate: boolean = true;\n\t\tvar windowPosition: Array<number> = position ? [position[0] + section.myTopLeft[0], position[1] + section.myTopLeft[1]]: null;\n\t\tfor (var j: number = 0; j < this.windowSectionList.length; j++) {\n\t\t\tvar windowSection = this.windowSectionList[j];\n\t\t\tif (windowSection.interactable)\n\t\t\t\twindowSection.onMouseMove(windowPosition, dragDistance, e);\n\n\t\t\tif (this.lowestPropagatedBoundSection === windowSection.name)\n\t\t\t\tpropagate = false; // Window sections can not stop the propagation of the event for other window sections.\n\t\t}\n\n\t\tif (propagate) {\n\t\t\tfor (var i: number = section.boundsList.length - 1; i > -1; i--) {\n\t\t\t\tif (section.boundsList[i].interactable)\n\t\t\t\t\tsection.boundsList[i].onMouseMove((position ? [position[0], position[1]]: null), dragDistance, e);\n\n\t\t\t\tif (section.boundsList[i].name === this.lowestPropagatedBoundSection)\n\t\t\t\t\tbreak; // Stop propagation.\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate propagateOnLongPress(section: CanvasSectionObject, position: Array<number>, e: MouseEvent) {\n\t\tthis.targetSection = section.name;\n\n\t\tvar propagate: boolean = true;\n\t\tvar windowPosition: Array<number> = position ? [position[0] + section.myTopLeft[0], position[1] + section.myTopLeft[1]]: null;\n\t\tfor (var j: number = 0; j < this.windowSectionList.length; j++) {\n\t\t\tvar windowSection = this.windowSectionList[j];\n\t\t\tif (windowSection.interactable)\n\t\t\t\twindowSection.onLongPress(windowPosition, e);\n\n\t\t\tif (this.lowestPropagatedBoundSection === windowSection.name)\n\t\t\t\tpropagate = false; // Window sections can not stop the propagation of the event for other window sections.\n\t\t}\n\n\t\tif (propagate) {\n\t\t\tfor (var i: number = section.boundsList.length - 1; i > -1; i--) {\n\t\t\t\tif (section.boundsList[i].interactable)\n\t\t\t\t\tsection.boundsList[i].onLongPress((position ? [position[0], position[1]]: null), e);\n\n\t\t\t\tif (section.boundsList[i].name === this.lowestPropagatedBoundSection)\n\t\t\t\t\tbreak; // Stop propagation.\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate propagateOnMouseDown(section: CanvasSectionObject, position: Array<number>, e: MouseEvent) {\n\t\tthis.targetSection = section.name;\n\n\t\tvar propagate: boolean = true;\n\t\tvar windowPosition: Array<number> = position ? [position[0] + section.myTopLeft[0], position[1] + section.myTopLeft[1]]: null;\n\t\tfor (var j: number = 0; j < this.windowSectionList.length; j++) {\n\t\t\tvar windowSection = this.windowSectionList[j];\n\t\t\tif (windowSection.interactable)\n\t\t\t\twindowSection.onMouseDown(windowPosition, e);\n\n\t\t\tif (this.lowestPropagatedBoundSection === windowSection.name)\n\t\t\t\tpropagate = false; // Window sections can not stop the propagation of the event for other window sections.\n\t\t}\n\n\t\tif (propagate) {\n\t\t\tfor (var i: number = section.boundsList.length - 1; i > -1; i--) {\n\t\t\t\tif (section.boundsList[i].interactable)\n\t\t\t\t\tsection.boundsList[i].onMouseDown((position ? [position[0], position[1]]: null), e);\n\n\t\t\t\tif (section.boundsList[i].name === this.lowestPropagatedBoundSection)\n\t\t\t\t\tbreak; // Stop propagation.\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate propagateOnMouseUp(section: CanvasSectionObject, position: Array<number>, e: MouseEvent) {\n\t\tthis.targetSection = section.name;\n\n\t\tvar propagate: boolean = true;\n\t\tvar windowPosition: Array<number> = position ? [position[0] + section.myTopLeft[0], position[1] + section.myTopLeft[1]]: null;\n\t\tfor (var j: number = 0; j < this.windowSectionList.length; j++) {\n\t\t\tvar windowSection = this.windowSectionList[j];\n\t\t\tif (windowSection.interactable)\n\t\t\t\twindowSection.onMouseUp(windowPosition, e);\n\n\t\t\tif (this.lowestPropagatedBoundSection === windowSection.name)\n\t\t\t\tpropagate = false; // Window sections can not stop the propagation of the event for other window sections.\n\t\t}\n\n\t\tif (propagate) {\n\t\t\tfor (var i: number = section.boundsList.length - 1; i > -1; i--) {\n\t\t\t\tif (section.boundsList[i].interactable)\n\t\t\t\t\tsection.boundsList[i].onMouseUp((position ? [position[0], position[1]]: null), e);\n\n\t\t\t\tif (section.boundsList[i].name === this.lowestPropagatedBoundSection)\n\t\t\t\t\tbreak; // Stop propagation.\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate propagateOnContextMenu(section: CanvasSectionObject) {\n\t\tthis.targetSection = section.name;\n\n\t\tvar propagate: boolean = true;\n\t\tfor (var j: number = 0; j < this.windowSectionList.length; j++) {\n\t\t\tvar windowSection = this.windowSectionList[j];\n\t\t\tif (windowSection.interactable)\n\t\t\t\twindowSection.onContextMenu();\n\n\t\t\tif (this.lowestPropagatedBoundSection === windowSection.name)\n\t\t\t\tpropagate = false; // Window sections can not stop the propagation of the event for other window sections.\n\t\t}\n\n\t\tif (propagate) {\n\t\t\tfor (var i: number = section.boundsList.length - 1; i > -1; i--) {\n\t\t\t\tif (section.boundsList[i].interactable)\n\t\t\t\t\tsection.boundsList[i].onContextMenu();\n\n\t\t\t\tif (section.boundsList[i].name === this.lowestPropagatedBoundSection)\n\t\t\t\t\tbreak; // Stop propagation.\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate propagateOnMouseWheel(section: CanvasSectionObject, position: Array<number>, delta: Array<number>, e: MouseEvent) {\n\t\tthis.targetSection = section.name;\n\n\t\tvar propagate: boolean = true;\n\t\tvar windowPosition: Array<number> = position ? [position[0] + section.myTopLeft[0], position[1] + section.myTopLeft[1]]: null;\n\t\tfor (var j: number = 0; j < this.windowSectionList.length; j++) {\n\t\t\tvar windowSection = this.windowSectionList[j];\n\t\t\tif (windowSection.interactable)\n\t\t\t\twindowSection.onMouseWheel(windowPosition, delta, e);\n\n\t\t\tif (this.lowestPropagatedBoundSection === windowSection.name)\n\t\t\t\tpropagate = false; // Window sections can not stop the propagation of the event for other window sections.\n\t\t}\n\n\t\tif (propagate) {\n\t\t\tfor (var i: number = section.boundsList.length - 1; i > -1; i--) {\n\t\t\t\tif (section.boundsList[i].interactable)\n\t\t\t\t\tsection.boundsList[i].onMouseWheel((position ? [position[0], position[1]]: null), delta, e);\n\n\t\t\t\tif (section.boundsList[i].name === this.lowestPropagatedBoundSection)\n\t\t\t\t\tbreak; // Stop propagation.\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate propagateOnMultiTouchStart(section: CanvasSectionObject, e: TouchEvent) {\n\t\tthis.targetSection = section.name;\n\n\t\tvar propagate: boolean = true;\n\t\tfor (var j: number = 0; j < this.windowSectionList.length; j++) {\n\t\t\tvar windowSection = this.windowSectionList[j];\n\t\t\tif (windowSection.interactable)\n\t\t\t\twindowSection.onMultiTouchStart(e);\n\n\t\t\tif (this.lowestPropagatedBoundSection === windowSection.name)\n\t\t\t\tpropagate = false; // Window sections can not stop the propagation of the event for other window sections.\n\t\t}\n\n\t\tif (propagate) {\n\t\t\tfor (var i: number = section.boundsList.length - 1; i > -1; i--) {\n\t\t\t\tif (section.boundsList[i].interactable)\n\t\t\t\t\tsection.boundsList[i].onMultiTouchStart(e);\n\n\t\t\t\tif (section.boundsList[i].name === this.lowestPropagatedBoundSection)\n\t\t\t\t\tbreak; // Stop propagation.\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate propagateOnMultiTouchMove(section: CanvasSectionObject, position: Array<number>, distance: number, e: TouchEvent) {\n\t\tthis.targetSection = section.name;\n\n\t\tvar propagate: boolean = true;\n\t\tvar windowPosition: Array<number> = position ? [position[0] + section.myTopLeft[0], position[1] + section.myTopLeft[1]]: null;\n\t\tfor (var j: number = 0; j < this.windowSectionList.length; j++) {\n\t\t\tvar windowSection = this.windowSectionList[j];\n\t\t\tif (windowSection.interactable)\n\t\t\t\twindowSection.onMultiTouchMove(windowPosition, distance, e);\n\n\t\t\tif (this.lowestPropagatedBoundSection === windowSection.name)\n\t\t\t\tpropagate = false; // Window sections can not stop the propagation of the event for other window sections.\n\t\t}\n\n\t\tif (propagate) {\n\t\t\tfor (var i: number = section.boundsList.length - 1; i > -1; i--) {\n\t\t\t\tif (section.boundsList[i].interactable)\n\t\t\t\t\tsection.boundsList[i].onMultiTouchMove((position ? [position[0], position[1]]: null), distance, e);\n\n\t\t\t\tif (section.boundsList[i].name === this.lowestPropagatedBoundSection)\n\t\t\t\t\tbreak; // Stop propagation.\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate propagateOnMultiTouchEnd(section: CanvasSectionObject, e: TouchEvent) {\n\t\tthis.targetSection = section.name;\n\n\t\tvar propagate: boolean = true;\n\t\tfor (var j: number = 0; j < this.windowSectionList.length; j++) {\n\t\t\tvar windowSection = this.windowSectionList[j];\n\t\t\tif (windowSection.interactable)\n\t\t\t\twindowSection.onMultiTouchEnd(e);\n\n\t\t\tif (this.lowestPropagatedBoundSection === windowSection.name)\n\t\t\t\tpropagate = false; // Window sections can not stop the propagation of the event for other window sections.\n\t\t}\n\n\t\tif (propagate) {\n\t\t\tfor (var i: number = section.boundsList.length - 1; i > -1; i--) {\n\t\t\t\tif (section.boundsList[i].interactable)\n\t\t\t\t\tsection.boundsList[i].onMultiTouchEnd(e);\n\n\t\t\t\tif (section.boundsList[i].name === this.lowestPropagatedBoundSection)\n\t\t\t\t\tbreak; // Stop propagation.\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate onClick (e: MouseEvent) {\n\t\tif (!this.draggingSomething) { // Prevent click event after dragging.\n\t\t\tif (this.positionOnMouseDown !== null && this.positionOnMouseUp !== null) {\n\t\t\t\tthis.positionOnClick = this.convertPositionToCanvasLocale(e);\n\t\t\t\tvar s1 = this.findSectionContainingPoint(this.positionOnMouseDown);\n\t\t\t\tvar s2 = this.findSectionContainingPoint(this.positionOnMouseUp);\n\t\t\t\tif (s1 && s2 && s1 == s2) { // Allow click event if only mouse was above same section while clicking.\n\t\t\t\t\tvar section: CanvasSectionObject = this.findSectionContainingPoint(this.positionOnClick);\n\t\t\t\t\tif (section) { // \"interactable\" property is checked while propagating the event.\n\t\t\t\t\t\tthis.propagateOnClick(section, this.convertPositionToSectionLocale(section, this.positionOnClick), e);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis.clearMousePositions(); // Drawing takes place after cleaning mouse positions. Sections should overcome this evil.\n\t\t\tthis.drawSections();\n\t\t}\n\t\telse {\n\t\t\tthis.clearMousePositions();\n\t\t}\n\t}\n\n\tprivate onDoubleClick (e: MouseEvent) {\n\t\tthis.positionOnDoubleClick = this.convertPositionToCanvasLocale(e);\n\n\t\tvar section: CanvasSectionObject = this.findSectionContainingPoint(this.positionOnDoubleClick);\n\t\tif (section) {\n\t\t\tthis.propagateOnDoubleClick(section, this.convertPositionToSectionLocale(section, this.positionOnDoubleClick), e);\n\t\t}\n\t\tthis.clearMousePositions();\n\t\tthis.drawSections();\n\t}\n\n\tprivate onMouseMove (e: MouseEvent) {\n\t\t// Early exit. If mouse is outside and \"draggingSomething = false\", then there is no reason to check further.\n\t\tif (!this.mouseIsInside && !this.draggingSomething)\n\t\t\treturn;\n\n\t\tif (!this.potentialLongPress) {\n\t\t\tif (!this.touchEventInProgress) {\n\t\t\t\tthis.mousePosition = this.convertPositionToCanvasLocale(e);\n\t\t\t\tif (this.positionOnMouseDown !== null && !this.draggingSomething) {\n\t\t\t\t\tvar dragDistance = [this.mousePosition[0] - this.positionOnMouseDown[0], this.mousePosition[1] - this.positionOnMouseDown[1]];\n\t\t\t\t\tif (Math.abs(dragDistance[0]) >= this.draggingTolerance || Math.abs(dragDistance[1]) >= this.draggingTolerance) {\n\t\t\t\t\t\tthis.draggingSomething = true;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tvar section: CanvasSectionObject;\n\n\t\t\t\tif (this.draggingSomething) {\n\t\t\t\t\tthis.dragDistance = [this.mousePosition[0] - this.positionOnMouseDown[0], this.mousePosition[1] - this.positionOnMouseDown[1]];\n\t\t\t\t\tsection = this.getSectionWithName(this.sectionOnMouseDown);\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tsection = this.findSectionContainingPoint(this.mousePosition);\n\t\t\t\t}\n\n\t\t\t\tif (section && section.boundsList) {\n\t\t\t\t\tif (section.name !== this.sectionUnderMouse) {\n\t\t\t\t\t\tif (this.sectionUnderMouse !== null) {\n\t\t\t\t\t\t\tvar previousSection: CanvasSectionObject = this.getSectionWithName(this.sectionUnderMouse);\n\t\t\t\t\t\t\tif (previousSection)\n\t\t\t\t\t\t\t\tthis.propagateOnMouseLeave(previousSection, this.convertPositionToSectionLocale(previousSection, this.mousePosition), e);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tthis.sectionUnderMouse = section.name;\n\t\t\t\t\t\tthis.propagateOnMouseEnter(section, this.convertPositionToSectionLocale(section, this.mousePosition), e);\n\t\t\t\t\t}\n\t\t\t\t\tthis.propagateOnMouseMove(section, this.convertPositionToSectionLocale(section, this.mousePosition), this.dragDistance, e);\n\t\t\t\t}\n\t\t\t\telse if (this.sectionUnderMouse !== null) {\n\t\t\t\t\tvar previousSection: CanvasSectionObject = this.getSectionWithName(this.sectionUnderMouse);\n\t\t\t\t\tif (previousSection)\n\t\t\t\t\t\tthis.propagateOnMouseLeave(previousSection, this.convertPositionToSectionLocale(previousSection, this.mousePosition), e);\n\t\t\t\t\tthis.sectionUnderMouse = null;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\tthis.mousePosition = this.convertPositionToCanvasLocale(e);\n\t\t\tvar section: CanvasSectionObject = this.findSectionContainingPoint(this.mousePosition);\n\t\t\tif (section) {\n\t\t\t\tthis.propagateOnLongPress(section, this.convertPositionToSectionLocale(section, this.mousePosition), e);\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate onMouseDown (e: MouseEvent) { // Ignore this event, just rely on this.draggingSomething variable.\n\t\tif (e.button === 0 && !this.touchEventInProgress) { // So, we only handle left button.\n\t\t\tthis.clearMousePositions();\n\t\t\tthis.positionOnMouseDown = this.convertPositionToCanvasLocale(e);\n\n\t\t\tvar section: CanvasSectionObject = this.findSectionContainingPoint(this.positionOnMouseDown);\n\t\t\tif (section) {\n\t\t\t\tthis.sectionOnMouseDown = section.name;\n\t\t\t\tthis.propagateOnMouseDown(section, this.convertPositionToSectionLocale(section, this.positionOnMouseDown), e);\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate onMouseUp (e: MouseEvent) { // Should be ignored unless this.draggingSomething = true.\n\t\t// Early exit. If mouse down position is not inside the canvas area, we have nothing to check further.\n\t\tif (!this.positionOnMouseDown) {\n\t\t\tthis.clearMousePositions();\n\t\t\treturn;\n\t\t}\n\n\t\tif (e.button === 0 && !this.touchEventInProgress) {\n\t\t\tthis.positionOnMouseUp = this.convertPositionToCanvasLocale(e);\n\n\t\t\tif (!this.draggingSomething) {\n\t\t\t\tvar section: CanvasSectionObject = this.findSectionContainingPoint(this.positionOnMouseUp);\n\t\t\t\tif (section) {\n\t\t\t\t\tthis.propagateOnMouseUp(section, this.convertPositionToSectionLocale(section, this.positionOnMouseUp), e);\n\t\t\t\t}\n\t\t\t}\n\t\t\telse {\n\t\t\t\tvar section: CanvasSectionObject = this.getSectionWithName(this.sectionOnMouseDown);\n\t\t\t\tif (section) {\n\t\t\t\t\tthis.propagateOnMouseUp(section, this.convertPositionToSectionLocale(section, this.positionOnMouseUp), e);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (!this.mouseIsInside) { // Normally, onclick event clears the positions. In this case, onClick won't be fired. So we clear the positions.\n\t\t\tthis.clearMousePositions();\n\t\t}\n\t}\n\n\tprivate onContextMenu (e: MouseEvent) {\n\t\tvar mousePosition = this.convertPositionToCanvasLocale(e);\n\t\tvar section: CanvasSectionObject = this.findSectionContainingPoint(mousePosition);\n\t\tif (section) {\n\t\t\tthis.propagateOnContextMenu(section);\n\t\t}\n\t\tif (this.potentialLongPress) {\n\t\t\t// LongPress triggers context menu.\n\t\t\t// We should stop propagating here because we are using different context menu handlers for touch and mouse events.\n\t\t\t// By stopping this event here, we can have real context menus (for mice) and other handlers (for longpress) at the same time (see Control.RowHeader.js).\n\t\t\te.preventDefault();\n\t\t\te.stopPropagation();\n\t\t\treturn false;\n\t\t}\n\t}\n\n\tprivate onMouseWheel (e: WheelEvent) {\n\t\tvar point = this.convertPositionToCanvasLocale(e);\n\t\tvar delta: Array<number>;\n\n\t\tif (e.deltaMode === 1)\n\t\t\tdelta = [e.deltaX * this.scrollLineHeight, e.deltaY * this.scrollLineHeight];\n\t\telse\n\t\t\tdelta = [e.deltaX, e.deltaY];\n\n\t\tvar section: CanvasSectionObject = this.findSectionContainingPoint(point);\n\t\tif (section)\n\t\t\tthis.propagateOnMouseWheel(section, this.convertPositionToSectionLocale(section, point), delta, e);\n\t}\n\n\tonMouseLeave (e: MouseEvent) {\n\t\t// While dragging something, we don't clear the event information even if the mouse is outside of the canvas area.\n\t\t// We catch the mouse move and mouse up events even when the mouse pointer is outside the canvas area.\n\t\t// This feature is enabled to create a better dragging experience.\n\t\tif (!this.draggingSomething) {\n\t\t\tif (this.sectionUnderMouse !== null) {\n\t\t\t\tvar section: CanvasSectionObject = this.getSectionWithName(this.sectionUnderMouse);\n\t\t\t\tif (section)\n\t\t\t\t\tthis.propagateOnMouseLeave(section, null, e);\n\t\t\t\tthis.sectionUnderMouse = null;\n\t\t\t}\n\t\t\tthis.clearMousePositions();\n\t\t\tthis.mousePosition = null;\n\t\t}\n\t\tthis.mouseIsInside = false;\n\t}\n\n\tonMouseEnter (e: MouseEvent) {\n\t\tthis.mouseIsInside = true;\n\n\t\tfor (var i: number = 0; i < this.windowSectionList.length; i++) {\n\t\t\tvar windowSection = this.windowSectionList[i];\n\t\t\tif (windowSection.interactable)\n\t\t\t\twindowSection.onMouseEnter(null, e);\n\t\t}\n\t}\n\n\tonTouchStart (e: TouchEvent) { // Should be ignored unless this.draggingSomething = true.\n\t\tif (e.touches.length === 1) {\n\t\t\tthis.clearMousePositions();\n\t\t\tthis.potentialLongPress = true;\n\t\t\tthis.positionOnMouseDown = this.convertPositionToCanvasLocale(e);\n\n\t\t\tvar section: CanvasSectionObject = this.findSectionContainingPoint(this.positionOnMouseDown);\n\t\t\tif (section) {\n\t\t\t\tthis.sectionOnMouseDown = section.name;\n\t\t\t\tthis.propagateOnMouseDown(section, this.convertPositionToSectionLocale(section, this.positionOnMouseDown), (<MouseEvent><any>e));\n\t\t\t}\n\t\t}\n\t\telse if (!this.multiTouch) {\n\t\t\tthis.potentialLongPress = false;\n\t\t\tthis.multiTouch = true;\n\t\t\tvar section: CanvasSectionObject = this.getSectionWithName(this.sectionOnMouseDown);\n\t\t\tif (section)\n\t\t\t\tthis.propagateOnMultiTouchStart(section, e);\n\t\t}\n\t}\n\n\tprivate onTouchMove (e: TouchEvent) {\n\t\t// Sometimes onTouchStart is fired for another element. In this case, we return.\n\t\tif (this.positionOnMouseDown === null)\n\t\t\treturn;\n\n\t\tthis.potentialLongPress = false;\n\t\tif (!this.multiTouch) {\n\t\t\tthis.mousePosition = this.convertPositionToCanvasLocale(e);\n\t\t\tthis.draggingSomething = true;\n\n\t\t\tthis.dragDistance = [this.mousePosition[0] - this.positionOnMouseDown[0], this.mousePosition[1] - this.positionOnMouseDown[1]];\n\n\t\t\tvar section: CanvasSectionObject = this.getSectionWithName(this.sectionOnMouseDown);\n\t\t\tif (section) {\n\t\t\t\tthis.propagateOnMouseMove(section, this.convertPositionToSectionLocale(section, this.mousePosition), this.dragDistance, <MouseEvent><any>e);\n\t\t\t}\n\t\t}\n\t\telse if (e.touches.length === 2) {\n\t\t\tvar section: CanvasSectionObject = this.getSectionWithName(this.sectionOnMouseDown);\n\t\t\tif (section) {\n\t\t\t\tvar diffX = Math.abs(e.touches[0].clientX - e.touches[1].clientX);\n\t\t\t\tvar diffY = Math.abs(e.touches[0].clientY - e.touches[1].clientY);\n\t\t\t\t// Let's keep \"touchCenter\" variable \"static\" for now. When we want to allow move & drag at the same time, we should make it dynamic again.\n\t\t\t\tif (!this.touchCenter) {\n\t\t\t\t\tthis.touchCenter = [(e.touches[0].clientX + e.touches[1].clientX) * 0.5, (e.touches[0].clientY + e.touches[1].clientY) * 0.5];\n\t\t\t\t\tthis.touchCenter = this.convertPointToCanvasLocale(this.touchCenter);\n\t\t\t\t}\n\t\t\t\tvar distance = Math.sqrt(Math.pow(diffX, 2) + Math.pow(diffY, 2));\n\t\t\t\tthis.propagateOnMultiTouchMove(section, this.convertPositionToSectionLocale(section, this.touchCenter), distance, e);\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate onTouchEnd (e: TouchEvent) { // Should be ignored unless this.draggingSomething = true.\n\t\tthis.potentialLongPress = false;\n\t\tif (!this.multiTouch) {\n\t\t\tthis.positionOnMouseUp = this.convertPositionToCanvasLocale(e);\n\t\t\tif (!this.draggingSomething) {\n\t\t\t\tvar section: CanvasSectionObject = this.findSectionContainingPoint(this.positionOnMouseUp);\n\t\t\t\tif (section)\n\t\t\t\t\tthis.propagateOnMouseUp(section, this.convertPositionToSectionLocale(section, this.positionOnMouseUp), <MouseEvent><any>e);\n\t\t\t}\n\t\t\telse {\n\t\t\t\tvar section: CanvasSectionObject = this.getSectionWithName(this.sectionOnMouseDown);\n\t\t\t\tif (section)\n\t\t\t\t\tthis.propagateOnMouseUp(section, this.convertPositionToSectionLocale(section, this.positionOnMouseUp), <MouseEvent><any>e);\n\t\t\t}\n\t\t}\n\t\telse if (e.touches.length === 0) {\n\t\t\tthis.multiTouch = false;\n\t\t\tvar section: CanvasSectionObject = this.getSectionWithName(this.sectionOnMouseDown);\n\t\t\tif (section) {\n\t\t\t\tthis.propagateOnMultiTouchEnd(section, e);\n\t\t\t}\n\t\t}\n\t\tthis.touchEventInProgress = true;\n\t}\n\n\tprivate onTouchCancel (e: TouchEvent) {\n\t\tthis.clearMousePositions();\n\t\tthis.potentialLongPress = false;\n\t}\n\n\tonResize (newWidth: number, newHeight: number) {\n\t\tvar container: HTMLElement = <HTMLElement> this.canvas.parentNode;\n\t\tvar cRect: ClientRect =\tcontainer.getBoundingClientRect();\n\t\tif (!newWidth)\n\t\t\tnewWidth = cRect.right - cRect.left;\n\n\t\tif (!newHeight)\n\t\t\tnewHeight = cRect.bottom - cRect.top;\n\n\t\tapp.dpiScale = window.devicePixelRatio;\n\t\tapp.roundedDpiScale = Math.round(window.devicePixelRatio);\n\n\t\tnewWidth = Math.floor(newWidth * app.dpiScale);\n\t\tnewHeight = Math.floor(newHeight * app.dpiScale);\n\n\t\tthis.canvas.width = newWidth;\n\t\tthis.canvas.height = newHeight;\n\n\t\t// CSS pixels can be fractional, but need to round to the same real pixels\n\t\tvar cssWidth: number = newWidth / app.dpiScale; // NB. beware\n\t\tvar cssHeight: number = newHeight / app.dpiScale;\n\t\tthis.canvas.style.width = cssWidth.toFixed(4) + 'px';\n\t\tthis.canvas.style.height = cssHeight.toFixed(4) + 'px';\n\n\t\t// Avoid black default background if canvas was never painted\n\t\t// since construction.\n\t\tif (!this.paintedEver)\n\t\t\tthis.clearCanvas();\n\n\t\tthis.clearMousePositions();\n\t\tthis.right = this.canvas.width;\n\t\tthis.bottom = this.canvas.height;\n\n\t\tthis.reNewAllSections();\n\t}\n\n\tfindSectionContainingPoint (point: Array<number>): any {\n\t\tfor (var i: number = this.sections.length - 1; i > -1; i--) { // Search from top to bottom. Top section will be sent as target section.\n\t\t\tif (this.sections[i].isLocated && !this.sections[i].windowSection && this.sections[i].showSection && (!this.sections[i].documentObject || this.sections[i].isVisible) && this.doesSectionIncludePoint(this.sections[i], point))\n\t\t\t\treturn this.sections[i];\n\t\t}\n\n\t\treturn null;\n\t}\n\n\tpublic doesSectionIncludePoint (section: any, point: Array<number>): boolean { // No ray casting here, it is a rectangle.\n\t\treturn ((point[0] >= section.myTopLeft[0] && point[0] <= section.myTopLeft[0] + section.size[0]) && (point[1] >= section.myTopLeft[1] && point[1] <= section.myTopLeft[1] + section.size[1]));\n\t}\n\n\tprivate doSectionsIntersectOnYAxis (section1: any, section2: any): boolean {\n\t\tvar y11 = section1.myTopLeft[1];\n\t\tvar y12 = section1.myTopLeft[1] + section1.size[1];\n\n\t\tvar y21 = section2.myTopLeft[1];\n\t\tvar y22 = section2.myTopLeft[1] + section2.size[1];\n\n\t\tif (((y11 >= y21 && y11 <= y22) || (y12 >= y21 && y12 <= y22)) || ((y21 >= y11 && y21 <= y12) || (y22 >= y11 && y22 <= y12)))\n\t\t\treturn true;\n\t\telse\n\t\t\treturn false;\n\t}\n\n\tprivate doSectionsIntersectOnXAxis (section1: any, section2: any): boolean {\n\t\tvar x11 = section1.myTopLeft[0];\n\t\tvar x12 = section1.myTopLeft[0] + section1.size[0];\n\n\t\tvar x21 = section2.myTopLeft[0];\n\t\tvar x22 = section2.myTopLeft[0] + section2.size[0];\n\n\t\tif (((x11 >= x21 && x11 < x22) || (x12 >= x21 && x12 <= x22)) || ((x21 >= x11 && x21 <= x12) || (x22 >= x11 && x22 <= x12)))\n\t\t\treturn true;\n\t\telse\n\t\t\treturn false;\n\t}\n\n\t// Find the left most point from a position with same zIndex.\n\tprivate hitLeft (section: CanvasSectionObject): number {\n\t\tvar maxX = -Infinity;\n\t\tfor (var i: number = 0; i < this.sections.length; i++) {\n\t\t\tif (this.sections[i].isLocated && this.sections[i].zIndex === section.zIndex && this.sections[i].name !== section.name) {\n\t\t\t\tvar currentLeft = this.sections[i].myTopLeft[0] + this.sections[i].size[0];\n\t\t\t\tif (currentLeft > maxX && currentLeft < section.myTopLeft[0]) {\n\t\t\t\t\tif (this.doSectionsIntersectOnYAxis(this.sections[i], section)) {\n\t\t\t\t\t\tmaxX = currentLeft;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif (maxX === -Infinity)\n\t\t\treturn 0; // There is nothing on the left of this section.\n\t\telse\n\t\t\treturn maxX + app.roundedDpiScale; // Don't overlap with the section on the left.\n\t}\n\n\t// Find the right most point from a position with same zIndex.\n\tprivate hitRight (section: CanvasSectionObject): number {\n\t\tvar minX = Infinity;\n\t\tfor (var i: number = 0; i < this.sections.length; i++) {\n\t\t\tif (this.sections[i].isLocated && this.sections[i].zIndex === section.zIndex && this.sections[i].name !== section.name) {\n\t\t\t\tvar currentRight = this.sections[i].myTopLeft[0];\n\t\t\t\tif (currentRight < minX && currentRight > section.myTopLeft[0]) {\n\t\t\t\t\tif (this.doSectionsIntersectOnYAxis(this.sections[i], section)) {\n\t\t\t\t\t\tminX = currentRight;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (minX === Infinity)\n\t\t\treturn this.right; // There is nothing on the right of this section.\n\t\telse\n\t\t\treturn minX - app.roundedDpiScale; // Don't overlap with the section on the right.\n\t}\n\n\t// Find the top most point from a position with same zIndex.\n\tprivate hitTop (section: CanvasSectionObject): number {\n\t\tvar maxY = -Infinity;\n\t\tfor (var i: number = 0; i < this.sections.length; i++) {\n\t\t\tif (this.sections[i].isLocated && this.sections[i].zIndex === section.zIndex && this.sections[i].name !== section.name) {\n\t\t\t\tvar currentTop =  this.sections[i].myTopLeft[1] + this.sections[i].size[1];\n\t\t\t\tif (currentTop > maxY && currentTop < section.myTopLeft[1]) {\n\t\t\t\t\tif (this.doSectionsIntersectOnXAxis(this.sections[i], section)) {\n\t\t\t\t\t\tmaxY = currentTop;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif (maxY === -Infinity)\n\t\t\treturn 0; // There is nothing on the left of this section.\n\t\telse\n\t\t\treturn maxY + app.roundedDpiScale; // Don't overlap with the section on the top.\n\t}\n\n\t// Find the bottom most point from a position with same zIndex.\n\tprivate hitBottom (section: CanvasSectionObject): number {\n\t\tvar minY = Infinity;\n\t\tfor (var i: number = 0; i < this.sections.length; i++) {\n\t\t\tif (this.sections[i].isLocated && this.sections[i].zIndex === section.zIndex && this.sections[i].name !== section.name) {\n\t\t\t\tvar currentBottom =  this.sections[i].myTopLeft[1];\n\t\t\t\tif (currentBottom < minY && currentBottom > section.myTopLeft[1]) {\n\t\t\t\t\tif (this.doSectionsIntersectOnXAxis(this.sections[i], section)) {\n\t\t\t\t\t\tminY = currentBottom;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif (minY === Infinity)\n\t\t\treturn this.bottom; // There is nothing on the left of this section.\n\t\telse\n\t\t\treturn minY - app.roundedDpiScale; // Don't overlap with the section on the bottom.\n\t}\n\n\tcreateUpdateSingleDivElement (section: CanvasSectionObject) {\n\t\tvar bcr: ClientRect = this.canvas.getBoundingClientRect();\n\t\tvar element: HTMLDivElement = <HTMLDivElement>document.getElementById('test-div-' + section.name);\n\t\tif (!element) {\n\t\t\telement = document.createElement('div');\n\t\t\telement.id = 'test-div-' + section.name;\n\t\t\tdocument.body.appendChild(element);\n\t\t}\n\t\telement.style.position = 'fixed';\n\t\telement.style.zIndex = '-1';\n\t\telement.style.left = String(bcr.left + Math.round(section.myTopLeft[0] / app.dpiScale)) + 'px';\n\t\telement.style.top = String(bcr.top + Math.round(section.myTopLeft[1] / app.dpiScale)) + 'px';\n\t\telement.style.width = String(Math.round(section.size[0] / app.dpiScale)) + 'px';\n\t\telement.style.height = String(Math.round(section.size[1] / app.dpiScale)) + 'px';\n\t\tif (section.name === 'tiles') {\n\t\t\t// For tiles section add document coordinates of top and left too.\n\t\t\telement.innerText = JSON.stringify({\n\t\t\t\ttop: Math.round(section.documentTopLeft[1]),\n\t\t\t\tleft: Math.round(section.documentTopLeft[0]),\n\t\t\t\twidth: Math.round(section.size[0]),\n\t\t\t\theight: Math.round(section.size[1])\n\t\t\t});\n\t\t}\n\t}\n\n\tcreateUpdateDivElements () {\n\t\tfor (var i: number = 0; i < this.sections.length; i++) {\n\t\t\tthis.createUpdateSingleDivElement(this.sections[i]);\n\t\t}\n\t}\n\n\tpublic reNewAllSections(redraw: boolean = true) {\n\t\tthis.orderSections();\n\t\tthis.locateSections();\n\n\t\tfor (var i: number = 0; i < this.sections.length; i++) {\n\t\t\tthis.sections[i].onResize();\n\t\t}\n\t\tthis.applyDrawingOrders();\n\t\tif (this.testing)\n\t\t\tthis.createUpdateDivElements();\n\t\tif (redraw && this.drawingAllowed())\n\t\t\tthis.drawSections();\n\t}\n\n\tprivate roundPositionAndSize(section: CanvasSectionObject) {\n\t\tsection.myTopLeft[0] = Math.round(section.myTopLeft[0]);\n\t\tsection.myTopLeft[1] = Math.round(section.myTopLeft[1]);\n\t\tsection.size[0] = Math.round(section.size[0]);\n\t\tsection.size[1] = Math.round(section.size[1]);\n\t}\n\n\tprivate calculateSectionInitialPosition(section: CanvasSectionObject, index: number): number {\n\t\tif (typeof section.anchor[index] === 'string' || section.anchor[index].length === 1) {\n\t\t\tvar anchor: string = typeof section.anchor[index] === 'string' ? section.anchor[index]: section.anchor[index][0];\n\t\t\tif (index === 0)\n\t\t\t\treturn anchor === 'top' ? section.position[1]: (this.bottom - (section.position[1] + section.size[1]));\n\t\t\telse\n\t\t\t\treturn anchor === 'left' ? section.position[0]: (this.right - (section.position[0] + section.size[0]));\n\t\t}\n\t\telse {\n\t\t\t// If we are here, it means section's edge(s) will be snapped to another section's edges.\n\t\t\t// Count should always be an odd number. Because last variable will be used as a fallback to canvas's edges (top, bottom, right or left).\n\t\t\t// See anchor explanation on top of this file.\n\t\t\t// Correct example: [\"header\", \"bottom\", \"top\"] => Look for section \"header\", if found, use its bottom, if not found, use canvas's top.\n\t\t\tif (section.anchor[index].length % 2 === 0) { // eslint-disable-line no-lonely-if\n\t\t\t\tconsole.error('Section: ' + section.name + '. Wrong anchor definition.');\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t\telse {\n\t\t\t\tvar count: number = section.anchor[index].length;\n\t\t\t\tvar targetSection: CanvasSectionObject = null;\n\t\t\t\tvar targetEdge: string = null;\n\t\t\t\tfor (var i: number = 0; i < count - 1; i++) {\n\t\t\t\t\tif (!this.doesSectionExist(section.anchor[index][i]))\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\ttargetSection = this.getSectionWithName(section.anchor[index][i]);\n\t\t\t\t\tif (targetSection) {\n\t\t\t\t\t\ttargetEdge = section.anchor[index][i + 1];\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (targetSection) {\n\t\t\t\t\t// So, we have target section, we will use its position. Is it located?\n\t\t\t\t\tif (!targetSection.isLocated) {\n\t\t\t\t\t\tconsole.error('Section: ' + section.name + '. Target section for anchor should be located before this section.'\n\t\t\t\t\t\t\t+ ' It means that target section\\'s (if zIndex is the same) processing order should be less or its zIndex should be less than this section.');\n\t\t\t\t\t\treturn 0;\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tif (targetEdge === 'top') { // eslint-disable-line no-lonely-if\n\t\t\t\t\t\t\treturn targetSection.myTopLeft[1] - app.roundedDpiScale;\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse if (targetEdge === 'bottom') {\n\t\t\t\t\t\t\treturn targetSection.myTopLeft[1] + targetSection.size[1] + app.roundedDpiScale;\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse if (targetEdge === 'left') {\n\t\t\t\t\t\t\treturn targetSection.myTopLeft[0] - app.roundedDpiScale;\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse if (targetEdge === 'right') {\n\t\t\t\t\t\t\treturn targetSection.myTopLeft[0] + targetSection.size[0] + app.roundedDpiScale;\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse if (targetEdge === '-left') {\n\t\t\t\t\t\t\tif (section.expand[0] === 'left' && section.origSizeHint) {\n\t\t\t\t\t\t\t\tsection.size[0] = section.origSizeHint[0];\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\treturn targetSection.myTopLeft[0] - section.size[0];\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\t// No target section is found. Use fallback.\n\t\t\t\t\tvar anchor: string = section.anchor[index][count - 1];\n\t\t\t\t\tif (index === 0) {\n\t\t\t\t\t\treturn anchor === 'top' ? section.position[1]: (this.bottom - (section.position[1] + section.size[1]));\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\treturn anchor === 'left' ? section.position[0]: (this.right - (section.position[0] + section.size[0]));\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate expandSection(section: CanvasSectionObject) {\n\t\tif (this.arrayIncludes(section.expand, 'left')) {\n\t\t\tvar initialX = section.myTopLeft[0];\n\t\t\tsection.myTopLeft[0] = this.hitLeft(section);\n\t\t\tsection.size[0] = initialX - section.myTopLeft[0];\n\t\t}\n\n\t\tif (this.arrayIncludes(section.expand, 'right')) {\n\t\t\tsection.size[0] = this.hitRight(section) - section.myTopLeft[0];\n\t\t}\n\n\t\tif (this.arrayIncludes(section.expand, 'top')) {\n\t\t\tvar initialY = section.myTopLeft[1];\n\t\t\tsection.myTopLeft[1] = this.hitTop(section);\n\t\t\tsection.size[1] = initialY - section.myTopLeft[1];\n\t\t}\n\n\t\tif (this.arrayIncludes(section.expand, 'bottom')) {\n\t\t\tsection.size[1] = this.hitBottom(section) - section.myTopLeft[1];\n\t\t}\n\t}\n\n\tprivate locateSections () {\n\n\t\tfor (var i: number = 0; i < this.sections.length; i++) {\n\t\t\tconst section = this.sections[i];\n\t\t\t// Reset some values.\n\t\t\tsection.isLocated = false;\n\t\t\tsection.myTopLeft = null;\n\n\t\t\t// Preserve the original size hint\n\t\t\tif (typeof section.origSizeHint === 'undefined') {\n\t\t\t\tsection.origSizeHint = [...section.size];\n\t\t\t}\n\t\t}\n\n\t\tthis.documentAnchor = null;\n\t\tthis.windowSectionList = [];\n\n\t\tfor (var i: number = 0; i < this.sections.length; i++) {\n\t\t\tconst section: CanvasSectionObject = this.sections[i];\n\n\t\t\tif (section.documentObject === true) { // \"Document anchor\" section should be processed before \"document object\" sections.\n\t\t\t\tif (section.size && section.position) {\n\t\t\t\t\tsection.isLocated = true;\n\t\t\t\t\tsection.myTopLeft = [this.documentAnchor[0] + section.position[0] - this.documentTopLeft[0], this.documentAnchor[1] + section.position[1] - this.documentTopLeft[1]];\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (section.boundToSection) { // Don't set boundToSection property for \"window sections\".\n\t\t\t\tvar parentSection = this.getSectionWithName(section.boundToSection);\n\t\t\t\tif (parentSection) {\n\t\t\t\t\tsection.myTopLeft = [0, 0];\n\t\t\t\t\tsection.size = [0, 0];\n\t\t\t\t\tsection.size[0] = parentSection.size[0];\n\t\t\t\t\tsection.size[1] = parentSection.size[1];\n\n\t\t\t\t\tsection.myTopLeft[0] = parentSection.myTopLeft[0];\n\t\t\t\t\tsection.myTopLeft[1] = parentSection.myTopLeft[1];\n\n\t\t\t\t\tthis.roundPositionAndSize(section);\n\t\t\t\t\tsection.isLocated = true;\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (section.windowSection) {\n\t\t\t\tsection.myTopLeft = [0, 0];\n\t\t\t\tsection.size = [this.canvas.width, this.canvas.height];\n\t\t\t\tsection.isLocated = true;\n\t\t\t\tthis.windowSectionList.push(section);\n\t\t\t}\n\t\t\telse { // A regular UI element.\n\t\t\t\tsection.myTopLeft = [this.calculateSectionInitialPosition(section, 1), this.calculateSectionInitialPosition(section, 0)];\n\n\t\t\t\tif (section.expand[0] !== '')\n\t\t\t\t\tthis.expandSection(section);\n\n\t\t\t\tthis.roundPositionAndSize(section);\n\t\t\t\tsection.isLocated = true;\n\t\t\t}\n\n\t\t\tif (section.name === this.documentAnchorSectionName) {\n\t\t\t\tthis.documentAnchor = [section.myTopLeft[0], section.myTopLeft[1]];\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate orderSections () {\n\t\t// According to zIndex & processing order.\n\t\tfor (var i: number = 0; i < this.sections.length - 1; i++) {\n\t\t\tfor (var j = i + 1; j < this.sections.length; j++) {\n\t\t\t\tif (this.sections[i].zIndex > this.sections[j].zIndex\n\t\t\t\t\t|| (this.sections[i].zIndex === this.sections[j].zIndex && this.sections[i].processingOrder > this.sections[j].processingOrder)) {\n\t\t\t\t\tvar temp = this.sections[i];\n\t\t\t\t\tthis.sections[i] = this.sections[j];\n\t\t\t\t\tthis.sections[j] = temp;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tpublic applyDrawingOrders () {\n\t\t// According to drawing order. Section with the highest drawing order will be drawn on top (inside same zIndex).\n\t\tfor (var i: number = 0; i < this.sections.length - 1; i++) {\n\t\t\tvar zIndex = this.sections[i].zIndex;\n\t\t\tfor (var j: number = i + 1; j < this.sections.length && this.sections[j].zIndex === zIndex; j++) {\n\t\t\t\tif (this.sections[i].drawingOrder > this.sections[j].drawingOrder) {\n\t\t\t\t\tvar temp = this.sections[j];\n\t\t\t\t\tthis.sections[j] = this.sections[i];\n\t\t\t\t\tthis.sections[i] = temp;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate drawSectionBorders () {\n\t\tthis.context.lineWidth = 2 * app.dpiScale;\n\t\tthis.context.strokeStyle = 'blue';\n\t\tfor (var i: number = 0; i < this.sections.length; i++) {\n\t\t\tvar section = this.sections[i];\n\n\t\t\tif (section.isLocated && section.showSection && (!section.documentObject || section.isVisible)) {\n\t\t\t\tvar xStart = section.myTopLeft[0];\n\t\t\t\tvar xEnd = xStart + section.size[0];\n\n\t\t\t\tvar yStart = section.myTopLeft[1];\n\t\t\t\tvar yEnd = yStart + section.size[1];\n\n\t\t\t\tthis.context.beginPath();\n\t\t\t\tthis.context.moveTo(xStart, yStart);\n\t\t\t\tthis.context.lineTo(xEnd, yStart);\n\t\t\t\tthis.context.stroke();\n\t\t\t\tthis.context.beginPath();\n\t\t\t\tthis.context.moveTo(xEnd, yStart);\n\t\t\t\tthis.context.lineTo(xEnd, yEnd);\n\t\t\t\tthis.context.stroke();\n\t\t\t\tthis.context.beginPath();\n\t\t\t\tthis.context.moveTo(xEnd, yEnd);\n\t\t\t\tthis.context.lineTo(xStart, yEnd);\n\t\t\t\tthis.context.stroke();\n\t\t\t\tthis.context.beginPath();\n\t\t\t\tthis.context.moveTo(xStart, yEnd);\n\t\t\t\tthis.context.lineTo(xStart, yStart);\n\t\t\t\tthis.context.stroke();\n\t\t\t}\n\t\t}\n\t}\n\n\tsetPenPosition (section: CanvasSectionObject) {\n\t\tthis.context.setTransform(1, 0, 0, 1, 0, 0);\n\t\tthis.context.translate(section.myTopLeft[0], section.myTopLeft[1]);\n\t}\n\n\tprivate drawSections (frameCount: number = null, elapsedTime: number = null) {\n\t\tthis.context.setTransform(1, 0, 0, 1, 0, 0);\n\n\t\tif (!this.zoomChanged) {\n\t\t\tthis.clearCanvas();\n\t\t}\n\n\t\tthis.context.font = String(20 * app.dpiScale) + 'px Verdana';\n\t\tfor (var i: number = 0; i < this.sections.length; i++) {\n\t\t\tif (this.sections[i].isLocated && this.sections[i].showSection && (!this.sections[i].documentObject || this.sections[i].isVisible)) {\n\t\t\t\tthis.context.translate(this.sections[i].myTopLeft[0], this.sections[i].myTopLeft[1]);\n\t\t\t\tif (this.sections[i].backgroundColor) {\n\t\t\t\t\tthis.context.globalAlpha = this.sections[i].backgroundOpacity;\n\t\t\t\t\tthis.context.fillStyle = this.sections[i].backgroundColor;\n\t\t\t\t\tthis.context.fillRect(0, 0, this.sections[i].size[0], this.sections[i].size[1]);\n\t\t\t\t\tthis.context.globalAlpha = 1;\n\t\t\t\t}\n\n\t\t\t\tthis.sections[i].onDraw(frameCount, elapsedTime);\n\n\t\t\t\tif (this.sections[i].borderColor) { // If section's border is set, draw its borders after section's \"onDraw\" function is called.\n\t\t\t\t\tthis.context.lineWidth = app.dpiScale;\n\t\t\t\t\tthis.context.strokeStyle = this.sections[i].borderColor;\n\t\t\t\t\tthis.context.strokeRect(0.5, 0.5, this.sections[i].size[0], this.sections[i].size[1]);\n\t\t\t\t}\n\n\t\t\t\tthis.context.translate(-this.sections[i].myTopLeft[0], -this.sections[i].myTopLeft[1]);\n\t\t\t}\n\t\t}\n\n\t\tthis.paintedEver = true;\n\t\t//this.drawSectionBorders();\n\t}\n\n\tdoesSectionExist (name: string): boolean {\n\t\tif (name && typeof name === 'string') {\n\t\t\tfor (var i: number = 0; i < this.sections.length; i++) {\n\t\t\t\tif (this.sections[i].name === name) {\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn false;\n\t\t}\n\t\telse {\n\t\t\treturn false;\n\t\t}\n\t}\n\n\tprivate checkNewSectionName (options: any) {\n\t\tif (options.name !== undefined && typeof options.name === 'string' && options.name.trim() !== '') {\n\t\t\tif (this.doesSectionExist(options.name)) {\n\t\t\t\tconsole.error('There is a section with the same name. Use doesSectionExist for existancy checks.');\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\telse if (this.arrayIncludes(['top', 'left', 'bottom', 'right'], options.name.trim())) {\n\t\t\t\tconsole.error('\"top\", \"left\", \"bottom\" and \"right\" words are reserved. Choose another name for the section.');\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\telse {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\tconsole.error('Sections should have a \"name\" property.');\n\t\t\treturn false;\n\t\t}\n\t}\n\n\tprivate checkSectionProperties (options: any) {\n\t\tif (\n\t\t\toptions.anchor === undefined\n\t\t\t|| options.position === undefined\n\t\t\t|| options.size === undefined\n\t\t\t|| options.expand === undefined\n\t\t\t|| options.processingOrder === undefined\n\t\t\t|| options.drawingOrder === undefined\n\t\t\t|| options.zIndex === undefined\n\t\t\t|| options.interactable === undefined\n\t\t) {\n\t\t\tconsole.error('Section has missing properties. See \"checkSectionProperties\" function.');\n\t\t\treturn false;\n\t\t}\n\t\telse {\n\t\t\tif (options.showSection === undefined)\n\t\t\t\toptions.showSection = true;\n\n\t\t\tif (options.windowSection === undefined)\n\t\t\t\toptions.windowSection = false;\n\n\t\t\treturn true;\n\t\t}\n\t}\n\n\tprivate newSectionChecks (options: any): boolean {\n\t\tif (!this.checkNewSectionName(options))\n\t\t\treturn false;\n\t\telse if (!this.checkSectionProperties(options))\n\t\t\treturn false;\n\t\telse\n\t\t\treturn true;\n\t}\n\n\tcreateSection (options: any, parentSectionName: string = null) {\n\t\tif (this.newSectionChecks(options)) {\n\t\t\t// Every section can draw from Point(0, 0), their drawings will be translated to myTopLeft position.\n\t\t\tvar newSection: CanvasSectionObject = new CanvasSectionObject(options);\n\t\t\tnewSection.boundToSection = parentSectionName;\n\t\t\tthis.pushSection(newSection);\n\t\t\treturn true;\n\t\t}\n\t\telse {\n\t\t\treturn false;\n\t\t}\n\t}\n\n\taddSection (newSection: CanvasSectionObject) {\n\t\tif (this.newSectionChecks(newSection)) {\n\t\t\tthis.pushSection(newSection);\n\t\t\treturn true;\n\t\t}\n\t\telse {\n\t\t\treturn false;\n\t\t}\n\t}\n\n\tprivate addSectionFunctions(section: CanvasSectionObject) {\n\t\tsection.setDrawingOrder = function(drawingOrder: number) {\n\t\t\tsection.drawingOrder = drawingOrder;\n\t\t\tsection.containerObject.updateBoundSectionLists();\n\t\t\tsection.containerObject.reNewAllSections();\n\t\t};\n\n\t\tsection.setZIndex = function(zIndex: number) {\n\t\t\tsection.zIndex = zIndex;\n\t\t\tsection.containerObject.updateBoundSectionLists();\n\t\t\tsection.containerObject.reNewAllSections();\n\t\t};\n\n\t\tsection.bindToSection = function(sectionName: string) {\n\t\t\tsection.boundToSection = sectionName;\n\t\t\tsection.containerObject.updateBoundSectionLists();\n\t\t\tsection.containerObject.reNewAllSections();\n\t\t};\n\n\t\tsection.stopPropagating = function() {\n\t\t\tsection.containerObject.lowestPropagatedBoundSection = section.name;\n\t\t};\n\n\t\tsection.startAnimating = function(options: any): boolean {\n\t\t\treturn section.containerObject.startAnimating(section.name, options);\n\t\t};\n\n\t\tsection.resetAnimation = function () {\n\t\t\tsection.containerObject.resetAnimation(section.name);\n\t\t};\n\n\t\tsection.getTestDiv = function (): HTMLDivElement {\n\t\t\tvar element: HTMLDivElement = <HTMLDivElement>document.getElementById('test-div-' + this.name);\n\t\t\tif (element) {\n\t\t\t\treturn element;\n\t\t\t}\n\t\t\telse {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t};\n\n\t\tsection.isCalcRTL = function (): boolean {\n\t\t\tconst docLayer = section.sectionProperties.docLayer;\n\t\t\tif (docLayer && docLayer.isCalcRTL()) {\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\treturn false;\n\t\t};\n\n\t\t// Only for document objects.\n\t\tif (section.documentObject === true) {\n\t\t\tsection.setPosition = function (x: number, y: number) {\n\t\t\t\tx = Math.round(x);\n\t\t\t\ty = Math.round(y);\n\t\t\t\tlet sectionXcoord = x - section.containerObject.documentTopLeft[0];\n\t\t\t\tif (section.isCalcRTL()) {\n\t\t\t\t\tconsole.log('DEBUG: setPosition: docSize = ' + section.containerObject.getDocumentSize()[0]);\n\t\t\t\t\t// the document coordinates are not always in sync(fixing that is non-trivial!), so use the latest from map.\n\t\t\t\t\tconst docLayer = section.sectionProperties.docLayer;\n\t\t\t\t\tconst docSize = docLayer._map.getPixelBoundsCore().getSize();\n\t\t\t\t\tsectionXcoord = docSize.x - sectionXcoord - section.size[0];\n\t\t\t\t}\n\n\t\t\t\tsection.myTopLeft[0] = section.containerObject.documentAnchor[0] + sectionXcoord;\n\t\t\t\tsection.myTopLeft[1] = section.containerObject.documentAnchor[1] + y - section.containerObject.documentTopLeft[1];\n\t\t\t\tsection.position[0] = x;\n\t\t\t\tsection.position[1] = y;\n\t\t\t\tsection.isVisible = section.containerObject.isDocumentObjectVisible(section);\n\t\t\t\tif (this.testing)\n\t\t\t\t\tsection.containerObject.createUpdateSingleDivElement(section);\n\t\t\t};\n\t\t}\n\t}\n\n\tprivate pushSection (newSection: CanvasSectionObject) {\n\t\t// Every section can draw from Point(0, 0), their drawings will be translated to myTopLeft position.\n\t\tnewSection.context = this.context;\n\t\tnewSection.documentTopLeft = this.documentTopLeft;\n\t\tnewSection.containerObject = this;\n\t\tnewSection.sectionProperties.section = newSection;\n\t\tthis.sections.push(newSection);\n\t\tthis.addSectionFunctions(newSection);\n\t\tnewSection.onInitialize();\n\t\tif (this.drawingAllowed()) {\n\t\t\tthis.updateBoundSectionLists();\n\t\t\tthis.reNewAllSections();\n\t\t}\n\t\telse {\n\t\t\tthis.sectionsDirty = true;\n\t\t\tthis.dirty = true;\n\t\t}\n\t}\n\n\tremoveSection (name: string) {\n\t\tvar found: boolean = false;\n\t\tfor (var i: number = 0; i < this.sections.length; i++) {\n\t\t\tif (this.sections[i].name === name) {\n\t\t\t\tvar element: HTMLDivElement = <HTMLDivElement>document.getElementById('test-div-' + this.sections[i].name);\n\t\t\t\tif (element) // Remove test div if exists.\n\t\t\t\t\tdocument.body.removeChild(element);\n\t\t\t\tthis.sections[i].onRemove();\n\t\t\t\tthis.sections[i] = null;\n\t\t\t\tthis.sections.splice(i, 1);\n\t\t\t\tfound = true;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\tif (found) {\n\t\t\tif (!this.drawingAllowed())\n\t\t\t    this.sectionsDirty = true;\n\t\t\telse {\n\t\t\t    this.updateBoundSectionLists();\n\t\t\t    this.reNewAllSections();\n\t\t\t}\n\t\t\treturn true;\n\t\t}\n\t\telse {\n\t\t\treturn false;\n\t\t}\n\t}\n\n\tprivate setAnimatingSectionName (sectionName: string) {\n\t\tthis.animatingSectionName = sectionName;\n\t}\n\n\tpublic getAnimatingSectionName (): string {\n\t\treturn this.animatingSectionName;\n\t}\n\n\tprivate animate (timeStamp: number) {\n\t\tif (this.lastFrameStamp > 0)\n\t\t\tthis.elapsedTime += timeStamp - this.lastFrameStamp;\n\n\t\tthis.lastFrameStamp = timeStamp;\n\n\t\tif (this.duration && this.elapsedTime >= this.duration) { // This is not the only place that can set \"continueAnimating\" to \"false\".\n\t\t\tthis.continueAnimating = false;\n\t\t}\n\n\t\tif (this.continueAnimating) {\n\t\t\tthis.drawSections(this.frameCount, this.elapsedTime);\n\t\t\tthis.frameCount++;\n\t\t\trequestAnimationFrame(this.animate.bind(this));\n\t\t}\n\t\telse {\n\t\t\tfor (var i: number = 0; i < this.stoppingFunctionList.length; i++) {\n\t\t\t\tthis.canvas.removeEventListener(this.stoppingEventTypes[i], this.stoppingFunctionList[i], true);\n\t\t\t}\n\n\t\t\tvar section: CanvasSectionObject = this.getSectionWithName(this.getAnimatingSectionName());\n\t\t\tif (section) {\n\t\t\t\tsection.isAnimating = false;\n\t\t\t\tsection.onAnimationEnded(this.frameCount, this.elapsedTime);\n\t\t\t}\n\n\t\t\tthis.setAnimatingSectionName(null);\n\t\t\tthis.frameCount = this.elapsedTime = null;\n\n\t\t\tthis.drawSections();\n\t\t}\n\t}\n\n\tprivate createStoppingFunction () {\n\t\treturn function () {\n\t\t\tthis.continueAnimating = false;\n\t\t}.bind(this);\n\t}\n\n\t// Resets animation duration. Not to be called directly. Instead, use (inside section class) this.resetAnimation()\n\tpublic resetAnimation (sectionName: string) {\n\t\tif (sectionName === this.getAnimatingSectionName()) {\n\t\t\tthis.lastFrameStamp = 0;\n\t\t\tthis.elapsedTime = 0;\n\t\t\tthis.frameCount = 0;\n\t\t}\n\t}\n\n\tpublic stopAnimating () {\n\t\t// Though this function is available for every section, generally, only the section that started animation should use this.\n\t\tthis.continueAnimating = false;\n\t}\n\n\t// Don't call this directly. Instead, call (inside the section class) section.startAnimating(options).\n\tpublic startAnimating (sectionName: string, options: any): boolean {\n\t\t/*\n\t\t\tMost of the time, we need to draw entire canvas when animating.\n\t\t\tBecause if there is another section under the animated one, that section needs to be renewed too.\n\t\t\tAlso, sections may need to be redrawn because of the updated view (while animating).\n\t\t\tThis animation feature re-draws all sections with requestAnimationFrame.\n\t\t\tDeveloper can set options to ensure the animation stops at certain point.\n\t\t\tIf your section's \"onDraw\" function is given the variables \"frameCount, elapsedTime\", then you can assume that CanvasSectionContainer is in animation mode.\n\t\t\tYou can also check getAnimatingSectionName function of container class (if it is null or not) to see if animating is on.\n\n\t\t\tSections other than the one which started the animation, can't know when the animation will stop.\n\n\t\t\tThe section which started the animation => \"(inside section class) this.containerObject.getAnimatingSectionName()\".\n\n\t\t\tFor now, only one section can start animations at a time.\n\n\t\t\toptions (possible values are separated by the '|' char):\n\t\t\t\t// Developer can specify the events those will stop animating.\n\t\t\t\t// Important note: User shouldn't depend on the order of the events if they assign a stopping handler to an event.\n\t\t\t\t\tLet's assume a stopping function is bound to 'onclick' event.\n\t\t\t\t\tFor now, most probably, onclick event will first be propagated to sections, then animation will stop.\n\t\t\t\t\tBut when Leaflet is removed, animation will stop first and then onclick event will be propagated to sections.\n\n\t\t\t\tstoppingEvents: ['click', 'mousemove' ..etc] // Events should match the real keywords.\n\t\t\t\t// Developer can set the duration for the animation, in miliseconds. There are also other ways to stop the animation.\n\t\t\t\tduration: 2000 | null // 2 seconds | null.\n\t\t*/\n\n\t\tif (!this.getAnimatingSectionName()) {\n\t\t\tthis.setAnimatingSectionName(sectionName);\n\t\t\tthis.getSectionWithName(sectionName).isAnimating = true;\n\t\t\tthis.lastFrameStamp = 0;\n\t\t\tthis.continueAnimating = true;\n\t\t\tthis.duration = options.duration ? options.duration: null;\n\t\t\tthis.elapsedTime = 0;\n\t\t\tthis.frameCount = 0;\n\n\t\t\tthis.stoppingFunctionList = new Array<EventListener>(0);\n\t\t\tthis.stoppingEventTypes = new Array<string>(0);\n\n\t\t\tif (options.stoppingEvents) {\n\t\t\t\tfor (var i: number = 0; i < options.stoppingEvents.length; i++) {\n\t\t\t\t\tthis.stoppingEventTypes.push(options.stoppingEvents[i]);\n\t\t\t\t\tthis.stoppingFunctionList.push(this.createStoppingFunction());\n\t\t\t\t\tthis.canvas.addEventListener(options.stoppingEvents[i], this.stoppingFunctionList[i], true);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.animate(performance.now());\n\t\t\treturn true;\n\t\t}\n\t\telse {\n\t\t\treturn false;\n\t\t}\n\t}\n}\n"]}