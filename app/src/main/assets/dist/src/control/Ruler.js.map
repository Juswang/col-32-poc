{"version":3,"file":"Ruler.js","sourceRoot":"","sources":["../../../../../../../../browser/src/control/Ruler.js"],"names":[],"mappings":"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","sourcesContent":["/* -*- js-indent-level: 8; fill-column: 100 -*- */\n/*\n * Ruler Handler\n */\n\n/* global app $ L _ Hammer */\nL.Control.Ruler = L.Control.extend({\n\toptions: {\n\t\tinteractive: true,\n\t\tmarginSet: false,\n\t\tdisplayNumber: true,\n\t\ttileMargin: 18, // No idea what this means and where it comes from\n\t\tmargin1: null,\n\t\tmargin2: null,\n\t\tnullOffset: null,\n\t\tpageOffset: null,\n\t\tpageWidth: null,\n\t\ttabs: [],\n\t\tunit: null,\n\t\tDraggableConvertRatio: null,\n\t\ttimer: null,\n\t\tshowruler: true\n\t},\n\n\tonAdd: function(map) {\n\t\tmap.on('rulerupdate', this._updateOptions, this);\n\t\tmap.on('tabstoplistupdate', this._updateTabStops, this);\n\t\tmap.on('scrolllimits', this._updatePaintTimer, this);\n\t\tmap.on('moveend', this._fixOffset, this);\n\t\tmap.on('updatepermission', this._changeInteractions, this);\n\t\tL.DomUtil.addClass(map.getContainer(), 'hasruler');\n\t\tthis._map = map;\n\n\t\treturn this._initLayout();\n\t},\n\n\t_updatePaintTimer: function() {\n\t\tclearTimeout(this.options.timer);\n\t\tthis.options.timer = setTimeout(L.bind(this._updateBreakPoints, this), 300);\n\t},\n\n\t_changeInteractions: function(e) {\n\t\tif (this._lMarginDrag) {\n\t\t\tif (e.perm === 'edit') {\n\t\t\t\tthis._lMarginDrag.style.cursor = 'e-resize';\n\t\t\t\tthis._rMarginDrag.style.cursor = 'w-resize';\n\n\t\t\t\tif (!window.ThisIsTheiOSApp) {\n\t\t\t\t\tL.DomEvent.on(this._rMarginDrag, 'mousedown', this._initiateDrag, this);\n\t\t\t\t\tL.DomEvent.on(this._lMarginDrag, 'mousedown', this._initiateDrag, this);\n\t\t\t\t}\n\t\t\t}\n\t\t\telse {\n\t\t\t\tthis._lMarginDrag.style.cursor = 'default';\n\t\t\t\tthis._rMarginDrag.style.cursor = 'default';\n\n\t\t\t\tif (!window.ThisIsTheiOSApp) {\n\t\t\t\t\tL.DomEvent.off(this._rMarginDrag, 'mousedown', this._initiateDrag, this);\n\t\t\t\t\tL.DomEvent.off(this._lMarginDrag, 'mousedown', this._initiateDrag, this);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t},\n\n\t_initiateIndentationMarkers: function() {\n\t\t// First line indentation..\n\t\tthis._firstLineMarker = document.createElement('div');\n\t\tthis._firstLineMarker.id = 'lo-fline-marker';\n\t\tthis._firstLineMarker.classList.add('cool-ruler-indentation-marker-down');\n\t\tthis._rFace.appendChild(this._firstLineMarker);\n\n\t\t// Paragraph indentation..\n\t\tthis._pStartMarker = document.createElement('div');\n\t\tthis._pStartMarker.id = 'lo-pstart-marker';\n\t\tthis._pStartMarker.classList.add('cool-ruler-indentation-marker-up');\n\t\tthis._rFace.appendChild(this._pStartMarker);\n\n\t\t// Paragraph end..\n\t\tthis._pEndMarker = document.createElement('div');\n\t\tthis._pEndMarker.id = 'lo-pend-marker';\n\t\tthis._pEndMarker.classList.add('cool-ruler-indentation-marker-up');\n\t\tthis._rFace.appendChild(this._pEndMarker);\n\n\t\t// While one of the markers is being dragged, a vertical line should be visible in order to indicate the new position of the marker..\n\t\tthis._markerVerticalLine = L.DomUtil.create('div', 'cool-ruler-indentation-marker-center');\n\t\tthis._rFace.appendChild(this._markerVerticalLine);\n\n\t\tvar self = this;\n\n\t\t// Now we have indentation markers. Next we should bind drag initializers to them..\n\t\t// We will use 3 hammers. 1 hammer is not usable for this case.\n\t\tif (L.Browser.touch) {\n\t\t\t// Hammer for first line indentation..\n\t\t\tthis._firstLineHammer = new Hammer(this._firstLineMarker);\n\t\t\tthis._firstLineHammer.add(new Hammer.Pan({ threshold: 0, pointers: 0 }));\n\t\t\tthis._firstLineHammer.get('press').set({\n\t\t\t\ttime: 500\n\t\t\t});\n\t\t\tthis._firstLineHammer.on('panstart', function (event) {\n\t\t\t\tself._initiateIndentationDrag(event);\n\t\t\t});\n\t\t\tthis._firstLineHammer.on('panmove', function (event) {\n\t\t\t\tself._moveIndentation(event);\n\t\t\t});\n\t\t\tthis._firstLineHammer.on('panend', function (event) {\n\t\t\t\tself._moveIndentationEnd(event);\n\t\t\t});\n\n\t\t\t// Hammer for paragraph start indentation..\n\t\t\tthis._pStartHammer = new Hammer(this._pStartMarker);\n\t\t\tthis._pStartHammer.add(new Hammer.Pan({ threshold: 0, pointers: 0 }));\n\t\t\tthis._pStartHammer.get('press').set({\n\t\t\t\ttime: 500\n\t\t\t});\n\t\t\tthis._pStartHammer.on('panstart', function (event) {\n\t\t\t\tself._initiateIndentationDrag(event);\n\t\t\t});\n\t\t\tthis._pStartHammer.on('panmove', function (event) {\n\t\t\t\tself._moveIndentation(event);\n\t\t\t});\n\t\t\tthis._pStartHammer.on('panend', function (event) {\n\t\t\t\tself._moveIndentationEnd(event);\n\t\t\t});\n\n\t\t\t// Hammer for paragraph end indentation..\n\t\t\tthis._pEndHammer = new Hammer(this._pEndMarker);\n\t\t\tthis._pEndHammer.add(new Hammer.Pan({ threshold: 0, pointers: 0 }));\n\t\t\tthis._pEndHammer.get('press').set({\n\t\t\t\ttime: 500\n\t\t\t});\n\t\t\tthis._pEndHammer.on('panstart', function (event) {\n\t\t\t\tself._initiateIndentationDrag(event);\n\t\t\t});\n\t\t\tthis._pEndHammer.on('panmove', function (event) {\n\t\t\t\tself._moveIndentation(event);\n\t\t\t});\n\t\t\tthis._pEndHammer.on('panend', function (event) {\n\t\t\t\tself._moveIndentationEnd(event);\n\t\t\t});\n\t\t}\n\t\telse {\n\t\t\tL.DomEvent.on(this._firstLineMarker, 'mousedown', this._initiateIndentationDrag, this);\n\t\t\tL.DomEvent.on(this._pStartMarker, 'mousedown', this._initiateIndentationDrag, this);\n\t\t\tL.DomEvent.on(this._pEndMarker, 'mousedown', this._initiateIndentationDrag, this);\n\t\t}\n\t},\n\n\t_initLayout: function() {\n\t\tthis._rWrapper = L.DomUtil.create('div', 'cool-ruler leaflet-bar leaflet-control leaflet-control-custom');\n\t\tthis._rWrapper.style.visibility = 'hidden';\n\n\t\t// We start it hidden rather than not initialzing at all.\n\t\t// It is due to rulerupdate command that comes from LOK.\n\t\t// If we delay its initialization, we can't calculate its margins and have to wait for another rulerupdate message to arrive.\n\t\tif (!this.options.showruler) {\n\t\t\tL.DomUtil.setStyle(this._rWrapper, 'display', 'none');\n\t\t}\n\t\tthis._rFace = L.DomUtil.create('div', 'cool-ruler-face', this._rWrapper);\n\t\tthis._rMarginWrapper = L.DomUtil.create('div', 'cool-ruler-marginwrapper', this._rFace);\n\t\t// BP => Break Points\n\t\tthis._rBPWrapper = L.DomUtil.create('div', 'cool-ruler-breakwrapper', this._rFace);\n\t\tthis._rBPContainer = L.DomUtil.create('div', 'cool-ruler-breakcontainer', this._rBPWrapper);\n\n\t\t// Tab stops\n\t\tthis._rTSContainer = L.DomUtil.create('div', 'cool-ruler-tabstopcontainer', this._rMarginWrapper);\n\t\tL.DomEvent.on(this._rTSContainer, 'mousedown', this._initiateTabstopDrag, this);\n\n\t\tvar self = this;\n\n\t\tif (L.Browser.touch) {\n\t\t\tthis._hammer = new Hammer(this._rTSContainer);\n\t\t\tthis._hammer.add(new Hammer.Pan({ threshold: 0, pointers: 0 }));\n\t\t\tthis._hammer.get('press').set({\n\t\t\t\ttime: 500\n\t\t\t});\n\t\t\tthis._hammer.on('panstart', function (event) {\n\t\t\t\tself._initiateTabstopDrag(event);\n\t\t\t});\n\t\t\tthis._hammer.on('panmove', function (event) {\n\t\t\t\tself._moveTabstop(event);\n\t\t\t});\n\t\t\tthis._hammer.on('panend', function (event) {\n\t\t\t\tself._endTabstopDrag(event);\n\t\t\t});\n\t\t\tthis._hammer.on('press', function (event) {\n\t\t\t\tself._onTabstopContainerLongPress(event);\n\t\t\t});\n\t\t}\n\n\t\tthis._initiateIndentationMarkers();\n\n\t\treturn this._rWrapper;\n\t},\n\n\t_updateOptions: function(obj) {\n\t\t// window.app.console.log('===> _updateOptions');\n\t\t// Note that the values for margin1, margin2 and leftOffset are not in any sane\n\t\t// units. See the comment in SwCommentRuler::CreateJsonNotification(). The values\n\t\t// are pixels for some virtual device in core, not related to the actual device this\n\t\t// is running on at all, passed through convertTwipToMm100(), i.e. multiplied by\n\t\t// approximately 1.76. Let's call these units \"arbitrary pixelish units\" in\n\t\t// comments here.\n\t\tthis.options.margin1 = parseInt(obj['margin1']);\n\t\tthis.options.margin2 = parseInt(obj['margin2']);\n\t\tthis.options.nullOffset = parseInt(obj['leftOffset']);\n\n\t\t// pageWidth on the other hand *is* really in mm100.\n\t\tthis.options.pageWidth = parseInt(obj['pageWidth']);\n\n\t\t// to be enabled only after adding support for other length units as well\n\t\t// this.options.unit = obj['unit'].trim();\n\n\t\tthis._updateBreakPoints();\n\n\t\tthis._rWrapper.style.visibility = '';\n\t},\n\n\t_updateParagraphIndentations: function() {\n\t\tvar items = this._map['stateChangeHandler'];\n\t\tvar state = items.getItemValue('.uno:LeftRightParaMargin');\n\n\t\tif (!state)\n\t\t\treturn;\n\n\t\tthis.options.firstLineIndent = parseFloat(state.firstline.replace(',', '.'));\n\t\tthis.options.leftParagraphIndent = parseFloat(state.left.replace(',', '.'));\n\t\tthis.options.rightParagraphIndent = parseFloat(state.right.replace(',', '.'));\n\t\tthis.options.indentUnit = state.unit;\n\n\t\tvar pxPerMm100 = this._map._docLayer._docPixelSize.x / (this._map._docLayer._docWidthTwips * 2540/1440);\n\n\t\t// Conversion to mm100.\n\t\tif (this.options.indentUnit === 'inch') {\n\t\t\tthis.options.firstLineIndent = this.options.firstLineIndent * 2540;\n\t\t\tthis.options.leftParagraphIndent = this.options.leftParagraphIndent * 2540;\n\t\t\tthis.options.rightParagraphIndent = this.options.rightParagraphIndent * 2540;\n\t\t}\n\n\t\tthis.options.firstLineIndent *= pxPerMm100;\n\t\tthis.options.leftParagraphIndent *= pxPerMm100;\n\t\tthis.options.rightParagraphIndent *= pxPerMm100;\n\n\t\t// rTSContainer is the reference element.\n\t\tvar pStartPosition = this._rTSContainer.getBoundingClientRect().left + this.options.leftParagraphIndent;\n\t\tvar fLinePosition = pStartPosition + this.options.firstLineIndent;\n\t\tvar pEndPosition = this._rTSContainer.getBoundingClientRect().right - this.options.rightParagraphIndent;\n\n\t\t// We calculated the positions. Now we should move them to left in order to make their sharp edge point to the right direction..\n\t\tthis._firstLineMarker.style.left = (fLinePosition - (this._firstLineMarker.getBoundingClientRect().width / 2.0)) + 'px';\n\t\tthis._pStartMarker.style.left = (pStartPosition - (this._pStartMarker.getBoundingClientRect().width / 2.0)) + 'px';\n\t\tthis._pEndMarker.style.left = (pEndPosition - (this._pEndMarker.getBoundingClientRect().width / 2.0)) + 'px';\n\n\t\tthis._markerVerticalLine.style.top = this._rTSContainer.getBoundingClientRect().bottom + 'px';\n\t},\n\n\t_updateTabStops: function(obj) {\n\t\tthis.options.tabs = [];\n\t\tvar jsonTabstops = obj['tabstops'];\n\t\tif (jsonTabstops === '')\n\t\t\treturn;\n\t\tfor (var i in jsonTabstops) {\n\t\t\tvar jsonTabstop = jsonTabstops[i];\n\t\t\tthis.options.tabs[i] = {\n\t\t\t\tposition: parseInt(jsonTabstop.position),\n\t\t\t\tstyle: parseInt(jsonTabstop.type)\n\t\t\t};\n\t\t}\n\t\tthis._updateBreakPoints();\n\t},\n\n\t_updateBreakPoints: function() {\n\n\t\tif (this.options.margin1 == null || this.options.margin2 == null)\n\t\t\treturn;\n\n\t\tvar lMargin, rMargin, wPixel, scale;\n\n\t\tlMargin = this.options.nullOffset;\n\n\t\t// This is surely bogus. We take pageWidth, which is in mm100, and subtract a value\n\t\t// that is in \"arbitrary pixelish units\". But the only thing rMargin is used for is\n\t\t// to calculate the width of the part of the ruler that goes out over the right side\n\t\t// of the window anyway (see the assignments to this._rMarginMarker.style.width and\n\t\t// this._rMarginDrag.style.width near the end of this function), so presumably it\n\t\t// doesn't matter that much what rMargin is.\n\t\trMargin = this.options.pageWidth - (this.options.nullOffset + this.options.margin2);\n\n\t\tscale = this._map.getZoomScale(this._map.getZoom(), 10);\n\t\twPixel = this._map._docLayer._docPixelSize.x - (this.options.tileMargin * 2) * scale;\n\n\t\tthis._fixOffset();\n\n\t\tthis.options.DraggableConvertRatio = wPixel / this.options.pageWidth;\n\t\tthis._rFace.style.width = wPixel + 'px';\n\t\tthis._rBPContainer.style.marginLeft = (-1 * (this.options.DraggableConvertRatio * (500 - (lMargin % 1000))) + 1) + 'px';\n\n\t\tvar numCounter = -1 * parseInt(lMargin / 1000);\n\n\t\tL.DomUtil.removeChildNodes(this._rBPContainer);\n\n\t\t// this.options.pageWidth is in mm100, so the code here makes one ruler division per\n\t\t// centimetre.\n\t\t//\n\t\t// FIXME: Surely this should be locale-specific, we would want to use inches at\n\t\t// least in the US. (The ruler unit to use doesn't seem to be stored in the document\n\t\t// at least for .odt?)\n\t\tfor (var num = 0; num <= (this.options.pageWidth / 1000) + 1; num++) {\n\t\t\tvar marker = L.DomUtil.create('div', 'cool-ruler-maj', this._rBPContainer);\n\t\t\t// The - 1 is to compensate for the left and right .5px borders of\n\t\t\t// cool-ruler-maj in leaflet.css.\n\t\t\tmarker.style.width = this.options.DraggableConvertRatio*1000 - 1 + 'px';\n\t\t\tif (this.options.displayNumber) {\n\t\t\t\tif (numCounter !== 0)\n\t\t\t\t\tmarker.innerText = Math.abs(numCounter++);\n\t\t\t\telse\n\t\t\t\t\tnumCounter++;\n\t\t\t}\n\t\t}\n\n\t\t// The tabstops. Only draw user-created ones, with style RULER_TAB_LEFT,\n\t\t// RULER_TAB_RIGHT, RULER_TAB_CENTER, and RULER_TAB_DECIMAL. See <svtools/ruler.hxx>.\n\t\tL.DomUtil.removeChildNodes(this._rTSContainer);\n\n\t\tvar pxPerMm100 = this._map._docLayer._docPixelSize.x / (this._map._docLayer._docWidthTwips * 2540/1440);\n\t\tthis._rTSContainer.tabStops = [];\n\t\tfor (var tabstopIndex = 0; tabstopIndex < this.options.tabs.length; tabstopIndex++) {\n\t\t\tvar markerClass = null;\n\t\t\tvar currentTabstop = this.options.tabs[tabstopIndex];\n\t\t\tswitch (currentTabstop.style) {\n\t\t\tcase 0:\n\t\t\t\tmarkerClass = 'cool-ruler-tabstop-left';\n\t\t\t\tbreak;\n\t\t\tcase 1:\n\t\t\t\tmarkerClass = 'cool-ruler-tabstop-right';\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\t\tmarkerClass = 'cool-ruler-tabstop-center';\n\t\t\t\tbreak;\n\t\t\tcase 3:\n\t\t\t\tmarkerClass = 'cool-ruler-tabstop-decimal';\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tif (markerClass != null) {\n\t\t\t\tmarker = L.DomUtil.create('div', markerClass, this._rTSContainer);\n\t\t\t\tvar positionPixel = currentTabstop.position * pxPerMm100;\n\t\t\t\tvar markerWidth = marker.offsetWidth;\n\t\t\t\tvar markerHalfWidth = markerWidth / 2.0;\n\t\t\t\tmarker.tabStopLocation = { left: positionPixel - markerHalfWidth, center: positionPixel, right: positionPixel + markerHalfWidth };\n\t\t\t\tmarker.style.left = marker.tabStopLocation.left + 'px';\n\t\t\t\tmarker.tabStopNumber = tabstopIndex;\n\t\t\t\tthis._rTSContainer.tabStops[tabstopIndex] = marker;\n\t\t\t\tmarker.style.cursor = 'move';\n\t\t\t}\n\t\t}\n\n\t\tif (!this.options.marginSet) {\n\t\t\tthis.options.marginSet = true;\n\t\t\tthis._lMarginMarker = L.DomUtil.create('div', 'cool-ruler-margin cool-ruler-left', this._rFace);\n\t\t\tthis._rMarginMarker =  L.DomUtil.create('div', 'cool-ruler-margin cool-ruler-right', this._rFace);\n\t\t\tthis._lMarginDrag = L.DomUtil.create('div', 'cool-ruler-drag cool-ruler-left', this._rMarginWrapper);\n\t\t\tthis._lToolTip = L.DomUtil.create('div', 'cool-ruler-ltooltip', this._lMarginDrag);\n\t\t\tthis._rMarginDrag = L.DomUtil.create('div', 'cool-ruler-drag cool-ruler-right', this._rMarginWrapper);\n\t\t\tthis._rToolTip = L.DomUtil.create('div', 'cool-ruler-rtooltip', this._rMarginDrag);\n\t\t\tvar lMarginTooltipText = _('Left Margin');\n\t\t\tvar rMarginTooltipText = _('Right Margin');\n\n\t\t\tthis._lMarginDrag.dataset.title = lMarginTooltipText;\n\t\t\tthis._rMarginDrag.dataset.title = rMarginTooltipText;\n\t\t}\n\n\t\tthis._lMarginMarker.style.width = (this.options.DraggableConvertRatio*lMargin) + 'px';\n\t\tthis._rMarginMarker.style.width = (this.options.DraggableConvertRatio*rMargin) + 'px';\n\t\tthis._lMarginDrag.style.width = (this.options.DraggableConvertRatio*lMargin) + 'px';\n\t\tthis._rMarginDrag.style.width = (this.options.DraggableConvertRatio*rMargin) + 'px';\n\n\t\t// Put the _rTSContainer in the right place\n\t\tthis._rTSContainer.style.left = (this.options.DraggableConvertRatio * lMargin) + 'px';\n\t\tthis._rTSContainer.style.right = (this.options.DraggableConvertRatio * rMargin) + 'px';\n\n\t\tthis._updateParagraphIndentations();\n\n\t\tif (this.options.interactive) {\n\t\t\tthis._changeInteractions({perm:'edit'});\n\t\t}\n\t\telse {\n\t\t\tthis._changeInteractions({perm:'readonly'});\n\t\t}\n\t},\n\n\t_fixOffset: function() {\n\t\tif (!this._map.options.docBounds)\n\t\t\treturn;\n\n\t\tvar scale = this._map.getZoomScale(this._map.getZoom(), 10);\n\t\tvar mapPane = this._map._mapPane;\n\t\tvar topLeft = this._map.latLngToLayerPoint(this._map.options.docBounds.getNorthWest());\n\t\tvar firstTileXTranslate = topLeft.x;\n\n\t\tvar tileContainer = mapPane.getElementsByClassName('leaflet-tile-container');\n\t\tfor (var i = 0; i < tileContainer.length; ++i) {\n\t\t\tif (parseInt(tileContainer[i].style.zIndex) === this._map.getMaxZoom()) {\n\t\t\t\ttileContainer = tileContainer[i];\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tvar tileContainerXTranslate = 0;\n\t\tif (tileContainer.style !== undefined)\n\t\t\ttileContainerXTranslate = parseInt(tileContainer.style.transform.match(/\\(([-0-9]*)/)[1]);\n\n\t\tvar mapPaneXTranslateMatch = mapPane.style.transform.match(/\\(([-0-9]*)/);\n\t\tvar mapPaneXTranslate = 0;\n\t\tif (mapPaneXTranslateMatch !== null && mapPaneXTranslateMatch[1] !== undefined)\n\t\t\tmapPaneXTranslate = parseInt(mapPaneXTranslateMatch[1]);\n\n\t\tvar rulerOffset = mapPaneXTranslate + firstTileXTranslate + tileContainerXTranslate + (this.options.tileMargin * scale);\n\n\t\tthis._rFace.style.marginInlineStart = rulerOffset + 'px';\n\n\t\tthis.rulerOffset = rulerOffset; // Needed on different parts too..\n\t\tthis._updateParagraphIndentations();\n\t},\n\n\t_moveIndentation: function(e) {\n\t\tif (e.type === 'panmove') {\n\t\t\te.clientX = e.center.x;\n\t\t}\n\n\t\tvar element = document.getElementById(this._indentationElementId);\n\n\t\t// User is moving the cursor / their finger on the screen and we are moving the marker.\n\t\tvar newLeft = parseInt(element.style.left.replace('px', '')) + e.clientX - this._lastposition;\n\t\telement.style.left = String(newLeft) + 'px';\n\t\tthis._lastposition = e.clientX;\n\t\t// halfWidth..\n\t\tvar halfWidth = (element.getBoundingClientRect().right - element.getBoundingClientRect().left) * 0.5;\n\t\tthis._markerVerticalLine.style.left = String(newLeft + halfWidth) + 'px';\n\t},\n\n\t_moveIndentationEnd: function(e) {\n\t\tthis._map.rulerActive = false;\n\n\t\tif (e.type !== 'panend') { // The screen may support touch and click at the same time, so we do not use L.Browser.touch while checking the event type in order to support both.\n\t\t\tL.DomEvent.off(this._rFace, 'mousemove', this._moveIndentation, this);\n\t\t\tL.DomEvent.off(this._map, 'mouseup', this._moveIndentationEnd, this);\n\t\t}\n\n\t\tvar unoObj = {}, indentType = '';\n\n\t\t// Calculation step..\n\t\t// The new coordinate of element subject to indentation is sent as a percentage of the page width..\n\t\t// We need to calculate the percentage. Left margin (nullOffset) is not being added to the indentation (on the core part)..\n\t\t// We can use TabStopContainer's position as the reference point, as they share the same reference point..\n\t\tvar element = document.getElementById(this._indentationElementId);\n\n\t\tvar leftValue;\n\t\t// The halfWidth of the shape..\n\t\tvar halfWidth = (element.getBoundingClientRect().right - element.getBoundingClientRect().left) * 0.5;\n\n\t\t// We need the pageWidth in pixels, so we can not use \"this.options.pageWidth\" here, since that's in mm..\n\t\tvar pageWidth = parseFloat(this._rFace.style.width.replace('px', ''));\n\n\t\tif (element.id === 'lo-fline-marker') {\n\t\t\tindentType = 'FirstLineIndent';\n\t\t\t// FirstLine indentation is always positioned according to the left indent..\n\t\t\t// We don't need to add halfWidth here..\n\t\t\tleftValue = (parseFloat(this._firstLineMarker.style.left.replace('px', '')) - parseFloat(this._pStartMarker.style.left.replace('px', '')));\n\t\t}\n\t\telse if (element.id === 'lo-pstart-marker') {\n\t\t\tindentType = 'LeftParaIndent';\n\t\t\tleftValue = element.getBoundingClientRect().left - this._rTSContainer.getBoundingClientRect().left + halfWidth;\n\t\t}\n\t\telse if (element.id === 'lo-pend-marker') {\n\t\t\tindentType = 'RightParaIndent';\n\t\t\t// Right marker is positioned from right, this is rightValue..\n\t\t\tleftValue = this._rTSContainer.getBoundingClientRect().right - element.getBoundingClientRect().right + halfWidth;\n\t\t}\n\n\t\tleftValue = leftValue / pageWidth; // Now it's a percentage..\n\n\t\tif (indentType !== '') {\n\t\t\tunoObj[indentType] = {};\n\t\t\tunoObj[indentType]['type'] = 'string';\n\t\t\tunoObj[indentType]['value'] = leftValue;\n\t\t\tapp.socket.sendMessage('uno .uno:ParagraphChangeState ' + JSON.stringify(unoObj));\n\t\t}\n\n\t\tthis._indentationElementId = '';\n\t\tthis._markerVerticalLine.style.display = 'none';\n\t},\n\n\t_initiateIndentationDrag: function(e) {\n\t\tif (window.ThisIsTheiOSApp && !this._map.isPermissionEdit())\n\t\t\treturn;\n\n\t\tthis._map.rulerActive = true;\n\n\t\tthis._indentationElementId = e.target.id.trim() === '' ? e.target.parentNode.id: e.target.id;\n\n\t\tif (e.type !== 'panstart') {\n\t\t\tL.DomEvent.on(this._rFace, 'mousemove', this._moveIndentation, this);\n\t\t\tL.DomEvent.on(this._map, 'mouseup', this._moveIndentationEnd, this);\n\t\t}\n\t\telse {\n\t\t\te.clientX = e.center.x;\n\t\t}\n\n\t\tthis._initialposition = this._lastposition = e.clientX;\n\t\tthis._markerVerticalLine.style.display = 'block';\n\t\tthis._markerVerticalLine.style.left = this._lastposition + 'px';\n\t},\n\n\t_initiateDrag: function(e) {\n\t\tif (e.type === 'touchstart') {\n\t\t\tif (e.touches.length !== 1)\n\t\t\t\treturn;\n\t\t\te.clientX = e.touches[0].clientX;\n\t\t}\n\n\t\tif (window.ThisIsTheiOSApp && !this._map.isPermissionEdit())\n\t\t\treturn;\n\n\t\tthis._map.rulerActive = true;\n\n\t\tvar dragableElem = e.srcElement || e.target;\n\t\tL.DomEvent.on(this._rFace, 'mousemove', this._moveMargin, this);\n\t\tL.DomEvent.on(this._map, 'mouseup', this._endDrag, this);\n\t\tthis._initialposition = e.clientX;\n\t\tthis._lastposition = this._initialposition;\n\n\t\tif (L.DomUtil.hasClass(dragableElem, 'cool-ruler-right')) {\n\t\t\tL.DomUtil.addClass(this._rMarginDrag, 'leaflet-drag-moving');\n\t\t\tthis._rFace.style.cursor = 'w-resize';\n\t\t}\n\t\telse {\n\t\t\tL.DomUtil.addClass(this._lMarginDrag, 'leaflet-drag-moving');\n\t\t\tthis._rFace.style.cursor = 'e-resize';\n\t\t}\n\t},\n\n\t_moveMargin: function(e) {\n\t\tif (e.type === 'touchmove')\n\t\t\te.clientX = e.touches[0].clientX;\n\n\t\tthis._lastposition = e.clientX;\n\t\tvar posChange = e.clientX - this._initialposition;\n\t\tvar unit = this.options.unit ? this.options.unit : ' cm';\n\t\tif (L.DomUtil.hasClass(this._rMarginDrag, 'leaflet-drag-moving')) {\n\t\t\tvar rMargin = this.options.pageWidth - (this.options.nullOffset + this.options.margin2);\n\t\t\tvar newPos = this.options.DraggableConvertRatio*rMargin - posChange;\n\t\t\tthis._rToolTip.style.display = 'block';\n\t\t\tthis._rToolTip.style.right = newPos - 25 + 'px';\n\t\t\tthis._rToolTip.innerText = (Math.round(this.options.pageWidth / 100 - newPos / (this.options.DraggableConvertRatio * 100)) / 10).toString() + unit;\n\t\t\tthis._rMarginDrag.style.width = newPos + 'px';\n\t\t}\n\t\telse {\n\t\t\tnewPos = this.options.DraggableConvertRatio*this.options.nullOffset + posChange;\n\t\t\tthis._lToolTip.style.display = 'block';\n\t\t\tthis._lToolTip.style.left = newPos - 25 + 'px';\n\t\t\tthis._lToolTip.innerText = (Math.round(newPos / (this.options.DraggableConvertRatio * 100)) / 10).toString() + unit;\n\t\t\tthis._lMarginDrag.style.width = newPos + 'px';\n\t\t}\n\t},\n\n\t_endDrag: function(e) {\n\t\tthis._map.rulerActive = false;\n\n\t\tvar posChange;\n\t\tif (e.type === 'touchend')\n\t\t\tposChange = this._lastposition - this._initialposition;\n\t\telse\n\t\t\tposChange = e.originalEvent.clientX - this._initialposition;\n\t\tvar unoObj = {}, marginType, fact;\n\n\t\tL.DomEvent.off(this._rFace, 'mousemove', this._moveMargin, this);\n\t\tL.DomEvent.off(this._map, 'mouseup', this._endDrag, this);\n\n\t\tif (L.DomUtil.hasClass(this._rMarginDrag, 'leaflet-drag-moving')) {\n\t\t\tmarginType = 'Margin2';\n\t\t\tfact = -1;\n\t\t\tL.DomUtil.removeClass(this._rMarginDrag, 'leaflet-drag-moving');\n\t\t\tthis._rToolTip.style.display = 'none';\n\t\t}\n\t\telse {\n\t\t\tmarginType = 'Margin1';\n\t\t\tfact = 1;\n\t\t\tL.DomUtil.removeClass(this._lMarginDrag, 'leaflet-drag-moving');\n\t\t\tthis._lToolTip.style.display = 'none';\n\t\t}\n\n\t\tthis._rFace.style.cursor = 'default';\n\n\t\tunoObj[marginType] = {};\n\t\tunoObj[marginType]['type'] = 'string';\n\t\tunoObj[marginType]['value'] = fact * posChange/(this.options.DraggableConvertRatio * this.options.pageWidth);\n\t\tapp.socket.sendMessage('uno .uno:RulerChangeState ' + JSON.stringify(unoObj));\n\t},\n\n\t_getTabStopHit: function(tabstopContainer, pointX) {\n\t\tvar tabstop = null;\n\t\tvar margin = 10;\n\t\tvar tabstopDiffFromCenter = 100000000; // just a big initial condition\n\n\t\tfor (var i = 0; i < tabstopContainer.tabStops.length; i++) {\n\t\t\tvar current = tabstopContainer.tabStops[i];\n\t\t\tvar location = current.tabStopLocation;\n\t\t\tif (pointX >= location.left - margin && pointX <= location.right + margin) {\n\t\t\t\tvar diff = Math.abs(pointX - location.center);\n\t\t\t\tif (diff < tabstopDiffFromCenter) {\n\t\t\t\t\ttabstop = current;\n\t\t\t\t\ttabstopDiffFromCenter = diff;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn tabstop;\n\t},\n\n\t_showTabstopContextMenu: function(position, tabstopNumber) {\n\t\tvar self = this;\n\t\tthis.currentPositionInTwips = position;\n\t\tthis.currentTabStopIndex = tabstopNumber;\n\t\t$.contextMenu({\n\t\t\tselector: '.cool-ruler-tabstopcontainer',\n\t\t\tclassName: 'cool-font',\n\t\t\titems: {\n\t\t\t\tinserttabstop: {\n\t\t\t\t\tname: _('Insert tabstop'),\n\t\t\t\t\tcallback: (this._insertTabstop).bind(this),\n\t\t\t\t\tvisible: function() {\n\t\t\t\t\t\treturn self.currentPositionInTwips != null;\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tremovetabstop: {\n\t\t\t\t\tname: _('Delete tabstop'),\n\t\t\t\t\tcallback: (this._deleteTabstop).bind(this),\n\t\t\t\t\tvisible: function() {\n\t\t\t\t\t\treturn self.currentTabStopIndex != null;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t},\n\n\t_initiateTabstopDrag: function(event) {\n\t\t// window.app.console.log('===> _initiateTabstopDrag ' + event.type);\n\n\t\tvar tabstopContainer = null;\n\t\tvar pointX = null;\n\n\t\tif (event.type === 'panstart') {\n\t\t\ttabstopContainer = event.target;\n\t\t\tpointX = event.center.x - event.target.getBoundingClientRect().left;\n\t\t}\n\t\telse {\n\t\t\ttabstopContainer = event.currentTarget;\n\t\t\tpointX = event.layerX;\n\t\t}\n\t\ttabstopContainer.tabStopMarkerBeingDragged = null;\n\n\t\t// check if we hit any tabstop\n\t\tvar tabstop = this._getTabStopHit(tabstopContainer, pointX);\n\n\t\t// Check what to do when a mouse buttons is clicked, ignore touch\n\t\tif (event.type !== 'panstart') {\n\t\t\t// right-click inside tabstop container\n\t\t\tif (event.button === 2) {\n\t\t\t\tif (tabstop == null) {\n\t\t\t\t\tvar position = this._map._docLayer._pixelsToTwips({x: pointX, y:0}).x;\n\t\t\t\t\tthis._showTabstopContextMenu(position, null);\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tthis._showTabstopContextMenu(null, tabstop.tabStopNumber);\n\t\t\t\t}\n\t\t\t\tevent.stopPropagation();\n\t\t\t\treturn;\n\t\t\t}\n\t\t\telse if (event.button !== 0) {\n\t\t\t\tevent.stopPropagation(); // prevent handling of the mother event elsewhere\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\n\t\tif (tabstop == null) {\n\t\t\treturn;\n\t\t}\n\n\t\ttabstopContainer.tabStopMarkerBeingDragged = tabstop;\n\t\ttabstopContainer.tabStopInitialPosiiton = pointX;\n\n\t\tif (!window.ThisIsTheiOSApp && event.pointerType !== 'touch') {\n\t\t\tL.DomEvent.on(this._rTSContainer, 'mousemove', this._moveTabstop, this);\n\t\t\tL.DomEvent.on(this._rTSContainer, 'mouseup', this._endTabstopDrag, this);\n\t\t\tL.DomEvent.on(this._rTSContainer, 'mouseout', this._endTabstopDrag, this);\n\t\t}\n\t},\n\n\t_moveTabstop: function(event) {\n\t\tvar tabstopContainer = null;\n\t\tvar pointX = null;\n\n\t\tif (event.type === 'panmove') {\n\t\t\ttabstopContainer = event.target;\n\t\t\tpointX = event.center.x - event.target.getBoundingClientRect().left;\n\t\t}\n\t\telse {\n\t\t\ttabstopContainer = event.currentTarget;\n\t\t\tpointX = event.layerX;\n\t\t}\n\n\t\tif (tabstopContainer === null)\n\t\t\treturn;\n\t\tvar marker = tabstopContainer.tabStopMarkerBeingDragged;\n\t\tif (marker === null)\n\t\t\treturn;\n\n\t\t//window.app.console.log('===> _moveTabstop ' + event.type);\n\n\t\tvar pixelDiff = pointX - tabstopContainer.tabStopInitialPosiiton;\n\t\tmarker.style.left = (marker.tabStopLocation.left + pixelDiff) + 'px';\n\t},\n\n\t_endTabstopDrag: function(event) {\n\t\t//window.app.console.log('===> _endTabstopDrag ' + event.type);\n\n\t\tvar tabstopContainer = null;\n\t\tvar pointX = null;\n\t\tif (event.type === 'panend') {\n\t\t\ttabstopContainer = event.target;\n\t\t\tpointX = event.center.x - event.target.getBoundingClientRect().left;\n\t\t}\n\t\telse {\n\t\t\ttabstopContainer = event.currentTarget;\n\t\t\tpointX = event.layerX;\n\t\t}\n\n\t\tif (tabstopContainer === null)\n\t\t\treturn;\n\t\tvar marker = tabstopContainer.tabStopMarkerBeingDragged;\n\t\tif (marker === null)\n\t\t\treturn;\n\n\t\tif (event.type == 'mouseout') {\n\t\t\tmarker.style.left = (marker.tabStopLocation.left) + 'px';\n\t\t}\n\t\telse {\n\t\t\tvar positionTwip = this._map._docLayer._pixelsToTwips({x: pointX, y: 0}).x;\n\t\t\tvar params = {\n\t\t\t\tIndex: {\n\t\t\t\t\ttype : 'int32',\n\t\t\t\t\tvalue : marker.tabStopNumber\n\t\t\t\t},\n\t\t\t\tPosition: {\n\t\t\t\t\ttype : 'int32',\n\t\t\t\t\tvalue : positionTwip\n\t\t\t\t},\n\t\t\t\tRemove: {\n\t\t\t\t\ttype : 'boolean',\n\t\t\t\t\tvalue : false\n\t\t\t\t}\n\t\t\t};\n\t\t\tthis._map.sendUnoCommand('.uno:ChangeTabStop', params);\n\t\t}\n\t\tL.DomEvent.off(this._rTSContainer, 'mousemove', this._moveTabstop, this);\n\t\tL.DomEvent.off(this._rTSContainer, 'mouseup', this._endTabstopDrag, this);\n\t\tL.DomEvent.off(this._rTSContainer, 'mouseout', this._endTabstopDrag, this);\n\t},\n\n\t_onTabstopContainerLongPress: function(event) {\n\t\tvar tabstopContainer = event.target;\n\t\tvar pointX = event.center.x - tabstopContainer.getBoundingClientRect().left;\n\t\tvar pointXTwip = this._map._docLayer._pixelsToTwips({x: pointX, y:0}).x;\n\t\tvar tabstop = this._getTabStopHit(tabstopContainer, pointX);\n\n\t\tif (window.mode.isMobile() || window.mode.isTablet()) {\n\t\t\tif (tabstop == null) {\n\t\t\t\tthis.currentPositionInTwips = pointXTwip;\n\t\t\t\tthis.currentTabStopIndex = null;\n\t\t\t\tthis._insertTabstop();\n\t\t\t}\n\t\t\telse {\n\t\t\t\tthis.currentPositionInTwips = null;\n\t\t\t\tthis.currentTabStopIndex = tabstop.tabStopNumber;\n\t\t\t\tthis._deleteTabstop();\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\tvar tabstopNumber = null;\n\t\t\tif (tabstop != null) {\n\t\t\t\ttabstopNumber = tabstop.tabstopNumber;\n\t\t\t\tpointXTwip = null;\n\t\t\t}\n\t\t\tthis._showTabstopContextMenu(pointXTwip, tabstopNumber);\n\t\t}\n\t},\n\n\t_deleteTabstop: function() {\n\t\tif (this.currentTabStopIndex != null) {\n\t\t\tvar params = {\n\t\t\t\tIndex: {\n\t\t\t\t\ttype : 'int32',\n\t\t\t\t\tvalue : this.currentTabStopIndex\n\t\t\t\t},\n\t\t\t\tPosition: {\n\t\t\t\t\ttype : 'int32',\n\t\t\t\t\tvalue : 0\n\t\t\t\t},\n\t\t\t\tRemove: {\n\t\t\t\t\ttype : 'boolean',\n\t\t\t\t\tvalue : true\n\t\t\t\t}\n\t\t\t};\n\t\t\tthis._map.sendUnoCommand('.uno:ChangeTabStop', params);\n\t\t\tthis.currentTabStopIndex = null;\n\t\t}\n\t},\n\n\t_insertTabstop: function() {\n\t\tif (this.currentPositionInTwips != null) {\n\t\t\tvar params = {\n\t\t\t\tIndex: {\n\t\t\t\t\ttype : 'int32',\n\t\t\t\t\tvalue : -1\n\t\t\t\t},\n\t\t\t\tPosition: {\n\t\t\t\t\ttype : 'int32',\n\t\t\t\t\tvalue : this.currentPositionInTwips\n\t\t\t\t},\n\t\t\t\tRemove: {\n\t\t\t\t\ttype : 'boolean',\n\t\t\t\t\tvalue : false\n\t\t\t\t}\n\t\t\t};\n\t\t\tthis._map.sendUnoCommand('.uno:ChangeTabStop', params);\n\t\t\tthis.currentPositionInTwips = null;\n\t\t}\n\t},\n\n});\n\nL.control.ruler = function (options) {\n\treturn new L.Control.Ruler(options);\n};\n"]}