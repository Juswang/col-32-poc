{"version":3,"file":"Signing.js","sourceRoot":"","sources":["../../../../../../../../browser/src/control/Signing.js"],"names":[],"mappings":"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","sourcesContent":["/* -*- js-indent-level: 8 -*- */\n/*\n * Document Signing\n */\n\n/* global app window setupViamAPI w2ui vex Promise $ _ */\n\nvar library = null;\nvar identity = null;\nvar currentPassport = null;\nvar passportCertificates = [];\n\nvar oldtoolbarSize = null;\nvar _map = null;\nvar currentDocumentSigningStatus = 'N/A';\n\nvar awaitForDocumentStatusToUpload = false;\nvar currentDocumentType = null;\n\nfunction isSuccess(result) {\n\treturn result.code == '200';\n}\n\nfunction haveIdentity() {\n\treturn identity != null;\n}\n\nfunction getVereignWopiURL() {\n\tvar vereignURL = window.documentSigningURL == null ? '' : window.documentSigningURL;\n\treturn vereignURL + '/wopi/';\n}\n\nfunction getVereignApiURL() {\n\tvar vereignURL = window.documentSigningURL == null ? '' : window.documentSigningURL;\n\treturn vereignURL + '/api/';\n}\n\nfunction getVereignIFrameURL() {\n\tvar vereignURL = window.documentSigningURL == null ? '' : window.documentSigningURL;\n\treturn vereignURL + '/vcl/js/iframe';\n}\n\nfunction randomName() {\n\treturn Math.random().toString(36).substring(2) + (new Date()).getTime().toString(36);\n}\n\nfunction getCurrentDocumentFilename(documentType) {\n\tvar filename = _map['wopi'].BaseFileName;\n\tif (!filename)\n\t\tfilename = randomName() + '.' + documentType;\n\treturn filename;\n}\n\nfunction updateIndentity() {\n\tif (library && identity) {\n\t\tlibrary.getIdentityProfile(identity.authentication.publicKey).then(function(result) {\n\t\t\tvar initials = result.data.initials;\n\t\t\tvar color = result.data.identityColor;\n\t\t\tw2ui['document-signing-bar'].get('identity').html = '<p style=\"background-color: ' + color + '; border: none; color: white; padding: 8px; text-align: center; text-decoration: none; display: inline-block; font-size: 12px; margin: 4px 2px; border-radius: 50%;\">' + initials + '</p>';\n\t\t\tw2ui['document-signing-bar'].refresh();\n\t\t});\n\t}\n\telse {\n\t\tw2ui['document-signing-bar'].get('identity').html = '';\n\t\tw2ui['document-signing-bar'].refresh();\n\t}\n}\n\nfunction addPassportToToolbar(passport, i) {\n\tvar name = null;\n\ttry {\n\t\tname = passport['claims']['passportName']['tags']['notag']['value']['value'];\n\t}\n\tcatch (exception) {\n\t\twindow.app.console.log(exception);\n\t\tname = 'Unknown ' + (i+1);\n\t}\n\n\tw2ui['document-signing-bar'].get('passport').items.push(\n\t\t{ text: name, id: 'item ' + (i+1), value: passport.uuid }\n\t);\n\n\tvar promise = library.getCertificateByPassport(passport.uuid);\n\tpromise = promise.then(function(result) {\n\t\tif (isSuccess(result)) {\n\t\t\tvar chain = result.data.chain;\n\t\t\tfor (var i = 0; i < chain.length; i++) {\n\t\t\t\tif (passportCertificates.indexOf(chain[i]) == -1) {\n\t\t\t\t\tpassportCertificates.push(chain[i]);\n\t\t\t\t}\n\t\t\t}\n\t\t\tpassportCertificates.push(result.data.x509Certificate);\n\t\t}\n\t});\n\treturn promise;\n}\n\nfunction checkCurrentDocument() {\n\tvar certificates = {\n\t\tcertificates: passportCertificates\n\t};\n\tvar blob = new Blob(['asksignaturestatus\\n', JSON.stringify(certificates)]);\n\tif (_map) {\n\t\tapp.socket.sendMessage(blob);\n\t}\n}\n\nfunction updatePassportList() {\n\tif (library) {\n\t\tlibrary.passportListPassports().then(function(result) {\n\t\t\tif (isSuccess(result))\n\t\t\t{\n\t\t\t\tpassportCertificates = [];\n\t\t\t\tw2ui['document-signing-bar'].get('passport').items = [];\n\t\t\t\tvar passports = result.data;\n\t\t\t\tvar promises = [];\n\t\t\t\tfor (var i = 0; i < passports.length; i++) {\n\t\t\t\t\tpromises.push(addPassportToToolbar(passports[i], i));\n\t\t\t\t}\n\t\t\t\t// wait for all promises to complete\n\t\t\t\tPromise.all(promises).then(function() {\n\t\t\t\t\tupdateCurrentPassport();\n\t\t\t\t\tcheckCurrentDocument();\n\t\t\t\t\tadjustUIState();\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t}\n}\n\nfunction updateCurrentPassport() {\n\tif (!haveIdentity())\n\t\treturn;\n\tif (currentPassport) {\n\t\tw2ui['document-signing-bar'].get('current-passport').html = '<p>' + currentPassport.text + '</p>';\n\t}\n\tadjustUIState();\n}\n\nfunction adjustUIState() {\n\tif (w2ui['document-signing-bar'] === undefined)\n\t\treturn;\n\n\tif (library && identity) {\n\t\tw2ui['document-signing-bar'].show('passport');\n\t\tw2ui['document-signing-bar'].show('passport-break');\n\n\t\tif (currentPassport) {\n\t\t\tw2ui['document-signing-bar'].show('current-passport');\n\t\t\tw2ui['document-signing-bar'].show('sign-upload');\n\t\t\tw2ui['document-signing-bar'].show('sign-upload-break');\n\t\t}\n\t\telse {\n\t\t\tw2ui['document-signing-bar'].hide('current-passport');\n\t\t\tw2ui['document-signing-bar'].hide('sign-upload');\n\t\t\tw2ui['document-signing-bar'].hide('sign-upload-break');\n\t\t}\n\n\t\tw2ui['document-signing-bar'].show('identity');\n\t\tw2ui['document-signing-bar'].hide('login');\n\t}\n\telse {\n\t\tw2ui['document-signing-bar'].hide('passport');\n\t\tw2ui['document-signing-bar'].hide('current-passport');\n\t\tw2ui['document-signing-bar'].hide('passport-break');\n\t\tw2ui['document-signing-bar'].hide('sign-upload-break');\n\t\tw2ui['document-signing-bar'].hide('sign-upload');\n\n\t\tw2ui['document-signing-bar'].hide('identity');\n\t\tif (library)\n\t\t\tw2ui['document-signing-bar'].show('login');\n\t\telse\n\t\t\tw2ui['document-signing-bar'].hide('login');\n\t}\n\n\tw2ui['document-signing-bar'].get('current-document-status').html = '<p>' + currentDocumentSigningStatus + '</p>';\n\tw2ui['document-signing-bar'].refresh();\n}\n\nfunction vereignLoadIdentity(selectedIdentityKey, pincode) {\n\tlibrary.loadIdentity(selectedIdentityKey, pincode).then(function(result) {\n\t\tif (isSuccess(result)) {\n\t\t\tidentity = result.data;\n\t\t\tvereignLogin();\n\t\t}\n\t\telse {\n\t\t\tidentity = null;\n\t\t\tvereignPinCodeDialog(selectedIdentityKey);\n\t\t}\n\t});\n}\n\nfunction vereignPinCodeDialog(selectedIdentityKey) {\n\tvex.dialog.open({\n\t\tcontentClassName: 'vex-has-inputs',\n\t\tmessage: _('Please enter the PIN Code'),\n\t\tinput: '<input name=\"pincode\" type=\"password\" value=\"\" required />',\n\t\tcallback: function(data) {\n\t\t\tif (library && data.pincode != null && data.pincode != '') {\n\t\t\t\tvereignLoadIdentity(selectedIdentityKey, data.pincode);\n\t\t\t}\n\t\t}\n\t});\n}\n\nfunction vereignLogin() {\n\tif (library && identity) {\n\t\tlibrary.login(identity, 'previousaddeddevice').then(function(result) {\n\t\t\tif (isSuccess(result)) {\n\t\t\t\tupdatePassportList();\n\t\t\t\tupdateIndentity();\n\t\t\t\tadjustUIState();\n\t\t\t}\n\t\t\telse {\n\t\t\t\tvex.dialog.alert(_('Error at login.'));\n\t\t\t\twindow.app.console.log('Error at login of previousa added device');\n\t\t\t\twindow.app.console.log(result);\n\t\t\t\tidentity = null;\n\t\t\t}\n\t\t});\n\t}\n}\n\nfunction verignNewIdentity(newIdentity) {\n\tlibrary.login(newIdentity, 'newdevice', '', '').then(function(result) {\n\t\tif (isSuccess(result)) {\n\t\t\tvex.open({\n\t\t\t\tcontent: '<p>' + _('Please scan the code') + '</p><p><div id=\"image-container\"></div></p>',\n\t\t\t\tshowCloseButton: true,\n\t\t\t\tescapeButtonCloses: true,\n\t\t\t\toverlayClosesOnClick: true,\n\t\t\t\tbuttons: {},\n\t\t\t\tafterOpen: function() {\n\t\t\t\t\tvar $vexContent = $(this.contentEl);\n\t\t\t\t\tvar container = $vexContent.find('#image-container');\n\t\t\t\t\tvar image = $('<img style=\"display: block; margin-left: auto; margin-right: auto\"/>');\n\t\t\t\t\timage.attr('src', result.data.image);\n\t\t\t\t\tcontainer.append(image);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\telse {\n\t\t\tvex.dialog.alert(_('Couldn\\'t get the QR code image.'));\n\t\t\twindow.app.console.log('Error getting the QR code');\n\t\t\twindow.app.console.log(result);\n\t\t\tlibrary.clearIdentities();\n\t\t}\n\t});\n}\n\nfunction verignQrDialog() {\n\tif (library == null) {\n\t\treturn;\n\t}\n\tlibrary.createIdentity('00000000').then(function(result) {\n\t\tif (isSuccess(result)) {\n\t\t\tverignNewIdentity(result.data);\n\t\t}\n\t});\n}\n\nfunction vereignRecoverFromEmail(emailOrSMS) {\n\tlibrary.createIdentity('00000000').then(function(result) {\n\t\tif (!isSuccess(result)) {\n\t\t\treturn;\n\t\t}\n\t\tvar createdIdentity = result.data;\n\t\tlibrary.identityRestoreAccess(result.data, emailOrSMS).then(function(result) {\n\t\t\tif (!isSuccess(result)) {\n\t\t\t\tvex.dialog.alert(_('Error when trying to restore access to identity.'));\n\t\t\t\twindow.app.console.log('Error at IdentityRestoreAccess');\n\t\t\t\twindow.app.console.log(result);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tvex.dialog.open({\n\t\t\t\tmessage: _('PIN Code'),\n\t\t\t\tinput: '<p>' + _('Please enter the PIN code from the EMail or SMS') + '</p><input name=\"pincode\" type=\"password\" value=\"\" required />',\n\t\t\t\tcallback: function(data) {\n\t\t\t\t\tif (data.pincode) {\n\t\t\t\t\t\tlibrary.login(createdIdentity, 'sms', data.pincode, '').then(function(result) {\n\t\t\t\t\t\t\tif (isSuccess(result)) {\n\t\t\t\t\t\t\t\tvereignRestoreIdentity();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\t});\n}\n\nfunction vereignRecoverFromEmailDialog() {\n\tif (library == null) {\n\t\treturn;\n\t}\n\tvex.dialog.open({\n\t\tcontentClassName: 'vex-has-inputs',\n\t\tmessage: _('Login from email or mobile number'),\n\t\tinput: '<input name=\"emailOrMobileNumber\" type=\"text\" value=\"\" required />',\n\t\tcallback: function(data) {\n\t\t\tif (data.emailOrMobileNumber) {\n\t\t\t\tvereignRecoverFromEmail(data.emailOrMobileNumber);\n\t\t\t}\n\t\t}\n\t});\n}\n\nfunction vereignRestoreIdentity() {\n\tif (library == null) {\n\t\treturn;\n\t}\n\tlibrary.getCurrentlyAuthenticatedIdentity().then(function(result) {\n\t\tif (isSuccess(result)) {\n\t\t\tidentity = result.data;\n\t\t\tvex.closeAll();\n\t\t\tupdateIndentity();\n\t\t\tupdatePassportList();\n\t\t\tadjustUIState();\n\t\t}\n\t});\n}\n\nfunction vereignSignAndUploadDocument() {\n\tif (library == null) {\n\t\treturn;\n\t}\n\tif (currentPassport == null) {\n\t\treturn;\n\t}\n\tvex.dialog.open({\n\t\tcontentClassName: 'vex-has-inputs',\n\t\tmessage: _('Select document type to upload'),\n\t\tinput: _('Type:') + '<select name=\"selection\"><option value=\"ODT\">ODT</option><option value=\"DOCX\">DOCX</option><option value=\"PDF\">PDF</option></select>',\n\t\tcallback: function(data) {\n\t\t\tvereignSignAndUploadForType(data.selection);\n\t\t}\n\t});\n}\n\nfunction vereignUpload(documentType) {\n\tif (library == null || documentType == null) {\n\t\treturn;\n\t}\n\n\tvar filename = getCurrentDocumentFilename(documentType);\n\n\tlibrary.getPassports(filename).then(function(result) {\n\t\tif (!isSuccess(result)) {\n\t\t\treturn;\n\t\t}\n\t\tvar resultArray = result.data;\n\t\tfor (var i = 0; i < resultArray.length; i++) {\n\t\t\tif (currentPassport.uuid == resultArray[i].PassportUUID) {\n\t\t\t\tvar jsonRequest = {\n\t\t\t\t\tfilename: filename,\n\t\t\t\t\twopiUrl: getVereignWopiURL() + 'files',\n\t\t\t\t\ttoken: resultArray[i].AccessToken,\n\t\t\t\t\ttype: documentType\n\t\t\t\t};\n\t\t\t\tvar blob = new Blob(['uploadsigneddocument\\n', JSON.stringify(jsonRequest)]);\n\t\t\t\tapp.socket.sendMessage(blob);\n\t\t\t\t// Let the user know that we're done.\n\t\t\t\t_map.fire('infobar', {\n\t\t\t\t\tmsg: _('Document uploaded.') + '\\n\\n' + filename,\n\t\t\t\t\taction: null,\n\t\t\t\t\tactionLabel: null\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t});\n}\n\nfunction vereignExportSignAndUploadToVereign(documentType) {\n\tlibrary.getOneTimeCertificateByPassport(currentPassport.uuid).then(function(result) {\n\t\tif (!isSuccess(result)) {\n\t\t\treturn;\n\t\t}\n\t\tvar otp = result.data;\n\t\tvar filename = getCurrentDocumentFilename(documentType);\n\t\tlibrary.getPassports(filename).then(function(result) {\n\t\t\tif (!isSuccess(result)) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tvar resultArray = result.data;\n\t\t\tfor (var i = 0; i < resultArray.length; i++) {\n\t\t\t\tif (currentPassport.uuid == resultArray[i].PassportUUID) {\n\t\t\t\t\tvar parameters = {\n\t\t\t\t\t\tx509Certificate: otp.x509Certificate,\n\t\t\t\t\t\tprivateKey: otp.privateKey,\n\t\t\t\t\t\tchain: otp.chain,\n\t\t\t\t\t\tfilename: filename,\n\t\t\t\t\t\twopiUrl: getVereignWopiURL() + 'files',\n\t\t\t\t\t\ttoken: resultArray[i].AccessToken,\n\t\t\t\t\t\ttype: documentType\n\t\t\t\t\t};\n\t\t\t\t\tvar blob = new Blob(['exportsignanduploaddocument\\n', JSON.stringify(parameters)]);\n\t\t\t\t\tapp.socket.sendMessage(blob);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t});\n}\n\nfunction vereignSignAndUploadForType(uploadDocType) {\n\tvar documentType = null;\n\n\tswitch (uploadDocType) {\n\tcase 'ODT':\n\t\tdocumentType = 'odt';\n\t\tbreak;\n\tcase 'DOCX':\n\t\tdocumentType = 'docx';\n\t\tbreak;\n\tcase 'PDF':\n\t\tdocumentType = 'pdf';\n\t\tbreak;\n\t}\n\n\tif (documentType == null)\n\t\treturn;\n\n\tif (uploadDocType == 'PDF' || uploadDocType == 'DOCX' || uploadDocType == 'ODT') {\n\t\tvereignExportSignAndUploadToVereign(documentType);\n\t}\n\telse {\n\t\tlibrary.getOneTimeCertificateByPassport(currentPassport.uuid).then(function(result) {\n\t\t\tif (isSuccess(result)) {\n\t\t\t\tvar otp = result.data;\n\t\t\t\tvar blob = new Blob(['signdocument\\n', JSON.stringify(otp)]);\n\t\t\t\tapp.socket.sendMessage(blob);\n\t\t\t\tawaitForDocumentStatusToUpload = true;\n\t\t\t\tcurrentDocumentType = documentType;\n\t\t\t\tcheckCurrentDocument();\n\t\t\t}\n\t\t});\n\t}\n}\n\nL.Map.include({\n\tshowSignDocument: function() {\n\t\t$('#document-signing-bar').show();\n\t\tthis.initializeLibrary();\n\t\toldtoolbarSize = $(this.options.documentContainer).css('top');\n\n\t\t$(this.options.documentContainer).css('top', '116px');\n\n\t\t// Avoid scroll button \">>\"\n\t\tvar el = w2ui['document-signing-bar'];\n\t\tif (el)\n\t\t\tel.resize();\n\t},\n\thideSignToolbar: function() {\n\t\t$('#document-signing-bar').hide();\n\t\tlibrary = null;\n\t\tidentity = null;\n\t\tcurrentPassport = null;\n\t\t$(this.options.documentContainer).css('top', oldtoolbarSize);\n\t},\n\tsigningInitializeBar: function() {\n\t\t$('#document-signing-bar').hide();\n\t\tadjustUIState();\n\t},\n\tsigningLogout: function() {\n\t\tif (library) {\n\t\t\tlibrary.logout().then(function() {\n\t\t\t\tidentity = null;\n\t\t\t\tcurrentPassport = null;\n\t\t\t\tupdateIndentity();\n\t\t\t\tadjustUIState();\n\t\t\t});\n\t\t}\n\t},\n\tsigningLogin: function() {\n\t\tvar w = window.innerWidth / 2;\n\n\t\tvar loginWithQR = false;\n\t\tvar recoverFromEmail = false;\n\t\tvar selectedIdentityKey = null;\n\n\t\t$.get('signing-identities.html', function(data) {\n\t\t\tvex.open({\n\t\t\t\tcontent: data,\n\t\t\t\tshowCloseButton: true,\n\t\t\t\tescapeButtonCloses: true,\n\t\t\t\toverlayClosesOnClick: true,\n\t\t\t\tbuttons: {},\n\t\t\t\tafterOpen: function() {\n\t\t\t\t\tvar that = this;\n\t\t\t\t\tthis.contentEl.style.width = w + 'px';\n\t\t\t\t\tvar $vexContent = $(this.contentEl);\n\t\t\t\t\t$('#select-identity').text(_('Select identity:'));\n\t\t\t\t\t$('#login-qr').text(_('Login from mobile'));\n\t\t\t\t\t$('#recover-from-email').text(_('Recover from email'));\n\t\t\t\t\tlibrary.listIdentities().then(function(response) {\n\t\t\t\t\t\tvar identities = response.data;\n\t\t\t\t\t\tvar identitiesDiv = $vexContent.find('#identities');\n\t\t\t\t\t\tfor (var key in identities) {\n\t\t\t\t\t\t\tvar button = $('<input class=\"identity-button\" type=\"button\"/>');\n\t\t\t\t\t\t\tbutton.attr('value', identities[key].initials);\n\t\t\t\t\t\t\tbutton.css('background-color', identities[key].identityColor);\n\t\t\t\t\t\t\tbutton.click({ key: key }, function(current) {\n\t\t\t\t\t\t\t\tselectedIdentityKey = current.data.key;\n\t\t\t\t\t\t\t\tthat.close();\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\tidentitiesDiv.append(button);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\t$('#login-qr').click(function() {\n\t\t\t\t\t\tloginWithQR = true;\n\t\t\t\t\t\tthat.close();\n\t\t\t\t\t});\n\t\t\t\t\t$('#recover-from-email').click(function() {\n\t\t\t\t\t\trecoverFromEmail = true;\n\t\t\t\t\t\tthat.close();\n\t\t\t\t\t});\n\t\t\t\t},\n\t\t\t\tafterClose: function () {\n\t\t\t\t\tif (loginWithQR) {\n\t\t\t\t\t\tverignQrDialog();\n\t\t\t\t\t}\n\t\t\t\t\telse if (recoverFromEmail) {\n\t\t\t\t\t\tvereignRecoverFromEmailDialog();\n\t\t\t\t\t}\n\t\t\t\t\telse if (selectedIdentityKey) {\n\t\t\t\t\t\tvereignLoadIdentity(selectedIdentityKey, '00000000');\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\t},\n\tinitializeLibrary: function() {\n\t\tvar vereignURL = window.documentSigningURL == null ? '' : window.documentSigningURL;\n\t\tif (vereignURL.length == 0)\n\t\t\treturn;\n\t\t_map = this;\n\t\tsetupViamAPI(\n\t\t\t'signdocument-iframe-content',\n\t\t\t{\n\t\t\t\tonEvent: function(event) {\n\t\t\t\t\tswitch (event.type) {\n\t\t\t\t\tcase 'ActionConfirmedAndExecuted':\n\t\t\t\t\t\twindow.app.console.log('event ActionConfirmedAndExecuted');\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'IdentityNotLoaded':\n\t\t\t\t\t\tvereignLoadIdentity(event.payloads[0], '00000000');\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'Authenticated':\n\t\t\t\t\t\twindow.app.console.log('event Authenticated');\n\t\t\t\t\t\tvereignRestoreIdentity();\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'Logout':\n\t\t\t\t\t\twindow.app.console.log('event Logout');\n\t\t\t\t\t\t_map.signingLogout();\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'QRCodeUpdated':\n\t\t\t\t\t\twindow.app.console.log('event QRCodeUpdated');\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tdefault:\n\t\t\t\t\t\twindow.app.console.log('UNKNOWN EVENT: ' + event.type);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t\tgetVereignIFrameURL(),\n\t\t\tgetVereignApiURL(),\n\t\t\tgetVereignWopiURL()\n\t\t).then(function(lib) {\n\t\t\tlibrary = lib;\n\t\t\tadjustUIState();\n\t\t});\n\t},\n\tsetCurrentPassport: function(uuid, text) {\n\t\tif (library && identity && uuid) {\n\t\t\tcurrentPassport = { uuid: uuid, text: text };\n\t\t\tupdateCurrentPassport();\n\t\t\tlibrary.passportGetAvatarByPassport(uuid).then(function(result) {\n\t\t\t\twindow.app.console.log(result); // TODO\n\t\t\t});\n\t\t\tadjustUIState();\n\t\t}\n\t},\n\thandleSigningClickEvent: function(id, item) {\n\t\tif (id === 'close-document-signing-bar') {\n\t\t\tthis.signingLogout();\n\t\t\tthis.hideSignToolbar();\n\t\t}\n\t\telse if (id === 'login' || id === 'identity') {\n\t\t\tthis.signingLogin();\n\t\t}\n\t\telse if (id === 'sign-upload') {\n\t\t\tvereignSignAndUploadDocument();\n\t\t}\n\t\telse if (id.startsWith('passport:')) {\n\t\t\tthis.setCurrentPassport(item.value, item.text);\n\t\t}\n\t\treturn false;\n\t},\n\tsetupSigningToolbarItems: function() {\n\t\treturn [\n\t\t\t{type: 'html',  id: 'logo', html: '<a href=\"http://www.vereign.com\" target=\"_blank\"><img src=\"' + L.LOUtil.getImageURL('vereign.png') + '\" style=\"padding-right: 16px; padding-left: 6px; height: 32px\"/></a>' },\n\t\t\t{type: 'menu', id: 'passport', caption: _('Select passport'), items: []},\n\t\t\t{type: 'html', id: 'current-passport', html: _('Passport: N/A')},\n\t\t\t{type: 'break', id: 'passport-break' },\n\t\t\t{type: 'button',  id: 'sign-upload',  caption: _('Sign'), img: '', hint: _('Sign document')},\n\t\t\t{type: 'break', id: 'sign-upload-break' },\n\t\t\t{type: 'html', id: 'current-document-status-label', html: '<p><b>' + _('Status:') + '&nbsp;</b></p>'},\n\t\t\t{type: 'html', id: 'current-document-status', html: _('N/A')},\n\t\t\t{type: 'spacer'},\n\t\t\t{type: 'html', id: 'identity', html: ''},\n\t\t\t{type: 'button',  id: 'login',  caption: _('Login'), img: '', hint: _('Login')},\n\t\t\t{type: 'button',  id: 'close-document-signing-bar', img: 'closetoolbar', hint: _('Close')}];\n\t},\n\tonChangeSignStatus: function(signstatus) {\n\t\tvar statusText = '';\n\t\tvar statusIcon = '';\n\t\t// This is meant to be in sync with core.git\n\t\t// include/sfx2/signaturestate.hxx, SignatureState.\n\t\tswitch (signstatus) {\n\t\tcase '0':\n\t\t\tcurrentDocumentSigningStatus = _('Not Signed');\n\t\t\tbreak;\n\t\tcase '1':\n\t\t\tstatusText = _('This document is digitally signed and the signature is valid.');\n\t\t\tstatusIcon = 'sign_ok';\n\t\t\tcurrentDocumentSigningStatus = _('Signed and validated');\n\t\t\tbreak;\n\t\tcase '2':\n\t\t\tstatusText = _('This document has an invalid signature.');\n\t\t\tstatusIcon = 'sign_not_ok';\n\t\t\tcurrentDocumentSigningStatus = _('Signature broken');\n\t\t\tbreak;\n\t\tcase '3':\n\t\t\tstatusText = _('The signature was valid, but the document has been modified.');\n\t\t\tstatusIcon = 'sign_not_ok';\n\t\t\tcurrentDocumentSigningStatus = _('Signed but document modified');\n\t\t\tbreak;\n\t\tcase '4':\n\t\t\tstatusText = _('The signature is OK, but the certificate could not be validated.');\n\t\t\tstatusIcon = 'sign_not_ok';\n\t\t\tcurrentDocumentSigningStatus = _('Signed but not validated');\n\t\t\tbreak;\n\t\tcase '5':\n\t\t\tstatusText = _('The signature is OK, but the document is only partially signed.');\n\t\t\tstatusIcon = 'sign_not_ok';\n\t\t\tcurrentDocumentSigningStatus = _('Signed but not all files are signed');\n\t\t\tbreak;\n\t\tcase '6':\n\t\t\tstatusText = _('The signature is OK, but the certificate could not be validated and the document is only partially signed.');\n\t\t\tstatusIcon = 'sign_not_ok';\n\t\t\tcurrentDocumentSigningStatus = _('Signed but not validated and not all files are signed');\n\t\t\tbreak;\n\t\t}\n\n\t\tif (statusText) {\n\t\t\tif (!window.mode.isMobile())\n\t\t\t\tw2ui['actionbar'].insert('prev', {type: 'button',  id: 'signstatus', img: statusIcon, hint: statusText});\n\t\t\telse\n\t\t\t\tw2ui['actionbar'].insert('undo', {type: 'button',  id: 'signstatus', img: statusIcon, hint: statusText});\n\t\t}\n\n\t\tadjustUIState();\n\n\t\tif (awaitForDocumentStatusToUpload) {\n\t\t\tawaitForDocumentStatusToUpload = false;\n\t\t\tvereignUpload(currentDocumentType);\n\t\t}\n\t\tawaitForDocumentStatusToUpload = false;\n\t\tcurrentDocumentType = null;\n\t},\n\tonVereignUploadStatus: function(uploadStatus) {\n\t\tif (uploadStatus == 'OK') {\n\t\t\t_map.fire('infobar', {\n\t\t\t\tmsg: _('Document uploaded.'),\n\t\t\t\taction: null,\n\t\t\t\tactionLabel: null\n\t\t\t});\n\t\t}\n\t}\n});\n"]}