{"version":3,"file":"Toolbar.js","sourceRoot":"","sources":["../../../../../../../../browser/src/control/Toolbar.js"],"names":[],"mappings":"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","sourcesContent":["/* -*- js-indent-level: 8; fill-column: 100 -*- */\n/*\n * Toolbar handler\n */\n\n/* global app $ w2ui window vex sanitizeUrl brandProductName brandProductURL _ Hammer */\nL.Map.include({\n\n\t// a mapping of uno commands to more readable toolbar items\n\tunoToolbarCommands: [\n\t\t'.uno:StyleApply',\n\t\t'.uno:CharFontName'\n\t],\n\n\t_modalDialogOptions: {\n\t\toverlayClose:true,\n\t\topacity: 80,\n\t\toverlayCss: {\n\t\t\tbackgroundColor : '#000'\n\t\t},\n\t\tcontainerCss: {\n\t\t\toverflow : 'hidden',\n\t\t\tbackgroundColor : '#fff',\n\t\t\tpadding : '20px',\n\t\t\tborder : '2px solid #000'\n\t\t}\n\t},\n\n\tonFontSelect: function(e) {\n\t\tvar font = e.target.value;\n\t\tthis.applyFont(font);\n\t\tthis.focus();\n\t},\n\n\t_getCurrentFontName: function() {\n\t\treturn this['stateChangeHandler'].getItemValue('.uno:CharFontName');\n\t},\n\n\tcreateFontSelector: function(nodeSelector) {\n\t\tvar that = this;\n\n\t\tvar fontcombobox = $(nodeSelector);\n\t\tif (!fontcombobox.hasClass('select2')) {\n\t\t\tfontcombobox.select2({\n\t\t\t\tplaceholder: _('Font')\n\t\t\t});\n\t\t}\n\n\t\tvar createSelector = function() {\n\t\t\tvar commandValues = that.getToolbarCommandValues('.uno:CharFontName');\n\n\t\t\tvar data = []; // reset data in order to avoid that the font select box is populated with styles, too.\n\t\t\t// Old browsers like IE11 et al don't like Object.keys with\n\t\t\t// empty arguments\n\t\t\tif (typeof commandValues === 'object') {\n\t\t\t\tdata = data.concat(Object.keys(commandValues));\n\t\t\t}\n\t\t\tfontcombobox.empty();\n\t\t\tfor (var i = 0; i < data.length; ++i) {\n\t\t\t\tif (!data[i]) continue;\n\t\t\t\tvar option = document.createElement('option');\n\t\t\t\toption.text = data[i];\n\t\t\t\toption.value = data[i];\n\t\t\t\tfontcombobox.append(option);\n\t\t\t}\n\t\t\tfontcombobox.on('select2:select', that.onFontSelect.bind(that));\n\n\t\t\tfontcombobox.val(that._getCurrentFontName()).trigger('change');\n\t\t};\n\n\t\tcreateSelector();\n\n\t\tvar onCommandStateChanged = function(e) {\n\t\t\tvar commandName = e.commandName;\n\n\t\t\tif (commandName !== '.uno:CharFontName')\n\t\t\t\treturn;\n\n\t\t\tvar state = e.state;\n\t\t\tvar found = false;\n\t\t\tfontcombobox.children('option').each(function () {\n\t\t\t\tvar value = this.value;\n\t\t\t\tif (value.toLowerCase() === state.toLowerCase()) {\n\t\t\t\t\tfound = true;\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tif (!found && state) {\n\t\t\t\tfontcombobox\n\t\t\t\t\t.append($('<option></option>')\n\t\t\t\t\t\t.text(state));\n\t\t\t}\n\n\t\t\tfontcombobox.val(state).trigger('change');\n\t\t};\n\n\t\tvar onFontListChanged = function(e) {\n\t\t\tif (e.commandName === '.uno:CharFontName')\n\t\t\t\tcreateSelector();\n\t\t};\n\n\t\tthis.off('commandstatechanged', onCommandStateChanged);\n\t\tthis.on('commandstatechanged', onCommandStateChanged);\n\t\tthis.off('updatetoolbarcommandvalues', onFontListChanged);\n\t\tthis.on('updatetoolbarcommandvalues', onFontListChanged);\n\t},\n\n\tonFontSizeSelect: function(e) {\n\t\tthis.applyFontSize(e.target.value);\n\t\tthis.focus();\n\t},\n\n\tcreateFontSizeSelector: function(nodeSelector) {\n\t\tvar data = [6, 7, 8, 9, 10, 10.5, 11, 12, 13, 14, 15, 16, 18, 20,\n\t\t\t22, 24, 26, 28, 32, 36, 40, 44, 48, 54, 60, 66, 72, 80, 88, 96];\n\n\t\tvar fontsizecombobox = $(nodeSelector);\n\t\tif (!fontsizecombobox.hasClass('select2')) {\n\t\t\tfontsizecombobox.select2({\n\t\t\t\tdropdownAutoWidth: true,\n\t\t\t\twidth: 'auto',\n\t\t\t\tplaceholder: _('Font Size'),\n\t\t\t\t//Allow manually entered font size.\n\t\t\t\tcreateTag: function(query) {\n\t\t\t\t\treturn {\n\t\t\t\t\t\tid: query.term,\n\t\t\t\t\t\ttext: query.term,\n\t\t\t\t\t\ttag: true\n\t\t\t\t\t};\n\t\t\t\t},\n\t\t\t\ttags: true,\n\t\t\t\tsorter: function(data) { return data.sort(function(a, b) {\n\t\t\t\t\treturn parseFloat(a.text) - parseFloat(b.text);\n\t\t\t\t});}\n\t\t\t});\n\t\t}\n\n\t\tfontsizecombobox.empty();\n\t\tfor (var i = 0; i < data.length; ++i) {\n\t\t\tvar option = document.createElement('option');\n\t\t\toption.text = data[i];\n\t\t\toption.value = data[i];\n\t\t\tfontsizecombobox.append(option);\n\t\t}\n\t\tfontsizecombobox.off('select2:select', this.onFontSizeSelect.bind(this)).on('select2:select', this.onFontSizeSelect.bind(this));\n\n\t\tvar onCommandStateChanged = function(e) {\n\t\t\tvar commandName = e.commandName;\n\n\t\t\tif (commandName !== '.uno:FontHeight')\n\t\t\t\treturn;\n\n\t\t\tvar state = e.state;\n\t\t\tvar found = false;\n\n\t\t\tif (state === '0') {\n\t\t\t\tstate = '';\n\t\t\t}\n\n\t\t\tfontsizecombobox.children('option').each(function (i, e) {\n\t\t\t\tif ($(e).text() === state) {\n\t\t\t\t\tfound = true;\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tif (!found) {\n\t\t\t\t// we need to add the size\n\t\t\t\tfontsizecombobox\n\t\t\t\t\t.append($('<option>')\n\t\t\t\t\t\t.text(state).val(state));\n\t\t\t}\n\n\t\t\tfontsizecombobox.val(state).trigger('change');\n\t\t};\n\n\t\tthis.off('commandstatechanged', onCommandStateChanged);\n\t\tthis.on('commandstatechanged', onCommandStateChanged);\n\t},\n\n\tapplyFont: function (fontName) {\n\t\tif (!fontName)\n\t\t\treturn;\n\t\tif (this.isPermissionEdit()) {\n\t\t\tvar msg = 'uno .uno:CharFontName {' +\n\t\t\t\t'\"CharFontName.FamilyName\": ' +\n\t\t\t\t\t'{\"type\": \"string\", \"value\": \"' + fontName + '\"}}';\n\t\t\tapp.socket.sendMessage(msg);\n\t\t}\n\t},\n\n\tapplyFontSize: function (fontSize) {\n\t\tif (this.isPermissionEdit()) {\n\t\t\tvar msg = 'uno .uno:FontHeight {' +\n\t\t\t\t'\"FontHeight.Height\": ' +\n\t\t\t\t'{\"type\": \"float\", \"value\": \"' + fontSize + '\"}}';\n\t\t\tapp.socket.sendMessage(msg);\n\t\t}\n\t},\n\n\tgetToolbarCommandValues: function (command) {\n\t\tif (this._docLayer) {\n\t\t\treturn this._docLayer._toolbarCommandValues[command];\n\t\t}\n\n\t\treturn undefined;\n\t},\n\n\tdownloadAs: function (name, format, options, id) {\n\t\tif (this._fatal) {\n\t\t\treturn;\n\t\t}\n\n\t\tid = id || 'export'; // not any special download, simple export\n\n\t\tif ((id === 'print' && this['wopi'].DisablePrint) ||\n\t\t\t(id === 'export' && this['wopi'].DisableExport)) {\n\t\t\tthis.hideBusy();\n\t\t\treturn;\n\t\t}\n\n\t\tif (format === undefined || format === null) {\n\t\t\tformat = '';\n\t\t}\n\t\tif (options === undefined || options === null) {\n\t\t\toptions = '';\n\t\t}\n\n\t\tif (!window.ThisIsAMobileApp)\n\t\t\tthis.showBusy(_('Downloading...'), false);\n\t\tapp.socket.sendMessage('downloadas ' +\n\t\t\t'name=' + encodeURIComponent(name) + ' ' +\n\t\t\t'id=' + id + ' ' +\n\t\t\t'format=' + format + ' ' +\n\t\t\t'options=' + options);\n\t},\n\n\tprint: function () {\n\t\tif (window.ThisIsTheiOSApp || window.ThisIsTheAndroidApp) {\n\t\t\twindow.postMobileMessage('PRINT');\n\t\t} else {\n\t\t\tthis.showBusy(_('Downloading...'), false);\n\t\t\tthis.downloadAs('print.pdf', 'pdf', null, 'print');\n\t\t}\n\t},\n\n\tsaveAs: function (url, format, options) {\n\t\tif (url === undefined || url == null) {\n\t\t\treturn;\n\t\t}\n\t\tif (format === undefined || format === null) {\n\t\t\tformat = '';\n\t\t}\n\t\tif (options === undefined || options === null) {\n\t\t\toptions = '';\n\t\t}\n\n\t\tthis.showBusy(_('Saving...'), false);\n\t\tapp.socket.sendMessage('saveas ' +\n\t\t\t'url=wopi:' + encodeURIComponent(url) + ' ' +\n\t\t\t'format=' + format + ' ' +\n\t\t\t'options=' + options);\n\t},\n\n\trenameFile: function (filename) {\n\t\tif (!filename) {\n\t\t\treturn;\n\t\t}\n\t\tthis.showBusy(_('Renaming...'), false);\n\t\tapp.socket.sendMessage('renamefile filename=' + encodeURIComponent(filename));\n\t},\n\n\tapplyStyle: function (style, familyName) {\n\t\tif (!style || !familyName) {\n\t\t\tthis.fire('error', {cmd: 'setStyle', kind: 'incorrectparam'});\n\t\t\treturn;\n\t\t}\n\t\tif (this.isPermissionEdit()) {\n\t\t\tvar msg = 'uno .uno:StyleApply {' +\n\t\t\t\t\t'\"Style\":{\"type\":\"string\", \"value\": \"' + style + '\"},' +\n\t\t\t\t\t'\"FamilyName\":{\"type\":\"string\", \"value\":\"' + familyName + '\"}' +\n\t\t\t\t\t'}';\n\t\t\tapp.socket.sendMessage(msg);\n\t\t}\n\t},\n\n\tapplyLayout: function (layout) {\n\t\tif (!layout) {\n\t\t\tthis.fire('error', {cmd: 'setLayout', kind: 'incorrectparam'});\n\t\t\treturn;\n\t\t}\n\t\tif (this.isPermissionEdit()) {\n\t\t\tvar msg = 'uno .uno:AssignLayout {' +\n\t\t\t\t\t'\"WhatPage\":{\"type\":\"unsigned short\", \"value\": \"' + this.getCurrentPartNumber() + '\"},' +\n\t\t\t\t\t'\"WhatLayout\":{\"type\":\"unsigned short\", \"value\": \"' + layout + '\"}' +\n\t\t\t\t\t'}';\n\t\t\tapp.socket.sendMessage(msg);\n\t\t}\n\t},\n\n\tsave: function(dontTerminateEdit, dontSaveIfUnmodified, extendedData) {\n\t\tvar msg = 'save' +\n\t\t\t\t\t' dontTerminateEdit=' + (dontTerminateEdit ? 1 : 0) +\n\t\t\t\t\t' dontSaveIfUnmodified=' + (dontSaveIfUnmodified ? 1 : 0);\n\n\t\tif (extendedData !== undefined) {\n\t\t\tmsg += ' extendedData=' + extendedData;\n\t\t}\n\n\t\tapp.socket.sendMessage(msg);\n\t},\n\n\tmessageNeedsToBeRedirected: function(command) {\n\t\tif (command === '.uno:EditHyperlink') {\n\t\t\tvar that = this;\n\t\t\tsetTimeout(function () { that.showHyperlinkDialog(); }, 500);\n\t\t\treturn true;\n\t\t}\n\t\telse {\n\t\t\treturn false;\n\t\t}\n\t},\n\n\tsendUnoCommand: function (command, json) {\n\t\t// To exercise the Trace Event functionality, uncomment this\n\t\t// app.socket.emitInstantTraceEvent('cool-unocommand:' + command);\n\n\t\tvar isAllowedInReadOnly = false;\n\t\tvar allowedCommands = ['.uno:Save', '.uno:WordCountDialog', '.uno:EditAnnotation',\n\t\t\t'.uno:InsertAnnotation', '.uno:DeleteAnnotation', '.uno:Signature',\n\t\t\t'.uno:ShowResolvedAnnotations', '.uno:ToolbarMode?Mode:string=notebookbar_online.ui',\n\t\t\t'.uno:ToolbarMode?Mode:string=Default'];\n\n\t\tfor (var i in allowedCommands) {\n\t\t\tif (allowedCommands[i] === command) {\n\t\t\t\tisAllowedInReadOnly = true;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tif (command.startsWith('.uno:SpellOnline')) {\n\t\t\tvar map = this;\n\t\t\tvar val = map['stateChangeHandler'].getItemValue('.uno:SpellOnline');\n\n\t\t\t// proceed if the toggle button is pressed\n\t\t\tif (val && (json === undefined || json === null)) {\n\t\t\t\t // because it is toggle, state has to be the opposite\n\t\t\t\tvar state = !(val === 'true');\n\t\t\t\tif (window.isLocalStorageAllowed)\n\t\t\t\t\twindow.localStorage.setItem('SpellOnline', state);\n\t\t\t}\n\t\t}\n\n\t\tif (this.uiManager.isUIBlocked())\n\t\t\treturn;\n\t\tif (this.dialog.hasOpenedDialog())\n\t\t\tthis.dialog.blinkOpenDialog();\n\t\telse if (this.isPermissionEdit() || isAllowedInReadOnly) {\n\t\t\tif (!this.messageNeedsToBeRedirected(command))\n\t\t\t\tapp.socket.sendMessage('uno ' + command + (json ? ' ' + JSON.stringify(json) : ''));\n\t\t}\n\t},\n\n\ttoggleCommandState: function (unoState) {\n\t\tif (this.isPermissionEdit()) {\n\t\t\tif (!unoState.startsWith('.uno:')) {\n\t\t\t\tunoState = '.uno:' + unoState;\n\t\t\t}\n\t\t\tthis.sendUnoCommand(unoState);\n\t\t}\n\t},\n\n\tinsertFile: function (file) {\n\t\tthis.fire('insertfile', {file: file});\n\t},\n\n\tinsertURL: function (url) {\n\t\tthis.fire('inserturl', {url: url});\n\t},\n\n\tselectBackground: function (file) {\n\t\tthis.fire('selectbackground', {file: file});\n\t},\n\n\t_doVexOpenHelpFile: function(data, id, map) {\n\t\tvar productName;\n\t\tif (window.ThisIsAMobileApp) {\n\t\t\tproductName = window.MobileAppName;\n\t\t} else {\n\t\t\tproductName = (typeof brandProductName !== 'undefined') ? brandProductName : 'Collabora Online Development Edition';\n\t\t}\n\t\tvar w;\n\t\tvar iw = window.innerWidth;\n\t\tif (iw < 768) {\n\t\t\tw = iw - 30;\n\t\t}\n\t\telse if (iw > 1920) {\n\t\t\tw = 960;\n\t\t}\n\t\telse {\n\t\t\tw = iw / 5 + 590;\n\t\t}\n\t\tvex.open({\n\t\t\tunsafeContent: data,\n\t\t\tshowCloseButton: true,\n\t\t\tescapeButtonCloses: true,\n\t\t\toverlayClosesOnClick: false,\n\t\t\tcloseAllOnPopState: false,\n\t\t\tcontentClassName: 'vex-content vex-selectable',\n\t\t\tbuttons: {},\n\t\t\tafterOpen: function() {\n\t\t\t\tvar $vexContent = $(this.contentEl);\n\t\t\t\tthis.contentEl.style.width = w + 'px';\n\t\t\t\tvar i;\n\t\t\t\t// Display keyboard shortcut or online help\n\t\t\t\tif (id === 'keyboard-shortcuts') {\n\t\t\t\t\tdocument.getElementById('online-help').style.display='none';\n\t\t\t\t\t// Display help according to document opened\n\t\t\t\t\tif (map.getDocType() === 'text') {\n\t\t\t\t\t\tdocument.getElementById('text-shortcuts').style.display='block';\n\t\t\t\t\t}\n\t\t\t\t\telse if (map.getDocType() === 'spreadsheet') {\n\t\t\t\t\t\tdocument.getElementById('spreadsheet-shortcuts').style.display='block';\n\t\t\t\t\t}\n\t\t\t\t\telse if (map.getDocType() === 'presentation') {\n\t\t\t\t\t\tdocument.getElementById('presentation-shortcuts').style.display='block';\n\t\t\t\t\t}\n\t\t\t\t\telse if (map.getDocType() === 'drawing') {\n\t\t\t\t\t\tdocument.getElementById('drawing-shortcuts').style.display='block';\n\t\t\t\t\t}\n\t\t\t\t} else /* id === 'online-help' */ {\n\t\t\t\t\tdocument.getElementById('keyboard-shortcuts').style.display='none';\n\t\t\t\t\tif (window.socketProxy) {\n\t\t\t\t\t\tvar helpdiv = document.getElementById('online-help');\n\t\t\t\t\t\tvar imgList = helpdiv.querySelectorAll('img');\n\t\t\t\t\t\tfor (var p = 0; p < imgList.length; p++) {\n\t\t\t\t\t\t\tvar imgSrc = imgList[p].src;\n\t\t\t\t\t\t\timgSrc = imgSrc.substring(imgSrc.indexOf('/images'));\n\t\t\t\t\t\t\timgList[p].src = window.makeWsUrl('/browser/dist'+ imgSrc);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\t// Display help according to document opened\n\t\t\t\t\tif (map.getDocType() === 'text') {\n\t\t\t\t\t\tvar x = document.getElementsByClassName('text');\n\t\t\t\t\t\tfor (i = 0; i < x.length; i++) {\n\t\t\t\t\t\t\tx[i].style.display = 'block';\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\telse if (map.getDocType() === 'spreadsheet') {\n\t\t\t\t\t\tx = document.getElementsByClassName('spreadsheet');\n\t\t\t\t\t\tfor (i = 0; i < x.length; i++) {\n\t\t\t\t\t\t\tx[i].style.display = 'block';\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\telse if (map.getDocType() === 'presentation' || map.getDocType() === 'drawing') {\n\t\t\t\t\t\tx = document.getElementsByClassName('presentation');\n\t\t\t\t\t\tfor (i = 0; i < x.length; i++) {\n\t\t\t\t\t\t\tx[i].style.display = 'block';\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// Let's translate\n\t\t\t\tvar max;\n\t\t\t\tvar translatableContent = $vexContent.find('h1');\n\t\t\t\tfor (i = 0, max = translatableContent.length; i < max; i++) {\n\t\t\t\t\ttranslatableContent[i].innerHTML = translatableContent[i].innerHTML.toLocaleString();\n\t\t\t\t}\n\t\t\t\ttranslatableContent = $vexContent.find('h2');\n\t\t\t\tfor (i = 0, max = translatableContent.length; i < max; i++) {\n\t\t\t\t\ttranslatableContent[i].innerHTML = translatableContent[i].innerHTML.toLocaleString();\n\t\t\t\t}\n\t\t\t\ttranslatableContent = $vexContent.find('h3');\n\t\t\t\tfor (i = 0, max = translatableContent.length; i < max; i++) {\n\t\t\t\t\ttranslatableContent[i].innerHTML = translatableContent[i].innerHTML.toLocaleString();\n\t\t\t\t}\n\t\t\t\ttranslatableContent = $vexContent.find('h4');\n\t\t\t\tfor (i = 0, max = translatableContent.length; i < max; i++) {\n\t\t\t\t\ttranslatableContent[i].innerHTML = translatableContent[i].innerHTML.toLocaleString();\n\t\t\t\t}\n\t\t\t\ttranslatableContent = $vexContent.find('td');\n\t\t\t\tfor (i = 0, max = translatableContent.length; i < max; i++) {\n\t\t\t\t\tvar orig = translatableContent[i].innerHTML;\n\t\t\t\t\tvar trans = translatableContent[i].innerHTML.toLocaleString();\n\t\t\t\t\t// Try harder to get translation of keyboard shortcuts (html2po trims starting <kbd> and ending </kbd>)\n\t\t\t\t\tif (orig === trans && orig.indexOf('kbd') != -1) {\n\t\t\t\t\t\tvar trimmedOrig = orig.replace(/^(<kbd>)/,'').replace(/(<\\/kbd>$)/,'');\n\t\t\t\t\t\tvar trimmedTrans = trimmedOrig.toLocaleString();\n\t\t\t\t\t\tif (trimmedOrig !== trimmedTrans) {\n\t\t\t\t\t\t\ttrans = '<kbd>' + trimmedTrans + '</kbd>';\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\ttranslatableContent[i].innerHTML = trans;\n\t\t\t\t}\n\t\t\t\ttranslatableContent = $vexContent.find('p');\n\t\t\t\tfor (i = 0, max = translatableContent.length; i < max; i++) {\n\t\t\t\t\ttranslatableContent[i].innerHTML = translatableContent[i].innerHTML.toLocaleString();\n\t\t\t\t}\n\t\t\t\ttranslatableContent = $vexContent.find('button'); // TOC\n\t\t\t\tfor (i = 0, max = translatableContent.length; i < max; i++) {\n\t\t\t\t\ttranslatableContent[i].innerHTML = translatableContent[i].innerHTML.toLocaleString();\n\t\t\t\t}\n\n\t\t\t\t//translatable screenshots\n\t\t\t\tvar supportedLanguage = ['fr', 'it', 'de', 'es', 'pt-BR'];\n\t\t\t\tvar currentLanguage = String.locale;\n\t\t\t\tif (supportedLanguage.indexOf(currentLanguage) >= 0) {\n\t\t\t\t\ttranslatableContent = $($vexContent.find('.screenshot')).find('img');\n\t\t\t\t\tfor (i = 0, max = translatableContent.length; i < max; i++) {\n\t\t\t\t\t\ttranslatableContent[i].src = translatableContent[i].src.replace('/en/', '/'+currentLanguage+'/');\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// Substitute %productName in Online Help and replace special Mac key names\n\t\t\t\tif (id === 'online-help') {\n\t\t\t\t\tvar productNameContent = $vexContent.find('span.productname');\n\t\t\t\t\tfor (i = 0, max = productNameContent.length; i < max; i++) {\n\t\t\t\t\t\tproductNameContent[i].innerHTML = productNameContent[i].innerHTML.replace(/%productName/g, productName);\n\t\t\t\t\t}\n\t\t\t\t\tdocument.getElementById('online-help').innerHTML = L.Util.replaceCtrlAltInMac(document.getElementById('online-help').innerHTML);\n\t\t\t\t}\n\t\t\t\tif (id === 'keyboard-shortcuts') {\n\t\t\t\t\tdocument.getElementById('keyboard-shortcuts').innerHTML = L.Util.replaceCtrlAltInMac(document.getElementById('keyboard-shortcuts').innerHTML);\n\t\t\t\t}\n\n\t\t\t\t$vexContent.attr('tabindex', -1);\n\t\t\t\t$vexContent.focus();\n\t\t\t\t// workaround for https://github.com/HubSpot/vex/issues/43\n\t\t\t\t$('.vex-overlay').css({ 'pointer-events': 'none'});\n\t\t\t},\n\t\t\tbeforeClose: function () {\n\t\t\t\tmap.focus();\n\t\t\t}\n\t\t});\n\t},\n\n\tshowHelp: function(id) {\n\t\tvar map = this;\n\t\tif (window.ThisIsAMobileApp) {\n\t\t\tmap._doVexOpenHelpFile(window.HelpFile, id, map);\n\t\t\treturn;\n\t\t}\n\t\tvar helpLocation = 'cool-help.html';\n\t\tif (window.socketProxy)\n\t\t\thelpLocation = window.makeWsUrl('/browser/dist/' + helpLocation);\n\t\t$.get(helpLocation, function(data) {\n\t\t\tmap._doVexOpenHelpFile(data, id, map);\n\t\t});\n\t},\n\n\tshowLOAboutDialog: function() {\n\n\t\t// Just as a test to exercise the Async Trace Event functionality, uncomment this\n\t\t// line and the asyncTraceEvent.finish() below.\n\t\t// var asyncTraceEvent = app.socket.createAsyncTraceEvent('cool-showLOAboutDialog');\n\n\t\t// Move the div sitting in 'body' as vex-content and make it visible\n\t\tvar content = $('#about-dialog').clone().css({display: 'block'});\n\t\t// fill product-name and product-string\n\t\tvar productName;\n\t\tif (window.ThisIsAMobileApp) {\n\t\t\tproductName = window.MobileAppName;\n\t\t} else {\n\t\t\tproductName = (typeof brandProductName !== 'undefined') ? brandProductName : 'Collabora Online Development Edition';\n\t\t}\n\t\tvar productURL = (typeof brandProductURL !== 'undefined') ? brandProductURL : 'https://collaboraonline.github.io/';\n\t\tcontent.find('#product-name').text(productName).addClass('product-' + productName.split(/[ ()]+/).join('-').toLowerCase());\n\t\tvar productString = _('This version of %productName is powered by');\n\t\tvar productNameWithURL;\n\t\tif (!window.ThisIsAMobileApp)\n\t\t\tproductNameWithURL = '<a href=\"' + sanitizeUrl.sanitizeUrl(productURL) +\n\t\t\t\t\t\t\t\t '\" target=\"_blank\">' + productName + '</a>';\n\t\telse\n\t\t\tproductNameWithURL = productName;\n\t\tcontent.find('#product-string').html(productString.replace('%productName', productNameWithURL));\n\n\t\tif (window.socketProxy)\n\t\t\tcontent.find('#slow-proxy').text(_('\"Slow Proxy\"'));\n\n\t\tvar w;\n\t\tvar iw = window.innerWidth;\n\t\tif (iw < 768) {\n\t\t\tw = iw - 30;\n\t\t}\n\t\telse if (iw > 1920) {\n\t\t\tw = 960;\n\t\t}\n\t\telse {\n\t\t\tw = iw / 5 + 590;\n\t\t}\n\t\tvar map = this;\n\t\tvar handler = function(event) {\n\t\t\tif (event.key === 'd') {\n\t\t\t\tmap._docLayer.toggleTileDebugMode();\n\t\t\t} else if (event.key === 'l') {\n\t\t\t\t// L toggges the Online logging level between the default (whatever\n\t\t\t\t// is set in coolwsd.xml or on the coolwsd command line) and the\n\t\t\t\t// most verbose a client is allowed to set (which also can be set in\n\t\t\t\t// coolwsd.xml or on the coolwsd command line).\n\t\t\t\t//\n\t\t\t\t// In a typical developer \"make run\" setup, the default is \"trace\"\n\t\t\t\t// so there is nothing more verbose. But presumably it is different\n\t\t\t\t// in production setups.\n\n\t\t\t\tapp.socket.threadLocalLoggingLevelToggle = !app.socket.threadLocalLoggingLevelToggle;\n\n\t\t\t\tvar newLogLevel = (app.socket.threadLocalLoggingLevelToggle ? 'verbose' : 'default');\n\n\t\t\t\tapp.socket.sendMessage('loggingleveloverride ' + newLogLevel);\n\n\t\t\t\tvar logLevelInformation = newLogLevel;\n\t\t\t\tif (newLogLevel === 'default')\n\t\t\t\t\tlogLevelInformation = 'default (from coolwsd.xml)';\n\t\t\t\telse if (newLogLevel === 'verbose')\n\t\t\t\t\tlogLevelInformation = 'most verbose (from coolwsd.xml)';\n\t\t\t\telse if (newLogLevel === 'terse')\n\t\t\t\t\tlogLevelInformation = 'least verbose (from coolwsd.xml)';\n\t\t\t\telse\n\t\t\t\t\tlogLevelInformation = newLogLevel;\n\n\t\t\t\t$(app.ExpertlyTrickForLOAbout.contentEl).find('#log-level-state').html('Log level: ' + logLevelInformation);\n\t\t\t}\n\t\t};\n\t\tvex.open({\n\t\t\tunsafeContent: content[0].outerHTML,\n\t\t\tshowCloseButton: true,\n\t\t\tcloseClassName: 'vex-close-m',\n\t\t\tescapeButtonCloses: true,\n\t\t\toverlayClosesOnClick: true,\n\t\t\tbuttons: {},\n\t\t\tafterOpen: function() {\n\n\t\t\t\tvar touchGesture = map['touchGesture'];\n\t\t\t\tif (touchGesture && touchGesture._hammer) {\n\t\t\t\t\ttouchGesture._hammer.off('tripletap', L.bind(touchGesture._onTripleTap, touchGesture));\n\t\t\t\t}\n\n\t\t\t\tvar $vexContent = $(this.contentEl);\n\t\t\t\tvar hammer = new Hammer.Manager($vexContent.get(0));\n\t\t\t\thammer.add(new Hammer.Tap({ taps: 3 }));\n\t\t\t\thammer.on('tap', function() {\n\t\t\t\t\tmap._docLayer.toggleTileDebugMode();\n\t\t\t\t});\n\n\t\t\t\tthis.contentEl.style.width = w + 'px';\n\n\t\t\t\t// FIXME: When we remove vex this needs to be cleaned up.\n\n\t\t\t\t// It is hard to access the value of \"this\" in this afterOpen\n\t\t\t\t// function in the handler function. Use a global variable until\n\t\t\t\t// somebody figures out a better way.\n\t\t\t\tapp.ExpertlyTrickForLOAbout = this;\n\t\t\t\t$(window).bind('keyup.vex', handler);\n\t\t\t\t// workaround for https://github.com/HubSpot/vex/issues/43\n\t\t\t\t$('.vex-overlay').css({ 'pointer-events': 'none'});\n\t\t\t},\n\t\t\tbeforeClose: function () {\n\t\t\t\t$(window).unbind('keyup.vex', handler);\n\t\t\t\tvar touchGesture = map['touchGesture'];\n\t\t\t\tif (touchGesture && touchGesture._hammer) {\n\t\t\t\t\ttouchGesture._hammer.on('tripletap', L.bind(touchGesture._onTripleTap, touchGesture));\n\t\t\t\t}\n\t\t\t\tmap.focus();\n\n\t\t\t\t// Unset the global variable, see comment above.\n\t\t\t\tapp.ExpertlyTrickForLOAbout = undefined;\n\t\t\t\t// asyncTraceEvent.finish();\n\t\t\t}\n\t\t});\n\t},\n\n\textractContent: function(html) {\n\t\tvar parser = new DOMParser;\n\t\treturn parser.parseFromString(html, 'text/html').documentElement.getElementsByTagName('body')[0].textContent;\n\t},\n\n\tmakeURLFromStr: function(str) {\n\t\tif (!(str.toLowerCase().startsWith('http://') || str.toLowerCase().startsWith('https://'))) {\n\t\t\tstr = 'http://' + str;\n\t\t}\n\t\treturn str;\n\t},\n\n\tshowHyperlinkDialog: function() {\n\t\tvar map = this;\n\t\tvar text = '';\n\t\tvar link = '';\n\t\tif (this.hyperlinkUnderCursor && this.hyperlinkUnderCursor.text && this.hyperlinkUnderCursor.link) {\n\t\t\ttext = this.hyperlinkUnderCursor.text;\n\t\t\tlink = this.hyperlinkUnderCursor.link;\n\t\t} else if (this._clip && this._clip._selectionType == 'text') {\n\t\t\tif (map['stateChangeHandler'].getItemValue('.uno:Copy') === 'enabled') {\n\t\t\t\ttext = this.extractContent(this._clip._selectionContent);\n\t\t\t}\n\t\t} else if (this._docLayer._selectedTextContent) {\n\t\t\ttext = this.extractContent(this._docLayer._selectedTextContent);\n\t\t}\n\n\t\tvex.dialog.open({\n\t\t\tcontentClassName: 'hyperlink-dialog vex-has-inputs',\n\t\t\tmessage: _('Insert hyperlink'),\n\t\t\toverlayClosesOnClick: false,\n\t\t\tinput: [\n\t\t\t\t_('Text') + '<textarea name=\"text\" id=\"hyperlink-text-box\" style=\"resize: none\" type=\"text\"></textarea>',\n\t\t\t\t_('Link') + '<input name=\"link\" id=\"hyperlink-link-box\" type=\"text\" value=\"' + link + '\"/>'\n\t\t\t].join(''),\n\t\t\tbuttons: [\n\t\t\t\t$.extend({}, vex.dialog.buttons.NO, { text: _('Cancel') }),\n\t\t\t\t$.extend({}, vex.dialog.buttons.YES, { text: _('OK') })\n\t\t\t],\n\t\t\tcallback: function(data) {\n\t\t\t\tif (data && data.link != '') {\n\t\t\t\t\tvar command = {\n\t\t\t\t\t\t'Hyperlink.Text': {\n\t\t\t\t\t\t\ttype: 'string',\n\t\t\t\t\t\t\tvalue: data.text\n\t\t\t\t\t\t},\n\t\t\t\t\t\t'Hyperlink.URL': {\n\t\t\t\t\t\t\ttype: 'string',\n\t\t\t\t\t\t\tvalue: map.makeURLFromStr(data.link)\n\t\t\t\t\t\t}\n\t\t\t\t\t};\n\t\t\t\t\tmap.sendUnoCommand('.uno:SetHyperlink', command);\n\t\t\t\t\tmap.focus();\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tmap.focus();\n\t\t\t\t}\n\t\t\t},\n\t\t\tafterOpen: function() {\n\t\t\t\tsetTimeout(function() {\n\t\t\t\t\tvar textBox = document.getElementById('hyperlink-text-box');\n\t\t\t\t\ttextBox.textContent = text ? text.trim() : '';\n\t\t\t\t\tif (textBox.textContent.trim() !== '') {\n\t\t\t\t\t\tdocument.getElementById('hyperlink-link-box').focus();\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\ttextBox.focus();\n\t\t\t\t\t}\n\t\t\t\t}, 0);\n\t\t\t}\n\t\t});\n\t},\n\n\topenRevisionHistory: function () {\n\t\tvar map = this;\n\t\t// if we are being loaded inside an iframe, ask\n\t\t// our host to show revision history mode\n\t\tmap.fire('postMessage', {msgId: 'rev-history', args: {Deprecated: true}});\n\t\tmap.fire('postMessage', {msgId: 'UI_FileVersions'});\n\t},\n\topenShare: function () {\n\t\tvar map = this;\n\t\tmap.fire('postMessage', {msgId: 'UI_Share'});\n\t},\n\topenSaveAs: function () {\n\t\tvar map = this;\n\t\tmap.fire('postMessage', {msgId: 'UI_SaveAs'});\n\t},\n\n\t// map.dispatch() will be used to call some actions so we can share the code\n\tdispatch: function(action) {\n\t\tswitch (action) {\n\t\tcase 'acceptformula':\n\t\t\t{\n\t\t\t\t// focus on map, and press enter\n\t\t\t\tthis.focus();\n\t\t\t\tthis._docLayer.postKeyboardEvent('input',\n\t\t\t\t\tthis.keyboard.keyCodes.enter,\n\t\t\t\t\tthis.keyboard._toUNOKeyCode(this.keyboard.keyCodes.enter));\n\n\t\t\t\tif (window.mode.isMobile()) {\n\t\t\t\t\tw2ui['actionbar'].hide('acceptformula', 'cancelformula');\n\t\t\t\t\tw2ui['actionbar'].show('undo', 'redo');\n\t\t\t\t}\n\t\t\t}\n\t\t\tbreak;\n\t\tcase 'cancelformula':\n\t\t\t{\n\t\t\t\tthis.sendUnoCommand('.uno:Cancel');\n\t\t\t\tif (window.mode.isMobile()) {\n\t\t\t\t\tw2ui['actionbar'].hide('acceptformula', 'cancelformula');\n\t\t\t\t\tw2ui['actionbar'].show('undo', 'redo');\n\t\t\t\t}\n\t\t\t}\n\t\t\tbreak;\n\t\tcase 'functiondialog':\n\t\t\t{\n\t\t\t\tif (window.mode.isMobile() && this._functionWizardData) {\n\t\t\t\t\tthis._docLayer._closeMobileWizard();\n\t\t\t\t\tthis._docLayer._openMobileWizard(this._functionWizardData);\n\t\t\t\t} else {\n\t\t\t\t\tthis.sendUnoCommand('.uno:FunctionDialog');\n\t\t\t\t}\n\t\t\t}\n\t\t\tbreak;\n\t\t}\n\t},\n});\n"]}