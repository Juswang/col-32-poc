{"version":3,"file":"Control.LanguageDialog.js","sourceRoot":"","sources":["../../../../../../../../browser/src/control/Control.LanguageDialog.js"],"names":[],"mappings":"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","sourcesContent":["/* -*- js-indent-level: 8 -*- */\n/*\n * L.Control.LanguageDialog used for spellchecking language selection on mobile devices\n */\n\n/* global _ $ vex */\nL.Control.LanguageDialog = L.Control.extend({\n\n\t_languages: [],\n\n\tonAdd: function (map) {\n\t\tmap.on('commandvalues', this._onCommandValues, this);\n\t\tmap.on('languagedialog', this._onLanguageDialog, this);\n\t},\n\n\t_onCommandValues: function(e) {\n\t\tif (e.commandName === '.uno:LanguageStatus' && L.Util.isArray(e.commandValues)) {\n\t\t\tvar languages = [];\n\n\t\t\te.commandValues.forEach(function(language) {\n\t\t\t\tvar split = language.split(';');\n\t\t\t\tlanguage = split[0];\n\t\t\t\tvar isoCode = '';\n\t\t\t\tif (split.length > 1)\n\t\t\t\t\tisoCode = split[1];\n\t\t\t\tlanguages.push({translated: _(language), neutral: language, iso: isoCode});\n\t\t\t});\n\n\t\t\tlanguages.sort(function(a, b) {\n\t\t\t\treturn a.translated < b.translated ? -1 : a.translated > b.translated ? 1 : 0;\n\t\t\t});\n\n\t\t\tthis._languages = languages;\n\t\t}\n\t},\n\n\t_onItemSelected: function(e) {\n\t\tvar unoCommand = '.uno:LanguageStatus?Language:string=Default_' + e.data.language;\n\t\te.data.self._map.sendUnoCommand(unoCommand);\n\t\tvex.closeAll();\n\t},\n\n\t_getSelectedLanguageCode: function() {\n\t\tvar constState = 'stateChangeHandler';\n\t\tvar languageAndCode = this._map[constState].getItemValue('.uno:LanguageStatus');\n\t\tvar split = languageAndCode.split(';');\n\t\tvar code = '-';\n\t\tif (split.length > 1)\n\t\t\tcode = split[1];\n\t\telse\n\t\t\twindow.app.console.error('Language code not found');\n\t\treturn code;\n\t},\n\n\t_addItem: function(parent, language) {\n\t\tvar selectedLanguageCode = this._getSelectedLanguageCode();\n\t\tvar neutralLanguage = 'LANGUAGE_NONE';\n\t\tvar code = '';\n\n\t\tvar tr = L.DomUtil.create('tr', '', parent);\n\t\tvar td = L.DomUtil.create('td', '', tr);\n\t\tvar a = L.DomUtil.create('a', '', td);\n\n\t\tif (language) {\n\t\t\tneutralLanguage = language.neutral;\n\t\t\tcode = language.iso;\n\t\t\ta.innerHTML = language.iso;\n\t\t} else {\n\t\t\ta.innerHTML = _('None (Do not check spelling)');\n\t\t}\n\n\t\tif ((selectedLanguageCode != '-' && code.indexOf(selectedLanguageCode) !== -1)\n\t\t\t|| (selectedLanguageCode == '-' && !language)) {\n\t\t\t$(a).addClass('highlighted');\n\t\t} else {\n\t\t\t$(a).removeClass('highlighted');\n\t\t}\n\n\t\t$(tr).on('click', {self: this, language: encodeURIComponent(neutralLanguage)}, this._onItemSelected);\n\t},\n\n\t_onLanguageDialog: function() {\n\t\tvar dialog = vex.dialog.open({\n\t\t\tmessage: '',\n\t\t\tbuttons: [\n\t\t\t\t$.extend({}, vex.dialog.buttons.NO, { text: _('Cancel') })\n\t\t\t],\n\t\t});\n\n\t\tvar div = L.DomUtil.create('div', '');\n\t\tvar ul = L.DomUtil.create('table', 'lo-menu', div);\n\n\t\t// Add NONE\n\t\tthis._addItem(ul, null);\n\n\t\tfor (var lang in this._languages) {\n\t\t\tthis._addItem(ul, this._languages[lang]);\n\t\t}\n\n\t\tdialog.get(0).insertBefore(div, dialog.get(0).childNodes[0]);\n\t}\n});\n\nL.control.languageDialog = function (options) {\n\treturn new L.Control.LanguageDialog(options);\n};\n"]}