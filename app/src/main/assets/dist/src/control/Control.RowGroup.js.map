{"version":3,"file":"Control.RowGroup.js","sourceRoot":"","sources":["../../../../../../../../browser/src/control/Control.RowGroup.js"],"names":[],"mappings":"AAAA,gCAAgC;AAChC;;EAEE;AAEF,gBAAgB;AAEhB;;;;;;EAME;AAEF,CAAC,CAAC,OAAO,CAAC,QAAQ,GAAG,CAAC,CAAC,OAAO,CAAC,SAAS,CAAC,MAAM,CAAC;IAC/C,IAAI,EAAE,CAAC,CAAC,SAAS,CAAC,QAAQ,CAAC,IAAI;IAC/B,MAAM,EAAE,CAAC,CAAC,CAAC,CAAC,SAAS,CAAC,WAAW,CAAC,IAAI,EAAE,QAAQ,EAAE,KAAK,CAAC,EAAE,MAAM,CAAC;IACjE,QAAQ,EAAE,CAAC,CAAC,EAAE,CAAC,CAAC;IAChB,IAAI,EAAE,CAAC,CAAC,EAAE,CAAC,CAAC;IACZ,MAAM,EAAE,CAAC,KAAK,EAAE,QAAQ,CAAC;IACzB,eAAe,EAAE,CAAC,CAAC,SAAS,CAAC,QAAQ,CAAC,eAAe;IACrD,YAAY,EAAE,CAAC,CAAC,SAAS,CAAC,QAAQ,CAAC,YAAY;IAC/C,MAAM,EAAE,CAAC,CAAC,SAAS,CAAC,QAAQ,CAAC,MAAM;IACnC,YAAY,EAAE,IAAI;IAClB,iBAAiB,EAAE,EAAE;IAErB,oGAAoG;IACpG,YAAY,EAAE;QACb,IAAI,CAAC,IAAI,GAAG,CAAC,CAAC,GAAG,CAAC,IAAI,CAAC;QACvB,IAAI,CAAC,iBAAiB,CAAC,QAAQ,GAAG,IAAI,CAAC,IAAI,CAAC,SAAS,CAAC;QACtD,IAAI,CAAC,OAAO,GAAG,IAAI,CAAC;QAEpB,uBAAuB;QACvB,IAAI,CAAC,cAAc,GAAG,IAAI,CAAC,KAAK,CAAC,EAAE,GAAG,GAAG,CAAC,QAAQ,CAAC,CAAC;QACpD,IAAI,CAAC,aAAa,GAAG,GAAG,CAAC,eAAe,CAAC;QAEzC,IAAI,CAAC,IAAI,CAAC,EAAE,CAAC,sBAAsB,EAAE,IAAI,CAAC,MAAM,EAAE,IAAI,CAAC,CAAC;QACxD,IAAI,CAAC,IAAI,CAAC,EAAE,CAAC,sBAAsB,EAAE,IAAI,CAAC,MAAM,EAAE,IAAI,CAAC,CAAC;QACxD,IAAI,CAAC,WAAW,EAAE,CAAC;QACnB,IAAI,CAAC,MAAM,EAAE,CAAC;QACd,IAAI,CAAC,SAAS,GAAG,KAAK,CAAC;IACxB,CAAC;IAED,MAAM,EAAE;QACP,IAAI,IAAI,CAAC,SAAS,EAAE,gEAAgE;YACnF,OAAO;QAER,IAAI,CAAC,cAAc,GAAG,IAAI,CAAC,IAAI,CAAC,SAAS,CAAC,aAAa,CAAC;QACxD,IAAI,CAAC,OAAO,GAAG,KAAK,CAAC,IAAI,CAAC,cAAc,CAAC,iBAAiB,EAAE,CAAC,CAAC;QAE9D,8BAA8B;QAC9B,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,GAAG,IAAI,CAAC,oBAAoB,EAAE,CAAC;QAE3C,IAAI,CAAC,mBAAmB,GAAG,IAAI,CAAC,eAAe,CAAC,kBAAkB,CAAC,CAAC,CAAC,SAAS,CAAC,YAAY,CAAC,IAAI,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC;QAE1G,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC,IAAI,CAAC,SAAS,CAAC,kBAAkB,CAAC,WAAW,EAAE,CAAC;QAEtE,IAAI,CAAC,kBAAkB,CAAC,IAAI,CAAC,cAAc,CAAC,sBAAsB,EAAE,CAAC,CAAC;IACvE,CAAC;IAED,mDAAmD;IACnD,oBAAoB,EAAE;QACrB,OAAO,IAAI,CAAC,aAAa,GAAG,CAAC,IAAI,CAAC,cAAc,GAAG,IAAI,CAAC,aAAa,CAAC,GAAG,CAAC,IAAI,CAAC,OAAO,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC;IACpG,CAAC;IAED,YAAY,EAAE,UAAU,MAAM;QAC7B,IAAI,MAAM,IAAI,IAAI,CAAC,SAAS,CAAC,CAAC,EAAE;YAC/B,OAAO,MAAM,GAAG,IAAI,CAAC,eAAe,CAAC,CAAC,CAAC,GAAG,IAAI,CAAC,mBAAmB,CAAC;SACnE;aACI;YACJ,8DAA8D;YAC9D,OAAO,IAAI,CAAC,GAAG,CAAC,MAAM,GAAG,IAAI,CAAC,eAAe,CAAC,CAAC,CAAC,EAAE,IAAI,CAAC,SAAS,CAAC,CAAC,CAAC,GAAG,IAAI,CAAC,mBAAmB,CAAC;SAC/F;IACF,CAAC;IAED,gBAAgB,EAAE,UAAU,KAAK;QAChC,IAAI,MAAM,GAAG,IAAI,CAAC,aAAa,GAAG,CAAC,IAAI,CAAC,cAAc,GAAG,IAAI,CAAC,aAAa,CAAC,GAAG,KAAK,CAAC,KAAK,CAAC;QAC3F,IAAI,MAAM,GAAG,IAAI,CAAC,YAAY,CAAC,KAAK,CAAC,QAAQ,CAAC,CAAC;QAC/C,IAAI,IAAI,GAAG,KAAK,CAAC,MAAM,GAAG,IAAI,CAAC,mBAAmB,GAAG,IAAI,CAAC,eAAe,CAAC,CAAC,CAAC,CAAC;QAE7E,IAAI,MAAM,GAAG,IAAI,CAAC,mBAAmB,EAAE;YACtC,YAAY;YACZ,IAAI,CAAC,OAAO,CAAC,SAAS,GAAG,IAAI,CAAC,eAAe,CAAC;YAC9C,IAAI,CAAC,OAAO,CAAC,QAAQ,CAAC,IAAI,CAAC,cAAc,CAAC,MAAM,EAAE,IAAI,CAAC,cAAc,CAAC,EAAE,MAAM,EAAE,IAAI,CAAC,cAAc,EAAE,IAAI,CAAC,cAAc,CAAC,CAAC;YAC1H,IAAI,CAAC,OAAO,CAAC,WAAW,GAAG,OAAO,CAAC;YACnC,IAAI,CAAC,OAAO,CAAC,SAAS,GAAG,GAAG,CAAC,QAAQ,CAAC;YACtC,IAAI,CAAC,OAAO,CAAC,UAAU,CAAC,IAAI,CAAC,cAAc,CAAC,MAAM,GAAG,GAAG,EAAE,IAAI,CAAC,cAAc,CAAC,EAAE,MAAM,GAAG,GAAG,EAAE,IAAI,CAAC,cAAc,EAAE,IAAI,CAAC,cAAc,CAAC,CAAC;SACxI;QAED,IAAI,CAAC,KAAK,CAAC,MAAM,IAAI,IAAI,GAAG,MAAM,EAAE;YACnC,WAAW;YACX,MAAM,IAAI,IAAI,CAAC,cAAc,GAAG,GAAG,CAAC;YACpC,IAAI,CAAC,OAAO,CAAC,WAAW,GAAG,OAAO,CAAC;YACnC,IAAI,CAAC,OAAO,CAAC,SAAS,GAAG,GAAG,CAAC,QAAQ,CAAC;YACtC,IAAI,CAAC,OAAO,CAAC,SAAS,EAAE,CAAC;YACzB,IAAI,CAAC,OAAO,CAAC,MAAM,CAAC,IAAI,CAAC,UAAU,CAAC,MAAM,GAAG,GAAG,CAAC,EAAE,MAAM,GAAG,IAAI,CAAC,cAAc,GAAG,GAAG,CAAC,CAAC;YACvF,IAAI,CAAC,OAAO,CAAC,MAAM,CAAC,IAAI,CAAC,UAAU,CAAC,MAAM,GAAG,GAAG,CAAC,EAAE,IAAI,GAAG,GAAG,CAAC,eAAe,GAAG,GAAG,CAAC,CAAC;YACrF,IAAI,CAAC,OAAO,CAAC,MAAM,CAAC,IAAI,CAAC,UAAU,CAAC,MAAM,GAAG,IAAI,CAAC,cAAc,GAAG,CAAC,CAAC,EAAE,IAAI,GAAG,GAAG,CAAC,eAAe,GAAG,GAAG,CAAC,CAAC;YACzG,IAAI,CAAC,OAAO,CAAC,MAAM,EAAE,CAAC;YACtB,MAAM,IAAI,IAAI,CAAC,cAAc,GAAG,GAAG,CAAC;YACpC,IAAI,MAAM,GAAG,IAAI,CAAC,mBAAmB,EAAE;gBACtC,WAAW;gBACX,IAAI,CAAC,OAAO,CAAC,MAAM,CAAC,IAAI,CAAC,UAAU,CAAC,MAAM,GAAG,IAAI,CAAC,cAAc,GAAG,IAAI,CAAC,EAAE,MAAM,GAAG,IAAI,CAAC,cAAc,GAAG,CAAC,GAAG,GAAG,CAAC,CAAC;gBAClH,IAAI,CAAC,OAAO,CAAC,MAAM,CAAC,IAAI,CAAC,UAAU,CAAC,MAAM,GAAG,IAAI,CAAC,cAAc,GAAG,IAAI,GAAG,GAAG,CAAC,eAAe,CAAC,EAAE,MAAM,GAAG,IAAI,CAAC,cAAc,GAAG,CAAC,GAAG,GAAG,CAAC,CAAC;gBACxI,IAAI,CAAC,OAAO,CAAC,MAAM,EAAE,CAAC;aACtB;SACD;aACI,IAAI,MAAM,GAAG,IAAI,CAAC,mBAAmB,EAAE;YAC3C,WAAW;YACX,IAAI,CAAC,OAAO,CAAC,SAAS,EAAE,CAAC;YAEzB,IAAI,CAAC,OAAO,CAAC,MAAM,CAAC,IAAI,CAAC,UAAU,CAAC,MAAM,GAAG,IAAI,CAAC,cAAc,GAAG,IAAI,CAAC,EAAE,MAAM,GAAG,IAAI,CAAC,cAAc,GAAG,CAAC,GAAG,GAAG,CAAC,CAAC;YAClH,IAAI,CAAC,OAAO,CAAC,MAAM,CAAC,IAAI,CAAC,UAAU,CAAC,MAAM,GAAG,IAAI,CAAC,cAAc,GAAG,IAAI,GAAG,GAAG,CAAC,eAAe,CAAC,EAAE,MAAM,GAAG,IAAI,CAAC,cAAc,GAAG,CAAC,GAAG,GAAG,CAAC,CAAC;YAExI,IAAI,CAAC,OAAO,CAAC,MAAM,CAAC,IAAI,CAAC,UAAU,CAAC,MAAM,GAAG,IAAI,CAAC,cAAc,GAAG,IAAI,GAAG,GAAG,CAAC,EAAE,MAAM,GAAG,IAAI,CAAC,cAAc,GAAG,IAAI,CAAC,CAAC;YACrH,IAAI,CAAC,OAAO,CAAC,MAAM,CAAC,IAAI,CAAC,UAAU,CAAC,MAAM,GAAG,IAAI,CAAC,cAAc,GAAG,IAAI,GAAG,GAAG,CAAC,EAAE,MAAM,GAAG,IAAI,CAAC,cAAc,GAAG,IAAI,GAAG,GAAG,CAAC,eAAe,CAAC,CAAC;YAE3I,IAAI,CAAC,OAAO,CAAC,MAAM,EAAE,CAAC;SACtB;IACF,CAAC;IAED,eAAe,EAAE,UAAU,KAAK;QAC/B,IAAI,GAAG,GAAG,IAAI,CAAC,OAAO,CAAC;QACvB,IAAI,YAAY,GAAG,IAAI,CAAC,cAAc,CAAC;QACvC,IAAI,YAAY,GAAG,IAAI,CAAC,aAAa,CAAC;QAEtC,IAAI,MAAM,GAAG,YAAY,GAAG,CAAC,YAAY,GAAG,YAAY,CAAC,GAAG,KAAK,CAAC;QAClE,IAAI,MAAM,GAAG,IAAI,CAAC,KAAK,CAAC,CAAC,IAAI,CAAC,mBAAmB,GAAG,YAAY,CAAC,GAAG,GAAG,CAAC,CAAC;QAEzE,GAAG,CAAC,WAAW,GAAG,OAAO,CAAC;QAC1B,GAAG,CAAC,SAAS,GAAG,GAAG,CAAC,QAAQ,CAAC;QAC7B,GAAG,CAAC,UAAU,CAAC,IAAI,CAAC,cAAc,CAAC,MAAM,GAAG,GAAG,EAAE,YAAY,CAAC,EAAE,MAAM,GAAG,GAAG,EAAE,YAAY,EAAE,YAAY,CAAC,CAAC;QAC1G,oBAAoB;QACpB,GAAG,CAAC,SAAS,GAAG,IAAI,CAAC,UAAU,CAAC;QAChC,GAAG,CAAC,IAAI,GAAG,IAAI,CAAC,QAAQ,EAAE,CAAC;QAC3B,GAAG,CAAC,SAAS,GAAG,QAAQ,CAAC;QACzB,GAAG,CAAC,YAAY,GAAG,QAAQ,CAAC;QAC5B,GAAG,CAAC,QAAQ,CAAC,KAAK,GAAG,CAAC,EAAE,IAAI,CAAC,UAAU,CAAC,MAAM,GAAG,CAAC,YAAY,GAAG,CAAC,CAAC,CAAC,EAAE,MAAM,GAAG,CAAC,YAAY,GAAG,CAAC,CAAC,GAAG,CAAC,GAAG,GAAG,CAAC,QAAQ,CAAC,CAAC;IACvH,CAAC;IAED,2BAA2B;IAC3B,mBAAmB,EAAE,UAAU,KAAK;QACnC,IAAI,KAAK,GAAG,KAAK,CAAC,MAAM,CAAC,CAAC,CAAC,SAAS,CAAC,CAAC,CAAC,QAAQ,CAAC,CAAC,gCAAgC;QACjF,IAAI,OAAO,GAAG,uBAAuB,GAAG,SAAS,GAAG,KAAK,CAAC,KAAK,GAAG,SAAS,GAAG,KAAK,CAAC,KAAK,GAAG,SAAS,GAAG,KAAK,CAAC;QAC9G,GAAG,CAAC,MAAM,CAAC,WAAW,CAAC,OAAO,CAAC,CAAC;IACjC,CAAC;IAED,qGAAqG;IACrG,2FAA2F;IAC3F,gBAAgB,EAAE,UAAU,KAAK;QAChC,IAAI,KAAK,CAAC,CAAC,CAAC,GAAG,IAAI,CAAC,mBAAmB,EAAE;YACxC,IAAI,KAAK,GAAG,CAAC,IAAI,CAAC,UAAU,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,GAAG,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,GAAG,GAAG,CAAC,CAAC,cAAc;YAC5E,IAAI,eAAe,GAAG,CAAC,CAAC,GAAG,CAAC,IAAI,CAAC,OAAO,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC,GAAG,GAAG,CAAC,CAAC,sDAAsD;YACnH,KAAK,GAAG,IAAI,CAAC,KAAK,CAAC,KAAK,GAAG,eAAe,CAAC,CAAC;YAC5C,OAAO,KAAK,CAAC;SACb;aACI;YACJ,OAAO,CAAC,CAAC,CAAC;SACV;IACF,CAAC;IAED,gBAAgB,EAAE,UAAU,KAAK;QAChC,IAAI,OAAO,GAAG,IAAI,CAAC,SAAS,EAAE,CAAC;QAC/B,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,IAAI,CAAC,OAAO,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;YAC7C,IAAI,IAAI,CAAC,OAAO,CAAC,CAAC,CAAC,EAAE;gBACpB,KAAK,IAAI,KAAK,IAAI,IAAI,CAAC,OAAO,CAAC,CAAC,CAAC,EAAE;oBAClC,IAAI,MAAM,CAAC,SAAS,CAAC,cAAc,CAAC,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC,CAAC,EAAE,KAAK,CAAC,EAAE;wBACjE,IAAI,MAAM,GAAG,IAAI,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC;wBACpC,IAAI,MAAM,GAAG,IAAI,CAAC,aAAa,GAAG,CAAC,IAAI,CAAC,cAAc,GAAG,IAAI,CAAC,aAAa,CAAC,GAAG,MAAM,CAAC,KAAK,CAAC;wBAC5F,IAAI,MAAM,GAAG,IAAI,CAAC,YAAY,CAAC,MAAM,CAAC,QAAQ,CAAC,CAAC;wBAChD,IAAI,IAAI,GAAG,MAAM,GAAG,IAAI,CAAC,cAAc,CAAC;wBACxC,IAAI,IAAI,GAAG,MAAM,GAAG,IAAI,CAAC,cAAc,CAAC;wBACxC,IAAI,IAAI,CAAC,aAAa,CAAC,KAAK,EAAE,MAAM,EAAE,MAAM,EAAE,IAAI,EAAE,IAAI,EAAE,OAAO,CAAC,EAAE;4BACnE,OAAO,MAAM,CAAC;yBACd;qBACD;iBACD;aACD;SACD;QACD,OAAO,IAAI,CAAC;IACb,CAAC;IAED,yCAAyC;IACzC,cAAc,EAAE,UAAU,KAAK;QAC9B,IAAI,OAAO,GAAG,IAAI,CAAC,SAAS,EAAE,CAAC;QAC/B,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,IAAI,CAAC,OAAO,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;YAC7C,IAAI,IAAI,CAAC,OAAO,CAAC,CAAC,CAAC,EAAE;gBACpB,KAAK,IAAI,KAAK,IAAI,IAAI,CAAC,OAAO,CAAC,CAAC,CAAC,EAAE;oBAClC,IAAI,MAAM,CAAC,SAAS,CAAC,cAAc,CAAC,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC,CAAC,EAAE,KAAK,CAAC,EAAE;wBACjE,IAAI,MAAM,GAAG,IAAI,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC;wBACpC,IAAI,MAAM,GAAG,IAAI,CAAC,aAAa,GAAG,CAAC,IAAI,CAAC,cAAc,GAAG,IAAI,CAAC,aAAa,CAAC,GAAG,MAAM,CAAC,KAAK,CAAC;wBAC5F,IAAI,MAAM,GAAG,IAAI,CAAC,YAAY,CAAC,MAAM,CAAC,QAAQ,CAAC,CAAC;wBAChD,IAAI,IAAI,GAAG,MAAM,GAAG,IAAI,CAAC,cAAc,CAAC,CAAC,8EAA8E;wBACvH,IAAI,IAAI,GAAG,MAAM,CAAC,MAAM,GAAG,IAAI,CAAC,mBAAmB,GAAG,IAAI,CAAC,eAAe,CAAC,CAAC,CAAC,CAAC;wBAE9E,IAAI,IAAI,CAAC,aAAa,CAAC,KAAK,EAAE,MAAM,EAAE,MAAM,EAAE,IAAI,EAAE,IAAI,EAAE,OAAO,CAAC,EAAE;4BACnE,OAAO,MAAM,CAAC;yBACd;qBACD;iBACD;aACD;SACD;IACF,CAAC;IAED,QAAQ,EAAE;QACT,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC;QACtB,IAAI,CAAC,eAAe,CAAC,kBAAkB,CAAC,CAAC,CAAC,SAAS,CAAC,SAAS,CAAC,IAAI,CAAC,CAAC,QAAQ,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC;QACpF,IAAI,CAAC,eAAe,CAAC,kBAAkB,CAAC,CAAC,CAAC,SAAS,CAAC,YAAY,CAAC,IAAI,CAAC,CAAC,QAAQ,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC;IACxF,CAAC;CACD,CAAC,CAAC;AAEH,CAAC,CAAC,OAAO,CAAC,QAAQ,GAAG,UAAU,OAAO;IACrC,OAAO,IAAI,CAAC,CAAC,OAAO,CAAC,QAAQ,CAAC,OAAO,CAAC,CAAC;AACxC,CAAC,CAAC","sourcesContent":["/* -*- js-indent-level: 8 -*- */\n/*\n * L.Control.RowGroup\n*/\n\n/* global app */\n\n/*\n\tThis file is Calc only. This adds a section for grouped rows in Calc.\n\tWhen user selects some rows and groups them using \"Data->Group and Outline->Group\" menu path, this section is added into\n\tsections list of CanvasSectionContainer. See _addRemoveGroupSections in file CalcTileLayer.js\n\n\tThis class is an extended version of \"CanvasSectionObject\".\n*/\n\nL.Control.RowGroup = L.Control.GroupBase.extend({\n\tname: L.CSections.RowGroup.name,\n\tanchor: [[L.CSections.CornerGroup.name, 'bottom', 'top'], 'left'],\n\tposition: [0, 0], // This section's myTopLeft is placed according to corner group section if exists, if not, this is placed at (0, 0).\n\tsize: [0, 0], // No initial height is necessary. Height will be expanded. Width is computed inside update function.\n\texpand: ['top', 'bottom'], // Expand vertically.\n\tprocessingOrder: L.CSections.RowGroup.processingOrder,\n\tdrawingOrder: L.CSections.RowGroup.drawingOrder,\n\tzIndex: L.CSections.RowGroup.zIndex,\n\tinteractable: true,\n\tsectionProperties: {},\n\n\t// This function is called by CanvasSectionContainer when the section is added to the sections list.\n\tonInitialize: function () {\n\t\tthis._map = L.Map.THIS;\n\t\tthis.sectionProperties.docLayer = this._map._docLayer;\n\t\tthis._groups = null;\n\n\t\t// group control styles\n\t\tthis._groupHeadSize = Math.round(12 * app.dpiScale);\n\t\tthis._levelSpacing = app.roundedDpiScale;\n\n\t\tthis._map.on('sheetgeometrychanged', this.update, this);\n\t\tthis._map.on('viewrowcolumnheaders', this.update, this);\n\t\tthis._createFont();\n\t\tthis.update();\n\t\tthis.isRemoved = false;\n\t},\n\n\tupdate: function () {\n\t\tif (this.isRemoved) // Prevent calling while deleting the section. It causes errors.\n\t\t\treturn;\n\n\t\tthis._sheetGeometry = this._map._docLayer.sheetGeometry;\n\t\tthis._groups = Array(this._sheetGeometry.getRowGroupLevels());\n\n\t\t// Calculate width on the fly.\n\t\tthis.size[0] = this._computeSectionWidth();\n\n\t\tthis._cornerHeaderHeight = this.containerObject.getSectionWithName(L.CSections.CornerHeader.name).size[1];\n\n\t\tthis._splitPos = this._map._docLayer._splitPanesContext.getSplitPos();\n\n\t\tthis._collectGroupsData(this._sheetGeometry.getRowGroupsDataInView());\n\t},\n\n\t// This returns the required width for the section.\n\t_computeSectionWidth: function () {\n\t\treturn this._levelSpacing + (this._groupHeadSize + this._levelSpacing) * (this._groups.length + 1);\n\t},\n\n\tgetRelativeY: function (docPos) {\n\t\tif (docPos <= this._splitPos.y) {\n\t\t\treturn docPos - this.documentTopLeft[1] + this._cornerHeaderHeight;\n\t\t}\n\t\telse {\n\t\t\t// max here is to prevent encroachment of the fixed pane-area.\n\t\t\treturn Math.max(docPos - this.documentTopLeft[1], this._splitPos.y) + this._cornerHeaderHeight;\n\t\t}\n\t},\n\n\tdrawGroupControl: function (group) {\n\t\tvar startX = this._levelSpacing + (this._groupHeadSize + this._levelSpacing) * group.level;\n\t\tvar startY = this.getRelativeY(group.startPos);\n\t\tvar endY = group.endPos + this._cornerHeaderHeight - this.documentTopLeft[1];\n\n\t\tif (startY > this._cornerHeaderHeight) {\n\t\t\t// draw head\n\t\t\tthis.context.fillStyle = this.backgroundColor;\n\t\t\tthis.context.fillRect(this.transformRectX(startX, this._groupHeadSize), startY, this._groupHeadSize, this._groupHeadSize);\n\t\t\tthis.context.strokeStyle = 'black';\n\t\t\tthis.context.lineWidth = app.dpiScale;\n\t\t\tthis.context.strokeRect(this.transformRectX(startX + 0.5, this._groupHeadSize), startY + 0.5, this._groupHeadSize, this._groupHeadSize);\n\t\t}\n\n\t\tif (!group.hidden && endY > startY) {\n\t\t\t//draw tail\n\t\t\tstartX += this._groupHeadSize * 0.5;\n\t\t\tthis.context.strokeStyle = 'black';\n\t\t\tthis.context.lineWidth = app.dpiScale;\n\t\t\tthis.context.beginPath();\n\t\t\tthis.context.moveTo(this.transformX(startX + 0.5), startY + this._groupHeadSize + 0.5);\n\t\t\tthis.context.lineTo(this.transformX(startX + 0.5), endY - app.roundedDpiScale + 0.5);\n\t\t\tthis.context.lineTo(this.transformX(startX + this._groupHeadSize / 2), endY - app.roundedDpiScale + 0.5);\n\t\t\tthis.context.stroke();\n\t\t\tstartX -= this._groupHeadSize * 0.5;\n\t\t\tif (startY > this._cornerHeaderHeight) {\n\t\t\t\t// draw '-'\n\t\t\t\tthis.context.moveTo(this.transformX(startX + this._groupHeadSize * 0.25), startY + this._groupHeadSize / 2 + 0.5);\n\t\t\t\tthis.context.lineTo(this.transformX(startX + this._groupHeadSize * 0.75 + app.roundedDpiScale), startY + this._groupHeadSize / 2 + 0.5);\n\t\t\t\tthis.context.stroke();\n\t\t\t}\n\t\t}\n\t\telse if (startY > this._cornerHeaderHeight) {\n\t\t\t// draw '+'\n\t\t\tthis.context.beginPath();\n\n\t\t\tthis.context.moveTo(this.transformX(startX + this._groupHeadSize * 0.25), startY + this._groupHeadSize / 2 + 0.5);\n\t\t\tthis.context.lineTo(this.transformX(startX + this._groupHeadSize * 0.75 + app.roundedDpiScale), startY + this._groupHeadSize / 2 + 0.5);\n\n\t\t\tthis.context.moveTo(this.transformX(startX + this._groupHeadSize * 0.50 + 0.5), startY + this._groupHeadSize * 0.25);\n\t\t\tthis.context.lineTo(this.transformX(startX + this._groupHeadSize * 0.50 + 0.5), startY + this._groupHeadSize * 0.75 + app.roundedDpiScale);\n\n\t\t\tthis.context.stroke();\n\t\t}\n\t},\n\n\tdrawLevelHeader: function (level) {\n\t\tvar ctx = this.context;\n\t\tvar ctrlHeadSize = this._groupHeadSize;\n\t\tvar levelSpacing = this._levelSpacing;\n\n\t\tvar startX = levelSpacing + (ctrlHeadSize + levelSpacing) * level;\n\t\tvar startY = Math.round((this._cornerHeaderHeight - ctrlHeadSize) * 0.5);\n\n\t\tctx.strokeStyle = 'black';\n\t\tctx.lineWidth = app.dpiScale;\n\t\tctx.strokeRect(this.transformRectX(startX + 0.5, ctrlHeadSize), startY + 0.5, ctrlHeadSize, ctrlHeadSize);\n\t\t// draw level number\n\t\tctx.fillStyle = this._textColor;\n\t\tctx.font = this._getFont();\n\t\tctx.textAlign = 'center';\n\t\tctx.textBaseline = 'middle';\n\t\tctx.fillText(level + 1, this.transformX(startX + (ctrlHeadSize / 2)), startY + (ctrlHeadSize / 2) + 2 * app.dpiScale);\n\t},\n\n\t// Handle user interaction.\n\t_updateOutlineState: function (group) {\n\t\tvar state = group.hidden ? 'visible' : 'hidden'; // we have to send the new state\n\t\tvar payload = 'outlinestate type=row' + ' level=' + group.level + ' index=' + group.index + ' state=' + state;\n\t\tapp.socket.sendMessage(payload);\n\t},\n\n\t// When user clicks somewhere on the section, onMouseClick event is called by CanvasSectionContainer.\n\t// Clicked point is also given to handler function. This function finds the clicked header.\n\tfindClickedLevel: function (point) {\n\t\tif (point[1] < this._cornerHeaderHeight) {\n\t\t\tvar index = (this.transformX(point[0]) / this.size[0]) * 100; // Percentage.\n\t\t\tvar levelPercentage = (1 / (this._groups.length + 1)) * 100; // There is one more button than the number of levels.\n\t\t\tindex = Math.floor(index / levelPercentage);\n\t\t\treturn index;\n\t\t}\n\t\telse {\n\t\t\treturn -1;\n\t\t}\n\t},\n\n\tfindClickedGroup: function (point) {\n\t\tvar mirrorX = this.isCalcRTL();\n\t\tfor (var i = 0; i < this._groups.length; i++) {\n\t\t\tif (this._groups[i]) {\n\t\t\t\tfor (var group in this._groups[i]) {\n\t\t\t\t\tif (Object.prototype.hasOwnProperty.call(this._groups[i], group)) {\n\t\t\t\t\t\tvar group_ = this._groups[i][group];\n\t\t\t\t\t\tvar startX = this._levelSpacing + (this._groupHeadSize + this._levelSpacing) * group_.level;\n\t\t\t\t\t\tvar startY = this.getRelativeY(group_.startPos);\n\t\t\t\t\t\tvar endX = startX + this._groupHeadSize;\n\t\t\t\t\t\tvar endY = startY + this._groupHeadSize;\n\t\t\t\t\t\tif (this.isPointInRect(point, startX, startY, endX, endY, mirrorX)) {\n\t\t\t\t\t\t\treturn group_;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn null;\n\t},\n\n\t// Users can double click on group tails.\n\tfindTailsGroup: function (point) {\n\t\tvar mirrorX = this.isCalcRTL();\n\t\tfor (var i = 0; i < this._groups.length; i++) {\n\t\t\tif (this._groups[i]) {\n\t\t\t\tfor (var group in this._groups[i]) {\n\t\t\t\t\tif (Object.prototype.hasOwnProperty.call(this._groups[i], group)) {\n\t\t\t\t\t\tvar group_ = this._groups[i][group];\n\t\t\t\t\t\tvar startX = this._levelSpacing + (this._groupHeadSize + this._levelSpacing) * group_.level;\n\t\t\t\t\t\tvar startY = this.getRelativeY(group_.startPos);\n\t\t\t\t\t\tvar endX = startX + this._groupHeadSize; // Let's use this as thikcness. User doesn't have to double click on a pixel:)\n\t\t\t\t\t\tvar endY = group_.endPos + this._cornerHeaderHeight - this.documentTopLeft[1];\n\n\t\t\t\t\t\tif (this.isPointInRect(point, startX, startY, endX, endY, mirrorX)) {\n\t\t\t\t\t\t\treturn group_;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t},\n\n\tonRemove: function () {\n\t\tthis.isRemoved = true;\n\t\tthis.containerObject.getSectionWithName(L.CSections.RowHeader.name).position[0] = 0;\n\t\tthis.containerObject.getSectionWithName(L.CSections.CornerHeader.name).position[0] = 0;\n\t},\n});\n\nL.control.rowGroup = function (options) {\n\treturn new L.Control.RowGroup(options);\n};"]}