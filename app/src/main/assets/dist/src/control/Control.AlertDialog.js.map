{"version":3,"file":"Control.AlertDialog.js","sourceRoot":"","sources":["../../../../../../../../browser/src/control/Control.AlertDialog.js"],"names":[],"mappings":"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","sourcesContent":["/* -*- js-indent-level: 8 -*- */\n/*\n * L.Control.Dialog used for displaying alerts\n */\n\n/* global _ vex sanitizeUrl */\nL.Control.AlertDialog = L.Control.extend({\n\tonAdd: function (map) {\n\t\t// TODO: Better distinction between warnings and errors\n\t\tmap.on('error', this._onError, this);\n\t\tmap.on('warn', this._onError, this);\n\t},\n\n\t_onError: function(e) {\n\t\tif (!this._map._fatal) {\n\t\t\t// TODO. queue message errors and pop-up dialogs\n\t\t\t// Close other dialogs before presenting a new one.\n\t\t\tvex.closeAll();\n\t\t}\n\n\t\tif (e.msg) {\n\t\t\tif (window.ThisIsAMobileApp && this._map._fatal) {\n\t\t\t\tvar buttonsList = [];\n\t\t\t\tbuttonsList.push({\n\t\t\t\t\ttext: _('Close'),\n\t\t\t\t\ttype: 'button',\n\t\t\t\t\tclassName: 'vex-dialog-button-primary',\n\t\t\t\t\tclick: function() {\n\t\t\t\t\t\twindow.postMobileMessage('BYE');\n\t\t\t\t\t\tvex.closeAll();\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tvex.dialog.alert({\n\t\t\t\t\tmessage: e.msg,\n\t\t\t\t\tbuttons: buttonsList,\n\t\t\t\t\tcallback: function() {},\n\t\t\t\t});\n\t\t\t}\n\t\t\telse\n\t\t\t\tvex.dialog.alert(e.msg);\n\t\t}\n\t\telse if (e.cmd == 'load' && e.kind == 'docunloading') {\n\t\t\t// Handled by transparently retrying.\n\t\t\treturn;\n\t\t} else if (e.cmd == 'openlink') {\n\t\t\tvar url = e.url;\n\t\t\tvar messageText = window.errorMessages.leaving;\n\n\t\t\tvar isLinkValid = sanitizeUrl.sanitizeUrl(url) !== 'about:blank';\n\n\t\t\tif (!isLinkValid) {\n\t\t\t\tmessageText = window.errorMessages.invalidLink;\n\t\t\t}\n\n\t\t\tvar containerWithLink = document.createElement('div');\n\t\t\tcontainerWithLink.innerHTML = messageText;\n\t\t\tvar externalUrl = document.createElement('p');\n\t\t\texternalUrl.classList.add('vex-dialog-external-url');\n\t\t\texternalUrl.innerHTML = url;\n\t\t\tcontainerWithLink.appendChild(externalUrl);\n\t\t\tbuttonsList = [];\n\n\t\t\tif (isLinkValid) {\n\t\t\t\tbuttonsList.push({\n\t\t\t\t\ttext: _('Open link'),\n\t\t\t\t\ttype: 'button',\n\t\t\t\t\tclassName: 'vex-dialog-button-primary',\n\t\t\t\t\tclick: function() {\n\t\t\t\t\t\tif ('processCoolUrl' in window) {\n\t\t\t\t\t\t\turl = window.processCoolUrl({ url: url, type: 'doc' });\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\twindow.open(url, '_blank');\n\t\t\t\t\t\tvex.closeAll();\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tvex.dialog.open({\n\t\t\t\tunsafeMessage: containerWithLink.outerHTML,\n\t\t\t\tshowCloseButton: true,\n\t\t\t\tcontentClassName: 'word-wrap-for-vex-dialog',\n\t\t\t\tbuttons: buttonsList,\n\t\t\t\tcallback: function() {},\n\t\t\t\tafterClose: function () {\n\t\t\t\t\tvex.dialogID = -1;\n\t\t\t\t\te.map.focus();\n\t\t\t\t}\n\t\t\t});\n\t\t} else if (e.cmd && e.kind) {\n\t\t\tthis._map.fire('hidebusy');\n\n\t\t\tvar msg = _('The server encountered a %0 error while parsing the %1 command.');\n\t\t\tmsg = msg.replace('%0', e.kind);\n\t\t\tmsg = msg.replace('%1', e.cmd);\n\t\t\tvex.dialog.alert(msg);\n\t\t}\n\t}\n});\n\nL.control.alertDialog = function (options) {\n\treturn new L.Control.AlertDialog(options);\n};\n"]}