{"version":3,"file":"Control.ColumnHeader.js","sourceRoot":"","sources":["../../../../../../../../browser/src/control/Control.ColumnHeader.js"],"names":[],"mappings":"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","sourcesContent":["/* -*- js-indent-level: 8 -*- */\n/*\n* Control.ColumnHeader\n*/\n\n/* global _UNO app UNOModifier */\n\nL.Control.ColumnHeader = L.Control.Header.extend({\n\tname: L.CSections.ColumnHeader.name,\n\tanchor: [[L.CSections.ColumnGroup.name, 'bottom', 'top'], [L.CSections.CornerHeader.name, 'right', 'left']],\n\tposition: [0, 0], // This section's myTopLeft is placed according to corner header and column group sections.\n\tsize: [0, 19 * app.dpiScale], // No initial width is necessary.\n\texpand: ['right'], // Expand horizontally.\n\tprocessingOrder: L.CSections.ColumnHeader.processingOrder,\n\tdrawingOrder: L.CSections.ColumnHeader.drawingOrder,\n\tzIndex: L.CSections.ColumnHeader.zIndex,\n\tinteractable: true,\n\tsectionProperties: {},\n\n\toptions: {\n\t\tcursor: 'col-resize'\n\t},\n\n\tonInitialize: function () {\n\t\tthis._map = L.Map.THIS;\n\t\tthis._isColumn = true;\n\t\tthis._setConverter();\n\t\tthis._current = -1;\n\t\tthis._resizeHandleSize = 15 * app.dpiScale;\n\t\tthis._selection = {start: -1, end: -1};\n\t\tthis._mouseOverEntry = null;\n\t\tthis._lastMouseOverIndex = undefined;\n\t\tthis._hitResizeArea = false;\n\t\tthis.sectionProperties.docLayer = this._map._docLayer;\n\n\t\tthis._selectionBackgroundGradient = [ '#3465A4', '#729FCF', '#004586' ];\n\n\t\tthis._map.on('move zoomchanged sheetgeometrychanged splitposchanged', this._updateCanvas, this);\n\n\t\tthis._initHeaderEntryStyles('spreadsheet-header-column');\n\t\tthis._initHeaderEntryHoverStyles('spreadsheet-header-column-hover');\n\t\tthis._initHeaderEntrySelectedStyles('spreadsheet-header-column-selected');\n\t\tthis._initHeaderEntryResizeStyles('spreadsheet-header-column-resize');\n\n\t\tthis._menuItem = {\n\t\t\t'.uno:InsertColumnsBefore': {\n\t\t\t\tname: _UNO('.uno:InsertColumnsBefore', 'spreadsheet', true),\n\t\t\t\tcallback: (this._insertColBefore).bind(this)\n\t\t\t},\n\t\t\t'.uno:InsertColumnsAfter': {\n\t\t\t\tname: _UNO('.uno:InsertColumnsAfter', 'spreadsheet', true),\n\t\t\t\tcallback: (this._insertColAfter).bind(this)\n\t\t\t},\n\t\t\t'.uno:DeleteColumns': {\n\t\t\t\tname: _UNO('.uno:DeleteColumns', 'spreadsheet', true),\n\t\t\t\tcallback: (this._deleteSelectedCol).bind(this)\n\t\t\t},\n\t\t\t'.uno:ColumnWidth': {\n\t\t\t\tname: _UNO('.uno:ColumnWidth', 'spreadsheet', true),\n\t\t\t\tcallback: (this._columnWidth).bind(this)\n\t\t\t},\n\t\t\t'.uno:SetOptimalColumnWidth': {\n\t\t\t\tname: _UNO('.uno:SetOptimalColumnWidth', 'spreadsheet', true),\n\t\t\t\tcallback: (this._optimalWidth).bind(this)\n\t\t\t},\n\t\t\t'.uno:HideColumn': {\n\t\t\t\tname: _UNO('.uno:HideColumn', 'spreadsheet', true),\n\t\t\t\tcallback: (this._hideColumn).bind(this)\n\t\t\t},\n\t\t\t'.uno:ShowColumn': {\n\t\t\t\tname: _UNO('.uno:ShowColumn', 'spreadsheet', true),\n\t\t\t\tcallback: (this._showColumn).bind(this)\n\t\t\t}\n\t\t};\n\n\t\tthis._menuData = L.Control.JSDialogBuilder.getMenuStructureForMobileWizard(this._menuItem, true, '');\n\t\tthis._headerInfo = new L.Control.Header.HeaderInfo(this._map, true /* isCol */);\n\t},\n\n\tdrawHeaderEntry: function (entry) {\n\t\tif (!entry)\n\t\t\treturn;\n\n\t\tvar isRTL = this.isCalcRTL();\n\t\tvar content = this._colIndexToAlpha(entry.index + 1);\n\t\tvar startX = isRTL ? this.size[0] - entry.pos : entry.pos - entry.size;\n\n\t\tif (entry.size <= 0)\n\t\t\treturn;\n\n\t\tvar highlight = entry.isCurrent || entry.isHighlighted;\n\n\t\t// background gradient\n\t\tvar selectionBackgroundGradient = null;\n\t\tif (highlight) {\n\t\t\tselectionBackgroundGradient = this.context.createLinearGradient(startX, 0, startX, this.size[1]);\n\t\t\tselectionBackgroundGradient.addColorStop(0, this._selectionBackgroundGradient[0]);\n\t\t\tselectionBackgroundGradient.addColorStop(0.5, this._selectionBackgroundGradient[1]);\n\t\t\tselectionBackgroundGradient.addColorStop(1, this._selectionBackgroundGradient[2]);\n\t\t}\n\n\t\t// draw background\n\t\tthis.context.beginPath();\n\t\tthis.context.fillStyle = highlight ? selectionBackgroundGradient : entry.isOver ? this._hoverColor : this._backgroundColor;\n\t\tthis.context.fillRect(startX, 0, entry.size, this.size[1]);\n\n\t\t// draw resize handle\n\t\tvar handleSize = this._resizeHandleSize;\n\t\tif (entry.isCurrent && entry.size > 2 * handleSize && !this.inResize()) {\n\t\t\tvar center = isRTL ? startX + handleSize / 2 : startX + entry.size - handleSize / 2;\n\t\t\tvar y = 2 * app.dpiScale;\n\t\t\tvar h = this.size[1] - 4 * app.dpiScale;\n\t\t\tvar size = 2 * app.dpiScale;\n\t\t\tvar offset = 1 * app.dpiScale;\n\n\t\t\tthis.context.fillStyle = '#BBBBBB';\n\t\t\tthis.context.beginPath();\n\t\t\tthis.context.fillRect(center - size - offset, y + 2 * app.dpiScale, size, h - 4 * app.dpiScale);\n\t\t\tthis.context.beginPath();\n\t\t\tthis.context.fillRect(center + offset, y + 2 * app.dpiScale, size, h - 4 * app.dpiScale);\n\t\t}\n\n\t\t// draw text content\n\t\tthis.context.fillStyle = highlight ? this._selectionTextColor : this._textColor;\n\t\tthis.context.font = this.getFont();\n\t\tthis.context.textAlign = 'center';\n\t\tthis.context.textBaseline = 'middle';\n\t\t// The '+ 1' below is a hack - it's currently not possible to measure\n\t\t// the exact bounding box in html5's canvas, and the textBaseline\n\t\t// 'middle' measures everything including the descent etc.\n\t\t// '+ 1' looks visually fine, and seems safe enough\n\t\tthis.context.fillText(content,\n\t\t\tisRTL ? startX + (entry.size / 2) : entry.pos - (entry.size / 2),\n\t\t\t(this.size[1] / 2) + 1);\n\n\t\t// draw column borders.\n\t\tthis.context.strokeStyle = this._borderColor;\n\t\tthis.context.lineWidth = app.dpiScale;\n\t\tthis.context.strokeRect(startX - 0.5, 0.5, entry.size, this.size[1]);\n\t},\n\n\tgetHeaderEntryBoundingClientRect: function (index) {\n\t\tvar entry = this._mouseOverEntry;\n\t\tif (index) {\n\t\t\tentry = this._headerInfo.getColData(index);\n\t\t}\n\n\t\tif (!entry)\n\t\t\treturn;\n\n\t\tvar rect = this._canvas.getBoundingClientRect();\n\n\t\tvar colStart = (entry.pos - entry.size) / app.dpiScale;\n\t\tvar colEnd = entry.pos / app.dpiScale;\n\n\t\tvar isRTL = this.isCalcRTL();\n\n\t\tvar left = isRTL ? rect.right - colEnd : rect.left + colStart;\n\t\tvar right = isRTL ? rect.right - colStart : rect.left + colEnd;\n\t\tvar top = rect.top;\n\t\tvar bottom = rect.bottom;\n\t\treturn {left: left, right: right, top: top, bottom: bottom};\n\t},\n\n\tonDraw: function () {\n\t\tthis._headerInfo.forEachElement(function(elemData) {\n\t\t\tthis.drawHeaderEntry(elemData);\n\t\t}.bind(this));\n\n\t\tthis.drawResizeLineIfNeeded();\n\t},\n\n\tonClick: function (point, e) {\n\t\tif (!this._mouseOverEntry)\n\t\t\treturn;\n\n\t\tvar col = this._mouseOverEntry.index;\n\n\t\tvar modifier = 0;\n\t\tif (e.shiftKey) {\n\t\t\tmodifier += UNOModifier.SHIFT;\n\t\t}\n\t\tif (e.ctrlKey) {\n\t\t\tmodifier += UNOModifier.CTRL;\n\t\t}\n\n\t\tthis._selectColumn(col, modifier);\n\t},\n\n\t_onDialogResult: function (e) {\n\t\tif (e.type === 'submit' && !isNaN(e.value)) {\n\t\t\tvar extra = {\n\t\t\t\taExtraWidth: {\n\t\t\t\t\ttype: 'unsigned short',\n\t\t\t\t\tvalue: e.value\n\t\t\t\t}\n\t\t\t};\n\n\t\t\tthis._map.sendUnoCommand('.uno:SetOptimalColumnWidth', extra);\n\t\t}\n\t},\n\n\tonDragEnd: function (dragDistance) {\n\t\tif (dragDistance[0] === 0) {\n\t\t\treturn;\n\t\t}\n\t\telse {\n\t\t\tvar width = this._dragEntry.size;\n\t\t\tvar column = this._dragEntry.index;\n\n\t\t\tvar nextCol = this._headerInfo.getNextIndex(this._dragEntry.index);\n\t\t\tif (this._headerInfo.isZeroSize(nextCol)) {\n\t\t\t\tcolumn = nextCol;\n\t\t\t\twidth = 0;\n\t\t\t}\n\n\t\t\tvar isRTL = this.isCalcRTL();\n\n\t\t\tif (isRTL) {\n\t\t\t\twidth -= dragDistance[0];\n\t\t\t}\n\t\t\telse {\n\t\t\t\twidth += dragDistance[0];\n\t\t\t}\n\n\t\t\twidth /= app.dpiScale;\n\t\t\twidth = this._map._docLayer._pixelsToTwips({x: width, y: 0}).x;\n\n\t\t\tvar command = {\n\t\t\t\tColumnWidth: {\n\t\t\t\t\ttype: 'unsigned short',\n\t\t\t\t\tvalue: this._map._docLayer.twipsToHMM(Math.max(width, 0))\n\t\t\t\t},\n\t\t\t\tColumn: {\n\t\t\t\t\ttype: 'unsigned short',\n\t\t\t\t\tvalue: column + 1 // core expects 1-based index.\n\t\t\t\t}\n\t\t\t};\n\n\t\t\tthis._map.sendUnoCommand('.uno:ColumnWidth', command);\n\t\t\tthis._mouseOverEntry = null;\n\t\t}\n\t},\n\n\tsetOptimalWidthAuto: function () {\n\t\tif (this._mouseOverEntry) {\n\t\t\tvar column = this._mouseOverEntry.index;\n\t\t\tvar command = {\n\t\t\t\tColumn: {\n\t\t\t\t\ttype: 'long',\n\t\t\t\t\tvalue: column\n\t\t\t\t},\n\t\t\t\tModifier: {\n\t\t\t\t\ttype: 'unsigned short',\n\t\t\t\t\tvalue: 0\n\t\t\t\t}\n\t\t\t};\n\n\t\t\tvar extra = {\n\t\t\t\taExtraHeight: {\n\t\t\t\t\ttype: 'unsigned short',\n\t\t\t\t\tvalue: 0\n\t\t\t\t}\n\t\t\t};\n\n\t\t\tthis._map.sendUnoCommand('.uno:SelectColumn', command);\n\t\t\tthis._map.sendUnoCommand('.uno:SetOptimalColumnWidthDirect', extra);\n\t\t}\n\t},\n\n\t_getParallelPos: function (point) {\n\t\treturn point.x;\n\t},\n\n\t_getOrthogonalPos: function (point) {\n\t\treturn point.y;\n\t},\n\n\tonResize: function () {},\n\tonRemove: function () {},\n});\n\nL.control.columnHeader = function (options) {\n\treturn new L.Control.ColumnHeader(options);\n};\n"]}