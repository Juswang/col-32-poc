{"version":3,"file":"Events.js","sourceRoot":"","sources":["../../../../../../../../browser/src/core/Events.js"],"names":[],"mappings":"AAAA,gCAAgC;AAChC;;GAEG;AAEH,CAAC,CAAC,OAAO,GAAG,CAAC,CAAC,KAAK,CAAC,MAAM,CAAC;IAE1B,EAAE,EAAE,UAAU,KAAK,EAAE,EAAE,EAAE,OAAO;QAE/B,uCAAuC;QACvC,IAAI,OAAO,KAAK,KAAK,QAAQ,EAAE;YAC9B,KAAK,IAAI,IAAI,IAAI,KAAK,EAAE;gBACvB,gEAAgE;gBAChE,sDAAsD;gBACtD,IAAI,CAAC,GAAG,CAAC,IAAI,EAAE,KAAK,CAAC,IAAI,CAAC,EAAE,EAAE,CAAC,CAAC;aAChC;SAED;aAAM;YACN,iDAAiD;YACjD,KAAK,GAAG,CAAC,CAAC,IAAI,CAAC,UAAU,CAAC,KAAK,CAAC,CAAC;YAEjC,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,GAAG,GAAG,KAAK,CAAC,MAAM,EAAE,CAAC,GAAG,GAAG,EAAE,CAAC,EAAE,EAAE;gBACjD,IAAI,CAAC,GAAG,CAAC,KAAK,CAAC,CAAC,CAAC,EAAE,EAAE,EAAE,OAAO,CAAC,CAAC;aAChC;SACD;QAED,OAAO,IAAI,CAAC;IACb,CAAC;IAED,GAAG,EAAE,UAAU,KAAK,EAAE,EAAE,EAAE,OAAO;QAEhC,IAAI,CAAC,KAAK,EAAE;YACX,kDAAkD;YAClD,OAAO,IAAI,CAAC,OAAO,CAAC;SAEpB;aAAM,IAAI,OAAO,KAAK,KAAK,QAAQ,EAAE;YACrC,KAAK,IAAI,IAAI,IAAI,KAAK,EAAE;gBACvB,IAAI,CAAC,IAAI,CAAC,IAAI,EAAE,KAAK,CAAC,IAAI,CAAC,EAAE,EAAE,CAAC,CAAC;aACjC;SAED;aAAM;YACN,KAAK,GAAG,CAAC,CAAC,IAAI,CAAC,UAAU,CAAC,KAAK,CAAC,CAAC;YAEjC,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,GAAG,GAAG,KAAK,CAAC,MAAM,EAAE,CAAC,GAAG,GAAG,EAAE,CAAC,EAAE,EAAE;gBACjD,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC,EAAE,EAAE,EAAE,OAAO,CAAC,CAAC;aACjC;SACD;QAED,OAAO,IAAI,CAAC;IACb,CAAC;IAED,gDAAgD;IAChD,GAAG,EAAE,UAAU,IAAI,EAAE,EAAE,EAAE,OAAO;QAE/B,IAAI,MAAM,GAAG,IAAI,CAAC,OAAO,GAAG,IAAI,CAAC,OAAO,IAAI,EAAE,EAC1C,SAAS,GAAG,OAAO,IAAI,OAAO,KAAK,IAAI,IAAI,CAAC,CAAC,KAAK,CAAC,OAAO,CAAC,CAAC;QAEhE,IAAI,SAAS,EAAE;YACd,4EAA4E;YAC5E,uFAAuF;YAEvF,IAAI,QAAQ,GAAG,IAAI,GAAG,MAAM,EACxB,WAAW,GAAG,IAAI,GAAG,MAAM,EAC3B,SAAS,GAAG,MAAM,CAAC,QAAQ,CAAC,GAAG,MAAM,CAAC,QAAQ,CAAC,IAAI,EAAE,EACrD,EAAE,GAAG,CAAC,CAAC,KAAK,CAAC,EAAE,CAAC,GAAG,GAAG,GAAG,SAAS,CAAC;YAEvC,IAAI,CAAC,SAAS,CAAC,EAAE,CAAC,EAAE;gBACnB,SAAS,CAAC,EAAE,CAAC,GAAG,EAAC,EAAE,EAAE,EAAE,EAAE,GAAG,EAAE,OAAO,EAAC,CAAC;gBAEvC,+EAA+E;gBAC/E,MAAM,CAAC,WAAW,CAAC,GAAG,CAAC,MAAM,CAAC,WAAW,CAAC,IAAI,CAAC,CAAC,GAAG,CAAC,CAAC;aACrD;SAED;aAAM;YACN,qFAAqF;YACrF,oFAAoF;YAEpF,MAAM,CAAC,IAAI,CAAC,GAAG,MAAM,CAAC,IAAI,CAAC,IAAI,EAAE,CAAC;YAClC,MAAM,CAAC,IAAI,CAAC,CAAC,IAAI,CAAC,EAAC,EAAE,EAAE,EAAE,EAAC,CAAC,CAAC;SAC5B;IACF,CAAC;IAED,IAAI,EAAE,UAAU,IAAI,EAAE,EAAE,EAAE,OAAO;QAChC,IAAI,MAAM,GAAG,IAAI,CAAC,OAAO,EACrB,QAAQ,GAAG,IAAI,GAAG,MAAM,EACxB,WAAW,GAAG,IAAI,GAAG,MAAM,CAAC;QAEhC,IAAI,CAAC,MAAM,EAAE;YAAE,OAAO;SAAE;QAExB,IAAI,CAAC,EAAE,EAAE;YACR,6DAA6D;YAC7D,OAAO,MAAM,CAAC,IAAI,CAAC,CAAC;YACpB,OAAO,MAAM,CAAC,QAAQ,CAAC,CAAC;YACxB,OAAO,MAAM,CAAC,WAAW,CAAC,CAAC;YAC3B,OAAO;SACP;QAED,IAAI,SAAS,GAAG,OAAO,IAAI,OAAO,KAAK,IAAI,IAAI,CAAC,CAAC,KAAK,CAAC,OAAO,CAAC,EAC3D,SAAS,EAAE,CAAC,EAAE,GAAG,EAAE,QAAQ,EAAE,EAAE,CAAC;QAEpC,IAAI,SAAS,EAAE;YACd,EAAE,GAAG,CAAC,CAAC,KAAK,CAAC,EAAE,CAAC,GAAG,GAAG,GAAG,SAAS,CAAC;YACnC,SAAS,GAAG,MAAM,CAAC,QAAQ,CAAC,CAAC;YAE7B,IAAI,SAAS,IAAI,SAAS,CAAC,EAAE,CAAC,EAAE;gBAC/B,QAAQ,GAAG,SAAS,CAAC,EAAE,CAAC,CAAC;gBACzB,OAAO,SAAS,CAAC,EAAE,CAAC,CAAC;gBACrB,MAAM,CAAC,WAAW,CAAC,EAAE,CAAC;aACtB;SAED;aAAM;YACN,SAAS,GAAG,MAAM,CAAC,IAAI,CAAC,CAAC;YAEzB,IAAI,SAAS,EAAE;gBACd,KAAK,CAAC,GAAG,CAAC,EAAE,GAAG,GAAG,SAAS,CAAC,MAAM,EAAE,CAAC,GAAG,GAAG,EAAE,CAAC,EAAE,EAAE;oBACjD,IAAI,SAAS,CAAC,CAAC,CAAC,CAAC,EAAE,KAAK,EAAE,EAAE;wBAC3B,QAAQ,GAAG,SAAS,CAAC,CAAC,CAAC,CAAC;wBACxB,SAAS,CAAC,MAAM,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;wBACvB,MAAM;qBACN;iBACD;aACD;SACD;QAED,kFAAkF;QAClF,IAAI,QAAQ,EAAE;YACb,QAAQ,CAAC,EAAE,GAAG,CAAC,CAAC,IAAI,CAAC,OAAO,CAAC;SAC7B;IACF,CAAC;IAED,IAAI,EAAE,UAAU,IAAI,EAAE,IAAI,EAAE,SAAS;QACpC,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC,IAAI,EAAE,SAAS,CAAC,EAAE;YAAE,OAAO,IAAI,CAAC;SAAE;QAEpD,IAAI,KAAK,GAAG,CAAC,CAAC,IAAI,CAAC,MAAM,CAAC,EAAE,EAAE,IAAI,EAAE,EAAC,IAAI,EAAE,IAAI,EAAE,MAAM,EAAE,IAAI,EAAC,CAAC,EAC3D,MAAM,GAAG,IAAI,CAAC,OAAO,CAAC;QAE1B,IAAI,MAAM,EAAE;YACX,IAAI,SAAS,GAAG,MAAM,CAAC,IAAI,GAAG,MAAM,CAAC,EACjC,CAAC,EAAE,GAAG,EAAE,SAAS,EAAE,EAAE,CAAC;YAE1B,IAAI,MAAM,CAAC,IAAI,CAAC,EAAE;gBACjB,uFAAuF;gBACvF,SAAS,GAAG,MAAM,CAAC,IAAI,CAAC,CAAC,KAAK,EAAE,CAAC;gBAEjC,KAAK,CAAC,GAAG,CAAC,EAAE,GAAG,GAAG,SAAS,CAAC,MAAM,EAAE,CAAC,GAAG,GAAG,EAAE,CAAC,EAAE,EAAE;oBACjD,SAAS,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,IAAI,CAAC,IAAI,EAAE,KAAK,CAAC,CAAC;iBAClC;aACD;YAED,uDAAuD;YACvD,KAAK,EAAE,IAAI,SAAS,EAAE;gBACrB,SAAS,CAAC,EAAE,CAAC,CAAC,EAAE,CAAC,IAAI,CAAC,SAAS,CAAC,EAAE,CAAC,CAAC,GAAG,EAAE,KAAK,CAAC,CAAC;aAChD;SACD;QAED,IAAI,SAAS,EAAE;YACd,2DAA2D;YAC3D,IAAI,CAAC,eAAe,CAAC,KAAK,CAAC,CAAC;SAC5B;QAED,OAAO,IAAI,CAAC;IACb,CAAC;IAED,OAAO,EAAE,UAAU,IAAI,EAAE,SAAS;QACjC,IAAI,MAAM,GAAG,IAAI,CAAC,OAAO,CAAC;QAE1B,IAAI,MAAM,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,IAAI,MAAM,CAAC,IAAI,GAAG,MAAM,CAAC,CAAC,EAAE;YAAE,OAAO,IAAI,CAAC;SAAE;QAEvE,IAAI,SAAS,EAAE;YACd,uDAAuD;YACvD,KAAK,IAAI,EAAE,IAAI,IAAI,CAAC,aAAa,EAAE;gBAClC,IAAI,IAAI,CAAC,aAAa,CAAC,EAAE,CAAC,CAAC,OAAO,CAAC,IAAI,EAAE,SAAS,CAAC,EAAE;oBAAE,OAAO,IAAI,CAAC;iBAAE;aACrE;SACD;QACD,OAAO,KAAK,CAAC;IACd,CAAC;IAED,IAAI,EAAE,UAAU,KAAK,EAAE,EAAE,EAAE,OAAO;QAEjC,IAAI,OAAO,KAAK,KAAK,QAAQ,EAAE;YAC9B,KAAK,IAAI,IAAI,IAAI,KAAK,EAAE;gBACvB,IAAI,CAAC,IAAI,CAAC,IAAI,EAAE,KAAK,CAAC,IAAI,CAAC,EAAE,EAAE,CAAC,CAAC;aACjC;YACD,OAAO,IAAI,CAAC;SACZ;QAED,IAAI,OAAO,GAAG,CAAC,CAAC,IAAI,CAAC;YACpB,IAAI;iBACC,GAAG,CAAC,KAAK,EAAE,EAAE,EAAE,OAAO,CAAC;iBACvB,GAAG,CAAC,KAAK,EAAE,OAAO,EAAE,OAAO,CAAC,CAAC;QACnC,CAAC,EAAE,IAAI,CAAC,CAAC;QAET,6DAA6D;QAC7D,OAAO,IAAI;aACN,EAAE,CAAC,KAAK,EAAE,EAAE,EAAE,OAAO,CAAC;aACtB,EAAE,CAAC,KAAK,EAAE,OAAO,EAAE,OAAO,CAAC,CAAC;IAClC,CAAC;IAED,mFAAmF;IACnF,cAAc,EAAE,UAAU,GAAG;QAC5B,IAAI,CAAC,aAAa,GAAG,IAAI,CAAC,aAAa,IAAI,EAAE,CAAC;QAC9C,IAAI,CAAC,aAAa,CAAC,CAAC,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,GAAG,GAAG,CAAC;QACvC,OAAO,IAAI,CAAC;IACb,CAAC;IAED,iBAAiB,EAAE,UAAU,GAAG;QAC/B,IAAI,IAAI,CAAC,aAAa,EAAE;YACvB,OAAO,IAAI,CAAC,aAAa,CAAC,CAAC,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC;SACxC;QACD,OAAO,IAAI,CAAC;IACb,CAAC;IAED,eAAe,EAAE,UAAU,CAAC;QAC3B,KAAK,IAAI,EAAE,IAAI,IAAI,CAAC,aAAa,EAAE;YAClC,IAAI,CAAC,aAAa,CAAC,EAAE,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,IAAI,EAAE,CAAC,CAAC,MAAM,CAAC,EAAC,KAAK,EAAE,CAAC,CAAC,MAAM,EAAC,EAAE,CAAC,CAAC,EAAE,IAAI,CAAC,CAAC;SAC1E;IACF,CAAC;CACD,CAAC,CAAC;AAEH,IAAI,KAAK,GAAG,CAAC,CAAC,OAAO,CAAC,SAAS,CAAC;AAEhC,4CAA4C;AAC5C,KAAK,CAAC,gBAAgB,GAAG,KAAK,CAAC,EAAE,CAAC;AAClC,KAAK,CAAC,mBAAmB,GAAG,KAAK,CAAC,sBAAsB,GAAG,KAAK,CAAC,GAAG,CAAC;AACrE,KAAK,CAAC,uBAAuB,GAAG,KAAK,CAAC,IAAI,CAAC;AAC3C,KAAK,CAAC,SAAS,GAAG,KAAK,CAAC,IAAI,CAAC;AAC7B,KAAK,CAAC,iBAAiB,GAAG,KAAK,CAAC,OAAO,CAAC;AAExC,CAAC,CAAC,KAAK,GAAG,EAAC,MAAM,EAAE,KAAK,EAAC,CAAC","sourcesContent":["/* -*- js-indent-level: 8 -*- */\n/*\n * L.Evented is a base class that Leaflet classes inherit from to handle custom events.\n */\n\nL.Evented = L.Class.extend({\n\n\ton: function (types, fn, context) {\n\n\t\t// types can be a map of types/handlers\n\t\tif (typeof types === 'object') {\n\t\t\tfor (var type in types) {\n\t\t\t\t// we don't process space-separated events here for performance;\n\t\t\t\t// it's a hot path since Layer uses the on(obj) syntax\n\t\t\t\tthis._on(type, types[type], fn);\n\t\t\t}\n\n\t\t} else {\n\t\t\t// types can be a string of space-separated words\n\t\t\ttypes = L.Util.splitWords(types);\n\n\t\t\tfor (var i = 0, len = types.length; i < len; i++) {\n\t\t\t\tthis._on(types[i], fn, context);\n\t\t\t}\n\t\t}\n\n\t\treturn this;\n\t},\n\n\toff: function (types, fn, context) {\n\n\t\tif (!types) {\n\t\t\t// clear all listeners if called without arguments\n\t\t\tdelete this._events;\n\n\t\t} else if (typeof types === 'object') {\n\t\t\tfor (var type in types) {\n\t\t\t\tthis._off(type, types[type], fn);\n\t\t\t}\n\n\t\t} else {\n\t\t\ttypes = L.Util.splitWords(types);\n\n\t\t\tfor (var i = 0, len = types.length; i < len; i++) {\n\t\t\t\tthis._off(types[i], fn, context);\n\t\t\t}\n\t\t}\n\n\t\treturn this;\n\t},\n\n\t// attach listener (without syntactic sugar now)\n\t_on: function (type, fn, context) {\n\n\t\tvar events = this._events = this._events || {},\n\t\t    contextId = context && context !== this && L.stamp(context);\n\n\t\tif (contextId) {\n\t\t\t// store listeners with custom context in a separate hash (if it has an id);\n\t\t\t// gives a major performance boost when firing and removing events (e.g. on map object)\n\n\t\t\tvar indexKey = type + '_idx',\n\t\t\t    indexLenKey = type + '_len',\n\t\t\t    typeIndex = events[indexKey] = events[indexKey] || {},\n\t\t\t    id = L.stamp(fn) + '_' + contextId;\n\n\t\t\tif (!typeIndex[id]) {\n\t\t\t\ttypeIndex[id] = {fn: fn, ctx: context};\n\n\t\t\t\t// keep track of the number of keys in the index to quickly check if it's empty\n\t\t\t\tevents[indexLenKey] = (events[indexLenKey] || 0) + 1;\n\t\t\t}\n\n\t\t} else {\n\t\t\t// individual layers mostly use \"this\" for context and don't fire listeners too often\n\t\t\t// so simple array makes the memory footprint better while not degrading performance\n\n\t\t\tevents[type] = events[type] || [];\n\t\t\tevents[type].push({fn: fn});\n\t\t}\n\t},\n\n\t_off: function (type, fn, context) {\n\t\tvar events = this._events,\n\t\t    indexKey = type + '_idx',\n\t\t    indexLenKey = type + '_len';\n\n\t\tif (!events) { return; }\n\n\t\tif (!fn) {\n\t\t\t// clear all listeners for a type if function isn't specified\n\t\t\tdelete events[type];\n\t\t\tdelete events[indexKey];\n\t\t\tdelete events[indexLenKey];\n\t\t\treturn;\n\t\t}\n\n\t\tvar contextId = context && context !== this && L.stamp(context),\n\t\t    listeners, i, len, listener, id;\n\n\t\tif (contextId) {\n\t\t\tid = L.stamp(fn) + '_' + contextId;\n\t\t\tlisteners = events[indexKey];\n\n\t\t\tif (listeners && listeners[id]) {\n\t\t\t\tlistener = listeners[id];\n\t\t\t\tdelete listeners[id];\n\t\t\t\tevents[indexLenKey]--;\n\t\t\t}\n\n\t\t} else {\n\t\t\tlisteners = events[type];\n\n\t\t\tif (listeners) {\n\t\t\t\tfor (i = 0, len = listeners.length; i < len; i++) {\n\t\t\t\t\tif (listeners[i].fn === fn) {\n\t\t\t\t\t\tlistener = listeners[i];\n\t\t\t\t\t\tlisteners.splice(i, 1);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// set the removed listener to noop so that's not called if remove happens in fire\n\t\tif (listener) {\n\t\t\tlistener.fn = L.Util.falseFn;\n\t\t}\n\t},\n\n\tfire: function (type, data, propagate) {\n\t\tif (!this.listens(type, propagate)) { return this; }\n\n\t\tvar event = L.Util.extend({}, data, {type: type, target: this}),\n\t\t    events = this._events;\n\n\t\tif (events) {\n\t\t\tvar typeIndex = events[type + '_idx'],\n\t\t\t    i, len, listeners, id;\n\n\t\t\tif (events[type]) {\n\t\t\t\t// make sure adding/removing listeners inside other listeners won't cause infinite loop\n\t\t\t\tlisteners = events[type].slice();\n\n\t\t\t\tfor (i = 0, len = listeners.length; i < len; i++) {\n\t\t\t\t\tlisteners[i].fn.call(this, event);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// fire event for the context-indexed listeners as well\n\t\t\tfor (id in typeIndex) {\n\t\t\t\ttypeIndex[id].fn.call(typeIndex[id].ctx, event);\n\t\t\t}\n\t\t}\n\n\t\tif (propagate) {\n\t\t\t// propagate the event to parents (set with addEventParent)\n\t\t\tthis._propagateEvent(event);\n\t\t}\n\n\t\treturn this;\n\t},\n\n\tlistens: function (type, propagate) {\n\t\tvar events = this._events;\n\n\t\tif (events && (events[type] || events[type + '_len'])) { return true; }\n\n\t\tif (propagate) {\n\t\t\t// also check parents for listeners if event propagates\n\t\t\tfor (var id in this._eventParents) {\n\t\t\t\tif (this._eventParents[id].listens(type, propagate)) { return true; }\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t},\n\n\tonce: function (types, fn, context) {\n\n\t\tif (typeof types === 'object') {\n\t\t\tfor (var type in types) {\n\t\t\t\tthis.once(type, types[type], fn);\n\t\t\t}\n\t\t\treturn this;\n\t\t}\n\n\t\tvar handler = L.bind(function () {\n\t\t\tthis\n\t\t\t    .off(types, fn, context)\n\t\t\t    .off(types, handler, context);\n\t\t}, this);\n\n\t\t// add a listener that's executed once and removed after that\n\t\treturn this\n\t\t    .on(types, fn, context)\n\t\t    .on(types, handler, context);\n\t},\n\n\t// adds a parent to propagate events to (when you fire with true as a 3rd argument)\n\taddEventParent: function (obj) {\n\t\tthis._eventParents = this._eventParents || {};\n\t\tthis._eventParents[L.stamp(obj)] = obj;\n\t\treturn this;\n\t},\n\n\tremoveEventParent: function (obj) {\n\t\tif (this._eventParents) {\n\t\t\tdelete this._eventParents[L.stamp(obj)];\n\t\t}\n\t\treturn this;\n\t},\n\n\t_propagateEvent: function (e) {\n\t\tfor (var id in this._eventParents) {\n\t\t\tthis._eventParents[id].fire(e.type, L.extend({layer: e.target}, e), true);\n\t\t}\n\t}\n});\n\nvar proto = L.Evented.prototype;\n\n// aliases; we should ditch those eventually\nproto.addEventListener = proto.on;\nproto.removeEventListener = proto.clearAllEventListeners = proto.off;\nproto.addOneTimeEventListener = proto.once;\nproto.fireEvent = proto.fire;\nproto.hasEventListeners = proto.listens;\n\nL.Mixin = {Events: proto};\n"]}